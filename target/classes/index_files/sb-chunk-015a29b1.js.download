(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["pro-spnews~pro-sptext"],{YXgF:function(e,r,t){"use strict";function s(e){return encodeURIComponent(e).replace(/'+/g,"''")}t.d(r,"a",function(){return s})},ncub:function(e,r,t){"use strict";var s=t("KmCS");r.a=Object(s.regs)("searchux.clientVersion","",!0)},qDPO:function(e,r,t){"use strict";t.d(r,"a",function(){return O}),t.d(r,"c",function(){return R}),t.d(r,"b",function(){return T});var s,a,o,n=t("D57K"),i=t("UlRC");t("PWby");!function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn"}(s||(s={})),function(e){e.test="test",e.inner="inner",e.outer="outer",e.insiders="insiders",e.generalAudience="generalAudience"}(a||(a={})),function(e){e.Select="Select",e.Deselect="Deselect",e.SelectAndDeselect="SelectAndDeselect"}(o||(o={}));var c,u=t("r6MD"),h=t("gDU4"),l=t("LB+V");!function(e){e.persRankCtxStream="ms-oil-datasource-spopersonalcontext",e.withAnySpDigest="ms-oil-datasource-SharePointDigest",e.persResStream="ms-oil-datasource-personalizedalldatasource",e.persPeopleStream="ms-oil-datasource-personalized-person",e.newsStream="ms-oil-datasource-newsdatasource",e.bestBetsStream="ms-oil-datasource-bestbetDataSource",e.unpersResStream="ms-oil-datasource-alldatasource",e.unpersPeopleStream="ms-oil-datasource-person",e.substrateSearchForAnswersEchoStream="mssearchux-cache-3s-answersEcho-iframe",e.substrateSearchForAssociatedSitesStream="mssearchux-cache-3s-associated-sites-iframe",e.substrateSearchForFilesStream="mssearchux-cache-3s-files-iframe",e.substrateSearchForPeopleStream="mssearchux-cache-3s-people-iframe",e.substrateSearchForNewsStream="mssearchux-cache-3s-news-iframe",e.substrateSearchForSiteStream="mssearchux-cache-3s-site-iframe",e.substrateSearchForAllStream="mssearchux-cache-3s-all-iframe",e.substrateSearchForBestBetsStream="mssearchux-cache-3s-bestBest-iframe",e.substrateSearchForOneDriveStream="mssearchux-cache-3s-onedrive-iframe",e.substrateSearchForConnectorStream="mssearchux-cache-3s-connector-iframe",e.substrateSearchForConversationStream="mssearchux-cache-3s-conversation-iframe",e.substrateSearchForCustomResults="mssearchux-cache-3s-custom-results-iframe",e.substrateSearchForCustomResultsEchoQuery="mssearchux-cache-3s-customQueryEcho-results-iframe",e.substrateSearchForSharepointCustomResults="mssearchux-cache-3s-sharepoint-custom-results-iframe",e.substrateSearchForSingleQueryEchoStream="mssearchux-cache-3s-singleQueryEcho-iframe",e.substrateSearchcombinedAnswerAndSerpQueryEchoStream="mssearchux-cache-3s-combinedAnswerAndSerpQueryEcho-iframe",e.substrateSearchForConnectorQueryEchoStream="mssearchux-cache-3s-connectorQueryEcho-iframe",e.substrateSearchForSingleQueryStream="mssearchux-cache-3s-singleQuery-iframe",e.substrateSearchForSingleQueryWithAnswerStream="mssearchux-cache-3s-singleQueryWithAnswer-iframe",e.substrateSearchForSingleQueryWprStream="mssearchux-cache-3s-singleQueryWpr-iframe",e.substrateSearchForSiteSingleQueryStream="mssearchux-cache-3s-siteSingleQuery-iframe",e.substrateSearchForSiteSingleQueryWprStream="mssearchux-cache-3s-siteSingleQueryWpr-iframe",e.substrateSearchForMergedFilesQueryStream="mssearchux-cache-3s-mergedFilesQueryForFilesVertical-iframe",e.substrateSearchForVideosQueryStream="mssearchux-cache-3s-queryForVideosVertical-iframe",e.substrateSearchForStreamVideosQueryStream="mssearchux-cache-3s-queryForStreamVideosVertical-iframe",e.substrateSearchForTopicsQueryStream="mssearchux-cache-3s-queryForTopicsVertical-iframe",e.substrateSearchForImagesQueryStream="mssearchux-cache-3s-queryForImages-iframe",e.substrateActionSearchChannelStream="mssearchux-cache-3s-actionSearchChannel-iframe",e.substrateSearchForPersonContentQueryStream="mssearchux-cache-3s-queryForPersonContent-iframe",e.substrateSearchForPersonConversationsQueryStream="mssearchux-cache-3s-queryForPersonConversations-iframe",e.spStream="ms-oil-datasource-personalized-files",e.hubSitesStream="mssearchux-cache-spohubsitesinfo",e.personalizedSitesStream="ms-oil-datasource-personalized-sites",e.unPersonalizedSitesStream="ms-oil-datasource-sites"}(c||(c={}));var m=t("2rja");var d=t("A280");function p(e,r){if(!r)throw new Error("Parameter "+e+" must be specified.")}var f,S="logMessage",g="errorMessage",b=function(){function e(e,r,t){p("type",e),p("source",r),p("data",t),this._type=e,this._source=r,this._data=t}return e.prototype.getType=function(){return this._type},e.prototype.getSource=function(){return this._source},e.prototype.getData=function(){return this._data},e}();!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warn=2]="Warn",e[e.Error=3]="Error"}(f||(f={}));var y=function(e,r,t,s){var a=(new Date).getTime(),o=s||{};return new b(S,e,{getLevel:Object(d.a)(t),getType:Object(d.a)(r),getTimestamp:Object(d.a)(a),getProperties:Object(d.a)(s),serialize:Object(d.a)(JSON.stringify(Object(n.__assign)(Object(n.__assign)({},o),{msoilSource:e.getId(),msoilType:r,msoilTimestamp:a,msoilLevel:f[t]})))})},v=t("OJcW"),_={UNKNOWN_ERROR:"unknown_error",PROPS_TIMED_OUT:"props_timed_out",HTTP_CLIENT_ERROR:"http_client_error",HTTP_SERVER_ERROR:"http_server_error",JSON_PARSE_ERROR:"json_parse_error"};var O,I=function(){function e(e){this.params=e}return e.tryCreateOilErrorFromXhr=function(e,r){if(!Boolean(e))return null;var t=e.status,s=null==t?"":t.toString(),a=e.statusText,o=e.getResponseHeader("SPRequestGuid");if(!Object(v.c)(e.responseText))try{var n=JSON.parse(e.responseText);Boolean(n)&&(Object(v.c)(n.ErrorCode)||(s=n.ErrorCode),Object(v.c)(n.ErrorMessage)||(a=n.ErrorMessage))}catch(e){}return{originalError:a,errorCode:s,serverCorrelationId:o,requestType:r}},e.prototype.createErrorMessage=function(e){return new b(g,e,this)},e}(),x=f,C={itemFetched:"itemFetched",cacheReset:"cacheReset",mismatchingQueryHash:"mismatchingQueryHash",serverSideQueryTimeout:"serverSideQueryTimeout"},E="sprequestduration";!function(e){var r="SPRequestGuid";function t(e,r,t,s){return i.Observable.returnValue({correlationID:e,sprequestduration:r,status:t,body:s})}var s="";function a(e,a){var o=e.getResponseHeader(r),n=e.status;if(n>=400&&n<500)throw new I({originalError:e.responseText,errorCode:_.HTTP_CLIENT_ERROR,xhr:e,queryId:o});if(n>=500&&n<600)throw new I({originalError:e.responseText,errorCode:_.HTTP_SERVER_ERROR,xhr:e,queryId:o});var i=s;-1!==e.getAllResponseHeaders().toLowerCase().indexOf(E)&&(i=e.getResponseHeader(E));try{return t(o,i,n,a(e))}catch(r){throw new I({originalError:"Failed to parse JSON from SPResponse",errorCode:_.JSON_PARSE_ERROR,xhr:e,queryId:o})}}function o(e,r){return e.selectMany(function(e){return r(i.Observable.returnValue(Object(n.__assign)(Object(n.__assign)({},e.body),{headers:{sprequestguid:e.correlationID}}))).selectMany(function(r){return t(e.correlationID,e.sprequestduration,e.status,r)})})}e.CreateObservableSPResponseFromXHR=a,e.CreateObservableSPResponseFromID=function(e,r,a){return t(e,s,r,a)},e.mapBody=function(e,r){return e.selectMany(function(e){return r(i.Observable.fromArray(e.body)).toArray().selectMany(function(r){return t(e.correlationID,e.sprequestduration,e.status,r)})})},e.applyToBody=o,e.parseAndExtractSPXHR=function(e,r,t){return o(a(e,r),function(e){return e.select(t)})}}(O||(O={}));var w,F=function(){function e(){}return e.prototype.load=function(e){try{return sessionStorage.getItem(e)}catch(e){return null}},e.prototype.save=function(e,r){try{sessionStorage.setItem(e,r)}catch(e){}},e}();!function(e){var r=function(){function e(e,r,t,s){this._obs=e,r&&(this._fetched=r),s&&(this._value=s),this._subscribed=t||!1}return e.prototype.expired=function(e){var r=(new Date).valueOf()-e;return this._fetched<=r},e.prototype.fetchPending=function(){return!!this._obs},e.prototype.getObservable=function(){return this._obs},e.prototype.getSubscribed=function(){return this._subscribed},e.prototype.setSubscribed=function(){if(this._subscribed)throw Error("Subcription cannot be set more than once.");this._subscribed=!0},e.prototype.getValue=function(){return this._value},e.prototype.setValue=function(e){this._fetched=(new Date).valueOf(),this._obs=null,this._value=e},e}();e.DataSourceCacheItem=r}(w||(w={}));var R=function(e){function r(r){var t=r.id,s=r.version,a=r.refreshIntervalMs,o=r.ignoreCache,n=void 0!==o&&o,i=r.microserviceFlights,c=e.call(this,{id:t,version:s,refreshIntervalMs:a,ignoreCache:n,storage:new F})||this;return i&&(c._microserviceFlights=i.join(";")),c}return Object(n.__extends)(r,e),r}(function(){function e(e){var r=e.id,t=e.version,s=e.storage,a=e.refreshIntervalMs,o=e.ignoreCache,n=void 0!==o&&o;this._id=r,this._refreshIntervalMs=a||Number.MAX_VALUE,this._version=t,this.load=s.load,this.save=s.save,this._logger=new i.Subject,n?this.clearCache():this.initCache()}return e.prototype.fetchItem=function(e,r){throw new Error("Not implemented")},e.prototype.getId=function(){return"ms-oil-datasource-"+this._id},e.prototype.loadCache=function(r,t,s){var a=this;t=t||{};var o=e.key(r),c=this._cache;if(this.queriesLoading||(this.queriesLoading={}),s)return c[o]=new w.DataSourceCacheItem(null,(new Date).getTime(),!1,s),i.Observable.empty();if(!this.queriesLoading[o]){var u=(new Date).getTime();this.queriesLoading[o]=new i.Subject,this.fetchItem(r,t).subscribe(function(e){t=Object(n.__assign)(Object(n.__assign)({},t),{msoilDurationMs:(new Date).getTime()-u}),a._logger.onNext(y(a,C.itemFetched,x.Info,t)),c[o]=new w.DataSourceCacheItem(null,(new Date).getTime(),!1,e),a.updateCache(),a.queriesLoading[o].onNext(e),a.queriesLoading[o].onCompleted(),a.queriesLoading[o]=null},function(e){delete c[o],a.updateCache(),a.queriesLoading[o].onError(e),a.queriesLoading[o].onCompleted(),a.queriesLoading[o]=null})}return this.queriesLoading[o]?this.queriesLoading[o]:i.Observable.returnValue(c[o].getValue())},e.prototype.resetCache=function(){this._cache={},this.updateCache(),this._logger.onNext(y(this,C.cacheReset,x.Info,{}))},e.prototype.key=function(r){return e.key(r)},e.prototype.getItem=function(r,t,a){var o=this;t=t||{};var u=this.key(r),h=this._cache,l=h[u],d=l&&l.expired(this._refreshIntervalMs);if(!l||d&&!t.useStale){if(t.onlyCache){if(t.serverCtxKey){var p=e.key(t.serverCtxKey),f=h[p];if(f){var S=f.getValue();return t.flushCacheEntry&&(delete h[p],this.updateCache()),i.Observable.returnValue(S)}return i.Observable.empty()}return i.Observable.empty()}if(t.persistent)return this.loadCache(r,t);var g=(new Date).getTime(),b=t,v=b&&"function"==typeof b.session?b.session():void 0,_=v&&"function"==typeof v.getId?v.getId():void 0,O=function(e){return e&&e.name?{version:2,status:0,providerName:o.getId(),properties:{promiseFactoryFailed:!1,error:e.name}}:{version:2,status:e.status,traceId:e.correlationID,providerName:o.getId(),properties:{diagnostics:JSON.stringify(e.diagnostics),latencies:e.latencies}}};return([c.persResStream,c.unpersResStream,c.bestBetsStream,c.persPeopleStream,c.unpersPeopleStream,c.spStream,c.unPersonalizedSitesStream,c.personalizedSitesStream,c.newsStream].map(function(e){return e.toString()}).indexOf(o.getId())>-1?i.Observable.fromPromise(Object(m.a)({monitorName:this.getId(),factoryErrorPropExtractor:function(e){return{version:2,status:e&&e.status||0,providerName:o.getId(),properties:{promiseFactoryFailed:!0}}},successPropExtractor:O,failurePropExtractor:O},function(e){return o.fetchItem(e.key,e.props).toPromise(Promise)})({key:r,props:t})):this.fetchItem(r,t)).monitor({isHot:!1,eventName:"oil_ds_base_fetch",nameDetail:this.getId(),additionalLogProperties:Object(n.__assign)({dataSource:this.getId(),searchSessionId:_},a)},function(e){if(!e)return{};var r={diagnostics:JSON.stringify(e.diagnostics),correlationID:e.correlationID,correlationType:e.correlationType,latencies:e.latencies,status:e.status};return e.bodyElapsedTime?r.bodyElapsedTime=e.bodyElapsedTime:e.body&&e.body.bodyElapsedTime&&(r.bodyElapsedTime=e.body.bodyElapsedTime),e.sprequestduration&&(r[E]=e.sprequestduration),r},function(e){var r,t,a=null;if(e instanceof XMLHttpRequest)a=I.tryCreateOilErrorFromXhr(e,o._id),r=e.statusText;else if(e instanceof Error){var n=e.message;t=n,a={errorCode:"",originalError:n,requestType:o._id}}return{correlationID:a&&a.serverCorrelationId,errorCode:a&&a.errorCode,responseStatusText:r,clientExceptionText:{value:t,pii:s.GenericData}}}).doAction(function(e){var r=(new Date).getTime()-g;t=Object(n.__assign)(Object(n.__assign)({},t),{msoilDurationMs:r}),o._logger.onNext(y(o,C.itemFetched,x.Info,t)),h[u]=new w.DataSourceCacheItem(null,(new Date).getTime(),!1,e),o.updateCache()}).catchException(function(e){throw delete h[u],o.updateCache(),e})}if(t.onlyCache)return i.Observable.empty();var F=l.getValue();return i.Observable.returnValue(F)},e.prototype.log=function(){if(!this._connectableLogger){var e=this._logger.asObservable();this._connectableLogger=e.publish(),this._connectableLogger.connect()}return this._connectableLogger.select(function(e){return e})},e.prototype.parseJSON=function(e){try{return JSON.parse(e)}catch(e){throw new Error(this.getId()+", parsing JSON : "+e.message)}},e.prototype.parseResponse=function(e){var r=this.getId()+", parsing JSON, status:"+e.status+", type:"+e.getResponseHeader("content-type"),t=e.responseText;if(null!=t&&(r+=", length:"+t.length,t.length)){var s=t.trim();r+=", starts:"+s.substr(0,5),r+=", ends:"+s.substr(Math.max(0,s.length-5),5)}try{return JSON.parse(t)}catch(e){throw new Error(r+e.message)}},e.prototype.traverseObject=function(e,r){var t=Object(u.a)(r,e);if(!t)throw new Error("traversing path '"+e+"'");return t},e.prototype.getVersionId=function(){return this.getId()+"-version"},e.prototype.initCache=function(){this._version===JSON.parse(this.load(this.getVersionId()))?(this._cache=JSON.parse(this.load(this.getId()))||{},this.completeLoad()):(this.clearCache(),this.save(this.getVersionId(),JSON.stringify(this._version)))},e.prototype.clearCache=function(){this._cache={},this.updateCache()},e.prototype.completeLoad=function(){for(var e in this._cache)if(this._cache.hasOwnProperty(e)){var r=this._cache[e];r._value?this._cache[e]=new w.DataSourceCacheItem(null,r._fetched,r._subscribed,r._value):delete this._cache[e]}},e.prototype.updateCache=function(){this.save(this.getId(),JSON.stringify(this._cache))},e.key=function(e){!function(e,r,t){if(!e(t))throw new Error(r)}(h.a,"Key argument must be an object.",e);for(var r,t,s=0,a=Object.keys(e).sort(),o=a.length,n=[];s<o;s++)null===(r=e[t=a[s]])||void 0===r||Object(h.a)(r)||Object(l.a)(r)||(r+="")&&n.push(t+":"+r);return n.join(",")},e}()),T=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(r,e),r}(R)}}]);