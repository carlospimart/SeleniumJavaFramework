(window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0=window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0||[]).push([[2],{"1tKF":function(e,t,n){"use strict";n.d(t,"e",function(){return U});var a=n("17wl"),i=n("dq6a"),r=n("K9kD");function o(e){for(var t="";t.length<e;){var n=16*Math.random();t+=(n|=0).toString(16)}return t}function s(){var e=[];e.push(o(8)),e.push(o(4));var t="4"+o(3);e.push(t);var n=o(4),a=parseInt(n[0],16);return a&=3,n=(a|=8).toString(16)+n.substr(1),e.push(n),e.push(o(12)),e.join("-")}var c,d="undefined"==typeof window?self:window;!function(e){e.success="success",e.error="error"}(c||(c={}));var l="app",u="app_lastRead",f="ODSP_DB",p="ODSP_DB_TABLE",m="lastModified",_="lastRead",h="ODSP_DB_METADATA_TABLE",b="database_metadata",g="parentKey",v="reads",y=(new function(e){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0;e||(e=t&&t.navigator&&navigator.userAgent||"");var n,i=e,r=e.toLowerCase(),o=function(e){var t;function n(n){return t=RegExp("".concat(n,"(\\d+)([\\d.]*)")).exec(e)}e=e.toLowerCase();var a=n("msie ")||n("trident.*rv:"),i=t&&"9"===t[1],r=!t&&n("edge/"),o=!t&&n("edg/"),s=!t&&n("fxios|firefox/"),c=!t&&n("(?:chrome|crios)/"),d=!t&&/safari\/(\d+)/.test(e);return d&&n("version/"),{browserName:a?"IE":r?"Edge":o?"EdgeChromium":s?"Firefox":c?"Chrome":d?"Safari":"NA",isChrome:!!c,isEdge:!!r,isEdgeChromium:!!o,isFirefox:!!s,isIE:!!a,isIE9:!!i,isSafari:!!d,matchedBrowser:t}}(r),s={browserMajor:(n=o.matchedBrowser)&&parseInt(n[1],10)||0,browserMinor:n&&n[2]&&n[2].slice(1)||"0"},c=function(e){e=e.toLowerCase();var t=/windows phone|wpdesktop/.test(e),n=t||/ipad|iphone|ipod|android/.exec(e),a=n&&n[0],i="android"===a,r="ipad"===a,o=!!a&&!i,s=!n&&e.indexOf("macintosh")>-1,c=!n&&e.indexOf("windows nt")>-1;return{isAndroid:i,isIOS:o,isIPad:r,isMac:s,isWindows:c,isWinPhone:!!t,isMobile:!!n,osName:c?"Windows":t?"Windows Phone":s?"OSX":o?"IOS":i?"Android":"NA"}}(r),d=c.isMobile,l=/electron\/\\d+[\\d.]*/.test(r),u=r.indexOf("winappwipenabled")>-1,f=!("undefined"==typeof window||!window.matchMedia)&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches),p=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(r),m=!1,_=!1,h=!1,b=!1;if(t&&t.document){var g=document.createElement("style");g.type="text/css",m=!g.styleSheet,_="addBehavior"in HTMLDivElement.prototype;var v=document.createElement("input");v.type="file";var y=t.File,S=y&&y.prototype;b=!(!S||!(S.slice||S.mozSlice||S.webkitSlice)),h="webkitdirectory"in v&&!l}return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},o),s),c),{isElectron:l,osVersion:p?p[2]:"NA",isWindows81:!d&&/windows (?:8\.1|nt 6\.3)/.test(r),isWindows10:!d&&r.indexOf("windows nt 10")>-1,isWindows7:!d&&r.indexOf("windows nt 6.1")>-1,isWinAppWipEnabled:u,isPWA:f,areCSS3TransitionsSupported:!o.isIE||s.browserMajor>9,areTouchEventsSupported:!!t&&"ontouchstart"in t,isFolderUploadSupported:h,isHtml5FileUploadSupported:b,isRetinaSupported:!!t&&t.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:m,isWebDavSupported:_,userAgent:i})}).isFirefox,S="indexedDB is not supported",D=function(){function e(t){if(!("indexedDB"in d)||!d.indexedDB)throw new Error(S);this._logger=t,e._openDBPromise||(e._openDBPromise=this._openIndexedDB().then(function(t){return e._db=t,t}))}return e.prototype.freeSpace=function(t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=a.sent(),a.label=2;case 2:return i=r._db=o,[2,new Promise(function(e,a){var r=i.transaction([p],"readwrite").objectStore(p).index(u).openCursor();r.onsuccess=function(a){var i=r.result;i?(i.value.app===t&&n>0&&(n-=i.value.size,i.delete()),n>0?i.continue():e()):e()},r.onerror=function(e){s._errorHandling(e,a)}})]}})})},e.prototype.read=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return[2,this._readInternal(p,function(t){return t.get(e)})]})})},e.prototype.rangeQuery=function(t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,r,o,s,c,d,l,u,f,m,_,h,b=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n={},r=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=a.sent(),a.label=2;case 2:return i=r._db=o,s=i.transaction([p],"readonly"),c=s.objectStore(p),d=[],l=t.index,u=t.range,f=t.direction,m=t.count,_=c.index(l),(h=_.openKeyCursor(u,f)).onerror=function(e){b._errorHandling(e,n.reject)},h.onsuccess=function(e){var t=e.target.result;t?(d.push(t.primaryKey),d.length>=m?n.resolve(d):t.continue()):n.resolve(d)},[2,new Promise(function(e,t){n.resolve=e,n.reject=t})]}})})},e.prototype.write=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(n){return t=e.key,void 0!==e.data?[2,this._writeInternal({tableName:p,key:t,row:Object(a.__assign)(Object(a.__assign)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:p,key:t,row:void 0})]})})},e.prototype.statistics=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent(),this._dbMetaData=e,n.label=2;case 2:return[4,this._iterate(p,function(e){return e.size})];case 3:return t=n.sent(),[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})},e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(n,a){if(e._db)n(e._db);else{var i=y?indexedDB.open(f,{version:4,storage:"temporary"}):indexedDB.open(f,4);i.onerror=function(e){t._errorHandling(e,a)},i.onsuccess=function(t){var a=e._db=i.result;n(a)},i.onupgradeneeded=function(e){var n=e.target.result;n.onerror=function(e){t._errorHandling(e,a)};var r=e.oldVersion;t._handleDBUpgrade(i,n,r)}}})},e.prototype._handleDBUpgrade=function(e,t,n){var a;n<1&&((a=t.createObjectStore(p,{keyPath:"key"})).createIndex(m,m,{unique:!1}),a.createIndex(v,v,{unique:!1}),t.createObjectStore(h,{keyPath:"key"})),n<2&&((a=a||e.transaction.objectStore(p)).createIndex(l,l,{unique:!1}),a.createIndex(_,_,{unique:!1}),a.createIndex(u,[l,_],{unique:!1})),n<3&&((a=a||e.transaction.objectStore(p)).createIndex("app_lastModified",[l,m],{unique:!1}),a.createIndex("app_reads",[l,v],{unique:!1})),n<4&&((a=a||e.transaction.objectStore(p)).createIndex(g,g,{unique:!1}),a.createIndex("parentKey_app",[g,l],{unique:!1}),a.createIndex("parentKey_app_lastModified",[g,l,m],{unique:!1}),a.createIndex("parentKey_app_lastRead",[g,l,_],{unique:!1}),a.createIndex("parentKey_app_reads",[g,l,v],{unique:!1}))},e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal(h,function(e){return e.get(b)}).then(function(t){if(t)return t.data;var n={id:s(),created:Date.now(),cacheType:1};return e._writeInternal({tableName:h,key:b,row:{key:b,data:n}}).then(function(){return n})})},e.prototype._readInternal=function(t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,o,s,c=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return o=e,(s=e._db)?[3,2]:[4,e._openDBPromise];case 1:s=a.sent(),a.label=2;case 2:return i=o._db=s,[2,new Promise(function(e,a){var o=c._logger({name:"PersistentCacheIDB.readInternal"}),s=Date.now(),d=i.transaction([t],"readonly").objectStore(t),l=n(d);l.onsuccess=function(t){o({resultType:r.ResultTypeEnum.Success,extraData:{io:Math.round(Date.now()-s)}}),e(l.result)},l.onerror=function(e){o({resultType:r.ResultTypeEnum.Failure,extraData:{io:Math.round(Date.now()-s)}}),c._errorHandling(e,a)}})]}})})},e.prototype._iterate=function(t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=a.sent(),a.label=2;case 2:return i=r._db=o,s=[],[2,new Promise(function(e,a){var r=i.transaction([t],"readonly").objectStore(t).openCursor();r.onsuccess=function(t){var a=r.result;a?(s.push(n(a.value)),a.continue()):e(s)},r.onerror=function(e){c._errorHandling(e,a)}})]}})})},e.prototype._writeInternal=function(t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,r,o,s,c,d=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n=t.tableName,i=t.key,r=t.row,s=e,(c=e._db)?[3,2]:[4,e._openDBPromise];case 1:c=a.sent(),a.label=2;case 2:return o=s._db=c,[2,new Promise(function(e,t){try{var a=o.transaction([n],"readwrite"),s=a.objectStore(n);a.oncomplete=function(){},a.onerror=function(e){d._errorHandling(e,t)};var c=r?s.put(r):s.delete(i);c.onsuccess=function(t){e()},c.onerror=function(e){d._errorHandling(e,t)}}catch(e){throw e}})]}})})},e.prototype._deleteDataRows=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n=this;return Object(a.__generator)(this,function(a){return t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1),[2,this.rangeQuery({index:g,range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return n._writeInternal({tableName:p,key:e,row:void 0})}))}).then(function(){})]})})},e.prototype._errorHandling=function(e,t){if(e.type===c.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}},e}(),I="PersistentCache",x="PersistentCache_metadata",C=function(){function e(){try{if("localStorage"in d&&d.localStorage&&(this._localStorage=d.localStorage,!this._localStorage.getItem(x))){var e={id:s(),created:Date.now(),cacheType:0};this._localStorage.setItem(x,JSON.stringify(e))}}catch(e){}if(!this._localStorage)throw new Error("localStorage is not supported")}return e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")},e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))},e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var n=Object(a.__assign)(Object(a.__assign)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(n))}else this._localStorage.removeItem(this._cacheKey(t))},e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf(I)){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem(x)),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}},e.prototype.rangeQuery=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,void 0]})})},e.prototype._cacheKey=function(e){return"".concat(I,"_").concat(e)},e}(),O=0,w=function(){function e(){this._queue={}}return e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],a=!0,i=[];n.length>0&&(n[0].schedule?(i=n.slice(1),this._queue[e]=[n[0]],a=!1):(i=this._queue[e],this._queue[e]=[]));var r=this._createUpateTask(e,t);return i.length>0&&(r.signal=i[0].signal),this._queue[e].push(r),a&&this._scheduleTask(e),r},e.prototype._createUpateTask=function(e,t){var n=this,i={};i.promise=new Promise(function(e,t){i.resolve=e,i.reject=t});var r={execute:function(){return Object(a.__awaiter)(n,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,t()];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),r.error=e,[3,4];case 3:return this._completeTask(r),[7];case 4:return[2]}})})},schedule:0,id:O++,key:e,signal:i};return r},e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=d.setTimeout(n.execute,5)}},e.prototype._completeTask=function(e){var t=e.id,n=e.key,a=this._queue[n],i=a[0],r=a.slice(1);if(i.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=r,this._scheduleTask(n),e.error?e.signal.reject(e.error):e.signal.resolve()},e}();function E(){return d.performance&&performance.now?Math.round(performance.now()):Date.now()}var A,L="_odspcache_",k="_____",M=function(){function e(e){var t=e.cacheType,n=void 0===t?1:t,i=Object(a.__rest)(e,["cacheType"]);if(this._config=Object(a.__assign)(Object(a.__assign)({},i),{cacheType:n}),this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=e.app,this._cacheUpdateTaskManager=new w,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._initLocalStorage(this._cacheType)}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!1,configurable:!0}),e.prototype.read=function(t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I;return Object(a.__generator)(this,function(a){switch(a.label){case 0:n=this._logQos({name:"PersistentCache.read"}),c=E(),d=Date.now(),a.label=1;case 1:return a.trys.push([1,12,,13]),u=this._getCacheKey(t),f=!1,p={lastModified:NaN,lastRead:d,reads:1},m=void 0,u?(_=E(),[4,this._storage.read(u)]):[3,11];case 2:return l=a.sent(),s=Math.round(E()-_),l?(h=l.data,p={lastModified:l.lastModified,lastRead:d,reads:l.reads+1},(i=e._buffer[u])&&i.cacheStats.lastModified===l.lastModified?(i.app=l.app||this._app,i.key={original:t,encoded:l.key||u},i.cacheStats.lastRead=d,i.cacheStats.reads++,i.performance={total:Math.round(E()-c)},[3,11]):[3,3]):[3,11];case 3:if(i=void 0,void 0===h)return[3,11];if(!this._dataIsEncrypted)return[3,10];b=h,g=this._cacheSecret,v=g.CurrentKey.Key,y=g.PreviousKey.Key,S=E(),a.label=4;case 4:return a.trys.push([4,6,,9]),[4,this._crypto.decrypt({encryptedData:b,encryptionSecret:v})];case 5:return m=a.sent(),[3,9];case 6:return(D=a.sent())&&D.message&&D.message.indexOf("wrong secret or signature.")>=0?[4,this._crypto.decrypt({encryptedData:b,encryptionSecret:y})]:[3,8];case 7:m=a.sent(),f=void 0!==m,n({resultType:r.ResultTypeEnum.ExpectedFailure,error:D.message,extraData:{cacheResult:"hit"}}),a.label=8;case 8:return[3,9];case 9:return o=Math.round(E()-S),[3,11];case 10:m=h,a.label=11;case 11:return i=i||{key:{original:t,encoded:l&&l.key||u},app:l&&l.app||this._app,data:m,cacheStats:p,cacheType:this._cacheType,performance:{crypto:o,io:s,total:Math.round(E()-c)}},e._buffer[u]=i,f&&this.update(t,m),[3,13];case 12:throw I=a.sent(),n({resultType:r.ResultTypeEnum.Failure,error:I.message?I.message:I.toString(),extraData:{cacheResult:"miss"}}),I;case 13:return n({resultType:r.ResultTypeEnum.Success,extraData:{cacheResult:"".concat(void 0!==i.data?"hit":"miss")}}),[2,Promise.resolve(i)]}})})},e.prototype.rangeQuery=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,o,s,c,d,l=this;return Object(a.__generator)(this,function(a){if(1!==this._cacheType)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"}),n=0,i=E(),o=Date.now(),c={lastModified:NaN,lastRead:o,reads:1};try{d=E(),s=this._storage.rangeQuery(e).then(function(e){return n=Math.round(E()-d),{key:void 0,app:void 0,data:e.map(function(e){return{original:l._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:c,cacheType:l._cacheType,performance:{io:n,total:Math.round(E()-i)}}})}catch(e){throw t({resultType:r.ResultTypeEnum.Failure,error:e.message?e.message:e.toString()}),e}return t({resultType:r.ResultTypeEnum.Success}),[2,s||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:c,cacheType:this._cacheType,performance:{io:n,total:Math.round(E()-i)}})]})})},e.prototype.update=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n=this._getCacheKey(e),[4,this._cacheUpdateTaskManager.enqueue(n,function(){return i._doCacheUpdate(e,t)}).signal.promise];case 1:return a.sent(),this._logCacheStats(),[2]}})})},e.prototype.remove=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return[2,this.update(e,void 0)]})})},e.prototype.freeSpace=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(n){return[2,this._storage.freeSpace(e,t)]})})},e.prototype.readAndUpdate=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,o,s,c,d,l=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:n=E(),i=Date.now(),o=this._logQos({name:"PersistentCache.readAndUpdate"}),s=t().then(function(t){var a={app:l._app,key:{original:e,encoded:l._getCacheKey(e)},data:t,cacheType:2,cacheStats:{lastModified:void 0,lastRead:i,reads:1},performance:{total:Math.round(E()-n)}};return l.update(e,t),a}),a.label=1;case 1:a.trys.push([1,8,,9]),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,Promise.race([this.read(e),s])];case 3:return c=a.sent(),[3,5];case 4:return a.sent(),[3,5];case 5:return!c||2!==c.cacheType&&void 0===c.data?[4,s]:[3,7];case 6:c=a.sent(),a.label=7;case 7:return[3,9];case 8:throw d=a.sent(),o({resultType:r.ResultTypeEnum.Failure,error:d.message?d.message:d.toString()}),d;case 9:return o({resultType:r.ResultTypeEnum.Success}),[2,c]}})})},e.prototype._initLocalStorage=function(e){if(0===e)this._storage=new C;else try{this._storage=new D(this._logQos.bind(this))}catch(e){e.message===S&&(this._storage=new C,this._cacheType=0)}},e.prototype._getCacheKey=function(e){var t=encodeURIComponent("".concat(e.key).concat(e.user?k+e.user:""));return"".concat(L).concat(this._dataIsEncrypted?btoa(t):t)},e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace(L,""),n=this._dataIsEncrypted?atob(t):t,a=decodeURIComponent(n);if(a.indexOf(k)>=0){var i=a.split(k);return{key:i[0],user:i[1]}}return{key:a}},e.prototype._doCacheUpdate=function(t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,o,s,c,d,l,u;return Object(a.__generator)(this,function(f){switch(f.label){case 0:i=this._logQos({name:"PersistentCache.update"}),f.label=1;case 1:return f.trys.push([1,9,,10]),o=this._getCacheKey(t),void 0===n?[3,6]:((s=e._buffer[o]=Object(a.__assign)(Object(a.__assign)({},e._buffer[o]),{data:n,cacheType:this._cacheType})).cacheStats||(s.cacheStats={lastModified:NaN,lastRead:E(),reads:1}),c=n,d=NaN,this._dataIsEncrypted?(l=this._cacheSecret.CurrentKey.Key,[4,this._crypto.encrypt({encryptionSecret:l,data:n,doSerialize:0===this._cacheType})]):[3,3]);case 2:return c=f.sent(),d=c.cipherText?c.cipherText.byteLength:0,[3,4];case 3:try{d="string"==typeof n?n.length:JSON.stringify(n).length}catch(e){}f.label=4;case 4:return[4,this._storage.write({app:this._app,key:o,data:c,lastRead:s.cacheStats.lastRead,parentKey:t.parentKey,reads:s.cacheStats.reads,size:d})];case 5:return f.sent(),[3,8];case 6:return delete e._buffer[o],[4,this._storage.write({key:o,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:f.sent(),f.label=8;case 8:return[3,10];case 9:throw u=f.sent(),i({resultType:r.ResultTypeEnum.Failure,error:u.message?u.message:u.toString()}),u;case 10:return i({resultType:r.ResultTypeEnum.Success}),[2]}})})},e.prototype._logCacheStats=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(a.__generator)(this,function(t){return this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return Object(a.__awaiter)(e,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:return e.sent(),[2]}})})},3e4)),[2]})})},e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t,n.end(e)}}return function(e){}},e._buffer={},e}();!function(e){e[e.useCacheAndUpdateInTheBackground=0]="useCacheAndUpdateInTheBackground",e[e.useCacheIfNotExpired=1]="useCacheIfNotExpired",e[e.onlyCache=2]="onlyCache",e[e.bypassCache=3]="bypassCache",e[e.useCacheAndNoUpdate=4]="useCacheAndNoUpdate"}(A||(A={}));var P=function(){function e(e,t){this._getDataPromises={};var n=e.id,i=e.dataSourceName,o=e.cacheType,s=void 0===o?1:o,c=(t.pageContext||{}).aadUserId;this._id=n,this._userId=c;var d=i||n,l=r.Qos.withData(function(e){return e.name&&d&&!e.name.startsWith(d)?Object(a.__assign)(Object(a.__assign)({},e),{name:"".concat(d,".").concat(e.name)}):e});this._cache=new M({cacheType:s,telemetry:{qos:l}})}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e,a=n.cacheRequestKey,i=n.cachingStrategy,o=void 0===i?0:i,s=n.cacheTimeoutTime,c=void 0===s?864e5:s,d=n.getData,l=n.returnStatistics,u=void 0!==l&&l,f={key:a,user:this._userId},p=function(){return t._getDataPromises[a]||(t._getDataPromises[a]=d().then(function(e){return delete t._getDataPromises[a],e}).catch(function(e){throw delete t._getDataPromises[a],e})),t._getDataPromises[a].then(function(e){return t._cache.update(f,e),u?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})};return 2===o?r.Promise.resolve(this._cache.read(f)).then(function(e){var t=e.data,n=e.cacheStats;return null==t?null:u?{data:t,cacheStats:n}:t}).catch(function(){return null}):r.Promise.resolve(this._cache.read(f)).then(function(e){var n=e.data,a=e.cacheStats;if(null==n)return p();var i=u?{data:n,cacheStats:a}:n,r=t._isCacheExpired(a.lastModified,c);switch(o){case 4:return i;case 0:return r&&p(),i;case 1:return r?p():i;default:return p()}}).catch(function(){return p()})},e.prototype.getRequestKey=function(e,t,n){var a=[];return a.push(e),a.push(t),n&&a.push(n.toString()),a.join(",")},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!1,configurable:!0}),e.prototype.flushCache=function(e){var t={key:e,user:this._userId};delete this._cache[e],this._cache.remove(t)},e.prototype.updateCache=function(e,t){var n={key:e,user:this._userId};this._cache.update(n,t)},e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t},e}(),T=function(){function e(e,t){var n=e.id,a=e.cacheType,i=void 0===a?r.DataStoreCachingType.session:a,o=t.cacheIdPrefix,s=void 0===o?"odsp-ds-":o,c=t.pageContext;this._id=n,this._version=c?c.siteClientTag+"_"+c.userDisplayName:"",this._store=new r.DataStore(s,i),this._storeDefaultCacheType=i,this._initCache()}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e,a=n.cacheRequestKey,i=n.useStale,o=void 0!==i&&i,s=n.bypassCache,c=void 0!==s&&s,d=n.onlyCache,l=void 0!==d&&d,u=n.checkForInvalidation,f=n.setInvalidated,p=n.getData,m=n.cacheTimeoutTime,_=void 0===m?3e5:m,h=n.returnStatistics,b=void 0!==h&&h,g=this._cache,v=g[a],y=function(){return b?{data:v._value,cacheStats:{lastModified:NaN,lastRead:v._fetched,reads:NaN}}:v._value};if(l)return v?r.Promise.resolve(y()):r.Promise.resolve(void 0);u=u&&!c&&this._storeDefaultCacheType!==r.DataStoreCachingType.local;var S=v&&this._isCacheExpired(v,a,u,_);return c||!v||S&&!o?p().then(function(e){var n=(new Date).valueOf();return g[a]={_fetched:n,_value:e},f&&t._store.setValue(a,n-1,r.DataStoreCachingType.local),t._updateCache(),b?{data:e,cacheStats:{lastModified:NaN,lastRead:n,reads:NaN}}:e}):r.Promise.resolve(y())},e.prototype.getRequestKey=function(e,t,n){var a=[];return a.push(e),a.push(t),n&&a.push(n.toString()),a.join(",")},e.prototype.isCachedDataInvalidated=function(e){var t=this._cache[e];return this._isCachedDataInvalidated(t,e)},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!1,configurable:!0}),e.prototype.flushCache=function(e){e?(delete this._cache[e],this._updateCache()):this._clearCache()},e.prototype._initCache=function(){this._version!==this._store.getValue(this.cacheVersionId,void 0,!1)?(this._clearCache(),this._store.setValue(this.cacheVersionId,this._version,void 0,!1)):this._cache=this._store.getValue(this.cacheId,void 0,!1)||{}},e.prototype._updateCache=function(){this._store.setValue(this.cacheId,this._cache,void 0,!1)},e.prototype._clearCache=function(){this._cache={},this._updateCache()},e.prototype._isCacheExpired=function(e,t,n,a){if(n&&this._isCachedDataInvalidated(e,t))return!0;var i=(new Date).valueOf()-a;return e._fetched<=i},e.prototype._isCachedDataInvalidated=function(e,t){var n=Number(this._store.getValue(t,r.DataStoreCachingType.local));return!!(e&&n&&e._fetched<n)},e}(),U=function(e){function t(t,n){var i=e.call(this,t,n)||this,r=n.pageContext;i._legacyRequestCache=new T(t,{pageContext:r}),t.cacheType;var o=Object(a.__rest)(t,["cacheType"]);return i._persistentRequestCache=new P(o,{pageContext:r}),i}return Object(a.__extends)(t,e),t.prototype.getDataUtilizingLegacyCache=function(e){var t=this,n=e,i=n.getUrl,r=n.getAdditionalPostData,o=n.cacheRequestKey,s=n.cacheTimeoutTime,c=Object(a.__rest)(n,["getUrl","getAdditionalPostData","cacheRequestKey","cacheTimeoutTime"]);(c=Object(a.__assign)({url:i&&i(),additionalPostData:r&&r(),method:"POST"},c)).url=c.url||i&&i(),"needsRequestDigest"in c||(c.needsRequestDigest=this.needsRequestDigest(c.url)),c.additionalPostData=c.additionalPostData||r&&r(),o=o||this.getRequestKey(c.url,c.method,c.additionalPostData);var d=e.useStale,l=void 0!==d&&d,u=e.bypassCache,f=void 0!==u&&u,p=e.onlyCache,m=void 0!==p&&p,_=e.checkForInvalidation,h=void 0!==_&&_,b=e.setInvalidated,g=void 0!==b&&b;return this._legacyRequestCache.getDataUtilizingCache({cacheRequestKey:o,useStale:l,bypassCache:f,onlyCache:m,checkForInvalidation:h,setInvalidated:g,cacheTimeoutTime:s,getData:function(){return t.dataRequestor.getData(c)}})},t.prototype.getDataUtilizingPersistentCache=function(e){var t=this,n=e,i=n.getUrl,r=n.getAdditionalPostData,o=n.cacheRequestKey,s=n.cacheTimeoutTime,c=n.returnStatistics,d=Object(a.__rest)(n,["getUrl","getAdditionalPostData","cacheRequestKey","cacheTimeoutTime","returnStatistics"]);(d=Object(a.__assign)({url:i&&i(),additionalPostData:r&&r(),method:"POST"},d)).url=d.url||i&&i(),"needsRequestDigest"in d||(d.needsRequestDigest=this.needsRequestDigest(d.url)),d.additionalPostData=d.additionalPostData||r&&r(),o=o||this.getRequestKey(d.url,d.method,d.additionalPostData);var l=e.cachingStrategy;return this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:l,cacheRequestKey:o,cacheTimeoutTime:s,getData:function(){return t.dataRequestor.getData(d)},returnStatistics:c})},t.prototype.isCachedDataInvalidated=function(e){return this._legacyRequestCache.isCachedDataInvalidated&&this._legacyRequestCache.isCachedDataInvalidated(e)},t.prototype.getRequestKey=function(e,t,n){return this._legacyRequestCache.getRequestKey(e,t,n)},Object.defineProperty(t.prototype,"cacheId",{get:function(){return this._legacyRequestCache.cacheId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cacheVersionId",{get:function(){return this._legacyRequestCache.cacheVersionId},enumerable:!1,configurable:!0}),t.prototype.flushCache=function(e){this._legacyRequestCache.flushCache(e),this._persistentRequestCache.flushCache(e)},t}(i.e);t.t=U},dq6a:function(e,t,n){"use strict";var a=n("17wl"),i=n("K9kD"),r=function(){function e(e,t){var n=this._pageContext=t.pageContext,r=t.tokenProvider,o=t.dataRequestorType,s=void 0===o?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:r})||this}return Object(a.__extends)(t,e),t}(i.DataRequestor):o,c=e.dataSourceName,d=void 0===c?"DataSource":c;this.dataRequestor=new s({qosName:d})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p){void 0===i&&(i="POST");var m=e(),_=a&&a(),h=this.needsRequestDigest(m);return this.dataRequestor.getData({url:m,parseResponse:t,qosName:n,additionalPostData:_,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:h,authToken:f,webAbsoluteUrl:p})},e}();t.e=r},jidH:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n("17wl"),i=n("K9kD"),r=n("1tKF"),o=n("ysJJ"),s={ODB:1447},c={links:void 0,name:"",startingNodeKey:"",isAudienceEnabled:!1,isAudienceTargeted:!1,isAudienceAffected:!1},d=function(e){function t(t,n){var a=e.call(this,{id:"ViewNavDataSource"},{pageContext:t})||this;return a._mapProviderName=n,a._audiencesDataSource=o.e.getInstance(t),a._viewNavCacheKey="viewNavDataSource"+"_".concat(t.aadUserId),a}return Object(a.__extends)(t,e),t.isRelativeUrl=function(e){return!!e&&!/^[a-z0-9+-.]+:\/\//i.test(e)&&-1===e.indexOf("/_layouts/15/groupstatus.aspx?")},t.shouldLinkOpenInSameWindow=function(e){if(!e)return!1;var t=new i.Uri(e),n=t.getScheme()+"://"+t.getAuthority();return(""===t.getScheme()&&""===t.getAuthority()||n===window.location.origin)&&-1===e.indexOf("/_layouts/15/groupstatus.aspx?")},t.transformNodesToLinks=function(e,n,a){var r=function(e,o){return a&&(e=e.filter(function(e){return a(e,o)})),e.map(function(e){var a;return{name:e.Title,key:e.Id.toString(),url:e.Url,onClick:n,isDocLib:e.IsDocLib,links:e.Children&&e.Children.length?r(e.Children,o+1):void 0,audiences:e.AudienceIds||void 0,currentLCID:e.CurrentLCID,openInNewWindow:e.OpenInNewWindow,target:i.Features.isFeatureEnabled({ODB:60322})?(null!==(a=e.OpenInNewWindow)&&void 0!==a?a:!t.shouldLinkOpenInSameWindow(e.Url))?"_blank":"_self":""}})};return r(e=e||[],0)},t.getAreaNavigationSettingsUrl=function(e){return"".concat(e.webAbsoluteUrl,"/_layouts/15/AreaNavigationSettings.aspx")},t.prototype.setGlobalNavEnabled=function(e){var t="".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/SetGlobalNavEnabled?isEnabled=").concat(e);return this.dataRequestor.getData({url:t,qosName:"SetGlobalNavEnabled",method:"POST",noRedirect:!0})},t.prototype.getGlobalNavEnabled=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(e._pageContext.webAbsoluteUrl,"/_api/navigation/GlobalNavEnabled")},parseResponse:function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.GlobalNavEnabled},qosName:"getGlobalNavEnabled",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._viewNavCacheKey,"_getGlobalNavEnabled")})},t.prototype.getGlobalNav=function(e,n,a){var r=this,o=new i.Qos({name:"GlobalNavigation"}),s="".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/GlobalNav");n&&(s+="?source='".concat(n,"'"));var c={url:s,qosName:"GetGlobalNavigation",parseResponse:function(e){var t=JSON.parse(e);return r._transformToNavLinkGroup(t,!1,o,!0)},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1,crossSiteCollectionCall:!0,cachingStrategy:e?3:1,noRedirect:!0,cacheRequestKey:"".concat(this._viewNavCacheKey,"_getGlobalNav")};return this.getDataUtilizingPersistentCache(c).then(function(e){return a||u()&&!e||!e.isAudienceEnabled||!e.isAudienceTargeted?e:r._audiencesDataSource.filter("GlobalNav",e.links,"links").then(function(n){var a=t.checkIfLinksAffected(e.links,n);return e.links=n||[],e.isAudienceAffected=a,e})})},t.prototype.isNavAudienceTargetedEnabled=function(){var e;return Boolean(0===this._pageContext.webPropertyFlags2||this._pageContext.webPropertyFlags2?this._pageContext.webPropertyFlags2&t.NAV_AUDIENCE_TARGET_FLAG:null===(e=this._pageContext.navigationInfo)||void 0===e?void 0:e.isAudienceTargeted)},t.prototype.getMenuState=function(e){var n=this;void 0===e&&(e={});var a=new i.Qos({name:"TransformMenuStateToLinkGroup"}),r=e.providerName,o=void 0===r?this._mapProviderName:r,d=e.isGlobalNav,l=e.useCache,f=e.forceRefresh,p=e.menuNodeKey,m=e.maxRetries,_=void 0===m?1:m,h=e.depth,b=void 0===h?3:h,g=e.skipAudienceFiltering,v=e.audienceFilterNodeKey,y=l?"getMenuStateUsingCache":"NavigationGetMenuState",S="";o=o||this._mapProviderName,p?(S+="?menuNodeKey='".concat(p,"'"),o&&(S+="&mapProviderName='".concat(o,"'"))):(d||o)&&(S+="?menuNodeKey=".concat(d?"1002":""),o&&(S+="&mapProviderName='".concat(o,"'"))),i.Features.isFeatureEnabled(s)&&S&&S.length>0&&(S+="&depth='".concat(b,"'"));var D,I={url:"".concat(this._pageContext.webAbsoluteUrl,"/_api/navigation/MenuState").concat(S),qosName:y,qosExtraData:{NavProviderName:o},parseResponse:function(e){var t=JSON.parse(e);return n._transformToNavLinkGroup(t,Boolean(g),a)},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:_,crossSiteCollectionCall:!0,cachingStrategy:f?3:0,noRedirect:!0};return D=l?this.getDataUtilizingPersistentCache(I).then(function(e){return u()?e:e||c}):this.dataRequestor.getData(I),u()?!g&&this.isNavAudienceTargetedEnabled()?D.then(function(e){return e&&n._isGroupAudienceTargeted(e)?("13b7c916-4fea-4bb2-8994-5cf274aeb530"===e.name&&e.links&&v&&n._audiencesDataSource.containsAudiences(e.links.filter(function(e){return e.name===v}),"links")&&i.Engagement.logData({name:"FooterNav.AudienceTargeting"}),n._audiencesDataSource.filter("SiteNav",e.links,"links").then(function(t){return e.links=t||[],e})):e}):D:D.then(function(e){return e.isAudienceEnabled&&e.isAudienceTargeted?n._audiencesDataSource.filter("SiteNav",e.links,"links").then(function(n){var a=t.checkIfLinksAffected(e.links,n);return e.links=n||[],e.isAudienceAffected=a,e}):e})},t.checkIfLinksAffected=function(e,t){return l(e)!==l(t)},t.prototype.clearCache=function(){this.flushCache()},t.prototype._transformToNavLinkGroup=function(e,t,n,a){if(!e||!e.Nodes||0===e.Nodes.length)return n.end({resultType:i.ResultTypeEnum.ExpectedFailure,error:"getMenuState empty MenuState"}),u()?void 0:c;try{var r=this._getLinksFromNodes(e.Nodes,e.FriendlyUrlPrefix),o={isAudienceEnabled:!u()&&!t&&(a?e.IsAudienceTargetEnabledForGlobalNav:this.isNavAudienceTargetedEnabled()),isAudienceTargeted:(u()||!t)&&this._audiencesDataSource.containsAudiences(r,"links"),isAudienceAffected:!1,name:e.StartingNodeTitle||"",links:r,startingNodeKey:e.StartingNodeKey};return n.end({resultType:i.ResultTypeEnum.Success}),o}catch(e){return n.end({resultType:i.ResultTypeEnum.Failure,error:e?e.toString():"getMenuState failed"}),u()?void 0:c}},t.prototype._getLinksFromNodes=function(e,n){var a=this,r=function(e,o,s){e=e.filter(function(e){return"1033"!==e.Key&&-1===e.Key.indexOf("SPNavigationNodeId=".concat("1033"))&&!e.IsDeleted&&!e.IsHidden});var c=s?s+"/":"";return e.map(function(e){var s,d,l,u,f=o&&c+o.FriendlyUrlSegment,p=a._getUrl(e,!!o,n,f);if(i.Killswitch.isActivated("192abaff-ff85-4e80-abec-b570608862a8","12/09/2021","Use custom target property to determine if nav links open in new window"))u=i.Features.isFeatureEnabled({ODB:60322})?(null!==(l=e.OpenInNewWindow)&&void 0!==l?l:!t.shouldLinkOpenInSameWindow(p))?"_blank":"":t.shouldLinkOpenInSameWindow(p)?"":"_blank";else{var m=e.CustomProperties?a._getCustomPropertyValue(e.CustomProperties,"Target"):void 0,_="_blank"===m||null!==m&&void 0;u=i.Features.isFeatureEnabled({ODB:60322})?(null!==(d=null!==(s=e.OpenInNewWindow)&&void 0!==s?s:_)&&void 0!==d?d:!t.shouldLinkOpenInSameWindow(p))?"_blank":"_self":(null!=_?_:!t.shouldLinkOpenInSameWindow(p))?"_blank":"_self"}return{name:e.Title,url:p,key:e.Key,ariaLabel:e.Title,isExpanded:!1,hasChildLinks:e.CustomProperties?"True"===a._getCustomPropertyValue(e.CustomProperties,"HasChildNodes"):void 0,target:u,links:e.Nodes&&e.Nodes.length?r(e.Nodes,e,f):void 0,audiences:e.AudienceIds&&e.AudienceIds.length>0?e.AudienceIds:void 0,currentLCID:e.CurrentLCID}})};return r(e||[])},t.prototype._getCustomPropertyValue=function(e,t){for(var n=e.length-1;n>0;n--)if(e[n].Key===t)return e[n].Value;return""},t.prototype._getUrl=function(e,t,n,a){return e.SimpleUrl?e.SimpleUrl:(1===e.NodeType&&e.FriendlyUrlSegment&&(i=(i=t?n+((a?"/".concat(a):"")+"/".concat(e.FriendlyUrlSegment)):n+e.FriendlyUrlSegment).replace("//","/")),i);var i},t.prototype._isGroupAudienceTargeted=function(e){return!!e.isAudienceTargeted||!("13b7c916-4fea-4bb2-8994-5cf274aeb530"!==e.name||!e.links)&&this._audiencesDataSource.containsAudiences(e.links,"links")},t.NAV_AUDIENCE_TARGET_FLAG=8388608,t}(r.e);function l(e){if(!e)return 0;for(var t=e.length,n=0,a=e;n<a.length;n++)t+=l(a[n].links);return t}function u(){return i.Killswitch.isActivated("1cd2d1c9-fdc8-4110-a71e-e8125063dd90","2020-09-01","Refine the audience targeting logging")}},ysJJ:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a,i=n("17wl"),r="MembershipsCache";function o(){if(!window||!window.localStorage)throw new Error("localStorage is not supported")}function s(e){return"".concat(r,"_").concat(e)}!function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.ExpectedFailure=2]="ExpectedFailure"}(a||(a={}));var c=function(){function e(e,t){var n=this;this._log=function(e,t,a){n._logCacheQoS&&n._logCacheQoS("".concat(r,".").concat(e),t,a)},this._getData=e,this._logCacheQoS=t}return e.doesItemContainAudiences=function(e){var t;return((null===(t=null==e?void 0:e.audiences)||void 0===t?void 0:t.length)||0)>0},e.containsAudiences=function(t,n){if(!t)return!1;if(t.some(e.doesItemContainAudiences))return!0;if(n)for(var a=0,i=t;a<i.length;a++){var r=i[a];if(e.containsAudiences(r[n],n))return!0}return!1},e.getInstance=function(t,n){return e._instance||(e._instance=new e(t,n)),e._instance},e.prototype.filter=function(e,t,n,a,i){var r=this;return a?this.getCurrentUserMemberships(e,t,n).then(function(e){return r.filterWithMembership(e,a,i)}).catch(function(){return r.filterWithMembership([],a,i)}):Promise.resolve(void 0)},e.prototype.filterWithMembership=function(e,t,n){var a=this;if(!t)return t;var r=t.filter(function(t){return!function(e){return Boolean(e.audiences&&e.audiences.length>0&&"00000000-0000-0000-0000-000000000000"!==e.audiences[0])}(t)||function(e,t){var n=e.audiences;if(!n)return!1;for(var a=0;a<n.length;a++)if(-1!==t.indexOf(n[a]))return!0;return!1}(t,e)});return n&&(r=r.map(function(t){var r;return Object(i.__assign)(Object(i.__assign)({},t),((r={})[n]=a.filterWithMembership(e,t[n],n),r))})),r},e.prototype.getCurrentUserMemberships=function(e,t,n){var i,r=this,c=new URLSearchParams(window.location.search),d=!1;if("Preview"===c.get("env")&&c.has("audiences")){var l=c.get("audiences");i=l?l.split(","):[],d=!0}else try{i=function(e){o();var t=window.localStorage.getItem(s(e));if(t){var n=JSON.parse(t);if(n&&n.lastModified&&Date.now()-n.lastModified<=72e5)return n.data}}(e)}catch(e){this._log(n,a.Failure,{error:e.message||e,scenario:n})}if(i)return d||this._log(n,a.Success),Promise.resolve(i);if(!this._getMembershipsPromise){var u=t+"/_api/SP.Publishing.SitePageService.GetCurrentUserMemberships"+(n?"?scenario='".concat(n,"'"):"");this._getMembershipsPromise=this._getData(u,n).then(function(t){return r._getMembershipsPromise=void 0,t&&function(e,t){if(o(),t){var n={data:t,lastModified:Date.now()};window.localStorage.setItem(s(e),JSON.stringify(n))}else window.localStorage.removeItem(e)}(e,t),r._log(n,a.ExpectedFailure),t})}return this._getMembershipsPromise},e}(),d=n("K9kD"),l=function(){function e(e){var t=this;this._getDataFromAPI=function(e,n){var a={url:e,qosName:n?"getUserMembershipsForAudienceTargeting.".concat(n):"getUserMembershipsForAudienceTargeting",cacheRequestKey:t._cacheRequestKey,parseResponse:function(e){return e&&JSON.parse(e).value||[]},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1};return t._dataRequestor.getData(a)},this._logCacheQoS=function(e,t,n){return new d.Qos({name:e}).end({name:e,resultType:t,extraData:n})},this._pageContext=e,this._dataRequestor=new d.DataRequestor({qosName:"AudiencesDataSource"},{pageContext:e}),this._cacheRequestKey=e.aadUserId||e.userLoginName,this._audienceTargetComponent=c.getInstance(this._getDataFromAPI,this._logCacheQoS)}return e.getInstance=function(t){var n=t.aadUserId||t.userLoginName;return e._instances[n]||(e._instances[n]=new e(t)),e._instances[n]},e.prototype.containsAudiences=function(e,t){if(!e)return!1;if(e.filter(u).length>0)return!0;if(t)for(var n=0,a=e;n<a.length;n++){var i=a[n];if(this.containsAudiences(i[t],t))return!0}return!1},e.containsAudienceTargetedNode=function(e){var t=this;return!!e&&(e.filter(u).length>0||e.filter(function(e){return t.containsAudienceTargetedNode(e.links)}).length>0)},e.prototype.filter=function(e,t,n){return d.Promise.resolve(this._audienceTargetComponent.filter(this._cacheRequestKey,this._pageContext.webAbsoluteUrl,e,t,n))},e.prototype.filterWithMembership=function(e,t,n){return this._audienceTargetComponent.filterWithMembership(e,t,n)},e.filterLinksWithMemberships=function(t,n){return e._filterRecursively(new Set(n),t,function(e){return e.links},function(e,t){return Object(i.__assign)(Object(i.__assign)({},e),{links:t})})},e.getGroupObjectId=function(e){return e.userId&&e.userId.length>=36?e.userId.substr(e.userId.length-36):void 0},e.prototype.getCurrentUserMemberships=function(e){var t=this._pageContext.webAbsoluteUrl;return window&&window.location&&window.location.origin&&-1===t.indexOf(window.location.origin)&&(t=window.location.origin),d.Promise.resolve(this._audienceTargetComponent.getCurrentUserMemberships(this._cacheRequestKey,t,e))},e._filterRecursively=function(t,n,a,i){if(!n)return n;var r=n.filter(function(e){var n;return!u(e)||(null===(n=e.audiences)||void 0===n?void 0:n.some(function(e){return t.has(e)}))});return a&&i&&(r=r.map(function(n){var r=a(n),o=e._filterRecursively(t,r,a,i);return i(n,o)})),r},e._instances={},e}();function u(e){return!!(e.audiences&&e.audiences.length>0&&e.audiences[0]!==d.Guid.Empty)}}}]);