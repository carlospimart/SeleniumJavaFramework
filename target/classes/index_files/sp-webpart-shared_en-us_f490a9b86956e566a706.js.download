define("914330ee-2df2-4f6e-a858-30c23a812408_2.2.20",["tslib","@ms/sp-telemetry","@microsoft/sp-component-base","@microsoft/sp-image-helper","@microsoft/sp-loader","@microsoft/office-ui-fabric-react-bundle","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-page-context","@ms/i18n-utilities","@microsoft/sp-webpart-base","react","react-dom","@ms/sp-component-utilities","@microsoft/load-themed-styles","@ms/sp-deferred-component","@ms/sp-rich-image","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,c=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&c.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(d&&d(t);c.length;)c.shift()()}var n={},a={4:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(t){for(var n=[],o=function(e){return{0:[{i:"a68dd513-949e-48c1-b210-23ad37dbbe13",v:"0.1.0",m:"WZz6"},{i:"2e09fb9b-13bb-48f2-859f-97d6fff71176",v:"1.1.302",m:"K9kD"}],2:[{i:"c79b9f88-6338-40fb-b463-3aad22a88b15",v:"0.1.0",m:"9poL"}]}[e]||[]}(t),s=0;s<o.length;s++)e[o[s].m]||function(t){n.push(r.SPComponentLoader.loadComponentById(t.i,t.v).then(function(n){e[t.m]=function(e){e.exports=n}}))}(o[s]);var c=a[t];if(0!==c)if(c)n.push(c[2]);else{var d=new Promise(function(e,n){c=a[t]=[e,n]});n.push(c[2]=d);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=function(e){return i.p+"chunk."+({0:"live-persona-card-loader",1:"sp-caption-element-edit",2:"sp-edit-utilities",3:"sp-fabric-teaching-bubble"}[e]||e)+"_"+(["en-us","none"])[{"0":0,"1":0,"2":1,"3":1}[e]]+"_"+{0:"2cc776655cd13f95254e",1:"6f2c190e931f03dccf65",2:"aa5bb07d34f98959707e",3:"c6804b653da7f9cd374a"}[e]+".js"}(t),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var f=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",f.name="ChunkLoadError",f.type=i,f.request=r,n[1](f)}a[t]=void 0}};var p=setTimeout(function(){l({type:"timeout",target:u})},12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(n)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var r=i("I6O9");i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp_914330ee_2df2_4f6e_a858_30c23a812408_2_2_20=window.webpackJsonp_914330ee_2df2_4f6e_a858_30c23a812408_2_2_20||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-webpart-shared_en-us_f490a9b86956e566a706\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="mwqp")}({"0l0e":function(e){e.exports=JSON.parse('{"n":"Opens Profile Card for {0}","e":"Opens Profile Card","t":"Getting detailsâ€¦"}')},"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"7Awa":function(e,t){e.exports=i},"8dK2":function(e,t){e.exports=r},Ar4x:function(e,t,n){"use strict";n.d(t,"t",function(){return f}),n.d(t,"e",function(){return p});var a=n("17wl"),i=n("cDcd"),r=n("KL1q"),o=n("ut3N"),s=n("Pk8u"),c=i.lazy(function(){return n.e(1).then(n.bind(null,"Emhs")).then(function(e){return{default:e.default}})});function d(e){return i.createElement(i.Suspense,{fallback:!1},i.createElement(c,Object(a.__assign)({},e)))}var l=n("fCCa"),u=n("vpvl"),f={Caption:1,Title:2},p={PageDirection:1,Center:2},m=function(e){function t(t){var n=e.call(this,t)||this;return n.focusOnCaptionElement=function(){var e;null===(e=n._textarea)||void 0===e||e.focus()},n._handleReceiveRef=function(e){n._textarea=e},n._handleClick=function(e){e.stopPropagation(),n.focusOnCaptionElement()},n._handleChange=function(e){var t=e.target.value;n.setState({text:t},function(){n.props.onChange&&n.props.onChange(t,e)})},n._handleFocus=function(){n.props.moduleName&&n.props.isEditMode&&(n._initialValue=n.state.text)},n._handleBlur=function(){if(n.props.moduleName&&n.props.isEditMode){var e=void 0,t=n.state.text;n._initialValue!==t&&(e=0===t.length?"Clear":0===n._initialValue.length?"Add":"Edit",o._EngagementLogger.logEventWithLogEntry(new o._LogEntry(n.props.moduleName,"CaptionElement",o._LogType.Event,{action:e,length:t.length.toString()})))}},n.state={text:t.text},n}return Object(a.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({text:e.text})},t.prototype.render=function(){var e,t,n,o,s,c,d=Object(r.css)(((e={})[u.e.captionElement__NoMargin]=!this.props.marginBottomSize||"None"===this.props.marginBottomSize,e),((t={})[u.e.captionElement__MiddleMargin]="Middle"===this.props.marginBottomSize,t),((n={})[u.e.captionElement__LargeMargin]="Large"===this.props.marginBottomSize,n)),m=Object(r.mergeStyles)(this.props.type===f.Caption&&u.e.captionElement__caption,this.props.type===f.Title&&u.e.captionElement__title,this.props.type===f.Title&&(c={theme:Object(r.getTheme)()},{title:Object(a.__assign)({},c.theme.fonts.xLarge)}).title,!Object(l.e)()&&u.e.thick),_=Object(r.css)(((o={})[u.e.captionElement__leftAlign]=this.props.alignPosition===p.PageDirection,o),((s={})[u.e.captionElement__centerAlign]=this.props.alignPosition===p.Center,s)),h=u.e.titleBreakInLines,b=Object(r.css)(d,m,_,h,this.props.className),g=this.props.isEditMode&&!1!==this.props.isTitleEditable?this._renderEditMode:this._renderViewMode;return this.props.useFigCaptionTag?i.createElement("figcaption",{className:b,"data-automation-id":"captionElement"},g):i.createElement("div",{className:b,"data-automation-id":"captionElement"},g)},t.prototype.value=function(){return this.state.text},Object.defineProperty(t.prototype,"_renderEditMode",{get:function(){return i.createElement(d,{handleChange:this._handleChange,placeholder:this.props.placeholder,text:this.state.text,handleFocus:this._handleFocus,handleBlur:this._handleBlur,handleClick:this._handleClick,receiveElement:this._handleReceiveRef,type:f.Title})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_renderViewMode",{get:function(){var e=this.props.headingLevel;return i.createElement("span",{role:e&&"heading","aria-level":e},this.state.text)},enumerable:!1,configurable:!0}),t.defaultProps={isEditMode:!1,text:void 0,onChange:s.noop,placeholder:void 0,type:f.Caption,alignPosition:p.Center},t}(r.BaseComponent);t.n=m},EpOV:function(e){e.exports=JSON.parse('{"e":"Month"}')},GrTz:function(e){e.exports=JSON.parse('{"e":"{0} at {1}"}')},I6O9:function(e,t){e.exports=o},IBxL:function(e){e.exports=JSON.parse('{"e":"The page context is not provided by the host environment.","a":"The page context does not provide a web instance.","i":"The page context does not provide a web identifier.","t":"The page context does not provide a site instance.","n":"The page context does not provide a site identifier.","r":"A data source is required.","c":"Title","s":"We didn\\u0027t find anything to show here.","o":"A layout is required."}')},KL1q:function(e,t){e.exports=s},NmG0:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"s",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"l",function(){return u}),n.d(t,"o",function(){return f}),n.d(t,"i",function(){return p}),n.d(t,"a",function(){return m});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("902fc107-961a-4ede-ab07-9824c4648958")}function r(){return a._SPKillSwitch.isActivated("11b685bf-41ea-4d57-a18c-89bac4251c32")}function o(){return a._SPKillSwitch.isActivated("3649aac0-078f-4e3e-b687-691fc57d3764")}function s(){return a._SPKillSwitch.isActivated("13dbf7b1-c8ac-4ad4-a245-cbbaaf1efec7")}function c(){return a._SPFlight.isEnabled(60251)}function d(){return a._SPFlight.isEnabled(60693)}function l(){return a._SPKillSwitch.isActivated("e9bbf461-25c0-44eb-aeb6-6d8e92ba3037")}function u(){return a._SPKillSwitch.isActivated("82d45bf4-9848-4c70-b95b-c5c4836edcb5")}function f(){return a._SPKillSwitch.isActivated("4bd5ea51-ece9-4630-9ee7-0f94551fe632")}function p(){return a._SPKillSwitch.isActivated("92a40cde-dc18-4f19-b8b7-3b6902a9ede1")}function m(){return a._SPKillSwitch.isActivated("1825189a-5bac-4426-bb67-1c8cbb7af0ee")}},Pk8u:function(e,t){e.exports=c},UWqr:function(e,t){e.exports=d},WTsn:function(e){e.exports=JSON.parse('{"e":"Page {0}","n":"Previous","t":"Next","a":"Go to the {0} page, you are currently on page {1}.","i":"Go to the {0} page."}')},"X+PM":function(e,t){e.exports=l},Ycni:function(e,t){e.exports=u},br4S:function(e,t){e.exports=f},cDcd:function(e,t){e.exports=p},fCCa:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("d34f45b6-8fb3-4bbc-ba0d-83b25c971f0c")}},faye:function(e,t){e.exports=m},"hiL/":function(e,t){e.exports=_},j3t2:function(e){e.exports=JSON.parse('{"t":"We need you to sign in again. Once you do, we\\u0027ll bring you back here.","e":"Continue"}')},jOlS:function(e,t){e.exports=h},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"BaseCollection",function(){return k}),n.d(t,"BaseCollectionWebPart",function(){return X}),n.d(t,"RefreshType",function(){return Y}),n.d(t,"CustomerPromiseUtilities",function(){return Z}),n.d(t,"CaptionElement",function(){return f.n}),n.d(t,"CaptionElementAlignPosition",function(){return f.e}),n.d(t,"CaptionElementType",function(){return f.t}),n.d(t,"WebPartDataProvider",function(){return ee}),n.d(t,"BaseDataWebPart",function(){return te}),n.d(t,"DateBox",function(){return ue}),n.d(t,"DateBoxSize",function(){return ce}),n.d(t,"getRelativeDateTimeStringForLists",function(){return _e}),n.d(t,"isSameDay",function(){return ae}),n.d(t,"CalculatedField",function(){return be}),n.d(t,"DisplayFieldMap",function(){return ve}),n.d(t,"MappedField",function(){return he}),n.d(t,"LINK_FIELDNAME_SUFFIX",function(){return ge}),n.d(t,"BaseEmphasisComponentStyles",function(){return ye}),n.d(t,"isFluentEnabledFor",function(){return Se}),n.d(t,"handleItemNavigation",function(){return De}),n.d(t,"getUrlTarget",function(){return Ie}),n.d(t,"isExternalUrl",function(){return xe}),n.d(t,"webPartPreviewThumbnail",function(){return Oe}),n.d(t,"DoughboyDetector",function(){return Pe}),n.d(t,"LessText",function(){return Te}),n.d(t,"truncateText",function(){return Ue}),n.d(t,"MySiteWebPartCacheManager",function(){return q}),n.d(t,"MySiteWebPartCacheHelper",function(){return N}),n.d(t,"OAuthErrorRenderer",function(){return Ge}),n.d(t,"PageType",function(){return p}),n.d(t,"Pagination",function(){return y}),n.d(t,"Parallax",function(){return We}),n.d(t,"Placeholder",function(){return je}),n.d(t,"clampText",function(){return He}),n.d(t,"TextClamp",function(){return Ne}),n.d(t,"clampElement",function(){return Re}),n.d(t,"WebPartChrome",function(){return w}),n.d(t,"WebPartTitle",function(){return Ye}),n.d(t,"WebViewUtility",function(){return Je}),n.d(t,"LivePersonaCard",function(){return et}),n.d(t,"EditModeUtilitiesLoader",function(){return tt}),n.d(t,"getEmbedOverlay",function(){return nt});var a=n("17wl"),i=n("cDcd"),r=n("faye"),o=n("UWqr"),s=n("ut3N"),c=n("KL1q"),d=n("hiL/"),l=n("2q6Q"),u=n("Pk8u"),f=n("Ar4x"),p={Default:0,Prev:1,Next:2},m=n("y88i"),_=n("WTsn"),h=n("jOlS");h.loadStyles('.aa_f_658c9e0a{width:100%;min-width:240px;text-align:center;margin:0;padding:2px 0;border:1px solid transparent;position:relative}.aa_f_658c9e0a .ms-Icon{line-height:inherit}[dir=ltr] .aa_f_658c9e0a [data-icon-name=ChevronLeft]{margin-left:0}[dir=ltr] .aa_f_658c9e0a [data-icon-name=ChevronRight],[dir=rtl] .aa_f_658c9e0a [data-icon-name=ChevronLeft]{margin-right:0}[dir=rtl] .aa_f_658c9e0a [data-icon-name=ChevronRight]{margin-left:0}.aa_f_658c9e0a button{font-size:14px;font-weight:400;padding:8px 4px;margin:0 8px;cursor:pointer;cursor:hand;position:relative;height:32px!important;display:none;outline:none}.aa_f_658c9e0a:not(.ab_f_658c9e0a) button:active{background:"[theme:white, default: #ffffff]"}.aa_f_658c9e0a .ac_f_658c9e0a,.aa_f_658c9e0a .ae_f_658c9e0a{margin:0;display:inline-block;border:none}.aa_f_658c9e0a .ac_f_658c9e0a i,.aa_f_658c9e0a .ae_f_658c9e0a i{margin:0 10px;position:relative;top:2px}.aa_f_658c9e0a .af_f_658c9e0a{border-bottom:2px solid!important;cursor:default;position:relative;top:-2px;height:20px;color:"[theme:black, default: #000000]"}.aa_f_658c9e0a .af_f_658c9e0a.ag_f_658c9e0a{border:1px dotted!important;border-bottom:3px solid!important}[dir=ltr] .ah_f_658c9e0a{text-align:left}[dir=rtl] .ah_f_658c9e0a{text-align:right}[dir=ltr] .ah_f_658c9e0a .ac_f_658c9e0a{float:right}[dir=rtl] .ah_f_658c9e0a .ac_f_658c9e0a{float:left}@media only screen and (min-width:640px){.aa_f_658c9e0a button{display:inline-block}}',!0);var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handleClick=function(){t.props.onClick(t.props.pageNumber,t.props.pageType)},t._handleKeyDown=function(e){t.props.onKeyDown(e,t.props.pageNumber,t.props.pageType)},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=this.props.pageType===p.Prev,n=this.props.pageType===p.Next,r=Object(c.css)(((e={}).af_f_658c9e0a=this.props.selected,e.ae_f_658c9e0a=t,e.ac_f_658c9e0a=n,e),this.props.className);return i.createElement(c.ActionButton,Object(a.__assign)({className:r,ariaLabel:this._pageAriaLabel,disabled:this.props.disabled,onClick:this._handleClick},this.props.onKeyDown?{onKeyDown:this._handleKeyDown}:{}),t&&i.createElement(c.Icon,{iconName:m.Locale.isRightToLeft?"ChevronRight":"ChevronLeft","aria-hidden":"true"}),this.props.text,n&&i.createElement(c.Icon,{iconName:m.Locale.isRightToLeft?"ChevronLeft":"ChevronRight","aria-hidden":"true"}))},Object.defineProperty(t.prototype,"_pageAriaLabel",{get:function(){return this.props.pageNumber?this.props.pageType===p.Default?m.StringHelper.format(_.e,this.props.pageNumber):m.StringHelper.format(_.a,this.props.text,this.props.pageNumber):m.StringHelper.format(_.i,this.props.text)},enumerable:!1,configurable:!0}),t}(i.PureComponent),g=b,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handleClick=function(e,n){t.props.onPageChange(e,n)},t._handleKeyDown=function(e,n,a){t.props.onPageChangeWithKeyDown(e,n,a)},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=Object(c.css)("aa_f_658c9e0a",((e={}).ah_f_658c9e0a=!this.props.showPageNum,e.ab_f_658c9e0a=!0,e),this.props.className);return 0===this.props.itemsCount?void 0:i.createElement("div",{className:t},this.pages)},Object.defineProperty(t.prototype,"pages",{get:function(){var e=[],t=Math.ceil(this.props.itemsCount/this.props.itemsPerPage),n=this.props.pageLength,r=this.props.currentPage;r<1&&(r=1),r>t&&(r=t);var o=Math.max(1,r-Math.floor(n/2)),s=Math.min(t,r+Math.floor(n/2));s-o+1<n&&(r<t/2?s=Math.min(t,n+o):o=Math.max(1,s-n)),s-o+1>n&&(r>t/2?o++:s--);var c=r-1>0?r-1:r,d=r===s?s:r+1;if(e.push(i.createElement(g,Object(a.__assign)({className:this.props.pageClassName,key:_.n+c,text:_.n,pageType:p.Prev,pageNumber:this.props.showPageNum?c:void 0,selected:!1,disabled:this.props.showPageNum?1===r:!this.props.hasPrevPage,onClick:this._handleClick},this.props.onPageChangeWithKeyDown?{onKeyDown:this._handleKeyDown}:{}))),this.props.showPageNum)for(var l=o;l<=s;l++){var u="".concat(l);e.push(i.createElement(g,Object(a.__assign)({key:u+l,text:u,pageType:p.Default,pageNumber:l,selected:r===l,disabled:!1,onClick:this._handleClick},this.props.onPageChangeWithKeyDown?{onKeyDown:this._handleKeyDown}:{})))}return e.push(i.createElement(g,Object(a.__assign)({key:_.t+d,text:_.t,pageType:p.Next,pageNumber:this.props.showPageNum?d:void 0,selected:!1,disabled:this.props.showPageNum?r===s:!this.props.hasNextPage,onClick:this._handleClick},this.props.onPageChangeWithKeyDown?{onKeyDown:this._handleKeyDown}:{}))),e},enumerable:!1,configurable:!0}),t}(i.PureComponent),y=v,S=function(){function e(){}return e.getStyles=function(e){var t=e.theme,n=t.semanticColors;return{title:[{selectors:{"& span":{color:n.bodyText},"& textarea":{color:t.semanticColors.bodyText+" !important"},"& textarea::placeholder":{color:t.semanticColors.bodySubtext+" !important"}}}],add:[{color:n.bodyText,selectors:{"& .ms-Button-icon":{color:n.link},"&:hover .ms-Button-icon, &:active .ms-Button-icon, &:focus .ms-Button-icon":{color:n.linkHovered+" !important"},"& .ms-Button-label":{color:n.actionLink},"&:hover .ms-Button-label, &:active .ms-Button-label, &:focus .ms-Button-label":{color:n.actionLinkHovered+" !important"},"& .ms-Button-menuIcon":{color:n.bodySubtext},"&:hover .ms-Button-menuIcon, &:active .ms-Button-menuIcon, &:focus .ms-Button-menuIcon":{color:n.bodySubtext+" !important"}}}],seeAll:[{color:n.link,selectors:{"&:hover, &:active":{color:n.linkHovered},"&:focus":{color:n.link}}}]}},e.getClassNames=Object(c.classNamesFunction)(),e}(),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype._internalLoad=function(){return n.e(3).then(n.bind(null,"bWQ8")).then(function(e){return e.TeachingBubble})},t}(n("qjmy")._DeferredComponent),I=D,x=n("xTKt");h.loadStyles('.ai_g_658c9e0a{display:flex;align-items:stretch;flex-direction:column}.aj_g_658c9e0a{display:flex;align-items:baseline}.ak_g_658c9e0a{order:2;width:100%}.al_g_658c9e0a{flex-grow:1}[dir=ltr] .al_g_658c9e0a{margin-right:32px}[dir=rtl] .al_g_658c9e0a{margin-left:32px}.ms-Button.am_g_658c9e0a{height:auto;margin-bottom:23px;border:0}[dir=ltr] .ms-Button.am_g_658c9e0a{padding-left:0}[dir=rtl] .ms-Button.am_g_658c9e0a{padding-right:0}[dir=ltr] .ms-Button.am_g_658c9e0a .ms-Icon{margin-left:0}[dir=rtl] .ms-Button.am_g_658c9e0a .ms-Icon{margin-right:0}.ms-Button.an_g_658c9e0a{background-color:transparent;height:35px;margin-bottom:5px;margin-top:-9px}.ms-Button.ao_g_658c9e0a .ms-Button-icon,.ms-Button.ao_g_658c9e0a:hover .ms-Button-label{color:"[theme:themePrimary, default: #0078d4]"}.ap_g_658c9e0a{white-space:nowrap}[dir=ltr] .ap_g_658c9e0a{margin-left:auto}[dir=rtl] .ap_g_658c9e0a{margin-right:auto}.CanvasSection--edit .al_g_658c9e0a{flex-shrink:0}.aq_g_658c9e0a{margin-bottom:18px}.ar_g_658c9e0a{margin-bottom:11px}.as_g_658c9e0a{margin-bottom:0}.at_g_658c9e0a{background-color:#fff}',!0);var C="al_g_658c9e0a",O="am_g_658c9e0a",w=function(e){function t(t){var n=e.call(this,t)||this;return n._handleClick=function(e){var t=n.props,a=t.seeAllLink,i=t.webPartAlias;a.teachingBubble&&!n.state.isTeachingBubbleDismissed&&n._onDismissTeachingBubble(),d.ScreenReaderAlert.read(o.Text.format(x.r,i||""),d.ReadingMode.ReadImmediately),a.onClick(e)},n._onDismissTeachingBubble=function(){var e=n.props.seeAllLink;n._isMounted&&n.setState({isTeachingBubbleDismissed:!0}),e&&e.teachingBubble.onDismiss()},n._handleSeeAllLinkKeyDown=function(e){e.keyCode===c.KeyCodes.enter&&d.ScreenReaderAlert.read(o.Text.format(x.r,n.props.webPartAlias||""),d.ReadingMode.ReadImmediately)},n.state={isTeachingBubbleDismissed:!1},n}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"_classNames",{get:function(){var e=this.props.theme;return Boolean(e)&&S.getClassNames(S.getStyles,{root:"webPartChrome",theme:e})},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this._isMounted=!0},t.prototype.componentWillUnmount=function(){this._isMounted=!1},t.prototype.render=function(){var e,t=this.props,n=t.dataAutomationId,a=t.forceContrastBackground,r=t.seeAllLink,o=t.showTitle,s=r&&r.show||o,d=i.createElement("div",{"data-automation-id":n,className:Object(c.css)("ai_g_658c9e0a",(e={},e.at_g_658c9e0a=a,e))},i.createElement("div",{className:s?"aj_g_658c9e0a":"","data-automation-id":s?"webPartHeader":""},this._renderTitle(),this._renderSeeAllLink()),this._renderContent(),this._renderTeachingBubble());return this.props.theme?i.createElement(c.Customizer,{settings:{theme:this.props.theme}},d):d},t.prototype.focusOnTitle=function(){this._captionElement&&this._captionElement.focusOnCaptionElement()},t.prototype._renderTitle=function(){var e=this.props,t=e.customTitle,n=e.isEditMode,a=e.onTitleChange,r=e.placeholder,o=e.showTitle,s=e.title,d=e.titleAlignment,l=e.isTitleEditable;return o?t||i.createElement(f.n,{className:Object(c.css)(this._classNames&&this._classNames.title,C),ref:this._resolveRef("_captionElement"),type:f.t.Title,isEditMode:n,text:s,onChange:a||u.noop,placeholder:r,alignPosition:d||f.e.PageDirection,headingLevel:2,marginBottomSize:this._titleMarginBottomSize,isTitleEditable:l}):i.createElement("div",{className:C})},t.prototype._renderContent=function(){var e=this.props,t=e.contentElement,n=e.pagination,r=e.panelElement;return i.createElement("div",{className:"ak_g_658c9e0a"},this._renderAddButton(),t,r,n&&i.createElement(y,Object(a.__assign)({},n)))},Object.defineProperty(t.prototype,"_titleMarginBottomSize",{get:function(){var e=this.props,t=e.addButton,n=e.seeAllLink,a=e.showTitle,i=e.titleMarginBottomSize;return void 0!==i?i:n&&n.show||a?t.show?"Middle":"Large":"None"},enumerable:!1,configurable:!0}),t.prototype._renderSeeAllLink=function(){var e,t=this.props.seeAllLink;switch(this._titleMarginBottomSize){case"Large":e="aq_g_658c9e0a";break;case"Middle":e="ar_g_658c9e0a";break;case"None":e="as_g_658c9e0a"}return t&&t.show&&t.href&&i.createElement("span",{className:e,ref:this._resolveRef("_teachingBubbleTargetElement")},i.createElement(c.Link,Object(a.__assign)({"aria-label":t.ariaLabel||x.i,className:Object(c.css)(!t.disabled&&this._classNames&&this._classNames.seeAll,"ap_g_658c9e0a"),disabled:t.disabled,onClick:this._handleClick,onKeyDown:this._handleSeeAllLinkKeyDown,"data-interception":"propagate","data-automation-id":t.automationId,id:t.id,"data-sp-action":t.action},{href:t.href}),t.label||x.a))},t.prototype._renderTeachingBubble=function(){var e=this.props.seeAllLink.teachingBubble;return this._showTeachingBubble&&!this.state.isTeachingBubbleDismissed?i.createElement(I,{deferredProps:{headline:e.headline,targetElement:this._teachingBubbleTargetElement,onDismiss:this._onDismissTeachingBubble,hasCloseIcon:!0,calloutProps:{doNotLayer:!1,gapSpace:2,isBeakVisible:!0,directionalHint:c.DirectionalHint.topAutoEdge},primaryButtonProps:e.primaryButtonProps,closeButtonAriaLabel:x.n}},e.text):void 0},Object.defineProperty(t.prototype,"_showTeachingBubble",{get:function(){var e=this.props.seeAllLink;return Boolean(e&&e.teachingBubble&&e.teachingBubble.show)},enumerable:!1,configurable:!0}),t.prototype._renderAddButton=function(){var e=this.props.addButton;if(e&&e.show){var t={ariaLabel:e.ariaLabel||x.e,ariaDescription:e.ariaDescription,disabled:e.disabled,iconProps:{iconName:"CalculatorAddition"},label:e.label||x.t,"data-automation-id":e.automationId,"data-interception":"propagate"};return e.menuProps?i.createElement(c.DefaultButton,Object(a.__assign)({},t,{className:Object(c.css)(!e.disabled&&this._classNames&&this._classNames.add,O,"an_g_658c9e0a",!this._classNames&&"ao_g_658c9e0a"),menuProps:e.menuProps,styles:{label:{fontWeight:400}}}),t.label):i.createElement(c.ActionButton,Object(a.__assign)({},t,{className:Object(c.css)(!e.disabled&&this._classNames&&this._classNames.add,O),href:e.href,onClick:e.onClick}),t.label)}},t.defaultProps={isEditMode:!1,seeAllLink:{show:!1},addButton:{show:!1},contentElement:i.createElement("div",null)},t}(c.BaseComponent),E=function(){function e(){}return e.exclusiveRenderTimeForBaseCollectionWebPart=new d.KillSwitch("d84e2f1c-760e-4fb3-9589-95de35f2ddc1"),e}();function A(){return!o._SPKillSwitch.isActivated("9da07b7d-b53a-4c3d-bced-36f541fd231f")}var L=n("IBxL");h.loadStyles('.av_i_658c9e0a{color:"[theme:neutralPrimary, default: #323130]"}.aw_i_658c9e0a{margin-bottom:5px}.ax_i_658c9e0a a::-moz-focus-inner,.ax_i_658c9e0a button::-moz-focus-inner{border:0}.ax_i_658c9e0a a,.ax_i_658c9e0a button{outline:transparent;position:relative}.ax_i_658c9e0a.ms-Fabric.is-focusVisible a:focus:after,.ax_i_658c9e0a.ms-Fabric.is-focusVisible button:focus:after,.ms-Fabric.is-focusVisible .ax_i_658c9e0a a:focus:after,.ms-Fabric.is-focusVisible .ax_i_658c9e0a button:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;border:1px solid "[theme:neutralsecondary, default: #605e5c]";border-radius:inherit;pointer-events:none}',!0);var k=function(e){function t(t){var n=e.call(this,t)||this;return n._webPartChromeRef=i.createRef(),n._handleTitleChange=function(e){n.props.onTitleChange(e)},n._layoutContainerRef=i.createRef(),n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props.onComponentMounted;!this._isDynamicLayout&&e&&e()},t.prototype.componentWillUnmount=function(){this._layoutContainerRef.current&&(r.unmountComponentAtNode(this._layoutContainerRef.current),this._layoutContainerRef=void 0)},t.prototype.render=function(){var e,t=this.props,n=t.addButton,a=t.defaultTitle,r=t.displayMode,d=t.emphasisTheme,l=t.errorCallback,u=t.hideWebPartWhenEmpty,f=(t.isInTeamsContext,t.isRenderedFromCacheData),p=t.paginationProps,m=t.panelElement,_=t.qosPrefix,h=t.seeAllLink,b=t.isTitleEditable,g=t.changeVisibility,v=new s._QosMonitor("".concat(_,"ComponentRender")),y=this._renderEmptyResult(v),S=f?"BaseCollection-Cache":"BaseCollection-FreshData";y||this._renderLayout();try{!u||!y||h&&h.show||r!==o.DisplayMode.Read?(e=i.createElement(c.Fabric,null,i.createElement(w,{addButton:n,contentElement:this._renderWebPartDisplay(y),dataAutomationId:S,forceContrastBackground:!1,isEditMode:r===o.DisplayMode.Edit,onTitleChange:this._handleTitleChange,pagination:p,panelElement:m,placeholder:a,ref:this._webPartChromeRef,seeAllLink:h,showTitle:this._shouldShowTitle,theme:d,title:this._title,isTitleEditable:b}),this._dialogRef?i.createElement("div",{ref:this._dialogRef}):void 0),null==g||g(!0)):(e=!1,null==g||g(!1))}catch(e){l(e),v.writeUnexpectedFailure("FailedToRender",e)}return v.writeSuccess(),e},t.prototype.focusOnTitle=function(){var e=this._webPartChromeRef.current;e&&e.focusOnTitle()},Object.defineProperty(t.prototype,"_hasEmptyResponse",{get:function(){var e=this.props.items;return!!e&&e.length<1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_emptyResponseText",{get:function(){var e=this.props,t=e.displayMode,n=e.hasInitialLoadingState,a=e.hideWebPartWhenEmpty,i=e.emptyResponseText;if(this._hasEmptyResponse&&!n){if(a&&t===o.DisplayMode.Read)return;return i||L.s}},enumerable:!1,configurable:!0}),t.prototype._renderEmptyResult=function(e){var t=this.props,n=t.errorCallback,a=t.hasInitialLoadingState,r=t.layoutInfo;if(this._hasEmptyResponse&&!a)try{var o=r&&r.id||"",s=A()&&this.props.emphasisTheme?"":"av_i_658c9e0a",c=A()?{color:this.props.emphasisTheme.palette.neutralPrimary}:{};return i.createElement("span",{className:s,"data-automation-id":"".concat(o,"-no-results"),style:c},this._emptyResponseText)}catch(t){n(t),e.writeUnexpectedFailure("FailedToRenderEmptyResult")}},t.prototype._renderLayout=function(){var e=this,t=this.props,n=t.emphasisTheme,o=t.errorCallback,d=t.layoutInfo,u=t.onComponentMounted,f=t.qosPrefix;E.exclusiveRenderTimeForBaseCollectionWebPart.isActivated()||l._PerformanceLogger.saveTempData("".concat(this.props.webPartTag,".loadLayoutStart"),l._PerformanceLogger.now());var p=new s._QosMonitor("".concat(f,"ComponentRenderLayout"));this._isDynamicLayout=!0,d.loadLayout().then(function(t){E.exclusiveRenderTimeForBaseCollectionWebPart.isActivated()||l._PerformanceLogger.saveTempData("".concat(e.props.webPartTag,".loadLayoutEnd"),l._PerformanceLogger.now());var o=i.createElement(t,e.props);if(n){var s={settings:{theme:n}};o=i.createElement(c.Customizer,Object(a.__assign)({},s),o)}var d=function(){p.writeSuccess(),u&&u()};e._layoutContainerRef.current?r.render(o,e._layoutContainerRef.current,d):d(),E.exclusiveRenderTimeForBaseCollectionWebPart.isActivated()||l._PerformanceLogger.saveTempData("".concat(e.props.webPartTag,".syncLayoutRenderComplete"),l._PerformanceLogger.now())}).catch(function(e){o(e),p.writeUnexpectedFailure("FailedToRenderLayout",e)})},Object.defineProperty(t.prototype,"_title",{get:function(){var e=this.props,t=e.defaultTitle,n=e.displayMode,a=e.displayPlaceholderTitleInReadMode,i=e.title;return n===o.DisplayMode.Read&&a&&!i?t:i||""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_shouldShowTitle",{get:function(){var e=this.props,t=e.displayMode,n=e.hasInitialLoadingState,a=e.showTitle,i=n||!this._hasEmptyResponse||Boolean(this._emptyResponseText);return a&&t===o.DisplayMode.Edit||i&&a&&!!this._title},enumerable:!1,configurable:!0}),t.prototype._renderWebPartDisplay=function(e){var t=this.props,n=t.addToPageScreenReaderLabel,a=t.displayMode,r=t.messageView,s=t.renderedOnce;return i.createElement("div",null,a===o.DisplayMode.Edit&&!s&&n&&i.createElement(d.ScreenReaderAlert,{readingMode:d.ReadingMode.ReadImmediately,message:n}),r&&i.createElement(c.MessageBar,{className:"aw_i_658c9e0a",ariaLabel:r.ariaLabel,messageBarType:r.messageBarType},r.message),e||i.createElement("div",{ref:this._layoutContainerRef}))},t}(c.BaseComponent),M=n("7Awa"),P=n("br4S"),T=n("X+PM"),U=n("vlQI");function F(){return o._SPFlight.isEnabled(1671)}var H="SP.ResourcePath",R="/_api/SP.UserProfiles.PersonalCache",N=function(){function e(){}return e.getRemoteSubfolderCreateUrl=function(e,t,n,a){o.Validate.isNonemptyString(e,"currentWebAbsoluteUrl"),o.Validate.isNonemptyString(t,"remoteWebAbsoluteUrl"),o.Validate.isNonemptyString(n,"remoteParentFolderRelativeUrl"),o.Validate.isNonemptyString(a,"remoteFolderName");var i=m.UriEncoding.encodeRestUriStringToken(t),r=m.UriEncoding.encodeRestUriStringToken(n),s=m.UriEncoding.encodeRestUriStringToken(a);return m.Uri.concatenate(m.Uri.concatenate(m.Uri.concatenate(e,"/_api/SP.RemoteWeb(@remoteWeb)"),"/Web/GetFolderByServerRelativePath(DecodedUrl=@parentFolderRelativeUrl)"),"/AddSubFolder(@subfolderTitle)")+"?@remoteWeb='".concat(i,"'")+"&@parentFolderRelativeUrl='".concat(r,"'")+"&@subfolderTitle='".concat(s,"'")},e.getUrlLastSegment=function(e){return o.Validate.isNonemptyString(e,"url"),new m.Uri(e).getLastPathSegment()},e.getUrlWithoutLastSegment=function(e){o.Validate.isNonemptyString(e,"url");var t=e.lastIndexOf("/");return t>-1?e.substring(0,t):e},e.getPersonalCacheItemCreateUrl=function(e){o.Validate.isNonemptyString(e,"currentWebAbsoluteUrl");var t=F()?"/ReadCacheOrCreate2":"/ReadCacheOrCreate";return m.Uri.concatenate(m.Uri.concatenate(e,R),t)},e.getPersonalCacheItemUpdateUrl=function(e){o.Validate.isNonemptyString(e,"currentWebAbsoluteUrl");var t=F()?"/WriteCache2":"/WriteCache";return m.Uri.concatenate(m.Uri.concatenate(e,R),t)},e.getPersonalCacheItemDeleteUrl=function(e){o.Validate.isNonemptyString(e,"currentWebAbsoluteUrl");var t=F()?"/DeleteCacheItemsAsync2":"/DeleteCacheItemsAsync";return m.Uri.concatenate(m.Uri.concatenate(e,R),t)},e.dateTimeStringToJsDate=function(e){o.Validate.isNonemptyString(e,"dateTime");var t=e.split(/[^0-9]/);return t.length<6?void 0:new Date(Date.UTC(Number(t[0]),Number(t[1])-1,Number(t[2]),Number(t[3]),Number(t[4]),Number(t[5])))},e.checkStatus=function(e){return o.Validate.isNotNullOrUndefined(e,"response"),e.status>=200&&e.status<300?Promise.resolve(e):Promise.reject(new Error(JSON.stringify(e)))},e.checkFolderStatus=function(e){return o.Validate.isNotNullOrUndefined(e,"response"),e.status>=200&&e.status<300||500===e.status?Promise.resolve(e):Promise.reject(new Error(JSON.stringify(e)))},e.getCreatePersonalCacheItemBody=function(e,t,n){o.Validate.isNonemptyString(e,"listRelativeFolderPath"),o.Validate.isNotNullOrUndefined(t,"items");var a="";t.forEach(function(e){""!==a&&(a+=", "),a+=e.CacheKey});var i={folderPath:{__metadata:{type:"".concat(H)},DecodedUrl:"".concat(e)},requiredCacheKeys:["".concat(a)],createIfMissing:!0};return n&&F()&&(i.mySiteUrl=n),i},e.getReadPersonalCacheItemBody=function(e,t,n){o.Validate.isNonemptyString(e,"listRelativeFolderPath"),o.Validate.isNotNullOrUndefined(t,"instanceIds");var a={folderPath:{__metadata:{type:"".concat(H)},DecodedUrl:"".concat(e)},requiredCacheKeys:t,createIfMissing:!1};return n&&F()&&(a.mySiteUrl=n),a},e.getUpdatePersonalCacheItemsBody=function(e,t,n){o.Validate.isNotNullOrUndefined(e,"items");var a={cacheItems:[]};return e.forEach(function(e){n&&(e.CacheValue=""),a.cacheItems.push(e)}),t&&F()&&(a.mySiteUrl=t),a},e.post=function(e,t,n,a){return o.Validate.isNotNullOrUndefined(e,"spHttpClient"),o.Validate.isNonemptyString(t,"url"),o.Validate.isNotNullOrUndefined(n,"body"),e.post(t,U.SPHttpClient.configurations.v1,{body:JSON.stringify(n),headers:{"OData-Version":"3.0"}}).then(a)},e.generateHash=function(e){return Object(d.Md5Hash)(e)},e.getDateNowAsUTC=function(){var e=new Date;return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()))},e.addSecondsToDate=function(e,t){o.Validate.isNotNullOrUndefined(e,"date"),o.Validate.isNotNullOrUndefined(t,"seconds");var n=new Date(e.toString());return n.setTime(n.getTime()+1e3*t),n},e.isExpired=function(t,n,a){return t&&n&&a&&a>0&&t>e.addSecondsToDate(n,a)},e}(),B="2.0",j="1.5",V="MySiteWebPartCacheDataProvider.",z="MySiteWebPartCacheDataProvider",G=new d.KillSwitch("4edae48c-3b13-49f4-9d36-ae20f68406f4"),K=new d.KillSwitch("119E9B3E-9B4E-4575-B09A-972FE0E35921"),W=function(){function e(t){var n=this;this._cacheItemsMap=new Map,this._cacheItemVersionMap=new Map,this._hasFlushCompleted=!1,this._hasInitializedSynchronously=!1,this._updateRemoteCacheItemsAPI=function(e,t){o.Validate.isNotNullOrUndefined(e,"absoluteUrl"),o.Validate.isNotNullOrUndefined(t,"items");var a="_writeCache",i=new s._QosMonitor(V+a);l._PerformanceLogger.startMarkForComponent(a),n._updateLocalItems(t);var r,c=N.getPersonalCacheItemUpdateUrl(e),d=N.getUpdatePersonalCacheItemsBody(t,n._mySiteAbsoluteUrl);return r=G.isActivated()?{count:t.length}:{count:t.length,dataSizeInKB:JSON.stringify(t).length/1024},N.post(n._spHttpClient,c,d,N.checkStatus).then(function(e){return i.writeSuccess(r),l._PerformanceLogger.endMarkForComponent(a),e}).catch(function(e){return i.writeUnexpectedFailure("WriteCacheError",e,r),l._PerformanceLogger.endMarkForComponent(a),Promise.reject(e)})},this._updateRemotePersonalCacheItems=function(){e._itemsToDeferUpdate.size>0&&(e._itemsToDeferUpdate.forEach(function(t,a){n._updateRemoteCacheItemsAPI(a,t).catch(function(t){return s._TraceLogger.logError(e._logSource,t,"UpdateRemoteCacheItems")})}),e._itemsToDeferUpdate.clear())},this._remoteUpdater=function(e){n._updateRemotePersonalCacheItems(),e||(n._writeCacheTimer=n._async.setTimeout(n._remoteUpdater,1e4))},this._hookUnloadEvent=function(){window.addEventListener("beforeunload",n._emergencyUpload)},this._unhookUnloadEvent=function(){window.removeEventListener("beforeunload",n._emergencyUpload)},this._emergencyUpload=function(){n._remoteUpdater(!0),n._unhookUnloadEvent(),n._writeCacheTimer&&n._async.clearTimeout(n._writeCacheTimer)},l._PerformanceLogger.startMarkForComponent(z),this._async=new c.Async(this);var a=function(){var e=new s._QosMonitor(V+"_tryInitializeFromLateFlush");try{n._tryInitializeFromPage(),n._hasFlushCompleted?e.writeSuccess():e.writeUnexpectedFailure("NoCacheMetadata")}catch(t){e.writeUnexpectedFailure("CatchAll",t)}},i=e._increaseLateFlushKS()?12e4:24e4,r=0;this._initializeFromLateFlush=new Promise(function(e,t){var o=new s._QosMonitor(V+"_initializeFromLateFlush");window._spWebPartDataLoaded||(window._spWebPartDataLoaded=a);var d=new c.Async;d.setInterval(function(){return!n._hasFlushCompleted&&window._spWebPartData&&a(),n._hasFlushCompleted&&window._spWebPartData?(l._PerformanceLogger.markComponent(z,n._hasInitializedSynchronously?"SyncFlushCompleted":"LateFlushCompleted"),o.writeSuccess({initializedAsync:!n._hasInitializedSynchronously}),d.dispose(),e()):r>=i?(l._PerformanceLogger.endMarkForComponent(z),o.writeUnexpectedFailure("TimedOut"),d.dispose(),t()):void(r+=50)},50)}),t.whenFinished(function(){n._pageContext=t.consume(T.PageContext.serviceKey),n._spHttpClient=t.consume(U.SPHttpClient.serviceKey),n._tryInitializeSynchronously(),n._remoteUpdater(),n._hookUnloadEvent(),s._EngagementLogger.logEvent("MySiteWebPartCacheDataProvider.Constructor")})}return e._increaseLateFlushKS=function(){return o._SPKillSwitch.isActivated("ab30cf50-82cc-4361-9270-edce465b67d7")},Object.defineProperty(e.prototype,"currentListRelativeFolderPath",{get:function(){return this._currentListRelativeFolderPath},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentWebAbsoluteUrl",{get:function(){return this._currentWebAbsoluteUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mySiteAbsoluteUrl",{get:function(){return this._mySiteAbsoluteUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasFlushCompleted",{get:function(){return this._hasFlushCompleted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"initializeFromLateFlush",{get:function(){return this._initializeFromLateFlush},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentPageCacheFolderKey",{set:function(e){this._currentPageCacheFolderKey=e,this._currentListRelativeFolderPath=this._getListRelativeFolderPath()},enumerable:!1,configurable:!0}),e.prototype.getCacheItemVersion=function(e){return this._cacheItemVersionMap.get(e)},e.prototype.getWebPartIdLogObject=function(e,t,n,a){return{alias:e,instanceId:t,isSmartRaceEnabled:this._isMySiteCacheSmartRaceRefactorEnabled(),cacheStatus:n,serverStatus:a}},e.prototype._internalAdvancedGetCachedData=function(e,t){var n=this._getCachedItem(e);if(n&&n.hash===t)return JSON.parse(n.result)},e.prototype._internalAdvancedSetCacheData=function(e,t,n){this._tryUpdateCache(e.instanceId,e.manifest.alias,n,t)},e.prototype.getWebPartData=function(t,n,a,i,r,c,d,l){var u=this;void 0===c&&(c=!0),void 0===d&&(d=-1),o.Validate.isNotNullOrUndefined(t,"requestData"),o.Validate.isNotNullOrUndefined(n,"dataUpdated"),o.Validate.isNotNullOrUndefined(a,"config"),o.Validate.isNonemptyString(i,"webPartInstanceId"),o.Validate.isNonemptyString(r,"webPartAlias");var f=new s._QosMonitor(V+"getWebPartData"),p="",m=void 0,_=this._getCachedItem(i),h=N.generateHash(JSON.stringify(a));l=l||"WebPart.".concat(r,".internal.").concat(i),this._isThrottlingEnabled()&&!this._hasFlushCompleted&&(t=this._getThrottledServerCall(t)),this._logCacheStart(i,l,"MySiteWebPartCacheDataProvider.GetWebPartData"),this._captureCacheKeyUsageTelemetry(r,h);var b=!!_&&h!==_.hash;if(!_||b){this._logCacheMiss(l),this._logConfigMismatch(l,_,!b);var g=t(),v=g.then(function(t){s._TraceLogger.logVerbose(e._logSource,"CacheMiss: Requested cached item for ".concat(l," doesn't exist. Creating.")),m=t,p=JSON.stringify(m),u._tryUpdateCache(i,r,p,h,_?_.id:void 0),f.writeSuccess(u.getWebPartIdLogObject(r,i))}).catch(function(t){s._TraceLogger.logError(e._logSource,t,"getWebPartData: error while processing non-cached item for ".concat(l,".")),f.writeUnexpectedFailure("NewItemRequestSaveRenderError",t,u.getWebPartIdLogObject(r,i))}).then(function(){return m});if(this._hasFlushCompleted)return v;this._logLateFlush(l);var y=this._initializeFromLateFlush.then(function(){return u._getCachedItem(i)}).then(function(t){return u._canUseCachedData_deprecated(t,a,d)?u._returnCachedDataWithRefresh(t,function(){return g},n,a,i,r,f,h,c,d):(s._TraceLogger.logVerbose(e._logSource,"Late flush resulted in a miss ".concat(r,".").concat(i)),v)});return Promise.race([y,v])}if(N.isExpired(this._utcTimeStamp,_.modified,d))return this._logCacheExpired(l),t().then(function(e){m=e,p=JSON.stringify(m),u._tryUpdateCache(i,r,p,h,_.id),f.writeSuccess(u.getWebPartIdLogObject(r,i))}).catch(function(t){s._TraceLogger.logError(e._logSource,t,"getWebPartData: error while processing cached WebPart item ".concat(i,".")),f.writeUnexpectedFailure("ExpiredCacheUpdateError",t,u.getWebPartIdLogObject(r,i))}).then(function(){return m});try{if(h===_.hash)return this._returnCachedDataWithRefresh(_,t,n,a,i,r,f,h,c,d)}catch(t){s._TraceLogger.logError(e._logSource,t,"getWebPartData: error while processing cache item request for ".concat(l,".")),f.writeUnexpectedFailure("CachedItemUpdateError",t,this.getWebPartIdLogObject(r,i))}finally{return this._logCacheHit(l),Promise.resolve(JSON.parse(_.result))}},e.prototype.getCacheData=function(e){var t=this,n=e.dataUpdated,a=e.serializedConfiguration,i=e.webPartAlias,r=e.webPartInstanceId,s=e.secondsToInvalidate,c=e.requestData;o.Validate.isNotNullOrUndefined(c,"requestData"),o.Validate.isNotNullOrUndefined(n,"dataUpdated"),o.Validate.isNotNullOrUndefined(a,"serializedConfiguration"),o.Validate.isNonemptyString(i,"webPartAlias"),o.Validate.isNonemptyString(r,"webPartInstanceId");var l=this._getCachedItem(r),u=N.generateHash(a),f="WebPart.".concat(i,".internal.").concat(r);this._logCacheStart(r,f,"MySiteWebPartCacheDataProvider.GetCacheData");var p={cacheResponseType:d.CacheResponseType.ServerData,serverResponseAsync:Promise.reject().catch(function(e){return e})},m=function(e){return t._shouldRequestServerDataWhenThrottling(e)?t._tryUpdateCacheAsync(c,n,i,r,u):p.serverResponseAsync};if(this._isThrottlingEnabled()?this._hasFlushCompleted||(c=this._getThrottledServerCall(c)):p.serverResponseAsync=this._tryUpdateCacheAsync(c,n,i,r,u),this._canUseCachedData(l,u,s,f))return p.cacheResponseType=d.CacheResponseType.CachedData,p.cacheResponseAsync=Promise.resolve(JSON.parse(l.result)),this._isThrottlingEnabled()&&(p.serverResponseAsync=m(l.modified)),Promise.resolve(p);if(this._logCacheMiss(f),!this._hasFlushCompleted){this._logLateFlush(f);var _=this._initializeFromLateFlush.then(function(){return t._getCachedItem(r)}).then(function(e){return t._canUseCachedData(e,u,s,f)&&(p.cacheResponseType=d.CacheResponseType.CachedData,p.cacheResponseAsync=Promise.resolve(JSON.parse(e.result)),t._isThrottlingEnabled()&&(p.serverResponseAsync=m(l.modified))),Promise.resolve(p)});this._isThrottlingEnabled()&&(p.serverResponseAsync=_.then(function(e){return e.serverResponseAsync}));var h=o.Guid.parse("f45cfbcb-6bff-4e57-93d9-5427a620ab01"),b=o.Guid.parse("4bba5b4c-4f1a-4639-9512-3abc0226331a"),g=[{raceablePromise:_.then(function(e){return e.cacheResponseAsync||e.serverResponseAsync}),raceId:h},{raceablePromise:p.serverResponseAsync,raceId:b}];return d.SmartRace.race(g).then(function(e){return{cacheResponseType:e.raceId===h?d.CacheResponseType.CachedData:d.CacheResponseType.ServerData,cacheResponseAsync:e.raceId===h?e.raceablePromise:void 0,serverResponseAsync:p.serverResponseAsync}}).catch(function(e){throw t._logSmartRaceError(e),e})}return p.cacheResponseType=d.CacheResponseType.ServerData,this._isThrottlingEnabled()&&(p.serverResponseAsync=this._tryUpdateCacheAsync(c,n,i,r,u)),Promise.resolve(p)},e.prototype._tryUpdateCacheAsync=function(e,t,n,a,i){var r=this;return e().then(function(e){t&&t(e);var o=JSON.stringify(e);return r._tryUpdateCache(a,n,o,i),e})},e.prototype._canUseCachedData=function(e,t,n,a){var i=!!e&&(e.hash===t||e.cacheVersion===B);if(this._logConfigMismatch(a,e,i),e){var r=N.isExpired(this._utcTimeStamp,e.modified,n);if(r&&this._logCacheExpired(a),i&&!r)return this._logCacheHit(a),!0}return!1},e.prototype._canUseCachedData_deprecated=function(e,t,n){return void 0===n&&(n=-1),!(!e||e.hash!==N.generateHash(JSON.stringify(t))&&e.cacheVersion!==B||N.isExpired(this._utcTimeStamp,e.modified,n))},e.prototype._returnCachedDataWithRefresh=function(t,n,a,i,r,o,c,d,l,u){var f=this;void 0===l&&(l=!0),void 0===u&&(u=-1);var p="",m=void 0;return s._TraceLogger.logVerbose(e._logSource,"Found cached item ".concat(r," with matching config.")),this._shouldRequestServerDataWhenThrottling(t.modified)&&n().then(function(n){m=n,p=JSON.stringify(m),t.result!==p?(s._TraceLogger.logVerbose(e._logSource,"Requested item ".concat(r," has newer results; updating.")),f._saveRenderAndUpdateItem(a,l,m,r,o,p,d,t.id),c.writeSuccess(f.getWebPartIdLogObject(o,r)),f._logCacheMatchApiResult(o,!1)):(s._TraceLogger.logVerbose(e._logSource,"Requested cached item ".concat(r," has matching result; No write back.")),c.writeSuccess(f.getWebPartIdLogObject(o,r)),f._logCacheMatchApiResult(o,!0))}).catch(function(t){s._TraceLogger.logError(e._logSource,t,"getWebPartData: error while processing cached WebPart item ".concat(r,".")),c.writeUnexpectedFailure("CachedItemUpdatedResultError",t,f.getWebPartIdLogObject(o,r))}),Promise.resolve(JSON.parse(t.result))},e.prototype._logCacheMatchApiResult=function(e,t){s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("MySiteWebPartValidCache_deprecated",e,s._LogType.Event,{CacheMatchApiResult:t?"Match":"Not match"}))},e.prototype._saveRenderAndUpdateItem=function(e,t,n,a,i,r,s,c){o.Validate.isNotNullOrUndefined(e,"dataUpdated"),o.Validate.isNotNullOrUndefined(t,"rerender"),o.Validate.isNotNullOrUndefined(n,"response"),o.Validate.isNonemptyString(a,"webPartInstanceId"),o.Validate.isNonemptyString(i,"webPartAlias"),o.Validate.isNonemptyString(r,"rawResponseString"),o.Validate.isNonemptyString(s,"webPartHash"),o.Validate.isNotNullOrUndefined(c,"cacheItemId"),t&&e(n),this._updateCache(a,i,r,s,c)},e.prototype._tryInitializeSynchronously=function(){var t=new s._QosMonitor(V+"_initialize"),n="Page ".concat(this._currentPageCacheFolderKey," is missing _spPageContextInfo."),a="Page ".concat(this._currentPageCacheFolderKey," has not yet gotten the LKG flush.");this._pageContext?(this._getPrefetchedPageContextProperties(this._pageContext.legacyPageContext),this._tryInitializeFromPage()?(this._hasInitializedSynchronously=!0,l._PerformanceLogger.markComponent(z,"SyncFlushCompleted"),t.writeSuccess()):(l._PerformanceLogger.markComponent(z,"DelayedFlush"),s._TraceLogger.logError(e._logSource,new Error,a),t.writeExpectedFailure("DelayedFlush",new Error))):(l._PerformanceLogger.markComponent(z,"SyncMissingContextInfo"),s._TraceLogger.logError(e._logSource,new Error,n),t.writeUnexpectedFailure("SPPageContextInfoError",new Error))},e.prototype._tryInitializeFromPage=function(){return!!this._hasFlushCompleted||(window._spWebPartData&&(this._getPrefetchedWebPartDataProperties(window._spWebPartData.Properties),this._getPrefetchedWebPartDataItems(window._spWebPartData.Items),this._hasFlushCompleted=!0),this._hasFlushCompleted)},e.prototype._getCachedItem=function(e){return this._cacheItemsMap.get(e)},e.prototype._getPrefetchedWebPartDataProperties=function(e){o.Validate.isNotNullOrUndefined(e,"data"),this._mySiteAbsoluteUrl=e.MySiteUrl,this._currentPageCacheFolderKey=e.PageCacheFolderKey,this._webPartCachePath=e.WebPartCachePath,e.UtcTimeStamp&&(this._utcTimeStamp=N.dateTimeStringToJsDate(e.UtcTimeStamp)),this._currentListRelativeFolderPath=this._getListRelativeFolderPath()},e.prototype._getPrefetchedPageContextProperties=function(e){o.Validate.isNotNullOrUndefined(e,"data"),o.Validate.isNonemptyString(e.webAbsoluteUrl,"data.webAbsoluteUrl"),this._currentWebAbsoluteUrl=e.webAbsoluteUrl},e.prototype._getPrefetchedWebPartDataItems=function(e){var t=this;o.Validate.isNotNullOrUndefined(e,"data"),Object.keys(e).forEach(function(n){var a={webPartInstanceId:n,result:e[n].Value,hash:e[n].HashCode,id:Number(e[n].ID),uniqueId:o.Guid.parse(e[n].UniqueId),modified:N.dateTimeStringToJsDate(e[n].Modified),cacheVersion:e[n].CacheVersion};if(a.cacheVersion===j||a.cacheVersion===B){var i="";try{i=JSON.parse(e[n].AltTitle).id}catch(t){i=e[n].AltTitle}a.webPartInstanceId=i,t._cacheItemVersionMap.set(i,a.cacheVersion),t._cacheItemsMap.set(i,a)}else t._cacheItemVersionMap.set(n,a.cacheVersion),t._cacheItemsMap.set(n,a)}),this._logCacheItemSize()},e.prototype._ensureFlush=function(){return this._hasFlushCompleted?Promise.resolve():this._initializeFromLateFlush},e.prototype._createRemoteCacheItem=function(e,t,n){var a=this;o.Validate.isNonemptyString(e,"title"),o.Validate.isNonemptyString(t,"value"),o.Validate.isNonemptyString(n,"hash");var i=[],r={AltTitle:void 0,CacheValue:t,CacheValueHash:n,ListItemId:void 0,ListItemUniqueId:void 0,CacheVersion:void 0,CacheKey:e,ModifiedTimeUtc:void 0};return i.push(r),this._ensureFlush().then(function(){return a._createPersonalCacheItemsAPI(a._currentListRelativeFolderPath,i)}).then(function(e){if(e)return a._createLocalCacheItemFromServerResponse(e)})},e.prototype._createPersonalCacheItemsAPI=function(e,t){var n=this;o.Validate.isNonemptyString(e,"listRelativeFolderPath"),o.Validate.isNotNullOrUndefined(t,"items");var a=N.getPersonalCacheItemCreateUrl(this._currentWebAbsoluteUrl),i=N.getCreatePersonalCacheItemBody(e,t,this._mySiteAbsoluteUrl);return N.post(this._spHttpClient,a,i,N.checkStatus).then(function(e){return e.json()}).then(function(e){o.Validate.isNotNullOrUndefined(e,"data");var a=t[0],i=[],r={AltTitle:void 0,CacheValue:a.CacheValue,CacheValueHash:a.CacheValueHash,ListItemId:e.value[0].ListItemId,ListItemUniqueId:e.value[0].ListItemUniqueId,CacheVersion:"1.0",CacheKey:a.CacheKey,ModifiedTimeUtc:e.value[0].ModifiedTimeUtc};i.push(r),n._createLocalItems(i),n._addItemToBeUpdated(n._currentWebAbsoluteUrl,r)})},e.prototype._updateRemoteCacheItem=function(e,t,n,a){o.Validate.isNonemptyString(e,"cacheKey"),o.Validate.isNonemptyString(n,"hash"),o.Validate.isNotNullOrUndefined(a,"itemID"),t||(t="");var i={AltTitle:void 0,CacheValue:t,CacheValueHash:n,ListItemId:a,ListItemUniqueId:void 0,CacheVersion:"1.0",CacheKey:K.isActivated()?void 0:e,ModifiedTimeUtc:void 0};return this._cacheItemVersionMap.get(e)===B&&(i.AltTitle=JSON.stringify({id:e}),i.CacheVersion=j),[].push(i),this._addItemToBeUpdated(this._currentWebAbsoluteUrl,i),Promise.resolve()},e.prototype._addItemToBeUpdated=function(t,n){if(e._itemsToDeferUpdate.has(t)){var a=e._itemsToDeferUpdate.get(t),i=Object(u.findIndex)(a,function(e){return n.CacheKey===e.CacheKey});i>=0?a[i]=n:a.push(n)}else e._itemsToDeferUpdate.set(t,[n])},e.prototype._updateCache=function(t,n,a,i,r){var c=this;o.Validate.isNonemptyString(t,"webPartInstanceId");var d=t,l=new s._QosMonitor(V+"_updateCache"),u="UnknownError",f=this._getCachedItem(d);if(f&&f.hash===i&&f.result===a)return u="NoOp",void l.writeExpectedFailure(u,void 0,this.getWebPartIdLogObject(n,t));try{var p=void 0;this._cacheItemsMap.has(d)?(s._TraceLogger.logVerbose(e._logSource,"Updating Cache Item ".concat(d,".")),u="UpdateCacheItemError",void 0===r&&(r=this._getCachedItem(d).id),p=this._updateRemoteCacheItem(d,a,i,r)):(s._TraceLogger.logVerbose(e._logSource,"Creating Cache Item ".concat(d,".")),u="CreateCacheItemError",p=this._createRemoteCacheItem(d,a,i)),p.then(function(){l.writeSuccess(c.getWebPartIdLogObject(n,t))}).catch(function(a){s._TraceLogger.logError(e._logSource,a,"_updateCache: ".concat(u," WebPart: ").concat(t," Page: ").concat(c._currentPageCacheFolderKey)),l.writeUnexpectedFailure(u,a,c.getWebPartIdLogObject(n,t))})}catch(e){l.writeUnexpectedFailure(u,e,this.getWebPartIdLogObject(n,t))}},e.prototype._tryUpdateCache=function(t,n,a,i,r){try{this._updateCache(t,n,a,i,r)}catch(n){s._TraceLogger.logError(e._logSource,n,"getWebPartData: error while processing item ".concat(t,"."))}},e.prototype._createLocalCacheItemFromServerResponse=function(t){var n=this;o.Validate.isNotNullOrUndefined(t,"response");var a,i=new s._QosMonitor(V+"_createCacheItemInMap"),r="UnknownError";return t.json().then(function(e){var s,c,d,l,u,f,p;o.Validate.isNotNullOrUndefined(e,"data"),o.Validate.isNotNullOrUndefined(e.value,"data.value");var m=N.getDateNowAsUTC();if(r="ResponseParseError",Object.keys(e.value).forEach(function(t){switch(f=e.value[t].FieldName,p=e.value[t].FieldValue,f){case"Id":c=+p;break;case"Title":a=p;break;case"AltTitle":s=p;break;case"HashCode":d=p;break;case"CacheVersion":l=p;break;case"Value":u=p}}),r="CreateCacheItemMapError",!n._cacheItemsMap.has(a)){var _={webPartInstanceId:a,result:u,hash:d,id:c,modified:m,cacheVersion:l};_.cacheVersion===j||_.cacheVersion===B?(_.webPartInstanceId=s,n._cacheItemVersionMap.set(s,_.cacheVersion),n._cacheItemsMap.set(s,_)):(n._cacheItemVersionMap.set(a,_.cacheVersion),n._cacheItemsMap.set(a,_))}return n._logCacheItemSize(),i.writeSuccess(),t}).catch(function(t){return s._TraceLogger.logError(e._logSource,t,"_createCacheItemInMap: error client caching response for WebPart: ".concat(a)),i.writeUnexpectedFailure(r,t),Promise.resolve(void 0)})},e.prototype._getListRelativeFolderPath=function(){o.Validate.isNonemptyString(this._webPartCachePath,"this._webPartCachePath"),o.Validate.isNonemptyString(this._currentPageCacheFolderKey,"this._currentPageCacheFolderKey");var e=N.getUrlLastSegment(this._webPartCachePath);return m.Uri.concatenate(e,this._currentPageCacheFolderKey)},e.prototype._createLocalItems=function(e){var t=this;e.forEach(function(e){if(!t._cacheItemsMap.has(e.CacheKey)){var n={webPartInstanceId:e.CacheKey,result:e.CacheValue,hash:e.CacheValueHash,id:e.ListItemId,modified:e.ModifiedTimeUtc,cacheVersion:e.CacheVersion};t._cacheItemsMap.set(e.CacheKey,n)}}),this._logCacheItemSize()},e.prototype._updateLocalItems=function(e){var t=this;e.forEach(function(e){if(t._cacheItemsMap.has(e.CacheKey)){var n=t._getCachedItem(e.CacheKey);n.result=e.CacheValue,n.hash=e.CacheValueHash,n.cacheVersion=e.CacheVersion}}),this._logCacheItemSize()},e.prototype._logCacheItemSize=function(){s._TraceLogger.logVerbose(e._logSource,"_cacheItemsMap Size: ".concat(this._cacheItemsMap.size,"."))},e.prototype._captureCacheKeyUsageTelemetry=function(e,t){new s._QosMonitor("MySiteWebPartCacheConfigHash").writeSuccess({alias:e,id:this._currentPageCacheFolderKey,instanceId:t})},e.prototype._logCacheStart=function(t,n,a){s._TraceLogger.logVerbose(e._logSource,"WebPart: ".concat(t,", Page: ").concat(this._currentPageCacheFolderKey,", Environment: ").concat(o.Environment.type,".")),s._EngagementLogger.logEvent(a),l._PerformanceLogger.markComponent(n,"CacheStart")},e.prototype._logConfigMismatch=function(t,n,a){n?a||(s._TraceLogger.logVerbose(e._logSource,"Cache config mismatch for ".concat(t)),l._PerformanceLogger.markComponent(t,"CacheMissConfigMismatch")):(s._TraceLogger.logVerbose(e._logSource,"Cached data not found for ".concat(t)),l._PerformanceLogger.markComponent(t,"CachedWebPartNotFound"))},e.prototype._logCacheHit=function(t){this._setLKGOnTimeState(!0,"true"),s._TraceLogger.logVerbose(e._logSource,"CacheHit: Returning cached item for ".concat(t,".")),l._PerformanceLogger.markComponent(t,"CacheHit")},e.prototype._logCacheExpired=function(t){this._setLKGOnTimeState(!0,"stale"),s._TraceLogger.logVerbose(e._logSource,"Requested cached item for ".concat(t," exists but is expired.")),l._PerformanceLogger.markComponent(t,"CacheExpired"),this._logCacheMiss(t)},e.prototype._logCacheMiss=function(t){this._setLKGOnTimeState(!1,"false"),s._TraceLogger.logVerbose(e._logSource,"Cache Miss for ".concat(t)),s._EngagementLogger.logEvent("MySiteWebPartCacheDataProvider.CacheMiss"),l._PerformanceLogger.markComponent(t,"CacheMiss")},e.prototype._logLateFlush=function(t){this._setLKGOnTimeState(!1,"false"),s._TraceLogger.logVerbose(e._logSource,"Racing between late flush and data fetch for ".concat(t)),l._PerformanceLogger.markComponent(t,"LateFlush")},e.prototype._setLKGOnTimeState=function(e,t){void 0===this._cacheOnTime&&(this._cacheOnTime=e,l._PerformanceLogger.setPerformanceProperty("lkgOnTime",t))},e.prototype._logSmartRaceError=function(t){s._TraceLogger.logError(e._logSource,t)},e.prototype._isMySiteCacheSmartRaceRefactorEnabled=function(){return o._SPFlight.isEnabled(1549)},e.prototype._isThrottlingEnabled=function(){return o._SPFlight.isEnabled(1917)},e.prototype._shouldRequestServerDataWhenThrottling=function(e){var t=this._isThrottlingEnabled();return!!(!t||t&&N.isExpired(this._utcTimeStamp,e,86400))},e.prototype._getThrottledServerCall=function(e){var t=this,n=e;return function(){return new Promise(function(e,a){t._async.setTimeout(function(){n().then(function(t){return e(t)}).catch(function(e){return a(e)})},750)})}},e._itemsToDeferUpdate=new Map,e._logSource=s._LogSource.create("MySiteWebPartCacheDataProvider"),e}(),q=function(){function e(e){this._isDisposed=!1,this._mySiteWebPartCacheDataProvider=new W(e),this._serviceScope=e,o._SPEventManager.instance.registerEvent("resetLegacyCacheManager",this,this.initializeCacheProvider)}return e._calculateHash=function(e){return N.generateHash(JSON.stringify(e))},Object.defineProperty(e.prototype,"instanceId",{get:function(){return this._instanceId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"componentId",{get:function(){return"96f08fe4-4e36-4fc2-8d13-f19ac082aedd"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0)},e.prototype.getCacheItemVersion=function(e){return this._mySiteWebPartCacheDataProvider.getCacheItemVersion(e)},e.prototype.initializeCacheProvider=function(e){var t,n;e!==(null===(n=null===(t=window._spWebPartData)||void 0===t?void 0:t.Properties)||void 0===n?void 0:n.PageCacheFolderKey)&&(window._spWebPartData=void 0,window._spWebPartDataLoaded=void 0),this._mySiteWebPartCacheDataProvider=new W(this._serviceScope),s._EngagementLogger.logEvent("MySiteWebPartCacheDataManager.InPageNavTriggered")},e.prototype.requestWebPartCacheData_deprecated=function(e){return this._mySiteWebPartCacheDataProvider.getWebPartData(e.requestData,e.dataUpdated,e.config,e.webPartInstanceId,e.webPartAlias,e.rerender,e.secondsToInvalidate,e.webPartTag)},e.prototype.requestWebPartCacheData=function(e){var t=this,n=new s._QosMonitor("MySiteWebPartCacheDataManager.requestWebPartCacheData");return this._mySiteWebPartCacheDataProvider.getCacheData(e).then(function(a){var i=a.cacheResponseType===d.CacheResponseType.CachedData?"Completed":"Miss",r=a.cacheResponseType===d.CacheResponseType.CachedData?"Waiting":"Completed";return n.writeSuccess(t._mySiteWebPartCacheDataProvider.getWebPartIdLogObject(e.webPartAlias,e.webPartInstanceId,i,r)),a}).catch(function(a){return a.serverResponseAsync.catch(function(a){n.writeUnexpectedFailure("FailedToRetrieveCacheAndServerData",a,t._mySiteWebPartCacheDataProvider.getWebPartIdLogObject(e.webPartAlias,e.webPartInstanceId,"Failed","Failed"))}),a})},e.prototype.getCachedData=function(t,n){return o.Validate.isNotNullOrUndefined(t,"context"),o.Validate.isNotNullOrUndefined(n,"configuration"),this._mySiteWebPartCacheDataProvider._internalAdvancedGetCachedData(t.instanceId,e._calculateHash(n))},e.prototype.setCachedData=function(t,n,a){o.Validate.isNotNullOrUndefined(t,"context"),o.Validate.isNotNullOrUndefined(n,"configuration"),this._mySiteWebPartCacheDataProvider._internalAdvancedSetCacheData(t,e._calculateHash(n),a&&JSON.stringify(a))},e.serviceKey=o.ServiceKey.create("sp-component-utilities:MySiteWebPartCacheManager",e),e}(),Q=function(){function e(){}return e.isMySiteCacheSmartRaceRefactorEnabled=function(){return o._SPFlight.isEnabled(1549)},e.isIDBTieredModelEnabled=function(){return 1===l._SPPerfExperiment.getVariantAndTrackExperiment(l._PerformanceExperiment.WEXUseIndexedDBTieredCachingExp)||o._SPFlight.isEnabled(1693)},e}(),Y={Append:0,Replace:1,Compare:2},J=new d.KillSwitch("4edae48c-3b13-49f4-9d36-ae20f68406f4"),X=function(e){function t(){var n=e.call(this)||this;return n.rendersRequested=0,n.rendersCompleted=0,n.failedRendersCompleted=0,n._getEmphasisTheme=function(){var e=n.context.serviceScope.consume(M.ThemeProvider.serviceKey);n._emphasisTheme=e.tryGetTheme(),e.themeChangedEvent.add(n,n._handleThemeChangedEvent)},n._handleThemeChangedEvent=function(e){n._emphasisTheme=e.theme,n.render()},n._getPrefetchedDataAsync=function(e,a){var i="bcwpGetPrefetchedDataAsync",r=t._getContextLogSource(n.context);return s._TraceLogger.logVerbose(r,"".concat(i,".start")),n.getPrefetchedDataAsync(e,a).then(function(e){return s._TraceLogger.logVerbose(r,"".concat(i,".end")),l._PerformanceLogger.markComponent(n.context.webPartTag,"prefetchedData"),Promise.resolve(e)}).catch(function(e){return s._TraceLogger.logVerbose(r,"".concat(i,".end")),Promise.reject(e)})},n._disableDataRequest=!1,n._isSelectedLayoutLogged=!1,n}return Object(a.__extends)(t,e),t._isOAuthUtilityError=function(e){var t=Object.getPrototypeOf(e);return t.constructor&&"OAuthUtilityError"===t.constructor.name},t._getContextLogSource=function(e){var t=e&&e.webPartTag;return s._LogSource.create(t||"BaseCollectionWebPart")},Object.defineProperty(t.prototype,"component",{get:function(){return this._component},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"response",{get:function(){return this._response},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeLayoutInfo",{get:function(){return this._activeLayoutInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeDataProviderInfo",{get:function(){return this._activeDataProviderInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isContributor",{get:function(){var e=this.context.pageContext.web.permissions;return!!e&&e.hasPermission(T.SPPermission.addListItems)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRenderAsync",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sectionBackgroundTheme",{get:function(){return this._emphasisTheme},enumerable:!1,configurable:!0}),t.prototype.updateActiveLayoutProp=function(e,t){this._activeLayoutInfo.properties[e]=t},t.prototype.onInit=function(){var e=this;this._response=[],this._options=this.options;var n=new l._QosMonitor("".concat(this._options.qosPrefix,"Mount"));return this._shouldUseLegacyMySiteWebPartCache()||o._SPKillSwitch.isActivated("f186df9f-68c1-472c-94fe-d68b47deaa27")||(l._PerformanceLogger.trackWebpartFlight(this.context.webPartTag,l._PerformanceFlight.WEXUseIndexedDBTieredCaching),l._PerformanceLogger.trackWebpartExperiment(this.context.webPartTag,l._PerformanceExperiment.WEXUseIndexedDBTieredCachingExp),l._PerformanceLogger.trackWebpartExperiment(this.context.webPartTag,l._PerformanceExperiment.WEXTieredCachingLateFlushExp)),this._onComponentMounted=this._onComponentMounted.bind(this),this.setDefaultProperties(this.properties),this._layoutInfos=this.layouts,this._setSelectedLayout(),this._setSelectedDataProvider(),this._getDisplayFieldMaps(),this._activeLayoutInfo.hasInitialLoadingState&&this.render(),new Promise(function(a,i){var r=e.context.serviceScope;r.whenFinished(function(){e.pageContext=r.consume(T.PageContext.serviceKey),e._shouldUseLegacyMySiteWebPartCache()&&(e._mySiteCacheWebPartManager=r.consume(q.serviceKey)),e._setPageContextVariables(),e._async=new c.Async(e);var i,o=void 0===e._options.delayBeforeNoResultsMessage?500:e._options.delayBeforeNoResultsMessage;e.delayedGetDataAndRender=e._async.debounce(e.refreshData,o);var u,f=e.getPrefetchedData(e._activeDataProviderInfo.id,e._activeLayoutInfo.id),p=e.context,m=p.instanceId,_=p.manifest,h=p.webPartTag;if(void 0!==f)u="bcwpPrefetchedData",i=new Promise(function(e){return l._PerformanceLogger.markComponent(h,"prefetchedData"),l._PerformanceLogger.markComponent(h,"CacheHit"),e(f)});else if(e._shouldUseLegacyMySiteWebPartCache()){u="bcwpCachedDataRequest";var b=e.dataCacheConfiguration,g={requestData:e.requestData.bind(e),dataUpdated:e.setResponseAndRender.bind(e),webPartInstanceId:m,webPartAlias:_.alias,secondsToInvalidate:void 0};if(Q.isMySiteCacheSmartRaceRefactorEnabled()){var v="BaseCollection_".concat(h);l._PerformanceLogger.markComponent(v,"LKGRequest");var y=g;y.serializedConfiguration=JSON.stringify(b),i=e._mySiteCacheWebPartManager.requestWebPartCacheData(y).then(function(t){return e._isResponseFromCache=t.cacheResponseType===d.CacheResponseType.CachedData,J.isActivated()?t.cacheResponseAsync||t.serverResponseAsync:(t.cacheResponseAsync||t.serverResponseAsync).then(function(t){var n=new s._LogEntry("MySiteCacheDataMetrics","CacheDataSize",s._LogType.Event,{dataSizeInKB:t?"".concat(JSON.stringify(t).length/1024):"0",dataProvider:e._activeDataProviderInfo.id,isCacheHit:"".concat(e._isResponseFromCache),numberOfItems:t?"".concat(t.length):"0"});return s._EngagementLogger.logEventWithLogEntry(n),t})}).then(function(e){return l._PerformanceLogger.markComponent(v,"DataReturned"),e})}else{var S=g;S.config=b,S.webPartTag=h,i=e._mySiteCacheWebPartManager.requestWebPartCacheData_deprecated(S)}}else u="bcwpRacePrefetchedDataAsync",e._shouldUseLegacyMySiteWebPartCache()&&(l._PerformanceLogger.markComponent(h,"CacheMiss"),l._PerformanceLogger.markComponent(h,"LateFlush")),i=Promise.race([e._getPrefetchedDataAsync(e._activeDataProviderInfo.id,e._activeLayoutInfo.id),e.requestData()]);var D=t._getContextLogSource(e.context);u&&s._TraceLogger.logVerbose(D,"".concat(u,".start")),i.then(function(t){e._shouldUseLegacyMySiteWebPartCache()&&"2.0"===e._mySiteCacheWebPartManager.getCacheItemVersion(e.context.instanceId)&&(t=e.postProcessTieredCachedData(t)),e._response=t,u&&s._TraceLogger.logVerbose(D,"".concat(u,".end")),e.renderedOnce||n.writeSuccess(),a()}).catch(function(t){e._handleRequestDataError(t),u&&s._TraceLogger.logError(D,t,"".concat(u,".end")),n.writeUnexpectedFailure("FailedInitialDataRequest",t),a()})})}).then(function(){return e._getEmphasisTheme()})},t.prototype.postProcessTieredCachedData=function(e){return e},t.prototype.setLayoutById=function(e){this.properties.layoutId=e,this._setSelectedLayout()},t.prototype.setLayoutByKey=function(e){for(var t=0,n=this._layoutInfos;t<n.length;t++){var a=n[t];if(a.option&&a.option.key===e){this.setLayoutById(a.id);break}}},t.prototype.getPrefetchedData=function(e,t){},t.prototype.getPrefetchedDataAsync=function(e,t){return new Promise(function(e,t){})},Object.defineProperty(t.prototype,"dataProvider",{get:function(){this._dataProviderPromises||(this._dataProviderPromises=new Map);var e=this._dataProviderPromises.get(this._activeDataProviderInfo.id);return e||(e=this._activeDataProviderInfo.loadDataProvider(this._activeDataProviderInfo.options||{serviceScope:this.context.serviceScope,qosPrefix:this._options.qosPrefix}),this._dataProviderPromises.set(this.activeDataProviderInfo.id,e)),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"usingEmptyStateRows",{get:function(){return this._usingEmptyStateRows},enumerable:!1,configurable:!0}),t.prototype.onAfterPropertiesUpdatedExternally=function(e){var t=this,n=e.title,i=e.layoutId,r=e.hideWebPartWhenEmpty,o=e.addToPageScreenReaderLabel,s=Object(a.__rest)(e,["title","layoutId","hideWebPartWhenEmpty","addToPageScreenReaderLabel"]),c=this.properties,d=c.title,f=c.layoutId,p=c.hideWebPartWhenEmpty,m=c.addToPageScreenReaderLabel,_=Object(a.__rest)(c,["title","layoutId","hideWebPartWhenEmpty","addToPageScreenReaderLabel"]),h=u.isEqual(s,_)&&(n!==d||i!==f||r!==p||o!==m);if(i!==f&&this._setSelectedLayout(),h)this.render();else if(e.dataProviderId!==this.properties.dataProviderId&&this.setDataProviderById(this.properties.dataProviderId),!u.isEqual(s,_)){var b=new l._QosMonitor("BaseCollectionWebPart.onAfterPropertiesUpdatedExternally");this.refreshData().then(function(e){var n={alias:"".concat(t.context.manifest.alias)};e?b.writeSuccess(n):b.writeUnexpectedFailure("Failed to refreshData",void 0,n)})}},t.prototype.setDataProviderById=function(e){this.properties.dataProviderId=e,this._setSelectedDataProvider()},t.prototype.setDataProviderByKey=function(e){for(var t=0,n=this.dataProviders;t<n.length;t++){var a=n[t];if(a.option&&a.option.key===e){this.setDataProviderById(a.id);break}}},t.prototype.getDisplayFieldMap=function(e,t){},Object.defineProperty(t.prototype,"propertyPaneLayoutOptions",{get:function(){return this._layoutInfos.map(function(e){var t=e.option;return{ariaLabel:t.ariaLabel,imageSize:{width:32,height:32},imageSrc:t.imageSrc,key:t.key,text:t.title,themableSvg:t.themableSvg,iconProps:t.iconProps}})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCacheConfiguration",{get:function(){return{}},enumerable:!1,configurable:!0}),t.prototype.refreshData=function(e,t,n){var a=this;return void 0===t&&(t=Y.Replace),void 0===n&&(n=!0),this.requestData(e).then(function(e){var i;switch(t){case Y.Append:i=a._response=a._response.concat(e);break;case Y.Compare:i=e;break;case Y.Replace:default:i=a._response=e}return n&&a.render(),i}).catch(function(e){a._handleRequestDataError(e)})},t.prototype.transposeRow=function(e,t,n){return n},t.prototype.transposeItems=function(e,t,n){return n},t.prototype.render=function(){var e=this,t=new l._QosMonitor("".concat(this._options.qosPrefix,"Render")),n={alias:this._options.qosPrefix};if(!this._activeLayoutInfo){var s=new Error(L.o);return this._handleRenderLayoutError(s),t.writeUnexpectedFailure("FailedNoLayout",s,n),void this.renderCompleted()}n.layout=this._activeLayoutInfo.id,this.rendersRequested++,this.onPreRender(this._activeLayoutInfo.id,this._activeDataProviderInfo.id,this._response).then(function(s){var d;s&&(e._options=Object(a.__assign)(Object(a.__assign)({},e._options),s));var u=e.context.webPartTag;l._PerformanceLogger.markComponent(u,"".concat(l._PerformanceDataDimensions.Layout).concat(e.activeLayoutInfo.id));var f=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},e._options),e.properties),(null===(d=e._activeLayoutInfo)||void 0===d?void 0:d.properties)||{});if(f.webPartTag=u,f.emphasisTheme=e._emphasisTheme,f.emphasisTheme||(f.emphasisTheme=Object(c.getTheme)()),Q.isMySiteCacheSmartRaceRefactorEnabled()&&(f.isRenderedFromCacheData=e._isResponseFromCache),f.isInTeamsContext=!!e.context.sdks.microsoftTeams,f.hasInitialLoadingState=e._activeLayoutInfo.hasInitialLoadingState,f.displayMode=e.displayMode,f.errorCallback=e._handleRenderLayoutError.bind(e),f.renderedOnce=e.renderedOnce,f.defaultTitle=e.defaultTitle,f.layoutInfo=e._activeLayoutInfo,f.width=e.width,f.registerEvent=function(t,n){return o._SPEventManager.instance.registerEvent(t,e,n)},f.unregisterEvent=function(t,n){return o._SPEventManager.instance.unregisterEvent(t,e,n)},e._activeLayoutInfo.displayFieldMaps&&(f.displayFieldMap=e._activeLayoutInfo.displayFieldMaps[e._activeDataProviderInfo.id]),f.items=void 0,f.onComponentMounted=e._onComponentMounted,f.onTitleChange=function(t){return e.properties.title=t},f.changeVisibility=function(t){return e.isVisible=t},e._activeLayoutInfo.displayFieldMaps&&e._activeDataProviderInfo){var p=e._activeLayoutInfo.displayFieldMaps[e._activeDataProviderInfo.id];p&&(f.displayFieldMap=p,e._response?f.items=p.transpose(e._response,function(t){return e.transposeRow(e._activeLayoutInfo.id,e._activeDataProviderInfo.id,t)}):f.items=[])}f.items||(e._response?f.items=e._response.map(function(t){return e.transposeRow(e._activeLayoutInfo.id,e._activeDataProviderInfo.id,t)}):f.items=[]),f.items=e.transposeItems(e._activeLayoutInfo.id,e._activeDataProviderInfo.id,f.items);try{var m=i.createElement(k,f);e._component=r.render(m,e.domElement),e.renderedOnce||!e._component||e.renderedFromPersistedData||e._component.focusOnTitle(),e.onPostRender(e._activeLayoutInfo.id,e._activeDataProviderInfo.id,e._response).then(function(){t.writeSuccess(n)}).catch(function(e){t.writeUnexpectedFailure("FailedPostRender",e,n)})}catch(a){n.stack=a.stack,t.writeUnexpectedFailure("FailedRender",a,n),e.failedRendersCompleted++}e.rendersCompleted++,E.exclusiveRenderTimeForBaseCollectionWebPart.isActivated()||l._PerformanceLogger.saveTempData("".concat(u,".postRenderComplete"),l._PerformanceLogger.now())}).catch(function(a){e._handleRenderLayoutError(a),t.writeUnexpectedFailure("FailedPreRender",a,n),e.renderCompleted()})},t.prototype.onPreRender=function(e,t,n){return Promise.resolve(void 0)},t.prototype.onPostRender=function(e,t,n){return Promise.resolve(void 0)},t.prototype.onBeforeSerialize=function(){this.properties.title&&(this.properties.title=this.properties.title.trim())},t.prototype.onDispose=function(){r.unmountComponentAtNode(this.domElement),this.context.serviceScope.consume(M.ThemeProvider.serviceKey).themeChangedEvent.remove(this,this._handleThemeChangedEvent),e.prototype.onDispose.call(this)},Object.defineProperty(t.prototype,"propertiesMetadata",{get:function(){return{title:{isSearchablePlainText:!0},baseUrl:{isLink:!0},layoutComponentId:{isComponentDependency:!0}}},enumerable:!1,configurable:!0}),t.prototype.onDiscard=function(){var e=this;this.refreshData().catch(function(n){return s._TraceLogger.logError(t._getContextLogSource(e.context),n,"RefreshData")})},t.prototype.setDefaultProperties=function(e){},Object.defineProperty(t.prototype,"defaultTitle",{get:function(){return L.c},enumerable:!1,configurable:!0}),t.prototype.getEmptyStateRows=function(e,t){},t.prototype.setResponse=function(e){this._response=e},t.prototype.setResponseAndRender=function(e){Q.isMySiteCacheSmartRaceRefactorEnabled()&&(this._isResponseFromCache=!1),this._response=e,this.render()},t.prototype.requestData=function(e){var n=this,a=this.context.webPartTag,i=t._getContextLogSource(this.context);return this._disableDataRequest||s._TraceLogger.logVerbose(i,"".concat("bcwpRequestData",".start")),new Promise(function(r,o){if(n._disableDataRequest)return s._TraceLogger.logVerbose(i,"".concat("bcwpRequestData",".end")),void r([]);if(n._activeDataProviderInfo){var c=new l._QosMonitor("".concat(n._options.qosPrefix,"RequestData"));s._TraceLogger.logVerbose(i,"".concat("bcwpDataProvider",".start")),n.dataProvider.then(function(d){l._PerformanceLogger.markComponent(a,"".concat(l._PerformanceDataDimensions.DataProvider).concat(d.id)),s._TraceLogger.logVerbose(i,"".concat("bcwpDataProvider",".end")),e=e||n.getRequest(n._activeDataProviderInfo.id,n._activeLayoutInfo.id),d.requestData(e).then(function(e){if(n._usingEmptyStateRows=!1,!e||0===e.length){n._usingEmptyStateRows=!0;var t=n.getEmptyStateRows(n._activeLayoutInfo.id,d.id);t&&(e=t)}r(e),s._TraceLogger.logVerbose(i,"".concat("bcwpRequestData",".end")),c.writeSuccess()},function(e){n.context.statusRenderer.clearLoadingIndicator(n.domElement),s._TraceLogger.logVerbose(i,"".concat("bcwpRequestData",".end")),c.writeUnexpectedFailure("FailedDataRequest",e),t._isOAuthUtilityError(e)&&n.canHandleOAuthError(e)?(n.render(),r(void 0)):o(e)})},function(e){l._PerformanceLogger.markComponent(a,"".concat("bcwpDataProvider",".end")),c.writeUnexpectedFailure("FailedToLoadDataProvider",e),o(e)})}else s._TraceLogger.logVerbose(i,"".concat("bcwpRequestData",".end")),o(new Error(L.r))})},t.prototype.disableDataRequest=function(){this._disableDataRequest=!0},t.prototype.enableDataRequest=function(){this._disableDataRequest=!1},t.prototype.canHandleOAuthError=function(e){return!1},t.prototype.canHandleWebpartError=function(e){return!1},t.prototype.onPropertyPaneConfigurationComplete=function(){e.prototype.onPropertyPaneConfigurationComplete.call(this),this.properties.layoutId&&this._addBCWPSelectedLayoutEngagementLog(this.properties.layoutId)},t.prototype._handleRenderLayoutError=function(t){this.canHandleWebpartError(t)||e.prototype.renderError.call(this,t)},t.prototype._handleRequestDataError=function(e){t._isOAuthUtilityError(e)&&this.canHandleOAuthError(e)?this.render():this.renderError(e)},t.prototype._setPageContextVariables=function(){if(this._options.requirePageContextVariables){if(!this.pageContext)throw new Error(L.e);if(!this.pageContext.web)throw new Error(L.a);if(this.pageContext.web.absoluteUrl){if(!this.pageContext.web.id)throw new Error(L.i);if(this.properties.webId=this.pageContext.web.id.toString(),!this.pageContext.site)throw new Error(L.t);if(!this.pageContext.site.id)throw new Error(L.n);this.properties.siteId=this.pageContext.site.id.toString(),this.properties.baseUrl=this.pageContext.web.absoluteUrl}else this.properties.webId="a50ff2b3-f789-4251-aad1-5909f23aed4f",this.properties.baseUrl="https://msft.spoppe.com/sites/wex"}},t.prototype._setSelectedLayout=function(){!this.properties.layoutId&&this._layoutInfos.length>0&&(this.properties.layoutId=this._layoutInfos[0].id,this.properties.layoutComponentId=this._layoutInfos[0].componentId);var e=this.properties.layoutId;if(e)for(var t=0,n=this._layoutInfos;t<n.length;t++){var a=n[t];if(a.id===e){this._activeLayoutInfo=a,this.properties.layoutComponentId=this._activeLayoutInfo.componentId;break}}},t.prototype._addBCWPSelectedLayoutEngagementLog=function(e){if(!this._isSelectedLayoutLogged){var t={component:"BaseWPSelectedLayout",extraData:{layoutId:e},feature:"WebPart",name:"".concat(this.context.manifest.alias,".BCWPSelectedLayout")};s._EngagementLogger.log(t),this._isSelectedLayoutLogged=!0}},t.prototype._setSelectedDataProvider=function(){if(!this.properties.dataProviderId&&this.dataProviders.length>0&&(this.properties.dataProviderId=this.dataProviders[0].id,this.properties.dataProviderComponentId=this.dataProviders[0].componentId),this.properties.dataProviderId)for(var e=0,t=this.dataProviders;e<t.length;e++){var n=t[e];if((null==n?void 0:n.id)===this.properties.dataProviderId){this._activeDataProviderInfo=n;break}}},t.prototype._getDisplayFieldMaps=function(){var e=this;this._layoutInfos.map(function(t){t.displayFieldMaps||(t.displayFieldMaps={}),e.dataProviders.map(function(n){n&&(t.displayFieldMaps[n.id]=e.getDisplayFieldMap(t.id,n.id))})})},t.prototype._onComponentMounted=function(){this.options.isRenderAsync||this.renderCompleted()},t.prototype._shouldUseLegacyMySiteWebPartCache=function(){return this._options.deprecated_canCacheResults&&!this._options.temporary_isTieredCacheImplementedInDataProvider},t}(P.BaseClientSideWebPart),Z=function(){function e(){}return e.getCustomerPromiseBaseEndSchema=function(e,t,n){var i=!!n&&!n.hit,r=!!t&&!t.hit,o=!!e&&!e.apiSuccess,s={resultType:(r||i)&&o?m.ResultTypeEnum.Failure:m.ResultTypeEnum.Success,extraData:{}};return(i||r||o)&&(s.errorCode=""),i&&(s.errorCode+="PREFETCH_FAILED--",s.extraData=Object(a.__assign)(Object(a.__assign)({},s.extraData),{prefetchError:"Prefetch Error: ".concat(n.failedReason)})),r&&(s.errorCode+="LKG_FAILED--",s.extraData=Object(a.__assign)(Object(a.__assign)({},s.extraData),{lkgError:"LKG Error: ".concat(t.failedReason)})),o&&(s.errorCode+="API-FAILED",s.extraData=Object(a.__assign)(Object(a.__assign)({},s.extraData),{apiError:"API Error: ".concat(e.apiFailedReason)})),s},e.updateCustomerPromiseStatus=function(e,t,n){return t&&(e.didRenderFromServer=t),n&&(e.didRenderFromCache=n),e},e.updateCustomerPromiseLKGStatus=function(e,t,n){return n?(e.hit=!1,e.failedReason=n&&n.message):(e.hit=!0,e.emptyData=t),e},e.updateCustomerDataProviderStatus=function(e,t,n,a){return e.dataSource=t,a?(e.apiSuccess=!1,e.apiFailedReason=a&&a.message):(e.apiSuccess=!0,e.emptyData=n),e},e}(),$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t}(function(e){function t(t){var n=e.call(this,t)||this;return n._cacheManager=t.serviceScope.consume(q.serviceKey),n}return Object(a.__extends)(t,e),t.prototype.requestData=function(e){return o.Validate.isNotNullOrUndefined(e,"request"),o.Validate.isNotNullOrUndefined(e.fetchData,"request.fetchData"),o.Validate.isNotNullOrUndefined(e.dataReceived,"request.dataReceived"),o.Validate.isNonemptyString(e.cacheKey,"request.cacheKey"),o.Validate.isNonemptyString(e.alias,"request.alias"),this._cacheManager.requestWebPartCacheData_deprecated({requestData:e.fetchData,dataUpdated:e.dataReceived,config:e.cacheParameters,webPartInstanceId:e.cacheKey,webPartAlias:e.alias,webPartTag:e.alias})},t}(function(e){o.Validate.isNotNullOrUndefined(e,"configuration"),o.Validate.isNotNullOrUndefined(e.serviceScope,"configuration.serviceScope"),this.configuration=e})),ee=$,te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._internalDataReceived=function(e){t.dataReceived({data:e,metadata:{}})},t}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"dataProviderConfiguration",{get:function(){return{serviceScope:this.context.serviceScope}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataProvider",{get:function(){return this._dataProvider||(this._dataProvider=new ee(this.dataProviderConfiguration)),this._dataProvider},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cacheKey",{get:function(){return this.context.instanceId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alias",{get:function(){return this.context.manifest.alias},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cacheParameters",{get:function(){return this.properties},enumerable:!1,configurable:!0}),t.prototype._internalGetData=function(){var e={fetchData:this.fetchData,dataReceived:this._internalDataReceived,cacheKey:this.cacheKey,alias:this.alias,cacheParameters:this.cacheParameters,webPartTag:this.context&&this.context.webPartTag};return this.dataProvider.requestData(e).then(function(t){e.dataReceived({data:t,metadata:{}})})},t}(P.BaseClientSideWebPart),ne=n("Ycni");function ae(e,t){return!(!e||!t)&&e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}h.loadStyles('.a_a_658c9e0a{font-weight:400;border:1px solid;color:"[theme:neutralPrimary, default: #323130]";display:flex;flex-direction:column;align-items:center;text-align:center}.a_a_658c9e0a.b_a_658c9e0a{height:62px;width:62px}.a_a_658c9e0a.c_a_658c9e0a{height:80px;width:80px}.a_a_658c9e0a.e_a_658c9e0a{height:104px;width:104px}.a_a_658c9e0a.f_a_658c9e0a{justify-content:center}.a_a_658c9e0a.g_a_658c9e0a{justify-content:space-between}.b_a_658c9e0a .h_a_658c9e0a:not(.i_a_658c9e0a){font-size:12px;font-weight:400}.c_a_658c9e0a .h_a_658c9e0a:not(.i_a_658c9e0a){font-size:15px;font-weight:400}.e_a_658c9e0a .h_a_658c9e0a:not(.i_a_658c9e0a){font-size:21px;font-weight:100}.b_a_658c9e0a .h_a_658c9e0a.i_a_658c9e0a{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]";font-weight:600}.c_a_658c9e0a .h_a_658c9e0a.i_a_658c9e0a{font-size:"[theme:mediumFontSize, default: 14px]";font-weight:"[theme:mediumFontWeight, default: 400]";font-weight:600}.e_a_658c9e0a .h_a_658c9e0a.i_a_658c9e0a{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]";font-weight:600}.j_a_658c9e0a{font-weight:600}.b_a_658c9e0a .j_a_658c9e0a:not(.i_a_658c9e0a){font-size:21px}.e_a_658c9e0a .j_a_658c9e0a:not(.i_a_658c9e0a),.c_a_658c9e0a .j_a_658c9e0a:not(.i_a_658c9e0a){font-size:28px}.b_a_658c9e0a .j_a_658c9e0a.i_a_658c9e0a{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}.e_a_658c9e0a .j_a_658c9e0a.i_a_658c9e0a,.c_a_658c9e0a .j_a_658c9e0a.i_a_658c9e0a{font-size:"[theme:xxLargeFontSize, default: 28px]";font-weight:"[theme:xxLargeFontWeight, default: 600]"}.k_a_658c9e0a{flex-grow:1;display:flex;flex-direction:column;justify-content:center}.b_a_658c9e0a .k_a_658c9e0a:not(.i_a_658c9e0a){font-size:10px;font-weight:600}.c_a_658c9e0a .k_a_658c9e0a:not(.i_a_658c9e0a){font-size:12px;font-weight:400}.e_a_658c9e0a .k_a_658c9e0a:not(.i_a_658c9e0a){font-size:15px;font-weight:400}.b_a_658c9e0a .k_a_658c9e0a.i_a_658c9e0a{font-size:"[theme:xSmallFontSize, default: 10px]";font-weight:"[theme:xSmallFontWeight, default: 400]";font-weight:600}.c_a_658c9e0a .k_a_658c9e0a.i_a_658c9e0a{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]";font-weight:600}.e_a_658c9e0a .k_a_658c9e0a.i_a_658c9e0a{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]";font-weight:600}.l_a_658c9e0a{margin:0;border:0;border-bottom:1px solid}.b_a_658c9e0a .l_a_658c9e0a{width:31px}.c_a_658c9e0a .l_a_658c9e0a{width:40px}.e_a_658c9e0a .l_a_658c9e0a{width:52px}',!0);var ie="a_a_658c9e0a",re="i_a_658c9e0a",oe="k_a_658c9e0a",se=n("EpOV"),ce={Small:0,Medium:1,Large:2},de={0:"b_a_658c9e0a",1:"c_a_658c9e0a",2:"e_a_658c9e0a"},le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.startDate,n=e.endDate;return this._sizeClassName=u.get(de,this.props.size),t&&n&&!ae(t,n)?this._multipleDaysDateBoxElement:this._singleDayDateBoxElement},Object.defineProperty(t.prototype,"_singleDayDateBoxElement",{get:function(){var e=this.props,t=e.startDate,n=e.endDate,a=e.formatMonth,r=e.formatDay,o=t||n,s=o?a(o):se.e,d=o?r(o):"01";return i.createElement("div",{className:Object(c.css)(ie,"f_a_658c9e0a",this._sizeClassName,this.props.className),"data-automation-id":"singleDayBox"},i.createElement("div",{className:Object(c.css)("h_a_658c9e0a",re),"data-automation-id":"singleDayMonthContainer"},s),i.createElement("div",{className:Object(c.css)("j_a_658c9e0a",re),"data-automation-id":"singleDayDayContainer"},d))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_multipleDaysDateBoxElement",{get:function(){var e=this.props,t=e.startDate,n=e.endDate,a=e.formatDate;return i.createElement("div",{className:Object(c.css)(ie,"g_a_658c9e0a",this._sizeClassName,this.props.className),"data-automation-id":"multipleDayBox"},i.createElement("div",{className:Object(c.css)(oe,re),"data-automation-id":"multipleDayStartDateContainer"},a(t)),i.createElement("hr",{className:"l_a_658c9e0a"}),i.createElement("div",{className:Object(c.css)(oe,re),"data-automation-id":"multipleDayEndDateContainer"},a(n)))},enumerable:!1,configurable:!0}),t.defaultProps={formatDate:function(e){return ne.LocaleFormat.formatDate(e,{skeleton:"MMMd"}).toUpperCase()},formatMonth:function(e){return ne.LocaleFormat.formatDate(e,{skeleton:"MMM"}).toUpperCase()},formatDay:function(e){return ne.LocaleFormat.formatDate(e,{skeleton:"d"})}},t}(i.PureComponent),ue=le,fe=n("GrTz"),pe=36e5;function me(e,t){return t||(e=-e),new Date(Date.now()+e)}function _e(e){var t=e.split("|");if("0"===t[0])return t[1];var n="1"===t[1],a=t[2],i=t.length>=4?t[3]:void 0,r=Number(i),s=t.length>=5?t[4]:void 0;switch(a){case"1":return ne.LocaleFormat.formatRelativeTimeApproximate(me(1e3,n));case"2":return ne.LocaleFormat.formatRelativeTimeApproximate(me(6e4,n));case"3":return ne.LocaleFormat.formatRelativeTime(n?r:-r,"minute");case"4":return ne.LocaleFormat.formatRelativeTimeApproximate(me(pe,n));case"5":var c=ne.LocaleFormat.formatRelativeTime(n?1:-1,"day");return i?o.Text.format(fe.e,c,i):c;case"6":return ne.LocaleFormat.formatRelativeTimeApproximate(me(r*pe,n));case"7":return s?o.Text.format(fe.e,i,s):i;case"8":return ne.LocaleFormat.formatRelativeTime(n?r:-r,"day");case"9":return ne.LocaleFormat.formatRelativeTime(0,"day")}}var he=function(){function e(e,t,n){this._target=e,this._displayField=t,this._onRenderCell=n}return Object.defineProperty(e.prototype,"target",{get:function(){return this._target},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sources",{get:function(){return this._displayField.sources||[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linkUrls",{get:function(){return this._displayField.linkUrls||[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heading",{get:function(){return this._displayField.heading||""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return void 0===this._displayField.width||null===this._displayField.width?100:this._displayField.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRenderCell",{get:function(){return this._onRenderCell},enumerable:!1,configurable:!0}),e}(),be=function(e){function t(t,n,a,i){var r=e.call(this,t,n,i)||this;return r._formatter=a,r}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"formatter",{get:function(){return this._formatter},enumerable:!1,configurable:!0}),t}(he),ge="_linkUrl",ve=function(){function e(e){this._map=e}return e.prototype.fieldValue=function(e,t){return e instanceof be?e.formatter(t):this._firstIdentifiedValue(t,e.sources)},e.prototype.fieldLinkUrl=function(e,t){return this._firstIdentifiedValue(t,e.linkUrls)},e.prototype.transposeRow=function(e,t){if(!e)return e;var n=t?t(e):e,a={};if(this._map)for(var i=0;i<this._map.length;i++){var r=this._map[i];a[r.target]=this.fieldValue(r,n),r.linkUrls&&(a[r.target+ge]=this.fieldLinkUrl(r,n))}return a},e.prototype.transpose=function(e,t){for(var n=[],a=0;a<e.length;a++)n[a]=this.transposeRow(e[a],t);return n},Object.defineProperty(e.prototype,"map",{get:function(){return this._map},enumerable:!1,configurable:!0}),e.prototype._firstIdentifiedValue=function(e,t){for(var n=0;n<t.length;n++){var a=t[n],i=e[a];if(null!=i&&""!==i)return e[a]}},e}(),ye=function(){function e(){}return e.prototype.getClassNames=function(e,t){return void 0===t&&(t=!0),!t&&this._cachedClassNames||(this._cachedClassNames=Object(c.classNamesFunction)()(this.getStyles,e)),this._cachedClassNames},e}();function Se(){return o._SPFlight.isEnabled(1248)}function De(e){"aspx"===(d.ExtensionHelper.getExtension(new m.Uri(e))||"")||o._BrowserUtilities.isTeamsHosted()?postMessage("router://".concat(e),location.origin):window.open(e,Ie(e))}function Ie(e){return xe(e)?"_blank":"_self"}function xe(e){if(!e)return!1;var t=new m.Uri(e).getHost();return Boolean(t)&&t.toLocaleLowerCase()!==window.location.host.toLowerCase()}var Ce=n("8dK2");function Oe(e){var t=e.pageContext,n=e.url,a=e.siteId,i=e.webId,r=e.uniqueId,s=e.callerId,c=e.originalWidth,l=e.originalHeight;if(n&&0!==n.indexOf("/_LAYOUTS/IMAGES/")){var u=new Ce._SPResourcePath(n),f=Ce._PreviewUtility.getFileExtension(u)||"";if(d.PreviewHelper.hasThumbnailOrFileTypeSupportsPreview(f,void 0)||"gif"===f){var p,_=Ce._ThumbnailUrlGenerator.getThumbnailProvider(n);switch(_){case Ce._ThumbnailProviderType.SPOLayoutsImage:p=n;break;case Ce._ThumbnailProviderType.PrivateCDN:case Ce._ThumbnailProviderType.AFDPrivateCDN:case Ce._ThumbnailProviderType.MeTA:case Ce._ThumbnailProviderType.Stock:case Ce._ThumbnailProviderType.VROOMMeTACache:return;case Ce._ThumbnailProviderType.HubbleStockThumbnail:case Ce._ThumbnailProviderType.HubbleStock:p=n;break;case Ce._ThumbnailProviderType.PublicCDN:case Ce._ThumbnailProviderType.MediaCDNHubble:p=Ce._ThumbnailUrlGenerator.updateThumbnailWidth(n,400)}if((null==p?void 0:p.length)<=255)return p;var h,b=t&&t.web.absoluteUrl||window.location.href,g=new m.Uri(b),v=g.getLeftPart(1),y=!!(a&&i&&r),S=!(t&&t.web&&t.web.serverRelativeUrl&&n)||-1===n.toUpperCase().indexOf(t.web.serverRelativeUrl.toUpperCase()),D=o._SPFlight.isEnabled(60134)||!y,I=!o._SPKillSwitch.isActivated("18c2cbec-1b16-45f3-aee7-361d33abb17c");if(I&&n&&(_===Ce._ThumbnailProviderType.SharePointHost||_===Ce._ThumbnailProviderType.MySite||u.isInternalResource(t))&&(D?(y=!0,u.format===Ce._SPResourcePathFormat.absolute?(v=u.authority,h=u.path):h=n):u.format===Ce._SPResourcePathFormat.absolute&&(v=u.authority)),!I&&D&&n&&!S){var x=we(n,v,S,t),C=new m.Uri(x);C.getHost().toUpperCase()===g.getHost().toUpperCase()&&(y=!!(h=C.getPath()))}return y&&(p=d.PreviewHelper.getPreviewImageUrl(f,void 0,v,h,a,i,r,void 0,!0,s,c,l))&&p.length<=255||(p=we(n,v,S,t)).length<=255?p:void 0}}}function we(e,t,n,a){var i=a&&a.web.absoluteUrl,r=""!==new m.Uri(e).getHost(),o=n?t:i,s=n?e:e.substr(a.web.serverRelativeUrl.length);return r?e:m.Uri.concatenate(o,s)}var Ee=n("tGpx"),Ae=new Set(["03590920bdfd864322cf7e8cca891bb4","0381c1bcfc0b809623b805e322dd9fa1","03d374b16722d252588fa2d58a3e828d","0540187fe91e3b78e3b5d06999eebf80","083313c7a8083e625c0def330dbd7cdd","0974242efa7f7b9bb52240ee615b931b","0bbb13911b2ce26da17bbdf2ea3404b6","0d827eba349aa0591be57331540fc4f4","0e47add0cdf9530b9e30ddef0c489a40","0f78c3aa1a3da070d8f62bb9a2ee76ae","0fe8fe2f5220263be4cbd5f61d9cf23c","178a70df6ddfa637e3d4f0ea9a80fbdd","1a960363e8daa165d3b82144b0d68c03","1e033e719ef573ec796c38bf8ac41dfc","1f420b466365299439abf6fe2f8bff6a","20f0b5fb7de21fa889b002714ec58f20","2149d6090d915f849f5c33c07545fb03","23d161d98611bae938697c4d0af3bfd4","241b2579d59d10255b2e405fbcbb9117","26736ef07954f237039d261c357f06e5","279ec9ccb88c02985b4e1f645b755faf","2d523e15f73a2b345887c8b8299c8d3c","2fce211aefcaec7742455aa616edfa32","2f73a4291c58a29acc783b73fa88c282","3178a5744ef0cd2b61757583d7b7ccf1","319f83a0e835d32ce2660a4de654a7c0","3a9c8d1a8fae79004ed36c0147bdd71b","3fa3e0b2e84cb77f00799dca10f1a03e","4a48f26592f4e1498d7a478a4c48609c","41ebba55d20ff0a87734a09d88dc8f27","4312d1e9ec65cb2412e83a64f50fcdd1","44f2e736a8f04d1b47a1151eb37e0a64","48e8c755618be2d66c67976910bac81f","49fe29d48bd08304cb7a9be0a4256b8a","5b60516651aebbbc796eafdee967ef2c","613c9c11d6bfdec3dd2a568412b79762","62fe9bb236110e4553483b02e1989986","68df1aaa4d4d20f6749dcf0cbcbfd182","6c06b3944a82b194dd56b848d5c1e53f","6fe016add870f202c0a30c70ee943c73","7024c1dc5ed913c848ac81adadfedee4","7ad602295f8386b7615b582d87bcc294","7f25de15c2e701c901252f81c1911af2","8193ab3946149e9175a3c3d44219e9e1","8a2bceaca7e84b8f4da535d772625c6f","8a430e2d85dc31b60c0c6f68d7cc4c20","8b02cb6c9f9d7a7e895970d94317e20a","8ddba906d9614422695d3c9756afee7f","8f296bb8aac7be4f08409d8dbbbc8714","9029ea4d3ee7796fe043710dfff1d218","90ac8c284c2ac3a6f6b7e6518dbb6227","965331b9e159f7e263f86866902241e8","98f88501895b89e844d24793dadc8a9f","9a85f4ab720503d37748e2d854a238dc","9aae9266066558e0e42223ed4d82b1f8","a284f85a5a3096a5e90f670316993365","a3f3c88a874da09d43c8f88deb9246b6","ab08afa407a9c009513a07525fadf367","ba3cc3f8be4b187472e2f5f7d5376bb9","b3b9212834745aa4457f459f12e56653","b8a930a9d063513ea9bba50a34aaaba5","b8f6d5994ef9e9a96180ea43dbb00ed6","baa367f8c4aef7abdcb912c61f53ed10","bc4fab3f78291f699922e57650be557f","c065f1d4e77c3678be1ff6aa835dda69","c4ae58fb4e94e08cfff98beddeb615ac","c63681d72227d0813a5cdfccb62be638","c903233a37600953361096a5c28d0d46","c9dc379c327bef6f8db124f5f013fe22","cbcecad0b1eb14fe8186c566f22b0fa1","cd26d43c2fabf764bfc054d06462f64f","cd849e71a1785cc1f046b181e68bbec3","d283507fbbeb97715a321ddbd2442164","d6c8114c17555266c90ad015c2acd8b9","dacd2fb8ace0a4176a74a228539b3d33","e6ede0691f3312bd6fd9f1066153a868","e72abfe847c8792f99bc8b2cbeb65886","ea754dbc9eba7d06ae4b444f722c24df","f0d90ca687e974534dfc12798166c7e6","ffb18190d6e56748b5d6d743ff7421ad"]),Le="DoughboyDetector",ke="CDNUserPhoto",Me="AFDCDNUserPhoto",Pe=function(e){function t(n){var a=e.call(this,n)||this;a._unmounted=!1,a._completeDetection=function(){a.props.onDetectCompleted&&a.props.onDetectCompleted()},a.revokeBlobUrl=function(){a._blobUrl&&(URL.revokeObjectURL(a._blobUrl),a._blobUrl=void 0)},a._logSource=s._LogSource.create("DoughboyDetector");var i=t._imageDataCache.get(n.imageUrl);return a.state={imageData:i},a}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.state.imageData?requestAnimationFrame(this._completeDetection):this.props.disableDelayDetect?this._resolveImage(this.props.imageUrl).then(this._completeDetection,this._completeDetection):setTimeout(function(){e._resolveImage(e.props.imageUrl).then(e._completeDetection,e._completeDetection)},7e3)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var n=this;if(this.props.imageUrl!==e.imageUrl){var a=t._imageDataCache.get(e.imageUrl);a?this.setState({imageData:a}):this._resolveImage(e.imageUrl).catch(function(e){return s._TraceLogger.logError(n._logSource,e,"ResolveImage")})}},t.prototype.componentWillUnmount=function(){this._unmounted=!0,this.revokeBlobUrl()},t.prototype.render=function(){return this.props.renderImage(this.state.imageData||"",this.props.imageProps,this._extraProps)},t.prototype._resolveImage=function(e){var n=this;return new Promise(function(a,i){var r=document.createElement("img");r.onload=function(){var o=n._getImageBase64(r),c=Object(d.Md5Hash)(o);if(Ae.has(c))s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("DoughboyDetector","IsDoughboyImage",s._LogType.Event,{fingerprint:c})),i(new d.ExpectedFailure("DoughboyImageDetected"));else if(n._unmounted)i(new d.ExpectedFailure("ElementUnmounted"));else{var l="data:image/png;base64,".concat(o);n.setState({imageData:l}),t._imageDataCache.set(e,l),a()}},r.onerror=function(e){i(new d.ExpectedFailure("DownloadImageFailed",e.error))},o._SPKillSwitch.isActivated("a2a16402-2f33-4194-9f64-0401227d07bd")?r.src=e:n._downloadImageBlob(e).then(function(e){n.revokeBlobUrl(),n._blobUrl=URL.createObjectURL(e),r.src=n._blobUrl}).catch(function(){return r.src=e}),r.crossOrigin="anonymous"})},t.prototype._downloadImageBlob=function(e){var t=this;return new Promise(function(n,a){var i,r=o._SPKillSwitch.isActivated("debde2df-6396-4e00-a52b-9f0e28593f6f"),c=new XMLHttpRequest;c.open("GET",e),c.responseType="blob";var d="";if(!r){var l=e.toLowerCase();d=l.indexOf("/_layouts/15/userphoto.aspx")>-1?"UserPhoto":l.indexOf("_vti_bin/afdcache.ashx/_userprofile/userphoto.jpg")>-1?Me:l.indexOf("https://privatecdn")>-1&&l.indexOf("/_userprofile/userphoto.jpg")>-1?ke:"Unknown",i=new s._QosMonitor("UserPhotoRenderService.".concat(d))}c.onload=function(){if(c.status>=200&&c.status<300&&c.response){if(!r){var s=d===ke||d===Me?c.getResponseHeader("x-cache"):"",l=d===Me?c.getResponseHeader("x-ccc"):"",u=c.getResponseHeader("x-cache-origin");i.writeSuccess({service:d,alias:Le,statusCode:c.status,CDNCache:null==s?void 0:s.split(" ")[0],OriginCache:u,cacheCountryCode:l,size:c.response.size,source:c.response.type})}return n(c.response)}var f=!o._SPKillSwitch.isActivated("0e15a700-a51b-41e7-b764-f01dcba615a6"),p=c.getResponseHeader("location");if(p&&c.status>=300&&c.status<400){if(f)return t._downloadImageBlob(p).then(n).catch(a);t._downloadImageBlob(p).then(n).catch(a)}else{if(!r){var m=new Error("<url>".concat(Object(Ee.scrubUrl)(void 0,e),"</url> <errorCode>").concat(c.status,"</errorCode>"));404===c.status?i.writeExpectedFailure("".concat(d," failed"),m,{alias:Le,statusCode:c.status}):i.writeUnexpectedFailure("".concat(d," failed"),m,{alias:Le,statusCode:c.status})}a("")}if(!f)return n(c.response)},c.onerror=function(){if(!r){var t=new Error("<url>".concat(Object(Ee.scrubUrl)(void 0,e),"</url> <errorCode>").concat(c.status,"</errorCode>"));i.writeUnexpectedFailure("".concat(d," failed"),t,{alias:Le,headers:c.getAllResponseHeaders()})}a("")},c.send()})},t.prototype._getImageBase64=function(e){var t,n=document.createElement("canvas");n.width=e.width,n.height=e.height,n.getContext("2d").drawImage(e,0,0);try{t=n.toDataURL("image/png"),this.revokeBlobUrl()}catch(e){return""}return t.replace(/^data:image\/png;base64,/,"")},Object.defineProperty(t.prototype,"_extraProps",{get:function(){var e=this.props;return e.imageUrl,e.imageProps,e.renderImage,e.onDetectCompleted,Object(a.__rest)(e,["imageUrl","imageProps","renderImage","onDetectCompleted"])},enumerable:!1,configurable:!0}),t._imageDataCache=new Map,Object(a.__decorate)([Object(d.monitor)("DoughboyDetector.ResolveImage")],t.prototype,"_resolveImage",null),t}(i.Component);h.loadStyles(".z_e_658c9e0a{word-wrap:break-word!important}",!0);var Te=function(e){function t(t){var n=e.call(this,t)||this;return n.update=function(){n._textContainerElementRef.current&&n._async.requestAnimationFrame(n._truncateLines)},n._truncateLines=function(){if(n._textContainerElementRef.current){var e=n.props.text||"";n._textContainerElementRef.current.textContent=e;var t=Math.round(n.props.lines),a=window.getComputedStyle(n._textContainerElementRef.current,void 0).getPropertyValue("line-height"),i=t*parseFloat(a),r=n._contentHeight;n._textArray=e.split("");var o=r>i&&t>0;if(o){var s=n._trimAndCalculateLength(r,i);n._applyTextNumber(s)}o&&n.props.autoShowTitle?n._textContainerElementRef.current.title=e:n._textContainerElementRef.current.removeAttribute("title"),n.props.onAfterTruncate&&n.props.onAfterTruncate(o)}},n._async=new c.Async(n),n._eventGroup=new c.EventGroup(n),n._handleWindowResize=n._async.debounce(n._handleWindowResizeCore,1010),n._textContainerElementRef=i.createRef(),n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._async.setTimeout(this.update,0),this._eventGroup.on(window,"resize",this._handleWindowResize)},t.prototype.componentDidUpdate=function(){this.update()},t.prototype.componentWillUnmount=function(){this._eventGroup.off(window,"resize",this._handleWindowResize),this._eventGroup.dispose(),this._async.dispose()},t.prototype.render=function(){return i.createElement("div",Object(a.__assign)({},Object(c.getNativeProps)(this.props,c.divProperties),{"data-automation-id":"less-text",ref:this._textContainerElementRef,className:Object(c.css)("z_e_658c9e0a",this.props.className)}),this.props.text)},Object.defineProperty(t.prototype,"_omission",{get:function(){return this.props.omission||"â€¦"},enumerable:!1,configurable:!0}),t.prototype._handleWindowResizeCore=function(){this.update()},Object.defineProperty(t.prototype,"_contentHeight",{get:function(){if(this._textContainerElementRef.current){var e=window.getComputedStyle(this._textContainerElementRef.current),t=0;return e&&e.paddingTop&&e.paddingBottom&&(t=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)),this._textContainerElementRef.current.offsetHeight-t}return 0},enumerable:!1,configurable:!0}),t.prototype._trimAndCalculateLength=function(e,t){var n=this._textArray.length;if(!this._textContainerElementRef.current)return n;var a=1,i=n;do{var r=Math.floor((a+i+1)/2);this._applyTextNumber(r),this._contentHeight>t?i=r-1:a=r}while(a<i);return a},t.prototype._applyTextNumber=function(e){var t=this._textArray.slice(0,e).join("");this._textContainerElementRef.current&&(this._textContainerElementRef.current.textContent=this._textContainerElementRef.current.textContent===t?t:t+this._omission)},t}(i.PureComponent);function Ue(e,t){void 0===t&&(t=1.35);var n=void 0;if("number"==typeof t)n="".concat(e*t,"em");else try{var a=e*Number(t.substr(0,t.length-2));if(isNaN(a))throw"Invalid line height input";n="".concat(a,"px")}catch(e){throw new e("Invalid line-height input format")}return{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":e.toString(),boxSizing:"content-box",maxHeight:n,textOverflow:1===e?"ellipsis":void 0}}var Fe=function(){function e(){this._x=0,this._y=0,this._line=1,this._whitespace=/(?!\xA0)\s/,this._hyphen=/\u2010|\u002d|\u00ad/,this._metrics={}}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!1,configurable:!0}),e.prototype.clampText=function(e){return this._resetCursor(),this._clampText(e)},e.prototype.clampElement=function(e,t,n,a){if(!e)return{text:"",lines:0};var i=e.getBoundingClientRect(),r=Math.round(i.width),o=Math.round(i.height),s=this._getComputedStyle(e);"border-box"===s.boxSizing&&(r-=this._parseInt(s.borderRightWidth)+this._parseInt(s.borderLeftWidth)+this._parseInt(s.paddingRight)+this._parseInt(s.paddingLeft),o-=this._parseInt(s.borderTopWidth)+this._parseInt(s.borderBottomWidth)+this._parseInt(s.paddingTop)+this._parseInt(s.paddingBottom)),window.MSInputMethodContext&&document.documentMode&&--r;var c=parseFloat(s.fontSize),d=1.1*c,l=Math.floor("normal"===s.lineHeight?d:parseFloat(s.lineHeight));if(this._resetCursor(),e.childElementCount&&!n)return this._clampComplexElement(e,r,o,l,t,a);var u=this._clampText({text:n||e.textContent,maxLines:t,ellipsis:a,width:r,height:o,lineHeight:l,style:s.fontStyle||"",variant:s.fontVariant||"",weight:s.fontWeight||"",size:c,family:s.fontFamily||""});return e.textContent=u.text,u},e.prototype._getComputedStyle=function(e){var t="__computedStyle";return e[t]||(e[t]=getComputedStyle(e))},e.prototype._parseInt=function(e){var t=parseInt(e,10);return isNaN(t)?0:t},e.prototype._createCanvas=function(){var e=document.createElement("canvas");return e.width=1,e.height=1,e.getContext("2d")},e.prototype._resetCursor=function(){this._x=0,this._y=0,this._line=1},e.prototype._getFontStyle=function(e,t){return"".concat(e.style||"normal")+" ".concat(e.variant||"normal")+" ".concat(t||e.weight||"normal")+" ".concat(e.size,"px")+" ".concat(e.family||"sans-serif")},e.prototype._setFont=function(e){this._context||(this._context=this._createCanvas()),this._font=this._getFontStyle(e),this._numericWeight=parseInt(e.weight,10),(this._isExtendedWeight=!isNaN(this._numericWeight)&&400!==this._numericWeight&&700!==this._numericWeight)?(this._context2||(this._context2=this._createCanvas()),this._context.font=this._getFontStyle(e,"normal"),this._context2.font=this._getFontStyle(e,"bold")):this._context.font=this._font},e.prototype._measureChar=function(e){var t=this._metrics[this._font]||(this._metrics[this._font]={}),n=t[e];if(n)return n;if(n=this._context.measureText(e).width,this._isExtendedWeight){var a=(this._context2.measureText(e).width-n)/3;n-=(400-this._numericWeight)/100*a}return t[e]=n,n},e.prototype._clampText=function(e){var t,n,a=e.text,i=e.width,r=e.height,o=e.lineHeight,s=e.maxLines,c=e.ellipsis,d=void 0===c?"â€¦":c;if(!a||!a.length||!i||!r||r<o||!s)return{text:"",lines:0};this._setFont(e);var l=s===this._line;l&&(this._x+=this._measureChar(d));for(var u=a.length,f=0;f<u;){var p=a[f],m=this._whitespace.test(p);if(n&&m)++f;else{var _=this._measureChar(p);if(this._x+_>i){if(l)return{text:a.substring(0,n?f-1:f)+d,didClamp:!0,lines:this._line};t&&!m?f=t:m&&++f,this._y+=o,l=++this._line===s||this._y+2*o>r,this._x=l?this._measureChar(d):0,t=0}else(m||this._hyphen.test(p))&&(t=f),this._x+=_,++f;n=m}}return{text:a,lines:this._line}},e.prototype._clampComplexElement=function(e,t,n,a,i,r){for(var o,s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null);o=s.nextNode();){var c=this._getComputedStyle(o.parentElement||o.parentNode),d=this._clampText({text:o.nodeValue,maxLines:i,ellipsis:r,width:t,height:n,lineHeight:a,style:c.fontStyle||"",variant:c.fontVariant||"",weight:c.fontWeight||"",size:parseFloat(c.fontSize),family:c.fontFamily||""});if(d.didClamp){for(o.nodeValue=d.text;o=s.nextNode();)o.parentNode.removeChild(o);return d}}},e}();function He(e){return Fe.instance.clampText(e)}function Re(e,t,n,a){return Fe.instance.clampElement(e,t,n,a)}var Ne=function(e){return He(e).text};h.loadStyles('.Placeholder{display:flex}.Placeholder.Placeholder--autoHeight .Placeholder-container{height:auto;padding:80px 0}.Placeholder .Placeholder-container{box-sizing:border-box;zoom:1;align-items:center;color:"[theme:neutralSecondary, default: #605e5c]";background-color:"[theme:neutralLighter, default: #f3f2f1]";width:100%;height:326px;padding:80px 0 0}.Placeholder .Placeholder-container:after,.Placeholder .Placeholder-container:before{display:table;content:"";line-height:0}.Placeholder .Placeholder-container:after{clear:both}.Placeholder .Placeholder-container .Placeholder-head{margin:0 -8px;box-sizing:border-box;zoom:1;color:"[theme:neutralPrimary, default: #323130]"}.Placeholder .Placeholder-container .Placeholder-head:after,.Placeholder .Placeholder-container .Placeholder-head:before{display:table;content:"";line-height:0}.Placeholder .Placeholder-container .Placeholder-head:after{clear:both}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-headContainer{height:100%;white-space:nowrap;text-align:center}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-icon{display:inline-block;vertical-align:middle;white-space:normal;font-size:42px;font-weight:100}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text{display:inline-block;vertical-align:middle;white-space:normal;line-height:normal}[dir=ltr] .Placeholder .Placeholder-container .Placeholder-head .Placeholder-text{padding-left:16px}[dir=rtl] .Placeholder .Placeholder-container .Placeholder-head .Placeholder-text{padding-right:16px}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text:not(.Placeholder-text-fluent){font-size:28px;font-weight:100}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text.Placeholder-text-fluent{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text:not(.ellipsisKillSwitch){max-width:70%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.Placeholder .Placeholder-container .Placeholder-description{box-sizing:border-box;zoom:1;width:65%;vertical-align:middle;margin:0 auto;text-align:center}.Placeholder .Placeholder-container .Placeholder-description:after,.Placeholder .Placeholder-container .Placeholder-description:before{display:table;content:"";line-height:0}.Placeholder .Placeholder-container .Placeholder-description:after{clear:both}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText{color:"[theme:neutralSecondary, default: #605e5c]";margin:20px 0 28px;line-height:23px}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText:not(.Placeholder-text-fluent){font-size:17px;font-weight:100}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText.Placeholder-text-fluent{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]"}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText:not(.Placeholder-text-truncate){display:inline-block}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText.Placeholder-text-truncate{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3;box-sizing:content-box;max-height:69px;overflow:hidden}.Placeholder .Placeholder-container button{margin:2px 4px}.Placeholder-overlay{position:relative;height:100%;z-index:1}.Placeholder-overlay .Placeholder-spinnerContainer{position:relative;width:100%;margin:164px 0}',!0);var Be=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n._handleWindowResize=function(){t.shouldUseCssClamp||n._processLines()},n}return Object(a.__extends)(t,e),Object.defineProperty(t,"shouldUseCssClamp",{get:function(){return void 0===this._shouldUseCssClamp&&(this._shouldUseCssClamp=o._BrowserDetection.getBrowserInformation().browser!==o._Browser.IE),this._shouldUseCssClamp},enumerable:!1,configurable:!0}),t._isEllipsisOverflowKillSwitchActivated=function(){return o._SPKillSwitch.isActivated(o.Guid.parse("e984b51f-12c9-45ea-abba-2dc3869cdc79"),"2018/3/27","ReplaceOverflowingTitleTextWithEllipsis")},t.prototype.UNSAFE_componentWillMount=function(){this._processLines=this._async.throttle(this._processLines,500)},t.prototype.componentDidMount=function(){this._processLines(),window.addEventListener("resize",this._handleWindowResize)},t.prototype.componentDidUpdate=function(e){this.props.description&&this.props.webpartWidth!==e.webpartWidth&&this._processLines()},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this._handleWindowResize)},t.prototype.render=function(){var e=this.props,n=e.children,a=e.contentClassName,r=e.description,o=e.icon,s=e.iconText;this._descriptionId="description-".concat(Math.random().toString());var d,l=Object(c.css)("Placeholder-descriptionText",{"Placeholder-text-fluent":!0,"Placeholder-text-truncate":t.shouldUseCssClamp});return this.props.placeholderHeight&&(d={height:"".concat(this.props.placeholderHeight,"px"),paddingTop:"".concat((this.props.placeholderHeight-150)/2,"px")}),i.createElement("div",{className:Object(c.css)("Placeholder",a,{"Placeholder--autoHeight":!!n})},i.createElement("div",{className:"Placeholder-container",style:d},i.createElement("div",{className:"Placeholder-head"},i.createElement("div",{className:"Placeholder-headContainer"},o&&i.createElement(c.Icon,{className:"Placeholder-icon",iconName:o}),i.createElement("span",{className:Object(c.css)("Placeholder-text",{ellipsisKillSwitch:t._isEllipsisOverflowKillSwitchActivated()},{"Placeholder-text-fluent":!0})},s))),i.createElement("div",{className:"Placeholder-description"},i.createElement("span",{className:l,id:this._descriptionId,ref:this._resolveRef("_placeholderDescription")},r)),n,i.createElement("div",{className:"Placeholder-description"},this.buttonElement,this._extraButtonElements)))},Object.defineProperty(t.prototype,"buttonElement",{get:function(){return this.props.buttonLabel&&this._renderButtonElement({description:this.props.description,label:this.props.buttonLabel,onClick:this.props.onAdd},!0)},enumerable:!1,configurable:!0}),t.prototype.focusOnPlaceHolderButton=function(){this._placeholderButton&&this._placeholderButton.focus()},Object.defineProperty(t.prototype,"_extraButtonElements",{get:function(){var e=this;return this.props.extraButtons&&this.props.extraButtons.map(function(t,n){return e._renderButtonElement(t,!1)})},enumerable:!1,configurable:!0}),t.prototype._processLines=function(){this._placeholderDescription&&!o._BrowserUtilities.isWebViewHosted()&&Re(this._placeholderDescription,3,this.props.description)},t.prototype._renderButtonElement=function(e,t){return i.createElement(c.PrimaryButton,{componentRef:t&&this._resolveRef("_placeholderButton"),"data-automation-id":"placeholderButton",onClick:e.onClick,ariaDescription:e.description},e.label)},t}(c.BaseComponent),je=Be,Ve=n("j3t2"),ze=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onLogin=function(){t._logAction("Click"),window.location.href=t.props.error.redirectUrl},t._logAction=function(e){var n=new s._LogEntry("OAuthErrorRenderer","MultiFactorAuthentication.".concat(e),s._LogType.Event,{webpartAlias:t.props.webpartAlias});s._EngagementLogger.logEventWithLogEntry(n)},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=!!this.props.error.redirectUrl,t=e?Ve.t:this.props.customErrorMessage||this.props.error.message;return i.createElement("div",{className:this.props.contentClassName},i.createElement(je,{icon:this.props.webpartIcon||"Permissions",iconText:this.props.webpartName,buttonLabel:e&&Ve.e,description:t,onAdd:e&&this._onLogin}))},t.prototype.componentDidMount=function(){this.props.error.redirectUrl&&this._logAction("Render")},t}(i.Component),Ge=ze,Ke=function(){function e(){var t=this;this.register=function(e,n,a){t._scrollableParents&&t._scrollableParents.length||(t._scrollableParents=a?[a]:t._findScrollableParents(e)),t._scrollableParents.forEach(function(e,n,a){1===t._updateRegisteredChildren(e,1)&&t._listenEvents(e)}),t._listenEvents(window),t._eventListeners.add(n)},this._findScrollableParents=function(t){for(var n=[],a=t;a;)(a=e._findScrollableParent(a))&&(n.push(a),a=a.parentElement);return n.length?n:[document.body]},this._unlistenEvents=function(e){if(e){var n=e===window;(!n||n&&t._isListeningWindow)&&(t._removeEventListener(e),n&&(t._isListeningWindow=!1))}},this._updateRegisteredChildren=function(t,n){var a=n+Number(t.getAttribute(e._eventTrackerAttribute));return a>0?t.setAttribute(e._eventTrackerAttribute,a.toString()):t.removeAttribute(e._eventTrackerAttribute),a},this._eventListeners=new Set,this._isListeningWindow=!1,this._lazyHandler=u.throttle(this._scrollEventHandler,10).bind(this)}return Object.defineProperty(e,"instance",{get:function(){return void 0===e._instance&&(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e.prototype.unregister=function(e,t){var n=this;o.Validate.isNotNullOrUndefined(t,"unregister callback function"),this._eventListeners.has(t)&&(this._eventListeners.delete(t),(this._scrollableParents&&this._scrollableParents.length?this._scrollableParents:this._findScrollableParents(e)).forEach(function(e,t,a){n._updateRegisteredChildren(e,-1)<=0&&n._unlistenEvents(e)}),0===this._eventListeners.size&&this._unlistenEvents(window))},e.prototype._scrollEventHandler=function(e){var t=this;this._cachedClientRect&&!this._cacheExpired||(this._cachedClientRect=this._scrollableParents[this._scrollableParents.length-1].getBoundingClientRect(),this._cachedClientRectAge=Date.now()),this._eventListeners.forEach(function(n){n(e,t._cachedClientRect)})},e.prototype._listenEvents=function(e){if(e){var t=e===window;(!t||t&&!this._isListeningWindow)&&(this._addEventListener(e),t&&(this._isListeningWindow=!0))}},e.prototype._addEventListener=function(t){t.addEventListener(e.SCROLL,this._lazyHandler,!1),t.addEventListener(e.RESIZE,this._lazyHandler,!1)},e.prototype._removeEventListener=function(t){t.removeEventListener(e.SCROLL,this._lazyHandler),t.removeEventListener(e.RESIZE,this._lazyHandler)},Object.defineProperty(e.prototype,"_cacheExpired",{get:function(){return Date.now()-this._cachedClientRectAge>=e.CACHE_EXPIRED},enumerable:!1,configurable:!0}),e._eventTrackerAttribute="data-sp-scroll-event-listener",e.SCROLL="scroll",e.RESIZE="resize",e.CACHE_EXPIRED=100,e._findScrollableParent=function(t){for(var n=t,a=document.body;n&&n!==a;){if("true"===n.getAttribute("data-is-scrollable"))return n;n=n.parentElement}for(n=t;n&&n!==a;){var i=getComputedStyle(n);if(i){var r=i.getPropertyValue("overflow-y");if(r&&(r===e.SCROLL||"auto"===r))return n}n=n.parentElement}return n&&n!==a||(n=void 0),n},e}(),We=function(){function e(){var e=this;this._parallaxElements=new Set,this._parallaxFactor=1.81,this._onScroll=function(t,n){window.requestAnimationFrame(e._updateParallax.bind(e,n))},this._updateParallax=function(t){var n=t.top;e._parallaxElements.forEach(function(t){if(t.parentElement){var a=t.parentElement.getBoundingClientRect(),i=a.top,r=a.bottom;if(i<n&&r>n){var o=Math.round((n-i)/e._parallaxFactor);e._setTranslate(t,o)}else i>=n&&e._setTranslate(t,0)}})}}return Object.defineProperty(e,"instance",{get:function(){return void 0===e._instance&&(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isParallaxEnabled",{get:function(){var e=o._BrowserDetection.getBrowserInformation();return e.browser!==o._Browser.Edge&&e.browser!==o._Browser.IE&&!o._BrowserUtilities.isWebViewHosted()},enumerable:!1,configurable:!0}),e.prototype.tryAddParallax=function(e){var t=this.isParallaxEnabled;if(t){o.Validate.isNotNullOrUndefined(e,"targetElement");var n=Object(c.findScrollableParent)(e),a=n===window?document.body:n;Ke.instance.register(e,this._onScroll,a),this._parallaxElements.add(e),e.style.setProperty("will-change","transform")}return t},e.prototype.removeParallax=function(e){o.Validate.isNotNullOrUndefined(e,"targetElement"),this._parallaxElements.has(e)&&(this._parallaxElements.delete(e),Ke.instance.unregister(e,this._onScroll),this._setTranslate(e,0),e.style.removeProperty("will-change"))},e.prototype._setTranslate=function(e,t){var n="translate3d(0px,"+t+"px, 0px)";e.style.transform=n},e}(),qe=Object(c.classNamesFunction)(),Qe=function(e){return e.variantTheme?{captionElement:[{selectors:{"& span":{color:e.variantTheme.semanticColors.bodyText},"& textarea":{color:e.variantTheme.semanticColors.bodyText+" !important"},"& textarea::placeholder":{color:e.variantTheme.semanticColors.bodySubtext+" !important"}}}]}:{captionElement:void 0}},Ye=function(e){function t(t){var n=e.call(this,t)||this;return n._captionElementRef=i.createRef(),n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.alignPosition,n=e.className,r=e.edit,o=e.marginBottomSize,s=e.onTitleChange,d=e.placeholder,l=e.title,u=e.theme,p=qe(Qe,{variantTheme:u}).captionElement,m=Object(c.css)(n,p),_={type:f.t.Title,isEditMode:r,text:l,onChange:s,placeholder:d,alignPosition:t,className:m,headingLevel:2,marginBottomSize:o};return!(!r&&!l)&&i.createElement(f.n,Object(a.__assign)({ref:this._captionElementRef},_))},t.prototype.value=function(){return this._captionElementRef.current.value()},t.prototype.focusOnWebPartTitle=function(){this._captionElementRef.current.focusOnCaptionElement()},t.defaultProps={edit:!1,title:void 0,onTitleChange:u.noop,placeholder:void 0,className:void 0,alignPosition:f.e.PageDirection,marginBottomSize:"None"},t}(i.Component),Je=function(){function e(){}return e.getOpenDocumentAction=function(t){if(t&&o._BrowserUtilities.isWebViewHosted())return JSON.stringify({key:e.documentKey,args:{command:e.documentCommand,url:t,version:"1.0"}})},Object.defineProperty(e,"webViewActionRole",{get:function(){return o._BrowserUtilities.isWebViewHosted()&&!(o._BrowserUtilities.isTeamsWebViewHosted()||o._BrowserUtilities.isTeamsAndroidHosted()||o._BrowserUtilities.isTeamsIOSHosted())?"button":void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e,"documentKey",{get:function(){return"openDocument"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"documentCommand",{get:function(){return"sitePageUserAction"},enumerable:!1,configurable:!0}),e}(),Xe=n("NmG0");h.loadStyles(".au_h_658c9e0a{cursor:pointer}.au_h_658c9e0a:hover{outline:none}",!0);var Ze=n("0l0e"),$e=new(function(){function e(){}return e.prototype.getLPCLoader=function(){return n.e(0).then(n.bind(null,"oCe/")).then(function(e){return e.default})},Object(a.__decorate)([Object(d.monitor)("LivePersonaCard.Load")],e.prototype,"getLPCLoader",null),e}()),et=function(e){function t(n){var a=e.call(this,n)||this;return a._isUnMounted=!1,a._bootstrapLivePersonaCard=function(e){return!t._isLivePersonaCardFlightEnabled()||o._BrowserUtilities.isMobileWebView()?Promise.resolve():t.LivePersonaCardHoverTarget?(a._updateBundleMountedState(null==e?void 0:e.nativeEvent),Promise.resolve()):(a._loadPromise||(a._loadPromise=a._bootstrapCore(null==e?void 0:e.nativeEvent)),a._loadPromise)},a._bootstrapCore=function(e){return s._TraceLogger.logVerbose(a._logSource,"LivePersonaCard._bootstrapCore"),$e.getLPCLoader().then(function(e){return e.bootstrap(a.props.serviceScope,a._clientType,a._personaType,a.props.clientScenario)}).then(function(){a._isUnMounted||a._updateBundleMountedState(e)}).catch(function(e){s._TraceLogger.logError(a._logSource,e,"BootstrapLivePersonaCard")})},a._manuallyDispatchEventToTriggerCallout=function(e){var t,n,i,r;"keydown"===(null==e?void 0:e.type)&&a._ref.current&&(null===(t=Object(c.getFirstTabbable)(a._ref.current,a._ref.current,!0))||void 0===t||t.focus(),null===(n=a._ref.current.firstElementChild)||void 0===n||n.dispatchEvent(function(){if(KeyboardEvent instanceof Function)return new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:"Enter",code:"Enter",keyCode:13,which:13});var e=document.createEvent("KeyboardEvent");return e.initKeyboardEvent("keydown",!0,!0,window,"Enter","Enter",0,"",!1),e}())),Object(Xe.d)()||"mouseover"===(null==e?void 0:e.type)&&a._ref.current&&a.state.shouldDisplayCallout&&(null===(i=a._ref.current.firstElementChild)||void 0===i||i.dispatchEvent(function(){if(MouseEvent instanceof Function)return new MouseEvent("mousemove",{bubbles:!0,cancelable:!0});var e=document.createEvent("MouseEvent");return e.initEvent("mousemove",!0,!0),e}())),Object(Xe.c)()||"click"===(null==e?void 0:e.type)&&a._ref.current&&a.state.shouldDisplayCallout&&(null===(r=a._ref.current.firstElementChild)||void 0===r||r.dispatchEvent(function(){if(MouseEvent instanceof Function)return new MouseEvent("click",{bubbles:!0,cancelable:!0});var e=document.createEvent("MouseEvent");return e.initEvent("click",!0,!0),e}()))},a._logTriggerAction=function(e,t){"Keyboard"===t&&e.keyCode!==c.KeyCodes.enter||a._triggerBootstrap(e,t)},a._triggerBootstrap=function(e,t){s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("LivePersonaCard","".concat(a._logScenario,".Trigger"),s._LogType.Event,{hasUPN:Boolean(a.props.upn).toString(),source:t,isBundleLoaded:a.state.isBundleLoaded.toString()})),a._isLPCBundleLoaded()||(a.setState({shouldDisplayCallout:!0}),a._bootstrapLivePersonaCard(e).catch(a._traceBootstrapFailure))},a._triggerBootstrapByKeyboard=function(e){"Enter"===e.key&&(a._triggerBootstrap(e,"Keyboard"),Object(Xe.e)()||a._isLPCBundleLoaded()||d.ScreenReaderAlert.read(Ze.t))},a._handleCardOpen=function(){s._EngagementLogger.logEvent("LivePersonaCard.".concat(a._logScenario),"Open");var e=a.props.onCardOpen;e&&e()},a._traceBootstrapFailure=function(e){s._TraceLogger.logError(a._logSource,e,"LivePersonaCard.bootstrap")},a._logSource=s._LogSource.create("LivePersonaCard"),a._ref=i.createRef(),a.state={isBundleLoaded:!1,shouldDisplayCallout:!1},a}return Object(a.__extends)(t,e),t._isLivePersonaCardFlightEnabled=function(){return o._SPFlight.isEnabled(809)},Object.defineProperty(t,"LivePersonaCardHoverTarget",{get:function(){return window.LivePersonaCardHoverTargetV2},enumerable:!1,configurable:!0}),t.prototype.componentWillUnmount=function(){this._isUnMounted=!0},t.prototype.render=function(){var e=this;if(this.props.disabled)return i.Children.only(this.props.children);if(o._BrowserUtilities.isMobileWebView())return i.cloneElement(i.Children.only(this.props.children),{role:"button","data-sp-action":JSON.stringify({key:"viewUserProfileDetails",args:Object(a.__assign)({upn:this.props.upn},!Object(Xe.o)()&&o._BrowserUtilities.isTeamsVivaMobile()&&{displayName:this.props.displayName})}),onClick:function(){}});var t=function(t){return Object(Xe.e)()?e._logTriggerAction(t,"Mouse"):e._triggerBootstrap(t,"Mouse")},n=this.props.useSpan?"span":"div",r=this.props.disableClick&&!Object(Xe.c)()?void 0:t,s=this.props.disableHover&&!Object(Xe.c)()?void 0:t,d=this.props.disableHover&&!Object(Xe.c)()?void 0:function(t){return e.setState({shouldDisplayCallout:!1})};return i.createElement(n,{className:Object(c.css)(this.props.className,"au_h_658c9e0a"),onClickCapture:r,onKeyDownCapture:function(t){return Object(Xe.e)()?e._logTriggerAction(t,"Keyboard"):e._triggerBootstrapByKeyboard(t)},onMouseOver:s,onMouseLeave:d,ref:this._ref},this._renderContent())},t.prototype._renderContent=function(){var e={Smtp:this.props.upn},n={cardParameters:{personaInfo:{identifiers:Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({PersonaType:this._personaType,Upn:this.props.upn},o._SPKillSwitch.isActivated("8069b9d9-ed8f-4e2d-8b5f-8ef00a01be15")?e:{}),{TopicId:Object(Xe.s)()?void 0:this.props.topicId}),this.props.hostAppPersonaInfo&&{LocationId:this.props.hostAppPersonaInfo.LocationId,OlsPersonaId:this.props.hostAppPersonaInfo.OlsPersonaId,AadObjectId:this.props.hostAppPersonaInfo.PersonaAadObjectId,DisplayName:this.props.hostAppPersonaInfo.PersonaDisplayName}),topicMetadata:this.props.topicCardMetadata,displayName:this.props.displayName,personaCoinColor:Object(c.getPersonaInitialsColor)({text:this.props.displayName})},externalAppSessionCorrelationId:this.props.externalAppSessionCorrelationId,behavior:{onCardOpen:this._handleCardOpen,onCardClose:this.props.onCardClose,disableHover:this.props.disableHover,disableClick:this.props.disableClick},ariaLabel:this.props.ariaLabel},tabIndex:this.props.tabIndex};return(this.props.upn||!Object(Xe.s)()&&this.props.topicId)&&this._isLPCBundleLoaded()?i.createElement(t.LivePersonaCardHoverTarget,Object(a.__assign)({},n,{onCardOpen:this._handleCardOpen}),i.Children.only(this.props.children)):(this.props.upn||!Object(Xe.s)()&&this.props.topicId)&&!this._isLPCBundleLoaded()?i.cloneElement(i.Children.only(this.props.children),Object(a.__assign)({tabIndex:0,"data-is-focusable":!0},!Object(Xe.e)()&&{role:"button","aria-label":this.props.ariaLabel||(this.props.displayName?o.Text.format(Ze.n,this.props.displayName):Ze.e),"aria-haspopup":"dialog"})):i.Children.only(this.props.children)},t.prototype._isLPCBundleLoaded=function(){return this.state.isBundleLoaded&&!!t.LivePersonaCardHoverTarget},Object.defineProperty(t.prototype,"_logScenario",{get:function(){return this.props.clientScenario||"unset"},enumerable:!1,configurable:!0}),t.prototype._updateBundleMountedState=function(e){var t=this;this.setState({isBundleLoaded:!0},function(){return t._manuallyDispatchEventToTriggerCallout(e)})},Object.defineProperty(t.prototype,"_clientType",{get:function(){return this.props.clientType||(Object(Xe.l)()?"SPPeopleWebPart":"ODSP")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_personaType",{get:function(){return this.props.hostAppPersonaInfo&&this.props.hostAppPersonaInfo.PersonaType||"User"},enumerable:!1,configurable:!0}),t}(i.PureComponent),tt=function(){function e(){}return e.GetUtilities=function(){return e._promise||(e._promise=n.e(2).then(n.bind(null,"aABU"))),e._promise},e}();function nt(e){return i.createElement("div",{className:"m_b_658c9e0a"},i.createElement(c.Icon,{className:"n_b_658c9e0a",iconName:e}))}h.loadStyles('.m_b_658c9e0a{z-index:2;position:absolute;width:100%;height:100%;background-color:"[theme:black, default: #000000]";opacity:.5;text-align:center;top:0;cursor:pointer}.n_b_658c9e0a{color:"[theme:white, default: #ffffff]";position:absolute;transform:translate(-50%,-50%);font-size:68px;top:50%}[dir=ltr] .n_b_658c9e0a{left:50%}[dir=rtl] .n_b_658c9e0a{right:50%}',!0)},qjmy:function(e,t){e.exports=b},tGpx:function(e,t){e.exports=g},ut3N:function(e,t){e.exports=v},vlQI:function(e,t){e.exports=y},vpvl:function(e,t,n){"use strict";n("jOlS").loadStyles('.o_c_658c9e0a{font-size:14px;font-weight:400;font-weight:300;line-height:1.6em;overflow-x:hidden;text-overflow:ellipsis}.o_c_658c9e0a.p_c_658c9e0a{font-weight:400}.q_c_658c9e0a{color:"[theme:neutralPrimary, default: #323130]";overflow-x:hidden;text-overflow:ellipsis}[dir=ltr] .r_c_658c9e0a{text-align:left}[dir=rtl] .r_c_658c9e0a{text-align:right}.s_c_658c9e0a{text-align:center}[dir=ltr] .t_c_658c9e0a{text-align:right}[dir=rtl] .t_c_658c9e0a{text-align:left}.u_c_658c9e0a{margin-bottom:18px}.v_c_658c9e0a{margin-bottom:11px}.w_c_658c9e0a{margin-bottom:0}.x_c_658c9e0a{white-space:pre-wrap}.y_c_658c9e0a{background-color:transparent;border:none;box-sizing:border-box;display:block;margin:0;outline:0;overflow:hidden;resize:none;width:100%;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;text-align:inherit}.y_c_658c9e0a.p_c_658c9e0a{font-weight:400}.y_c_658c9e0a:-ms-input-placeholder{color:"[theme:neutralTertiary, default: #a19f9d]"}.y_c_658c9e0a::placeholder{color:"[theme:neutralTertiary, default: #a19f9d]"}',!0),t.e={captionElement__caption:"o_c_658c9e0a",thick:"p_c_658c9e0a",captionElement__title:"q_c_658c9e0a",captionElement__leftAlign:"r_c_658c9e0a",captionElement__centerAlign:"s_c_658c9e0a",captionElement__rightAlign:"t_c_658c9e0a",captionElement__LargeMargin:"u_c_658c9e0a",captionElement__MiddleMargin:"v_c_658c9e0a",captionElement__NoMargin:"w_c_658c9e0a",titleBreakInLines:"x_c_658c9e0a",textarea:"y_c_658c9e0a"}},xTKt:function(e){e.exports=JSON.parse('{"a":"See all","i":"See all. Press enter to browse all items.","t":"Add","e":"Add an item","n":"Close teaching bubble","r":"The See All page for the {0} web part is opening."}')},y88i:function(e,t){e.exports=S}})});