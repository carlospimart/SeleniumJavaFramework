(window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0=window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0||[]).push([[29],{FzFR:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a,i=n("17wl"),r=n("3HEj"),o=n("1tKF"),s=n("K9kD"),c=n("y88i");!function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed"}(a||(a={}));var d=["#0078d7","#088272","#107c10","#881798","#b4009e","#e81123","#da3b01","#006f94","#005e50","#004e8c","#a80000","#4e257f"],l=function(e){function t(t){return e.call(this,{dataSourceName:"SiteHeaderLogoAcronym",id:"acronymAndColors"},{pageContext:t})||this}return Object(i.__extends)(t,e),t.decodeAcronymColor=function(e){return d.indexOf(e)+1},t.prototype.getAcronymData=function(e){return this.getAcronyms([e]).then(function(e){return e[0]},function(){return{acronym:void 0,color:void 0,text:void 0}})},t.prototype.getAcronyms=function(e,t){var n=this;if(void 0===t&&(t={}),this._pageContext.webServerRelativeUrl){var a=t.qosName,i=void 0===a?"GetSiteHeaderLogoAcronym":a;return this.getDataUtilizingPersistentCache({getUrl:function(){var t=e.map(function(e){return"{Text: ".concat(c.UriEncoding.encodeURIComponent('"'+e+'"'),"}")}).join(",");return Object(r.n)(n._pageContext)+"/_api/sphome/GetAcronymsAndColors?labels=[".concat(t,"]")},parseResponse:function(e){return JSON.parse(e).d.GetAcronymsAndColors.results.map(function(e){return{acronym:e.Acronym,color:e.Color,text:e.Text}})},method:"GET",qosName:i})}return s.Promise.reject(new Error("No web URL specified for request."))},t}(o.e);t.t=l},KarG:function(e,t,n){"use strict";n.r(t),n.d(t,"FOLLOWED_SITES_IN_STORE_KEY",function(){return B}),n.d(t,"SiteHeaderContainerStateManager",function(){return j});var a,i=n("17wl"),r=n("l9Kh"),o=n("2FRe"),s=n("iNGM"),c=n("Vlqv"),d=n("Y7TA"),l=n("K9kD"),u={ODB:1075},f=n("a4sQ"),p=n("3HEj"),m=n("FzFR"),_=n("NacN"),h=n("OpjN"),b=n("71k8"),g=n("y88i"),v=n("1tKF"),y=n("4ERF"),S={"SPHome-ClientType":"PagesWeb"},D=500007,I=500019,x=500020,C=500021,O="04B280A8-D635-4437-89BB-E051B80C000F",w=function(e){function t(t){var n=e.call(this,{dataSourceName:"FollowDataSource",id:"FavoriteFeed"},{pageContext:t})||this;return n._isSiteFollowedCacheKey="isSiteFollowed"+"_".concat(t.siteId+t.webId),n}return Object(i.__extends)(t,e),t.prototype.followSite=function(e){var t=this;return this.dataRequestor.getData({url:Object(p.n)(this._pageContext)+"/_vti_bin/homeapi.ashx/sites/followed/add",qosName:"FollowSite",additionalPostData:'"'.concat(e,'"'),additionalHeaders:S,noRedirect:!0}).then(function(){t.flushCache(t._isSiteFollowedCacheKey)})},t.prototype.unfollowSite=function(e){var t=this;return this.dataRequestor.getData({url:Object(p.n)(this._pageContext)+"/_vti_bin/homeapi.ashx/sites/followed/remove",qosName:"UnfollowSite",additionalPostData:'"'.concat(e,'"'),additionalHeaders:S,noRedirect:!0}).then(function(){t.flushCache(t._isSiteFollowedCacheKey)})},t.prototype.isSiteFollowed=function(e,t,n,a,r){void 0===t&&(t=!1),void 0===n&&(n=!1);var o=0;return n?o=3:t&&(o=2),a&&r?this.getDataUtilizingPersistentCache({url:Object(p.n)(this._pageContext)+"/_vti_bin/homeapi.ashx/sites/followed/isFollowed?"+"siteId=".concat(a,"&webId=").concat(r,"&url=").concat(g.UriEncoding.encodeURIComponent(e)),parseResponse:function(e){return"true"===e},qosName:"isSiteFollowed",telemetryHandler:function(e){var t=e.errorData,n=e.eventData;if(t){var a=!1;if(t.responseData&&t.responseData.ErrorCode){var r=t.responseData.ErrorCode;r!==D&&r!==I&&r!==x&&r!==C||(a=!0)}var o=a?l.ResultTypeEnum.ExpectedFailure:l.ResultTypeEnum.Failure;return{eventData:Object(i.__assign)(Object(i.__assign)({},n),{resultType:o})}}return{eventData:n}},additionalHeaders:S,noRedirect:!0,method:"GET",cachingStrategy:o,cacheRequestKey:this._isSiteFollowedCacheKey}).catch(function(e){if(e&&e.responseData&&e.responseData.ErrorCode){var t=e.responseData.ErrorCode;if(t===D||t===I||t===x||t===C)return!1}throw e}):this.getDataUtilizingPersistentCache({url:"".concat(Object(p.n)(this._pageContext),"/_api/social.following/IsFollowed"),parseResponse:function(e){return JSON.parse(e).d.IsFollowed},qosName:"isSiteFollowed",noRedirect:!0,method:"POST",additionalPostData:JSON.stringify({actor:{__metadata:{type:"SP.Social.SocialActorInfo"},ActorType:1,ContentUri:e,Id:null}}),cachingStrategy:o,cacheRequestKey:this._isSiteFollowedCacheKey})},t.prototype.isFollowFeatureEnabled=function(){if(!l.KillSwitch.isActivated("A7A2793E-67CD-4dc1-9FD0-43F61581207A")&&this._pageContext.featureInfo){var e=new y.e(this._pageContext.featureInfo);if(e){var t=e.get("FollowingContent");if(t)return l.KillSwitch.isActivated(O)||new l.Qos({name:"FollowingContent.SQLRTsSaved"}).end({resultType:l.ResultTypeEnum.Success}),l.Promise.resolve(t.enabled)}}return this.getDataUtilizingPersistentCache({url:"".concat(this._pageContext.webAbsoluteUrl,"/_api/SP.Utilities.SPSocialSwitch.IsFollowingFeatureEnabled"),cacheRequestKey:"followEnabled_".concat(this._pageContext.webId+this._pageContext.siteId),method:"POST",noRedirect:!0,qosName:"isFollowFeatureEnabled",parseResponse:function(e){var t=JSON.parse(e);return l.KillSwitch.isActivated("A7A2793E-67CD-4dc1-9FD0-43F61581207A")||l.KillSwitch.isActivated(O)?l.KillSwitch.isActivated(O)||new l.Qos({name:"FollowingContent.SQLRTsSaved"}).end({resultType:l.ResultTypeEnum.ExpectedFailure}):new l.Qos({name:"FollowingContent.SQLRTsSaved"}).end({resultType:l.ResultTypeEnum.Failure}),t.d.IsFollowingFeatureEnabled}})},t}(v.e),E=n("vyKV"),A=n("jidH"),L=n("ynV5"),k=n("85Bv"),M={ODB:1075},P={ODB:1559},T={ODB:60299,ODC:null,Fallback:!1},U={ODB:60328},F={ODB:60340},H={ODB:60703},R={ODB:60752},N=[{name:"inboxUrl",eid:"Mail",trimIfAnonymous:!0},{name:"calendarUrl",eid:"Calendar",trimIfAnonymous:!0},{name:"filesUrl",eid:"Files",trimIfAnonymous:!1},{name:"notebookUrl",eid:"Notebook",trimIfAnonymous:!1},{name:"siteUrl",eid:"Home",trimIfAnonymous:!1},{name:"membersUrl",eid:"Members",trimIfAnonymous:!0},{name:"plannerUrl",eid:"Planner",trimIfAnonymous:!0}],B="FollowedSites";!function(e){e[e.quickLaunch=0]="quickLaunch",e[e.globalNav=1]="globalNav",e[e.none=2]="none"}(a||(a={}));var j=function(){function e(e){var t=this;this._openTeamsChannel=function(e){window.open("".concat(t._pageContext.webAbsoluteUrl,"/_layouts/15/GroupStatus.aspx?id=").concat(t._pageContext.relatedGroupId,"&Target=").concat(t._pageContext.isTeamsConnectedSite?"TEAM":"TEAMSWEBAPP"),"_blank")},this._onGoToMembersClick=function(e){l.Engagement.logData({name:"SiteHeader.GoToMembers.Click"}),t._params.goToMembersOnClick(e),e&&(e.stopPropagation(),e.preventDefault())},this._onCreateSiteClick=function(e){l.Engagement.logData({name:"SiteHeader.CreateSite.Click"}),t._params.createSiteOnClick&&t._params.createSiteOnClick(e),e&&(e.stopPropagation(),e.preventDefault())},this._onUserExpirationDismissClick=function(e){l.Engagement.logData({name:"SiteHeader.UserExpirationMessageBarDismiss.Click"}),t.setState({hideUserExpirationBar:!0})},this._onFollowClick=function(e){l.Engagement.logData({name:"SiteHeader.Follow.Click"});var n=t._params.siteHeader.state.followState;t.setState({followState:o.e.transitioning}),n===o.e.followed?t._followDataSource.unfollowSite(t._pageContext.webAbsoluteUrl).done(function(){t.setState({followState:o.e.notFollowing})},function(e){t.setState({followState:o.e.followed})}):t._followDataSource.followSite(t._pageContext.webAbsoluteUrl).done(function(){t.setState({followState:o.e.followed})},function(e){t.setState({followState:o.e.notFollowing})})},this._getUrlFromEnum=function(e,n){var a=n[N[e].name];return a||e!==r.e.site||(a=t._params.pageContext.webAbsoluteUrl),a},this._updateUsageGuidelineCallback=function(){t._noThrowPromise(t._updateUsageGuidelineUrl()).then(function(e){e&&e.usageGuidelineUrl&&t.setState({usageGuidelineUrl:e.usageGuidelineUrl})})},this._params=e;var n=e.pageContext;this._pageContext=n,this._isGroup=Object(p.r)(n),this._async=new l.Async,this._asyncFetchTopNav=!1,this._isNavigationSwitcherEnabled=k.e(F,this._pageContext,{killSwitch:"39702562-b8cb-4062-acff-022dc2cb0606"}),this._isAnonymousGuest=n.isAnonymousGuestUser||n.isEmailAuthenticationGuestUser,this._isGuest=this._isAnonymousGuest||n.isExternalGuestUser,this._hasManageLists=E.e.hasPermission(n.webPermMasks,E.e.manageLists),this._chrome=Object(c.e)(this._pageContext);var a,i="";this.shouldUseSiteIconManager(n)?(i="".concat(n.webAbsoluteUrl,"/_api/siteiconmanager/getsitelogo?type='1'"),n.headerLogoHash&&(i+="&hash=".concat(n.headerLogoHash))):i=e.pageContext.webLogoUrl;var s=e.pageContext.webAbsoluteUrl;s&&(a=function(t){l.Engagement.logData({name:"SiteHeader.Logo.Click"}),e.logoOnClick&&(e.logoOnClick(s,t),t.stopPropagation(),t.preventDefault())});var d=this._setupHorizontalNav(),u=this._isGroup?"".concat(n.webAbsoluteUrl,"/_layouts/15/groupstatus.aspx?id=").concat(n.groupId,"&target=conversations"):void 0;this._params.siteHeader.state={membersText:void 0,siteClassification:this._getSiteClassification(),usageGuidelineUrl:void 0,siteLogoUrl:i,horizontalNavItems:d,logoOnClick:a,webAbsoluteUrl:s,outlookUrl:u,showCreateSiteButton:!1},z()&&!i&&(this._acronymDatasource=this._params.acronymDatasource||new m.e(n))}return e.prototype.componentDidMount=function(){var e=this,t=[this._isGroup||z()&&!this._acronymDatasource?l.Promise.resolve(void 0):this._noThrowPromise(this._loadSiteAcronym()),this._noThrowPromise(this._setupSiteReadOnlyBar()),this._noThrowPromise(this._setupSiteResourceQuotaBar()),this._noThrowPromise(this._setupFollowButton()),this._noThrowPromise(this._setupUserExpirationBar()),this._noThrowPromise(this._processGroups()),this._noThrowPromise(this._setupCreateSiteButton()),this._noThrowPromise(this._setupSiteStatusBar()),this._noThrowPromise(this._setupSitePolicyBar()),this._noThrowPromise(this._setupFraudTenantBar()),this._noThrowPromise(this._fetchTopNavigation()),this._noThrowPromise(this._setupNoSharePointSyntexLicenseBar()),this._noThrowPromise(this._syncTeamSiteSettings())];l.Promise.all(t).then(function(t){var n={};t.forEach(function(e){e&&(n=Object(i.__assign)(Object(i.__assign)({},n),e))}),e.setState(n)}),this._isNavigationSwitcherEnabled&&(this._ensureEventGroup(),this._eventGroup.on(window,"UPDATE_NAV_PLACEMENT",function(t){var n=t.args,i=n.placement,r=n.quickLaunchEnabled,o=i===_.i.HORIZONTAL&&r;if(e._horizontalNavType=o?a.quickLaunch:a.none,o){var s=e._transformToNavItems(e._pageContext.navigationInfo.quickLaunch);e.updateHorizontalNav(s)}}))},e.prototype.componentWillUnmount=function(){this._async.dispose(),this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=null)},e.prototype.getRenderProps=function(e,t,n,i){var r,o,u=this._params,p=u.siteHeader.state,m=u.strings,h=u.pageContext,g=Number(h.webTemplate),v={siteLogoUrl:p.siteLogoUrl,siteAcronym:p.siteAcronym},y=this._computeGoToMembersAction(p.membersUrl),S=p.facepilePersonas?{personas:p.facepilePersonas,getPersonaProps:function(e){return{onRenderCoin:function(a,i){var r,o={personaType:(r=e&&e.data&&e.data.groupPerson)&&2===r.entityType?"Group":"User",identifier:r&&r.email,pageContext:h,moduleLoader:t,customWaiter:n,addGroupMembersCallback:function(e){y(void 0)},lpcHoverTargetProps:{upn:r&&r.email,hostAppPersonaInfo:{PersonaDisplayName:r&&r.name}}};return Object(d.t)(o,i(a))}}}}:{personas:p.facepilePersonas},D={membersText:p.membersText,goToMembersAction:y},I=p.webAbsoluteUrl,x={siteTitle:h.webTitle,headerOptions:this._chrome&&this._chrome.header,groupInfoString:this._getGroupInfoString(h,m),siteClassification:this._getSiteClassification(),siteLogo:v,logoHref:I,logoOnClick:p.logoOnClick,disableSiteLogoFallback:!0,facepile:S,showGroupCard:!!p.groupLinks,groupLinks:p.groupLinks,membersInfoProps:D,moduleLoader:e,lpcModuleLoader:t,lpcModuleLoaderWaiter:n,usageGuidelineUrl:p.usageGuidelineUrl,updateUsageGuidelineUrl:this._updateUsageGuidelineCallback,pageContext:h,groupEmail:p.groupEmail,waitForPLT:this._params.waitForPLT,openTeamsChannel:this._params.openTeamsChannel||this._openTeamsChannel},C=Object(c.e)(this._pageContext),O=!!u.onEditClicked&&!p.isSiteReadOnly&&!this._isAnonymousGuest&&this._hasManageLists&&(!this._isNavigationSwitcherEnabled||C.nav.placement===_.i.HORIZONTAL),w=this._chrome.nav.megaMenuEnabled,A={items:p.horizontalNavItems,editLink:O?Object(s.n)(h,!1,u.onEditClicked,void 0,f.t):void 0,moduleLoader:e,isEditMode:p.isEditMode,ariaLabel:m.horizontalNavAriaLabel||f.e,splitButtonAriaLabel:f.a,moreOptionsAriaLabel:m.horizontalNavMoreOptionsAriaLabel||f.n,hasSelectedState:this._horizontalNavType===a.quickLaunch,pageContext:this._pageContext,useMegaMenu:w};h&&h.navigationInfo&&h.navigationInfo.isAudienceTargeted&&(A.isAudienceTargeted=!0),this._horizontalNavType===a.quickLaunch?r=A:this._horizontalNavType===a.globalNav&&(o=A);var L=void 0!==p.followState?{followLabel:m.follow,followAction:this._onFollowClick,followState:p.followState,followedAriaLabel:m.followButtonAriaLabel,notFollowedAriaLabel:m.followButtonAriaLabel,followedHoverText:m.followedHover,notFollowedHoverText:m.notFollowedHover,notFollowedLabel:m.notFollowed}:void 0,k={pageContext:h,moduleLoader:i,moduleLoaderWaiter:n,imageUrls:this._params.imageUrls},M=void 0;this._isAnonymousGuest||!E.e.hasPermission(this._pageContext.webPermMasks,E.e.editListItems)||h.groupId&&"00000000-0000-0000-0000-000000000000"!==h.groupId||(M={url:h.webAbsoluteUrl+"/_layouts/15/share.aspx?isDlg=1&OpenInTopFrame=1",shareLabel:m.shareLabel,loadingLabel:m.loadingLabel},u.shareButtonOnClick&&(M.url="",M.onShare=u.shareButtonOnClick));var P,T=p.showCreateSiteButton?{createSiteAction:this._onCreateSiteClick}:void 0;p.isSiteReadOnly?(P={isSiteReadOnly:!0,siteReadOnlyString:m.siteIsReadOnly,siteReadOnlyState:p.siteReadOnlyState,siteIsMovingString:m.siteIsMoving,siteMoveCompletedString:m.siteMoveComplete},h.isArchived&&g===b.e.teamChannel&&(P.siteReadOnlyString=m.siteIsArchived)):P=void 0;var U=void 0;0!==p.siteResourceQuotaState&&(U={siteResourceQuotaState:p.siteResourceQuotaState,siteResourceOverQuota:m.siteIsOverQuota,siteResourceQuotaWarning:m.siteIsCloseToQuota});var F=l.Killswitch.isActivated("F88CC3D7-8906-4639-A8FD-DE719C2446F9","2/16/2021","Add create site action to composite header props")?null:{createSiteAction:this._onCreateSiteClick},H=this._horizontalNavType===a.quickLaunch?_.n.FULLBLEED:void 0,R=l.FeatureOverrides.isFeatureEnabled({ODB:1179})?this._pageContext.headerLayout:void 0,N=!p.hideUserExpirationBar&&p.expiringUsers>0&&{userExpirationOnClick:this._params.userExpirationOnClick,onDismiss:this._onUserExpirationDismissClick,expiringUserCount:p.expiringUsers};return{siteHeaderProps:x,horizontalNavProps:r,topNavProps:o,onRenderHorizontalNav:u.onRenderHorizontalNav,createSiteButton:T,shareButton:M,follow:L,siteScriptProgressIndicator:k,messageBarProps:p.messageBarState,siteReadOnlyProps:P,siteResourceQuotaProps:U,policyBarProps:p.policyBarState,fraudTenantBarProps:p.fraudTenantBarState,noSharePointSyntexLicenseBarProps:p.noSharePointSyntexLicenseBarState,layout:H,unifiedLayout:R,userExpirationBarProps:N,getAccessToken:u.getAccessToken,groupsProvider:this._groupsProvider,createSiteAction:F}},e.prototype.updateHorizontalNav=function(e,t){this.setState({horizontalNavItems:e,editModeHorizontalNav:!1},t)},e.prototype._getGroupInfoString=function(e,t){var n;if(this._isGroup)n="Public"===e.groupType?t.publicGroup:t.privateGroup;else if(e.isTeamsChannelSite||Number(e.webTemplate)===b.e.teamChannel){var a=e.teamsChannelType;n=3===a?t.standardChannel:2===a?t.sharedChannel:t.privateChannel}return n},e.prototype._computeGoToMembersAction=function(e){var t=void 0;return this._isGuest||(t=this._onGoToMembersClick),t},e.prototype.setState=function(e,t){this._params.siteHeader.setState(e,t)},e.prototype._noThrowPromise=function(e){return e.catch(function(){})},e.prototype.shouldUseSiteIconManager=function(e){return e.webLogoUrl||e.webLogoUrl.indexOf(p.e)>=0||this.containsSiteAssetsRelativePath(e)||this._isGroup},e.prototype.containsSiteAssetsRelativePath=function(e){return e.webLogoUrl&&e.webAbsoluteUrl&&e.webLogoUrl.toLowerCase().indexOf(e.webAbsoluteUrl.toLowerCase()+"/siteassets")>=0},e.prototype._loadSiteAcronym=function(){return this._acronymDatasource.getAcronymData(this._pageContext.webTitle).then(function(e){return{siteAcronym:e.acronym,siteLogoColor:e.color}})},e.prototype._setupHorizontalNav=function(){var e,t=this._pageContext,n=t.navigationInfo,i=n&&n.quickLaunch,r=n&&n.topNav,o=this._chrome.nav.placement===_.i.HORIZONTAL,s=a.none;return o&&this._params.horizontalQuickLaunchEnabled&&i&&i.length?(e=i,s=a.quickLaunch):t.isHubSite?s=a.none:t.PublishingFeatureOn?(this._asyncFetchTopNav=!0,s=a.globalNav):r&&r.length&&(!l.Killswitch.isActivated("15979AEF-B71B-4125-B81E-DB0332B5ED14","12/2/2021","Hide global nav on non-hub homesite")&&t.isGlobalNavEnabled&&Object(p.o)(t)?s=a.none:(s=a.globalNav,e=r)),this._horizontalNavType=s,this._transformToNavItems(e)},e.prototype._syncTeamSiteSettings=function(){var e=this;return l.Features.isFeatureEnabled(U)&&this._pageContext.isTeamsChannelSite&&this._params.getSiteDataSource?this._params.getSiteDataSource().then(function(t){t.GetTeamSiteData().then(function(n){e._pageContext.themeCacheToken===n.ThemeToken&&e._pageContext.headerEmphasis===n.HeaderEmphasis||t.SyncTeamSiteSettings()})}):l.Promise.resolve(void 0)},e.prototype._fetchTopNavigation=function(){return this._asyncFetchTopNav?new A.e(this._pageContext,"GlobalNavigationSwitchableProvider").getMenuState({useCache:!0,depth:3}).then(function(e){if((!V||e)&&e.links)return{horizontalNavItems:e.links}}):l.Promise.resolve(void 0)},e.prototype._transformToNavItems=function(e){var t=this,n=[];if(e&&e.length>0){var i=this._horizontalNavType===a.quickLaunch;n=A.e.transformNodesToLinks(e,function(e,n){(!n||""!==n.url&&n.url!==s.t)&&t._params.topNavNodeOnClick(e,n),e.stopPropagation(),e.preventDefault()},function(e,t){return t>0||!(i&&e.Id===Number("1033"))})}return n},e.prototype._processGroups=function(){var e=this;return this._isGroup?this._params.getGroupsProvider().then(function(t){return t&&(e._groupsProvider=t,e._groupsProvider.group)?(e._groupsProvider.group.membership.load(),e._updateGroupsInfo()):l.Promise.resolve(void 0)}):l.Promise.resolve(void 0)},e.prototype._updateGroupsInfo=function(){var e,t,n,a=this,r={};if(this._isGroup){var o=this._groupsProvider.group,s=function(e){var t={};if(e!==h.e.None&&o.membership&&a._totalNumberOfMembers!==o.membership.totalNumberOfMembers){var n=a._updateFacepilePersonas(o.membership),r=a._getMembersText(o.membership);a._totalNumberOfMembers=o.membership.totalNumberOfMembers,t=Object(i.__assign)(Object(i.__assign)({},t),{membersText:r,facepilePersonas:n})}return l.Promise.resolve(t)},c=function(r){var s={};if(r!==h.e.None&&!a._hasParsedMembers){a._hasParsedMembers=!0,n=a._getSiteClassification(),e=a._isGuest?void 0:o.inboxUrl,t=a._isGuest?void 0:o.membersUrl;var c=a._groupCardLinksFromGroupCardLinkParams(a._params.groupCardInfo,o);if(s={siteClassification:n,outlookUrl:e,membersUrl:t,groupLinks:c,groupEmail:o.mail},!z()||a._acronymDatasource)return a._noThrowPromise(a._loadSiteAcronym()).then(function(e){return Object(i.__assign)(Object(i.__assign)({},e),s)})}return l.Promise.resolve(s)};return this._ensureEventGroup(),this._eventGroup.on(o,"source",function(e){c(e).then(function(e){a.setState(e)})}),this._eventGroup.on(o.membership,"source",function(e){s(e).then(function(e){a.setState(e)})}),l.Promise.all([c(o.source),s(o.membership.source)]).then(function(e){return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},e[0]),e[1]),r)})}return l.Promise.resolve(r)},e.prototype._ensureEventGroup=function(){this._eventGroup||(this._eventGroup=new l.EventGroup(this))},e.prototype._groupCardLinksFromGroupCardLinkParams=function(e,t){var n=[];if(this._isGroup&&t&&e&&e.length){for(var a=0;a<e.length;a++){var i=e[a].linkType,r=this._getUrlFromEnum(i,t);if(r&&(!this._isAnonymousGuest||!N[i].trimIfAnonymous)){var o="GroupCard."+N[i].eid+".Click";n.push({title:e[a].title,icon:e[a].icon,href:r,engagementId:o})}}return n}return null},e.prototype._updateUsageGuidelineUrl=function(){var e=this;return!Object(p.i)(this._pageContext)&&this._getSiteClassification()&&this._params.getGroupSiteProvider?this._params.getGroupSiteProvider().then(function(t){e._groupSiteProvider=t}).then(function(){var t;return e._groupSiteProvider&&(t=e._groupSiteProvider.getGroupCreationContext()),t}).then(function(e){return{usageGuidelineUrl:e.usageGuidelineUrl}}):l.Promise.resolve(void 0)},e.prototype._getHubDataSource=function(){var e=this;return this._hubDataSource?l.Promise.as(this._hubDataSource):Promise.resolve().then(n.bind(null,"bugI")).then(function(t){return e._hubDataSource=new t.default(e._pageContext),e._hubDataSource})},e.prototype._setupCreateSiteButton=function(){var e=this;if(l.FeatureOverrides.isFeatureEnabled(M)){var t=this._params.waitForPLT;if(t)return t.then(function(){return e._getHubDataSource()}).then(function(t){return function(e,t){return l.FeatureOverrides.isFeatureEnabled(u)&&t&&e&&e.isHubSite?t.canCreateHubJoinedSite(e.hubSiteId):l.Promise.resolve(!1)}(e._pageContext,t)}).then(function(e){return{showCreateSiteButton:!!e}})}return l.Promise.resolve(void 0)},e.prototype._setupFollowButton=function(){var e=this;return this._isGuest?l.Promise.resolve(void 0):(this._followDataSource=this._params.followDataSource||new w(this._pageContext),this._followDataSource.isFollowFeatureEnabled().then(function(t){var n;return t?e._followDataSource.isSiteFollowed(e._pageContext.webAbsoluteUrl,!1,!1,e._pageContext.siteId,e._pageContext.webId).then(function(e){return void 0!==e&&(n={followState:e?o.e.followed:o.e.notFollowing}),n}):{followState:void 0}}))},e.prototype._setupSiteStatusBar=function(){return this._params.getSiteDataSource?this._params.getSiteDataSource().then(function(e){return e.getStatusBarInfo()}).then(function(e){return e.StatusBarText?{messageBarState:{message:e.StatusBarText,linkText:e.StatusBarLinkText,linkTarget:e.StatusBarLinkTarget}}:l.Promise.resolve(void 0)}):l.Promise.resolve(void 0)},e.prototype._setupSitePolicyBar=function(){if(this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled||this._pageContext.m365GroupsBlockDownloadsExperienceEnabled||this._pageContext.readOnlyExperienceEnabled){var e=void 0;return e=this._params.strings.authenticationPolicyActive&&this._params.strings.messageBarMoreInfo?{message:this._params.strings.authenticationPolicyActive,linkText:this._params.strings.messageBarMoreInfo,linkTarget:"http://go.microsoft.com/fwlink/p/?LinkId=823640"}:{message:void 0,linkText:void 0,linkTarget:void 0},l.FeatureOverrides.isFeatureEnabled(H)&&this._pageContext.m365GroupsBlockDownloadsExperienceEnabled&&(e={message:this._params.strings.blockDownloadPolicyActive,linkText:void 0,linkTarget:void 0}),l.FeatureOverrides.isFeatureEnabled(R)&&this._pageContext.readOnlyExperienceEnabled&&(e={message:this._params.strings.readOnlyAccessPolicyActive,linkText:void 0,linkTarget:void 0}),l.Promise.resolve({policyBarState:e})}return l.Promise.resolve(void 0)},e.prototype._setupFraudTenantBar=function(){var e;return l.Features.isFeatureEnabled(T)&&this._pageContext.isFraudTenant?(e=this._params.strings.fraudTenantActive&&this._params.strings.messageBarMoreInfo&&void 0!==this._pageContext.fraudTenantAccessRevokeTime?{message:L.format(this._params.strings.fraudTenantActive,this._fetchTimestampFormat(this._pageContext.fraudTenantAccessRevokeTime)),linkText:this._params.strings.messageBarMoreInfo,linkTarget:"http://go.microsoft.com/fwlink/p/?LinkId=2092321"}:{message:void 0,linkText:void 0,linkTarget:void 0},l.Promise.resolve({fraudTenantBarState:e})):l.Promise.resolve(void 0)},e.prototype._fetchTimestampFormat=function(e){var t=e.split("T")[0],n=e.split("T")[1];return new Date(t).toDateString()+", "+n+" UTC"},e.prototype._setupNoSharePointSyntexLicenseBar=function(){var e=this,t={ODB:1234,ODC:null,Fallback:!1};if(l.Features.isFeatureEnabled({ODB:60031,ODC:null,Fallback:!1})&&Number(this._pageContext.webTemplate)===b.e.contentCenter){var n={noSharePointSyntexLicenseBarState:void 0};if(this._params.getSyntexDataSource)return this._params.getSyntexDataSource().then(function(a){return l.Features.isFeatureEnabled(t)?a.getMachineLearningEnabled().then(function(t){var a;if(!t.MachineLearningCaptureEnabled&&!t.MachineLearningExperienceEnabled){var i=l.Features.isFeatureEnabled({ODB:60049,ODC:null,Fallback:!1}),r=null===(a=e._params.strings)||void 0===a?void 0:a.default;n.noSharePointSyntexLicenseBarState={message:i&&(null==r?void 0:r.noSharePointSyntexLicense)?r.noSharePointSyntexLicense:e._params.strings.noSharePointSyntexLicense,linkText:void 0,linkTarget:void 0}}return n}):a.getMachineLearningCaptureEnabled().then(function(t){var a;if(!t){var i=l.Features.isFeatureEnabled({ODB:60049,ODC:null,Fallback:!1}),r=null===(a=e._params.strings)||void 0===a?void 0:a.default;n.noSharePointSyntexLicenseBarState={message:i&&(null==r?void 0:r.noSharePointSyntexLicense)?r.noSharePointSyntexLicense:e._params.strings.noSharePointSyntexLicense,linkText:void 0,linkTarget:void 0}}return n})})}return l.Promise.resolve(void 0)},e.prototype._setupSiteReadOnlyBar=function(){if(l.Killswitch.isActivated("40EBE94D-11BC-4926-A75E-6827E8FB6CD8","8/11/2020","Remove Readonly XHR"))return this._setupSiteReadOnlyBarOld();var e={};return void 0===this._pageContext.readOnlyState?e.siteReadOnlyState=-2:null===this._pageContext.readOnlyState?e.siteReadOnlyState=-1:(e.siteReadOnlyState=this._pageContext.readOnlyState,e.isSiteReadOnly=this._pageContext.readOnlyState>=0),this._pageContext.isArchived&&(e.isSiteReadOnly=!0),l.Promise.resolve(e)},e.prototype._setupSiteReadOnlyBarOld=function(){var e=this;return this._params.getSiteDataSource?this._params.getSiteDataSource().then(function(t){return t.getReadOnlyState().then(function(n){var a={siteReadOnlyState:t.getFullSiteReadOnlyState()};return(n||e._pageContext.isArchived)&&(a.isSiteReadOnly=!0),a})}):l.Promise.resolve(void 0)},e.prototype._setupSiteResourceQuotaBar=function(){var e={siteResourceQuotaState:this._pageContext.resourceQuotaExceeded};return l.Promise.resolve(e)},e.prototype._setupUserExpirationBar=function(){var e=this,t=this._pageContext.isSiteAdmin&&l.Features.isFeatureEnabled(P);return this._params.userExpirationOnClick&&this._params.getUserExpirationProvider&&t?this._userExpirationProvider?this._userExpirationProvider.getUsersWithExpirations("UserExpiration",!0,50,0,void 0).then(function(t){return e._countExpiringUsers(t)}).then(function(e){if(e>0)return{expiringUsers:e}}):this._params.getUserExpirationProvider().then(function(t){e._userExpirationProvider=t}).then(function(){return e._userExpirationProvider.getUsersWithExpirations("UserExpiration",!0,50,0,void 0).then(function(t){return e._countExpiringUsers(t)}).then(function(e){if(e>0)return{expiringUsers:e}})}):l.Promise.resolve(void 0)},e.prototype._countExpiringUsers=function(e){var t=0,n=new Date,a=new Date(n.getTime()+18144e5);return e.forEach(function(e){e.expiration<a&&!(e.isSiteAdmin&&e.expiration<n)&&t++}),t},e.prototype._getMembersText=function(e){var t=e.totalNumberOfMembers;if(t){var n=this._params.strings,a=L.getLocalizedCountValue(n.membersCount,n.membersCountIntervals,t);return L.format(a,t)}},e.prototype._updateFacepilePersonas=function(e){return e.membersList.members.slice(0,3).map(function(e,t){return{personaName:e.name,imageUrl:e.image,data:{groupPerson:e,personaType:e.entityType},"data-automationid":"SiteHeaderFacepilePersona_"+t.toString()}})},e.prototype._getSiteClassification=function(){return l.Killswitch.isActivated("149A9D34-BEC1-4FD1-950C-8E5CB81348D2","03-17-2021","Fix classification for channels.")?this._getSiteClassificationOld():(this._pageContext&&(e=this._pageContext.sensitivityLabelName),!e&&this._groupsProvider&&this._groupsProvider.group&&(t=this._groupsProvider.group.classification),e||t||this._pageContext&&this._pageContext.siteClassification);var e,t},e.prototype._getSiteClassificationOld=function(){var e,t;return this._groupsProvider&&this._groupsProvider.group&&(this._pageContext&&(e=this._pageContext.sensitivityLabelName),e||(t=this._groupsProvider.group.classification)),e||t||this._pageContext&&this._pageContext.siteClassification},e}();function V(){return l.Killswitch.isActivated("1cd2d1c9-fdc8-4110-a71e-e8125063dd90","2020-09-01","Refine the audience targeting logging")}function z(){return!l.Killswitch.isActivated("4f8452f7-e57d-4fcd-978c-fb72127955a9","09/08/2020","Skip call to get acronym if cusotm site logo exists")}t.default=j},OpjN:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Cache=0]="Cache",e[e.Server=1]="Server",e[e.None=2]="None",e[e.Error=3]="Error"}(a||(a={}))},Vlqv:function(e,t,n){"use strict";n.d(t,"e",function(){return x});var a,i,r=n("17wl"),o=n("K9kD"),s=n("85Bv"),c=n("71k8"),d=n("3HEj"),l=n("NacN"),u={ODB:60340},f="c8b3137a-ca4c-48a9-b356-a8e7987dd693",p="96c933ac-3698-44c7-9f4a-5fd17d71af9e",m="6142d2a0-63a5-4ba0-aede-d9fefca2c767",_="f6cc5403-0d63-442e-96c0-285923709ffc",h="400955b3-329f-4b22-ade5-002653506aee",b="fbf8ec01-846c-44c4-b17b-8fe1e4e5adae",g="ab120c41-0d36-490b-a048-b39f65675858",v="67f52693-99aa-428d-8670-0b1b2d291aa8",y="5e8b2de3-2f17-43a2-b020-2f666b2891c9",S="ab407e62-bf10-4e8a-aa2e-af77c5a94634",D=((a={})[c.t.teamSite]=f,a[c.t.group]=f,a[c.t.sitePagePublishing]=p,a[c.t.pointPublishingPersonal]=h,a[c.t.contentCenter]=g,a[c.t.teamChannel]=y,a[c.t.mySite]=S,a),I=((i={})[f]=function(){return{id:f,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.LEFT},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[c.t.teamSite,c.t.group]}},i[p]=function(){return{id:p,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!0}},supportedTemplates:[c.t.sitePagePublishing]}},i[m]=function(){return{id:m,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!0}},supportedTemplates:[c.t.sitePagePublishing]}},i[_]=function(){return{id:_,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!0}},supportedTemplates:[c.t.sitePagePublishing]}},i[h]=function(){return{id:h,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.LEFT,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[c.t.pointPublishingPersonal]}},i[b]=function(){return{id:b,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[c.t.sitePagePublishing]}},i[g]=function(){return{id:g,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[c.t.contentCenter]}},i[v]=function(){return{id:v,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[c.t.contentCenter]}},i[y]=function(){return{id:y,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:l.r.none},nav:{hidden:!1,placement:l.i.LEFT,megaMenuEnabled:!1},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[c.t.teamChannel]}},i[S]=function(){return{id:S,title:void 0,description:void 0,chromeOptions:{header:{hidden:!0,layout:l.r.none},nav:{hidden:!0,placement:l.i.HORIZONTAL,megaMenuEnabled:!1},footer:{hidden:!0},search:{hidden:!1}},supportedTemplates:[c.t.mySite]}},i);function x(e){var t,n=function(e){if(!e)throw new Error("pageContext missing");var t=function(e){var t,n=o.Guid.Empty;return e.DesignPackageId&&(t=e.DesignPackageId,void 0!==I[t])&&(n=e.DesignPackageId),n===o.Guid.Empty&&void 0!==D[e.webTemplate]&&(n=D[e.webTemplate]),n===o.Guid.Empty&&(n=f),n}(e);return Object(r.__assign)(Object(r.__assign)({},I[t]().chromeOptions),{footer:{emphasis:l.e.Strong,hidden:!0,layout:l.t.SIMPLE}})}(e),a=(e.webPropertyFlags2&d.t.FooterEmphasis1)>>8,i=(e.webPropertyFlags2&d.t.FooterEmphasis0)>>8;n.footer.emphasis=a|i;var p=(e.webPropertyFlags2&d.t.FooterLayout1)>>10,m=(e.webPropertyFlags2&d.t.FooterLayout0)>>10;if(n.footer.layout=p|m,n.footer.hidden=0==(2&e.webPropertyFlags2),n.nav&&!n.nav.hidden){if(n.nav.megaMenuEnabled=0!=(128&e.webPropertyFlags2),o.Killswitch.isActivated("93B26AAC-7D48-4AE2-9471-5A0B485A6066","10/14/2021","Preserve quickLaunch on Publishing sites."))n.nav.quickLaunchEnabled=!!(null===(t=e.navigationInfo)||void 0===t?void 0:t.quickLaunch);else{var _=e.navigationInfo;_&&(n.nav.quickLaunchEnabled=!!_.quickLaunch)}if(s.e(u,e,{killSwitch:"39702562-b8cb-4062-acff-022dc2cb0606"})&&[c.t.teamSite,c.t.group].indexOf(Number(e.webTemplate))>-1){var h=1==(e.webPropertyFlags2&d.t.HorizontalQuickLaunch);n.nav.placement=h?l.i.HORIZONTAL:l.i.LEFT,e.PublishingFeatureOn&&(n.nav.placement=l.i.LEFT)}}n.header.layout=e.headerLayout,n.header.emphasis=e.headerEmphasis,n.header.logoAlignment=e.logoAlignment;var b=0!=(e.webPropertyFlags2&d.t.HideTitleInHeader);return n.header.hideTitle=b,n}}}]);