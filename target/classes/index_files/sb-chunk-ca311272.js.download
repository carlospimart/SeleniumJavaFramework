(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["pro-spnews"],{irXh:function(e,t,r){"use strict";r.r(t);var n=r("D57K"),s=r("UlRC"),a=r("rpSO"),i=r("KmCS"),u=r("XgOi"),o=(r("Jvpx"),r("RkML")),c=r("f+c0");var l=r("zdki"),d=r.n(l),h="suxrid";var p=r("W6XZ");var f="LastModifiedTime";var g,m=function(){var e=new Date;e.setFullYear(e.getFullYear()-1);var t=new Date;t.setMonth(t.getMonth()-3);var r=new Date;r.setMonth(r.getMonth()-1);var n=new Date;n.setDate(n.getDate()-7);var s=new Date;return s.setDate(s.getDate()-1),[e,t,r,n,s].map(function(e){return e.toISOString()})}();var b=r("kKJH"),S=r("iI/e"),v=r("hV4J"),O=r("PtyX"),j=r("D/8p"),q=r("QZnE"),y=r("hTSy"),k=r("CVAo"),x=r("D7WJ"),I={},w=[],T=Object(x.b)("measure")?function(e,t,r){try{window.performance.measure(e,t,r)}catch(e){return null}var n=window.performance.getEntriesByName(e,"measure");return n.length>0?n[n.length-1]:null}:function(e,t,r){var n=I[t],s=r?I[r]:Object(x.a)();return n&&s?{duration:s-n,entryType:"measure",name:e,startTime:n,toJSON:function(){return null}}:null},R=Object(x.b)("mark")?window.performance.mark.bind(window.performance):function(e){w.push({entryType:"mark",name:e,startTime:x.c,duration:0,toJSON:function(){return null}}),I[e]=Object(x.a)()},D=(Object(x.b)("getEntriesByType")&&window.performance.getEntriesByType.bind(window.performance),Object(x.b)("getEntriesByName")&&window.performance.getEntriesByName.bind(window.performance),r("JlzF")),_=r("xOCl"),L=r("txiW");function C(e){var t="".concat(e,"-start-").concat(F),r="".concat(e,"-end-").concat(F);R(t);var n=Object(x.a)(),s=E(),a=!1;return function(i){if(void 0===i&&(i=!0),!a){a=!0,R(r),i&&T("".concat(e,"-").concat(s),t,r);var u=Object(x.a)();return{name:e,startName:t,endName:r,duration:u-n,start:n,end:u}}}}var F=0;function E(){return F++}function P(e){var t="".concat(e,"-").concat(E());return R(t),{name:t,time:Object(x.a)()}}!function(){function e(e,t,r){void 0===e&&(e=!1),void 0===t&&(t=[]),void 0===r&&(r=Object(k.a)()),this.firstSearch=e,this.excludedErrorSources=t,this.id=r,this.ended=!1,this.sessionStartMark=P("session-start"),this.numRequests=0,this.numDataRequests=0,this.requests=[],this.dataRequests=[],this.sessionFailures=[]}e.prototype.getId=function(){return this.id},e.prototype.fetchStart=function(){return this.fetchStartMark=P("fetch-start")},e.prototype.request=function(e){var t=this;this.numRequests++;var r=C("request-".concat(e));return function(){return t.requests[t.requests.push(r(!1))-1]}},e.prototype.dataRequest=function(e){var t=this;this.numDataRequests++;var r=C("data-request-".concat(e));return function(){return t.dataRequests[t.dataRequests.push(r(!1))-1]}},e.prototype.setStateStart=function(){return this.setStateStartMark=P("set-state-start")},e.prototype.setStateEnd=function(){if(this.numRequests!==this.requests.length)throw new Error("Not all requests have been measured.");if(this.numDataRequests!==this.dataRequests.length)throw new Error("Not all data requests have been measured.");if(this.ended)return this.statistics;this.ended=!0;var e=P("session-end"),t=z("request-overhead-time",this.requests),r=t?t.latestStartedRequest.start:-1,n=t?t.latestStoppedRequest.end:-1,s=z("request-data-time",this.dataRequests),a=s?s.latestStartedRequest.start:-1;(t||s)&&T("client-overhead-".concat(E()),this.fetchStartMark.name,(t||s).latestStartedRequest.startName);var i=s?(T("process-data-time-".concat(E()),s.latestStoppedRequest.endName,this.setStateStartMark.name),T("client-overhead-".concat(E()),s.latestStoppedRequest.endName,e.name),s.latestStoppedRequest.end):-1;T("render-time-".concat(E()),this.setStateStartMark.name,e.name),T("session-".concat(E()),this.sessionStartMark.name,e.name);var u=this.sessionStartMark.time,o=this.setStateStartMark.time,c=e.time,l=this.requests.length,d=this.dataRequests.length,h=e.time;return this.statistics={id:this.id,firstSearch:this.firstSearch,overheadRequestCount:l,dataRequestCount:d,sessionStartTime:u,searchInitiationTime:-1,fetchStartTime:this.fetchStartMark.time,requestOverheadStartTime:r,requestDataStartTime:a,requestDataEndTime:i,setStateStartTime:o,setStateEndTime:c,sessionEndTime:h,sessionDuration:h-u,preClientOverheadDuration:Object(D.a)([r,a,o].filter(function(e){return-1!==e}))-u,requestOverheadDuration:l?Object(_.a)([n,a].filter(function(e){return-1!==e}))-r:0,requestDataDuration:d?i-a:0,dataProcessingDuration:d?o-i:l?o-n:0,renderDuration:c-o}},e.prototype.addFailure=function(e){var t=e.correlationId,r=e.errorCode,n=e.errorSource,s=e.errorDescription,a=e.isPageFailure,i=e.isPartialFailure,u=e.diagnosticDetails;return-1===this.excludedErrorSources.indexOf(n)&&this.sessionFailures.push({correlationId:t,errorCode:r,errorSource:n,errorDescription:s,isPageFailure:a,isPartialFailure:i,diagnosticDetails:u}),this.sessionFailures[this.sessionFailures.length-1]},e.prototype.getFailures=function(){return this.sessionFailures}}();function z(e,t){if(!t.length)return null;var r=Object(L.a)(t,function(e){return e.start}),n=Object(L.a)(t,function(e){return e.end});return T("".concat(e,"-").concat(E()),r.startName,n.endName),{latestStartedRequest:r,latestStoppedRequest:n}}var N={getId:M,fetchStart:M,request:A,dataRequest:A,setStateStart:M,setStateEnd:M,addFailure:M,getFailures:M};function M(){return null}function A(){return M}var B=["token","digest","session"];var H={session:function(){return N}},J=r("eTzd"),U=r("qDPO"),X=function(e){function t(t){var r=t.id,n=t.version,s=t.refreshIntervalMs,a=t.ignoreCache,i=t.microserviceFlights,u=t.refine,o=e.call(this,{id:r,version:n,refreshIntervalMs:s,ignoreCache:a,microserviceFlights:i})||this;return o._refine=!1,o.requestType="data",o._refine=u,o}return Object(n.__extends)(t,e),t.prototype.fetchItem=function(e,t){var r=this;void 0===t&&(t=H);var s,a,i,u=function(e){return Object(v.a)(Object(O.a)(Object(j.a)(Object(q.a)(Object(y.a)(e,B)).filter(function(e){var t=Object(n.__read)(e,2);t[0];return"function"==typeof t[1]})),function(e){return e()}),{session:N})}(t);e.query+=this._refine?"&Refiners='".concat((g||(g="LastModifiedTime(discretize=manual/".concat(m.join("/"),")")),g),"'"):"",e.query=(s=e.query,a=this.getId(),(i=new d.a(s||"")).setQueryParameter(h,a),i.toString());var o=this.createRequest(e.query,u).selectMany(function(e){return U.a.CreateObservableSPResponseFromXHR(e,r.parseResponse.bind(r))});return U.a.applyToBody(o,function(e){return r.map(e,u)})},t.prototype.createRequest=function(e,t){var r=this,n=t.token,s=t.session;return"token"in t?Object(S.a)(this.createOptions(e,n)).stopPerfMeasure("data"===this.requestType?s.dataRequest(this.getId()):s.request(this.getId())):Object(b.a)(Object(J.g)(),function(){return r.createOptions(e,n)})},t.prototype.createOptions=function(e,t){return{url:e,method:"GET",headers:Object(n.__assign)({Accept:"application/json;odata=verbose"},t?{Authorization:"Bearer ".concat(t)}:{})}},t.prototype.map=function(e,t){throw new Error("Not implemented.")},t}(U.b),G=r("sUxJ"),Q=r("ncub"),W=r("OJcW"),K=r("lJaw"),V=(r("dOPi"),["ai","bmp","gif","heic","ico","jpeg","jpg","png","svg","tiff","tif","webp"]),Y=V.concat(["dib","eps","odg","rle","psd","wmf","wpd"]),Z=["ai","webp"];V.filter(function(e){return Z.indexOf(e)<0});var $={docx:["doc","docx","docm","dot","dotx"],xlsx:["xls","xlsx","xlsm","xlsb","xltm","xlam"],pptx:["ppt","pptx","pptm"],video:["wmv","avi","mpg","asf","mp4","ogg","ogv","webm","mov"],photo:Y,pdf:["pdf"],one:["one"],html:["aspx"]},ee="0x0120";var te="ContentTypeId:".concat("0x0101009D1CB255DA76424F860D91F20E6C4118","* AND PromotedState:2");function re(e,t){return void 0===t&&(t=""),e.map(function(e){return e&&e.expression}).filter(function(e){return!Object(W.b)(e)}).join(" "+t+" ")}function ne(e,t){var r="(";return t.forEach(function(n,s){r+=e+":"+n,r+=s!==t.length-1?" OR ":")"}),r}var se=function(e){return e?{expression:'Path:"'.concat(e,'/"'),description:"Scoping search to a site using Path"}:{expression:""}},ae=function(e){return e?{expression:ne("DepartmentId",[e,e.replace(/[{}]/g,"")]),description:"Scoping search to a department/hub-site using DepartmentId"}:{expression:""}};var ie=function(e,t){return e&&t?{expression:"(DepartmentId:".concat(e," OR DepartmentId:").concat(e.replace(/[{}]/g,"")," OR RelatedHubSites:").concat(e.replace(/[{}]/g,""),")"),description:"Scoping search to a department and hub-sites using DepartmentId and RelatedHubSites"}:{expression:""}};function ue(e,t,r,n){return t&&e?r?ie(e,r):ae(e):se(n)}var oe=r("o2F0"),ce=["".concat(ee,"*")],le=[oe.a,"".concat(oe.b,"*")],de=("".concat(ne("Title",["OneNote_DeletedPages","OneNote_RecycleBin"])),"".concat(ne("ContentClass",["STS_List_544","STS_ListItem_544"])),"(".concat(ne("filetype",K.b),")"),"(".concat(ne("ContentTypeId",le))," OR ".concat(ne("SecondaryFileExtension",$.video),")"),"".concat(ne("FileType",$.photo)),"".concat(ne("ContentTypeId",ce)),{expression:"(".concat(te,")"),description:"News articles"}),he=function(e){return{expression:"(SPTranslationLanguage:".concat(e," OR(NOT SPTranslatedLanguages:").concat(e," AND NOT SPIsTranslation:true))"),description:"Show pages in your language or those that are not translated to your language"}};"".concat(ne("ContentClass",["STS_ListItem_GenericList","STS_ListItem_Events","STS_ListItem_Contacts","STS_ListItem_851","STS_ListItem_Categories"]));var pe={af:null,am:null,ar:"ar-sa","ar-sa":"ar-sa","as-in":null,"az-latn-az":"az-latn-az","be-by":null,bg:"bg-bg","bg-bg":"bg-bg","bn-in":null,"bn-bd":null,"bs-latn-ba":"bs-latn-ba",ca:"ca-es","ca-es":"ca-es","ca-es-valencia":"ca-es",cs:"cs-cz","cs-cz":"cs-cz",cy:"cy-gb","cy-gb":"cy-gb",da:"da-dk","da-dk":"da-dk",de:"de-de","de-de":"de-de",el:"el-gr","el-gr":"el-gr","en-gb":"en-us","en-us":"en-us",es:"es-es","es-es":"es-es","es-mx":"es-es",et:"et-ee","et-ee":"et-ee",eu:"eu-es","eu-es":"eu-es",fa:null,fi:"fi-fi","fi-fi":"fi-fi",fil:null,fr:"fr-fr","fr-ca":"fr-fr","fr-fr":"fr-fr","ga-ie":"ga-ie","gd-gb":null,gl:"gl-es","gl-es":"gl-es",gu:null,"ha-latn-ng":null,he:"he-il","he-il":"he-il",hi:"hi-in","hi-in":"hi-in",hr:"hr-hr","hr-hr":"hr-hr",hu:"hu-hu","hu-hu":"hu-hu",hy:null,id:"id-id","id-id":"id-id",is:"null",it:"it-it","it-it":"it-it",ja:"ja-jp","ja-jp":"ja-jp",ka:null,kk:"kk-kz","kk-kz":"kk-kz","km-kh":null,kn:null,ko:"ko-kr","ko-kr":"ko-kr",kok:null,ky:null,"lb-lu":null,"lo-la":null,lt:"lt-lt","lt-lt":"lt-lt",lv:"lv-lv","lv-lv":"lv-lv","mi-nz":null,mk:"mk-mk","mk-mk":"mk-mk",ml:null,"mn-mn":null,mr:null,ms:"ms-my","ms-my":"ms-my","mt-mt":null,"ne-np":null,nl:"nl-nl","nl-nl":"nl-nl","nn-no":"nb-no",no:"nb-no",nb:"nb-no","nb-no":"nb-no",or:null,"pa-in":null,pl:"pl-pl","pl-pl":"pl-pl",prs:"prs-af","prs-af":"prs-af",pt:"pt-pt","pt-pt":"pt-pt","pt-br":"pt-br","quz-pe":null,ro:"ro-ro","ro-ro":"ro-ro",ru:"ru-ru","ru-ru":"ru-ru","sd-arab-pk":null,"si-lk":null,sk:"sk-sk","sk-sk":"sk-sk",sl:"sl-si","sl-si":"sl-si",sq:null,sr:"sr-Latn-rs","sr-Latn-rs":"sr-Latn-rs","sr-cyrl":"sr-cyrl-rs","sr-cyrl-ba":"sr-cyrl-rs","sr-cyrl-rs":"sr-cyrl-rs",sv:"sv-se","sv-se":"sv-se",sw:null,ta:null,te:null,th:"th-th","th-th":"th-th","tk-tm":null,tr:"tr-tr","tr-tr":"tr-tr",tt:null,"ug-cn":null,uk:"uk-ua","uk-ua":"uk-ua",ur:null,uz:null,vi:"vi-vn","vi-vn":"vi-vn","zh-hans":"zh-cn","zh-cn":"zh-cn","zh-hant":"zh-tw","zh-tw":"zh-tw","zu-za":null},fe=r("YXgF"),ge=r("ohlq"),me=Object(i.regs)("searchux.enableQueryRules",!1),be=(Object(i.regs)("searchux.clientSideRelevance",!1,{required:!0,includeInLogs:!0}),Object(i.regs)("searchux.isCrossGeoEnabled",!1,{required:!0,includeInLogs:!0}));Object(i.regs)("searchux.isGuestUser",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.use3sInPeopleVertical",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.noSourceIdForFiles",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.use3SEcho",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.use3SConnectorEcho",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.use3SEchoAnswers",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.3SUDTConnectorsEcho.enable3SUDTConnectorsEcho",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.mergeSpAndOdbFilesForEcho",!0,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.use3SFileSuggestions",!1,{required:!0,includeInLogs:!0}),Object(i.regs)("searchux.use3SPeopleSuggestions",!1,{required:!0,includeInLogs:!0}),Object(i.regs)("searchux.use3SSiteSuggestions",!1,{required:!0,includeInLogs:!0}),Object(i.regs)("searchux.use3SBookmarkSuggestions",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.useSearchApp",!1,{required:!0,includeInLogs:!0}),Object(i.regs)("searchux.useSearchBoxInTheSuiteNav",!1,{required:!1,includeInLogs:!0}),Object(i.regs)("searchux.aadTokenForSubstrate",!1,{required:!1,includeInLogs:!0});var Se;r("aZDo");function ve(){var e=Se&&Se.getState(),t=e&&e.sites;return t?Object(p.a)(t,function(e){return!0===e.isDefaultSite}):null}var Oe=r("qTII"),je=Object(i.regs)("searchux.searchResultsPerPage",15),qe=100,ye=0;function ke(e){var t,r=e.searchText,n=e.pageNumber,s=e.timeRefiner,a=e.sitePath,i=e.departmentId,u=e.isHubSite,o=e.selectProperties,c=e.searchCenterUrl,l=e.relatedHubSites,d=Object(W.b)(s)?"":"&RefinementFilters='"+s+"'";return t=c,(ve()?Object(J.b)():Object(J.e)(t))+"?QueryText='"+Object(fe.a)(r)+"'&QueryTemplate='"+function(e,t,r,n,s){void 0===s&&(s="");var a=[de,ue(t,e,n,r)],i=pe[Object(Oe.a)().toLowerCase()];i&&a.push(he(i));return function(e,t){return t?"".concat(e," AND (").concat(t,")"):e}("({searchterms}) "+re(a,"AND"),s)}(u,i,a,l)+"'&HitHighlightedProperties='Title'&StartRow="+(n?function(e){return 1===e||0===e?0:je()*(e-1)}(n):ye)+"&RowLimit="+(n?je():qe)+"&Properties='ClientFunction:News"+(be()?",EnableMultiGeoSearch:true":",EnableMultiGeoSearch:false")+"'&sortlist='LastModifiedTime:descending'&SelectProperties='"+o+"'&ClientType='"+Object(ge.a)()+"'&EnableQueryRules="+me()+d}var xe=null;function Ie(e,t,r,s){var a,i,u=(a=o.a,i=[],a.forEach(function(e){i=Object(n.__spreadArray)(Object(n.__spreadArray)([],Object(n.__read)(i),!1),Object(n.__read)(e.getSources()),!1)}),Object(c.a)(i).sort().join(","));if(!xe){xe=new X({id:"search-news-suggestions",version:Object(Q.a)(),refreshIntervalMs:9e5});var l=Object(G.a)(o.a);xe.map=function(e,t){return e.select(function(e){return l(e)})}}return xe.getItem({query:ke({searchText:"*",sitePath:e,departmentId:t,isHubSite:r,selectProperties:u,searchCenterUrl:s})})}var we=r("F6lS"),Te=r("Xopu"),Re="".concat(we.a,".").concat(Te.n),De=function(){function e(e,t){this.site=e,this.searchCenterUrl=t}return e.prototype.getId=function(){return"SearchNewsSuggestionProvider"},e.prototype.createStream=function(e){return this.site?Ie(this.site.sitePath,this.site.departmentId,this.site.isHubSite,this.searchCenterUrl).select(function(e){return e.body}).selectMany(function(e){return s.Observable.fromArray(e)}).specFilter(e,new u.a):s.Observable.empty()},e=Object(n.__decorate)([Object(n.__param)(0,Object(a.a)("site")),Object(n.__param)(1,Object(a.a)("searchCenterUrl"))],e)}();t.default=De;Object(i.regs)(Re,De)}}]);