(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[199],{"67N2":function(e,t,n){"use strict";n.d(t,"o",function(){return i}),n.d(t,"i",function(){return r}),n.d(t,"s",function(){return o}),n.d(t,"u",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"d",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"l",function(){return f}),n.d(t,"f",function(){return p}),n.d(t,"c",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"r",function(){return h}),n.d(t,"p",function(){return b});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("b08d62b9-3c21-4a8f-b136-e7d7b525e924")}function r(){return a._SPKillSwitch.isActivated("bafad34d-40e9-478d-b565-5c812b80031f")}function o(){return a._SPKillSwitch.isActivated("61be9ad0-f47c-405d-9c28-92f9142430a9")}function s(){return a._SPKillSwitch.isActivated("d9407616-7ba4-4b30-8e26-64e6c81cddcc")}function c(){return a._SPKillSwitch.isActivated("cb5d7cee-5511-4928-bf2e-ed9d5a967e01")}function d(){return a._SPKillSwitch.isActivated("74843650-4b21-403f-a76b-dfe9d4230bd2")}function l(){return a._SPKillSwitch.isActivated("a0cc773e-4b78-4e4f-ba45-deb0cfc86ba1")}function u(){return a._SPKillSwitch.isActivated("1771ca0a-b7a0-4a00-ac4f-33cce7b5a8d8")}function f(){return a._SPKillSwitch.isActivated("77f1af93-cb1a-450c-9b7f-fe4255f81fed")}function p(){return a._SPKillSwitch.isActivated("18f6bae5-696a-4bbf-88ac-6f9d653bca49")}function m(){return a._SPKillSwitch.isActivated("5916883a-78b8-4ead-aceb-c17400e84430")}function _(){return a._SPKillSwitch.isActivated("e4ec543e-b34d-4615-b1a0-c00c803f3515")}function h(){return a._SPKillSwitch.isActivated("68d190d9-c1b0-4d51-8263-cbaf1e007b3d")}function b(){return a._SPKillSwitch.isActivated("54a84d15-714a-4db3-b282-0be5a12aaa0a")}},Fn15:function(e,t,n){"use strict";var a=n("hiL/"),i=n("jyrw"),r=function(){function e(){}return e.pageSaved=function(){i.e._dispatchAction("SET_SAVESTATUS",a.PageSaveStatus.Saved,e._moduleName,"SPPageSetPageSaved",{SPPageStatus:a.PageSaveStatus.Saved.toString()})},e.pageDirty=function(){i.e._dispatchAction("SET_SAVESTATUS",a.PageSaveStatus.NotSaved,e._moduleName,"SPPageSetPageDirty",{SPPageStatus:a.PageSaveStatus.NotSaved.toString()})},e.pageCheckedOut=function(){i.e._dispatchAction("SET_SAVESTATUS",a.PageSaveStatus.UnPublished,e._moduleName,"SPPageSetPageUnPublished",{SPPageStatus:a.PageSaveStatus.UnPublished.toString()})},e._moduleName="[PageStatusStoreAction]",e}();t.e=r},IKdF:function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("ut3N"),r=n("2q6Q"),o=n("hiL/"),s=n("y88i"),c=n("HVbJ"),d=n("0SGS"),l=n("q+wp"),u=function(){function e(){}return e.insert=function(e,t){var n=new r._QosMonitor("PageCacheInsert");try{var a=JSON.stringify(t);window.sessionStorage.setItem(e,a),n.writeSuccess()}catch(e){n.writeUnexpectedFailure("PageCacheInsert",e)}},e.insertPage=function(e,t,n){e=this._normalize(e),this.insert("page-cache://"+e,{route:e,preloadedData:t,version:n})},e.get=function(e){var t=new r._QosMonitor("PageCacheGet");try{var n=window.sessionStorage.getItem(e),a=JSON.parse(n);return t.writeSuccess(),a}catch(e){t.writeUnexpectedFailure("PageCacheGet",e)}},e.getPage=function(e){return e=this._normalize(e),this.get("page-cache://"+e)},e.remove=function(e){var t=new r._QosMonitor("PageCacheDelete");try{window.sessionStorage.removeItem(e),t.writeSuccess()}catch(e){t.writeUnexpectedFailure("PageCacheDelete",e)}},e.removePage=function(e){e=this._normalize(e),this.remove("page-cache://"+e)},e._normalize=function(e){return l.e.relativizeUrl(l.e.removeQueryString(e.toLowerCase()))},e}(),f=n("onFi"),p=n("lmp7"),m=n("7plR"),_=n("ExwJ"),h=n("UF/m"),b=n("xs0R"),g=n("0IsF"),v=n("XdGY"),y="HomePage",S="ClassicHomepageUrl",D="PageTemplates",I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._logSource=i._LogSource.create("SPPageDataProvider"),t}return Object(a.__extends)(t,e),t.convertSitePageFlagArrayToString=function(e){var t=";#";if(Array.isArray(e)&&(null==e?void 0:e.length)>0)return"".concat(t).concat(e.join(t)).concat(t)},t.prototype.getPageUrlAsync=function(e){var t=this,n="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/FileName");p.e.appCacheHit=!1;var a=new r._QosMonitor("GetPageUrlAPI");return this._fetchJson(n).then(function(e){return a.writeSuccess(),e.value}).catch(function(e){return i._TraceLogger.logError(t._logSource,e),404===e.status?a.writeExpectedFailure("FailedResponseNotFound",e):403===e.status?a.writeExpectedFailure("FailedResponseForbidden",e):406===e.status?a.writeExpectedFailure("FailedResponseNotAcceptable",e):a.writeUnexpectedFailure("FailedResponseStatus",e),Promise.reject(e)})},t.prototype.getListItemModerationStatusAsync=function(e){var t=this._webServerRelativeUrl+"/_api/web/lists(guid'".concat(this._pageContext.list.id,"')/Items(").concat(e,")?$select=OData__ModerationStatus");return this._fetchJson(t).then(function(e){if(void 0===e.OData__ModerationStatus)throw"Invalid Moderation Status";return e.OData__ModerationStatus})},t.prototype.getPageTemplates=function(){var e="".concat(D,"_").concat(this._webServerRelativeUrl),t=u.get(e);if(t)return Promise.resolve(t);var n=this._restSitePagesEndPointUrl+"/templates";return this._fetchJson(n).then(function(t){var n=t.value;return u.insert(e,n),n}).catch(function(e){throw e})},t.prototype.savePageToServerAsync=function(e,t,n,a){if(!Object.keys(t).length){var r=new Error("should not save empty page content");return i._TraceLogger.logError(this._logSource,r,a),Promise.reject(r)}var s=t[_.e.PreviewImageUrl];o.ThumbnailUrlGenerator.isStockImage(s)&&(t[_.e.PreviewImageUrl]=this._defaultSitePageThumbnail);var c=n?"SavePageAsDraft":"SavePage",d="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/").concat(c),l=new h.t(t);return i._TraceLogger.logVerbose(this._logSource,"".concat(a," (").concat(e,")")),this._savePage(d,l,a,new h.n("POST"))},t.prototype.createBlankPageAsync=function(e,n,a,i){var o=new r._QosMonitor("CreateBlankPageAPI"),s=b.t.isSpace?this._restSpacesEndPointUrl:this._restSitePagesEndPointUrl,c=new h.t({PromotedState:e||void 0,PageLayoutType:n||void 0,ContentTypeId:a||void 0,SitePageFlags:t.convertSitePageFlagArrayToString(i)});return this.createOrCopyPage(s,new h.n("POST"),c.toString(),o,"createBlankPageAsync")},t.prototype.createPageAsync=function(e,n,a,i,o,s,c){var d=new r._QosMonitor("CreatePageAPI"),l=b.t.isSpace?this._restSpacesEndPointUrl:this._restSitePagesEndPointUrl,u=new h.t({PromotedState:e||void 0,PageLayoutType:n||void 0,ContentTypeId:a||void 0,SitePageFlags:t.convertSitePageFlagArrayToString(i),CanvasContent1:o||void 0,Title:s||void 0,Name:c||void 0});return this.createOrCopyPage(l,new h.n("POST"),u.toString(),d,"createPageAsync")},t.prototype.createTopicPageAsync=function(){var e=new r._QosMonitor("CreateTopicPageAPI"),t=this._restTopicsEndPointUrl,n=b.t.fields.EntityId,a=new h.t({Title:b.t.fields.Title,EntityId:n!==o.NULL_TOPIC_ENTITY.Id?n:"",EntityType:Object(c.isTopicTypesFlightEnabled)(m.e.instance.pageContext.legacyPageContext)?"":"Project",EntityRelations:o.EntityRelationsService.getRelationsAsString(m.e.instance.serviceScope),LayoutWebpartsContent:d.e.serializeLayoutWebPartData(b.t.fields.LayoutWebPartsDataMap),CanvasContent1:JSON.stringify(b.t.fields.CanvasContent1),TopicHeader:"Topic",BannerImageUrl:"/_layouts/15/images/sitepagethumbnail.png",PageLayoutType:g.e.Topic});return this.createOrCopyPage(t,new h.n("POST"),a.toString(),e,"createTopicPageAsync")},t.prototype.copyPage=function(e,n){var a=new r._QosMonitor("CopyPageAPI"),i="",o=this._shouldCreateNewsCopy();Object(v.m)()?o?(i="CreateNewsCopy",m.e.instance.promoteOnPublish=!1):i="Copy":(i="CopyWithConfiguration",o&&(m.e.instance.promoteOnPublish=!1));var s="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/").concat(i);return this.createOrCopyPage(s,new h.n("POST"),Object(v.m)()?new h.t({SitePageFlags:t.convertSitePageFlagArrayToString(n)}).toString():JSON.stringify({sitePageFlags:t.convertSitePageFlagArrayToString(n),isNews:o}),a,"copyPage")},t.prototype.savePageAsTemplate=function(e){if(l.e.isScribeCopyTemplateEnabled()){var t="SavePageAsTemplate",n=new r._QosMonitor("SavePageAsTemplateAPI");return this._savePageAsTemplateInternal(e,t,n)}var a="".concat(D,"_").concat(this._webServerRelativeUrl);u.remove(a),n=new r._QosMonitor("SavePageAsTemplateAPI"),t="SavePageAsTemplate";var i="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/").concat(t);return this.createOrCopyPage(i,new h.n("POST"),(new h.t).toString(),n,"savePageAsTemplate")},t.prototype.savePageAsTemplateOnMySite=function(e){var t=new i._AutoAlertableQosMonitor("SavePageAsTemplateOnMySiteAPI",i._AutoAlertableMonitorType.StaticReliabilityQos95Sev4);return this._savePageAsTemplateInternal(e,"SavePageAsTemplateOnMySite",t)},t.prototype.getTemplateFolderUrl=function(){var e=this._webServerRelativeUrl+"/_api/lists/EnsureClientRenderedSitePagesLibrary/GetSpecialFolderUrl",t=new r._QosMonitor("GetTemplateFolderUrl");return this._fetchJson(e,new h.n("POST"),JSON.stringify({type:9,bForceCreate:!1})).then(function(e){return t.writeSuccess(),e.value}).catch(function(e){return t.writeUnexpectedFailure("FailedGettingTemplateFolderUrl",e),Promise.reject(e)})},t.prototype.createOrCopyPage=function(e,n,a,r,o){var s=this;i._TraceLogger.logVerbose(this._logSource,o);var c=window._isInitiatedByPageApp?"FromPageApp":"FromRouter";return this._fetchJson(e,n,a).then(function(e){if(!e||!e.Id)throw t._getOdataRestApiError(e)||new f.e;return s._processCreateOrCopyResponse(o,r,e)}).catch(function(e){throw e instanceof f.e?403===e.status?r.writeExpectedFailure("FailedResponseForbidden",e,{pageCreationEntryPoint:c}):r.writeUnexpectedFailure("FailedResponseStatus",e,{pageCreationEntryPoint:c}):(r.writeUnexpectedFailure("FailedResponseStatus",e,{pageCreationEntryPoint:c}),i._TraceLogger.logError(s._logSource,e,c)),e})},t.prototype.checkOutAndReloadPageAsync=function(e){var t=this,n="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/checkoutpage"),a=new r._QosMonitor("CheckOutPageAPI");return i._TraceLogger.logVerbose(this._logSource,"checkOutAndReloadPageAsync"),this._fetchJson(n,new h.n("POST")).then(function(e){if(!e||!e.IsPageCheckedOutToCurrentUser)throw new f.e;var n=d.e.tryLoadFromSitePagesOdata(e);return i._TraceLogger.logVerbose(t._logSource,"checkOutAndReloadPageAsync success"),a.writeSuccess(),n}).catch(function(e){throw e instanceof f.e?(t._handleOdataError(e,e.status,a,"CheckOutPageAPI"),i._TraceLogger.logError(t._logSource,e,"CheckOutPageAPI")):(a.writeUnexpectedFailure("FailedToCheckoutPageError2",e),i._TraceLogger.logError(t._logSource,e)),e})},t.prototype.publishPageAsync=function(e){var t,n=this,a="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/publish"),o=new r._QosMonitor("PublishPageAPI");i._TraceLogger.logVerbose(this._logSource,"publishPageAsync");var s={alias:null===(t=b.t.fields)||void 0===t?void 0:t.PageLayoutType};return this._fetchJson(a,new h.n("POST")).then(function(e){if(!0!==e.value)return Promise.reject(new f.e);o.writeSuccess(s)}).catch(function(e){return e.isUnknown?(o.writeUnexpectedFailure("PublishPageAPI",e,s),i._TraceLogger.logError(n._logSource,e)):n._handleOdataError(e,e.status,o,"PublishPageAPI",s),Promise.reject(e)})},t.prototype.schedulePageAsync=function(e){var t=this,n=new r._QosMonitor("SchedulePublishAPI"),a="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/schedulepublish");return i._TraceLogger.logVerbose(this._logSource,"schedulePageAsync"),this._fetchJson(a,new h.n("POST"),JSON.stringify({})).then(function(e){return n.writeSuccess(),e.value}).catch(function(e){return"-2146232832, Microsoft.SharePoint.SPFeatureDependencyNotActivatedException"===(null==e?void 0:e.code)&&(n.writeExpectedFailure("SchedulePublishAPI",e),i._TraceLogger.logError(t._logSource,e)),e.isUnknown?(n.writeUnexpectedFailure("SchedulePublishAPI",e),i._TraceLogger.logError(t._logSource,e)):t._handleOdataError(e,e.status,n,"SchedulePublishAPI"),Promise.reject(e)})},t.prototype.discardPageAsync=function(e){var t=this,n=Object(v.Pe)()?"".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/discardPage"):"".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/discardPage?$expand=VersionInfo"),a=new r._QosMonitor("DiscardPageAPI");return i._TraceLogger.logVerbose(this._logSource,"discardPageAsync"),this._fetchJson(n,new h.n("POST")).then(function(e){if(!e)throw new f.e;var n=d.e.tryLoadFromSitePagesOdata(e);return i._TraceLogger.logVerbose(t._logSource,"discardPageAsync success"),a.writeSuccess(),n}).catch(function(e){throw e instanceof f.e&&!e.isUnknown?t._handleOdataError(e,e.status,a,"DiscardPageAPI"):(a.writeUnexpectedFailure("FailedToDiscardPageError22",e),i._TraceLogger.logError(t._logSource,e)),e})},t.prototype.promotePageToNewsAsync=function(e){var t=this,n="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/PromoteToNews"),a=new r._QosMonitor("PromotePageToNewsAPI");return i._TraceLogger.logVerbose(this._logSource,"promotePageToNewsAsync"),this._fetchJson(n,new h.n("POST")).then(function(e){if(!0!==e.value)return Promise.reject(new f.e);a.writeSuccess()}).catch(function(e){return e.isUnknown?(i._TraceLogger.logError(t._logSource,e,"PromotePageToNewsAPI"),a.writeUnexpectedFailure("PromotePageToNewsAPI",e)):t._handleOdataError(e,e.status,a,"PromotePageToNewsAPI"),Promise.reject(e)})},t.prototype.checkInFileAsync=function(e,t){var n=this._webServerRelativeUrl+"/_api/web/getfilebyserverrelativeurl('".concat(this._pageContext.list.serverRelativeUrl+"/"+t,"')/checkin(").concat(e,")"),a=new r._QosMonitor("CheckinFileAPI");return this._fetchJson(n,new h.n("POST"),JSON.stringify({})).then(function(){return a.writeSuccess()}).catch(function(e){return a.writeUnexpectedFailure("FailedCheckingInFile",e),Promise.reject(e)})},t.prototype.getFileEtagAsync=function(){var e=s.StringHelper.format(this._restWebEndPointForEtag,this._pageServerRelativeUrl),t=new r._QosMonitor("GetFileEtagAPI");return this._fetchJson(e).then(function(e){if(!e.ETag)throw new f.e;return t.writeSuccess(),e.ETag}).catch(function(e){throw t.writeUnexpectedFailure("FailedGettingFileEtag",e),e})},t.prototype.getFileCheckinCommentsAsync=function(){var e=s.StringHelper.format(this._restWebEndPointForCheckInComments,this._pageServerRelativeUrl),t=new r._QosMonitor("GetFileCheckInComments");return this._fetchJson(e).then(function(e){return t.writeSuccess(),e.CheckInComment}).catch(function(e){return t.writeUnexpectedFailure("FailedCheckingInFile",e),Promise.reject(e)})},t.prototype.getUserById=function(e){var t=this._webServerRelativeUrl+"/_api/web/GetUserById(".concat(e,")"),n=new r._QosMonitor("GetUserById");return this._fetchJson(t).then(function(t){return n.writeSuccess(),{id:e,email:t.Email,name:t.Title}}).catch(function(e){return n.writeUnexpectedFailure("FailedGettingUser",e),Promise.reject(e)})},t.prototype.getPagePublishStartDate=function(e){var t="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")?$select=PublishStartDate"),n=new r._QosMonitor("GetPublishStartDate");return this._fetchJson(t).then(function(e){return n.writeSuccess(),e.PublishStartDate}).catch(function(e){return n.writeUnexpectedFailure("FailedGettingUser",e),Promise.reject(e)})},t.prototype.getListMetadataAsync=function(){var e=this._webServerRelativeUrl+"/_api/lists/EnsureClientRenderedSitePagesLibrary?$select=EnableModeration,EnableMinorVersions,Id";Object(v.We)()||(e+=",DraftVersionVisibility");var t=new r._QosMonitor("GetListMetadataAPI");return this._fetchJson(e,new h.n("POST"),JSON.stringify({})).then(function(e){return t.writeSuccess(),{DraftVersionVisibility:e.DraftVersionVisibility,EnableMinorVersions:e.EnableMinorVersions,EnableModeration:e.EnableModeration,Id:e.Id}}).catch(function(e){return t.writeUnexpectedFailure("FailedGettingModerationStatus",e),Promise.reject(e)})},t.prototype.getIsTemplate=function(e){var t="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")?$select=IsTemplate"),n=new r._QosMonitor("GetIsTemplate");return this._fetchJson(t).then(function(e){return n.writeSuccess(),e.IsTemplate}).catch(function(e){return n.writeUnexpectedFailure("FailedGettingFileEtag",e),Promise.reject(e)})},t.prototype.setListItemModerationStatus=function(e,t,n,a){var i=this._webServerRelativeUrl+"/_api/SP.APIHubConnector.SetApprovalStatus",o=new r._QosMonitor("SetModerationStatusAPI"),s={action:n,comments:t,etag:a,itemId:e.toString(),listName:this._pageContext.list?this._pageContext.list.id.toString():"Site Pages"};return this._fetchJson(i,new h.n("POST"),JSON.stringify(s)).then(function(){return o.writeSuccess()}).catch(function(e){return o.writeUnexpectedFailure("FailedSettingModerationStatusAPI",e),Promise.reject(e)})},t.prototype.getClassicHomepageUrlAsync=function(){var e=this,t=u.get("".concat(S,"_").concat(this._webServerRelativeUrl));if(t)return i._TraceLogger.logVerbose(this._logSource,"get classic homepage url from cache"),Promise.resolve(t);var n=s.Uri.concatenate(this._webServerRelativeUrl,"_api/Web?$select=ClassicWelcomePage,IsRevertHomepageLinkHidden"),a=new r._QosMonitor("GetClassicHomepageUrl");return this._fetchJson(n).then(function(t){var n=t.ClassicWelcomePage,r=t.IsRevertHomepageLinkHidden?"":n;return i._TraceLogger.logVerbose(e._logSource,"getClassicHomepageUrlAsync success"),a.writeSuccess(),u.insert("".concat(S,"_").concat(e._webServerRelativeUrl),r),r}).catch(function(t){return 403===t.status?(a.writeExpectedFailure("GetClassicHomepageUrl",t),""):(a.writeUnexpectedFailure("GetClassicHomepageUrl",t),i._TraceLogger.logError(e._logSource,t),Promise.reject(t))})},t.prototype.removeClassicHomepageUrl=function(){var e=this,t=this._webServerRelativeUrl+"/_api/Web",n=new r._QosMonitor("RemoveClassicHomepageUrl");return this._fetchJson(t,new h.n("PATCH"),JSON.stringify({__metadata:{type:"SP.Web"},IsRevertHomepageLinkHidden:!0})).then(function(){n.writeSuccess(),u.remove("".concat(S,"_").concat(e._webServerRelativeUrl))}).catch(function(e){return n.writeUnexpectedFailure("RemoveClassicHomepageUrl",e),Promise.reject(e)})},t.prototype.getHomePageUrlAsync=function(){var e=this,t=u.get("".concat(y,"_").concat(this._webServerRelativeUrl));if(t)return i._TraceLogger.logVerbose(this._logSource,"get home page url from cache"),Promise.resolve(t);var n=s.Uri.concatenate(this._webServerRelativeUrl,"_api/web/rootfolder?$select=welcomepage"),a=new r._QosMonitor("GetHomePageUrl");return this._fetchJson(n).then(function(t){var n=s.Uri.concatenate(e._webServerRelativeUrl,t.WelcomePage);return i._TraceLogger.logVerbose(e._logSource,"getHomePageUrlAsync success"),a.writeSuccess(),u.insert("".concat(y,"_").concat(e._webServerRelativeUrl),n),n}).catch(function(t){return 403===t.status?(a.writeExpectedFailure("GetHomePageUrl",t),""):(a.writeUnexpectedFailure("GetHomePageUrl",t),i._TraceLogger.logError(e._logSource,t),Promise.reject(t))})},t.prototype.getPreviousPageVersionInfoAsync=function(e){var t=this,n="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/VersionInfo"),a=new r._QosMonitor("VersionInfoPageAPI");return i._TraceLogger.logVerbose(this._logSource,"getPreviousPageVersionInfoAsync"),this._fetchJson(n,new h.n("POST")).then(function(e){if(!e)throw new f.e;return a.writeSuccess(),e}).catch(function(e){throw e instanceof f.e?e.isUnknown?(a.writeUnexpectedFailure("FailedResponseStatus",e),i._TraceLogger.logError(t._logSource,e,"VersionInfoPageAPI")):t._handleOdataError(e,e.status,a,"VersionInfoPageAPI"):(a.writeUnexpectedFailure("FailedToGetPageVersion",e),i._TraceLogger.logError(t._logSource,e)),e})},t.prototype.deletePageAsync=function(){var e=this,t=new r._QosMonitor("DeletePageAPI"),n=s.Uri.concatenate(this._webServerRelativeUrl,"/_api/web/lists(guid'".concat(this._pageContext.list.id,"')/Items(").concat(b.t.fields.Id||l.e.spPageContextInfo.pageItemId,")/recycle"));return this._fetchJson(n,new h.n("POST")).then(function(e){if(!(null==e?void 0:e.value))throw new f.e;t.writeSuccess()}).catch(function(n){throw n instanceof f.e?n.isUnknown?(t.writeUnexpectedFailure("FailedResponseStatus",n),i._TraceLogger.logError(e._logSource,n,"DeletePageAPI")):e._handleOdataError(n,n.status,t,"DeletePageAPI"):(t.writeUnexpectedFailure("FailedToDeletePage",n),i._TraceLogger.logError(e._logSource,n)),n})},t.prototype.addPageToQuickLaunchAsync=function(e,t){var n=this,a="".concat(this._webServerRelativeUrl,"/_api/web/navigation/QuickLaunch"),o=new r._QosMonitor("AddPageToQuickLaunchAPI"),s=new h.t({__metadata:{type:"SP.NavigationNode"},IsExternal:!0,Title:e,Url:t});return this._fetchJson(a,new h.n("POST"),s.toString()).then(function(e){return o.writeSuccess(),i._TraceLogger.logVerbose(n._logSource,"addPageToQuickLaunchAsync success"),{key:e.Id.toString(),name:e.Title,url:e.Url,target:l.e.isRelativeUrl(e.Url)?"_self":"_blank"}}).catch(function(e){return o.writeUnexpectedFailure("FailedResponseStatus",e),e instanceof f.e?i._TraceLogger.logError(n._logSource,e,"AddPageToQuickLaunchAPI"):i._TraceLogger.logError(n._logSource,e),Promise.reject(e)})},t.prototype.getClassicPubNavProviderTypeAsync=function(e){var t=new r._QosMonitor("GetClassicPublishingNavProviderAPI"),n="".concat(this._webServerRelativeUrl,"/_api/navigation/GetPublishingNavigationProviderType?mapProviderName=%27");return n+=e,n+="%27",this._fetchJson(n).then(function(e){return t.writeSuccess(),e.value}).catch(function(e){return t.writeUnexpectedFailure("FailedResponseStatus",e),Promise.reject(e)})},t.prototype.ensureTitleResourceAsync=function(){var e=this,t="".concat(this._restSitePagesEndPointUrl,"/EnsureTitleResource");return this._fetchJson(t,new h.n("POST"),JSON.stringify({})).then(function(){}).catch(function(t){throw i._TraceLogger.logError(e._logSource,t),t})},t.prototype.getVersion=function(e,t){var n="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/getversion(").concat(t,")"),a=new r._QosMonitor("GetVersionAPI");return this._fetchJson(n).then(function(e){if(!e)throw new f.e;var t=d.e.tryLoadFromSitePagesOdata(e);return a.writeSuccess(),t}).catch(function(e){throw a.writeUnexpectedFailure("FailedGetVersion",e),e})},t.prototype.getDashboardPage=function(){var e=this._restSitePagesEndPointUrl+"?$filter=PageLayoutType eq '".concat(g.e.Dashboard,"'&$top=1&$select=FileName"),t=new r._QosMonitor("GetDashboardPage");return this._fetchJson(e).then(function(e){return e&&e.value&&e.value.length>0?(t.writeSuccess({exist:!0}),e.value[0].FileName):void t.writeSuccess({exist:!1})}).catch(function(e){t.writeUnexpectedFailure(e)})},t.prototype._savePage=function(e,t,n,a){var o,s=this,c=new r._QosMonitor(n),d={alias:null===(o=b.t.fields)||void 0===o?void 0:o.PageLayoutType};return this._fetchJson(e,a,t.toString(),this._isSaveSuccessful).then(function(e){return c.writeSuccess(d),i._TraceLogger.logVerbose(s._logSource,n+"success"),e.value}).catch(function(e){return Object(v.X)()||(d.spPagesApiCorrelationId=e.correlationId),e instanceof f.e?e.isUnknown?(c.writeUnexpectedFailure("FailedResponseUnknown",e,d),i._TraceLogger.logError(s._logSource,e,n)):s._handleOdataError(e,e.status,c,n,d):(c.writeUnexpectedFailure("FailedToSavePageError2",e,d),i._TraceLogger.logError(s._logSource,e)),Promise.reject(e)})},t.prototype._processCreateOrCopyResponse=function(e,t,n){i._TraceLogger.logVerbose(this._logSource,"".concat(e," (").concat(n.Id,")"));var a=d.e.tryLoadFromSitePagesOdata(n);return l.e.updatePageContextItemId(n.Id),t.writeSuccess(),a},t.prototype._shouldCreateNewsCopy=function(){return m.e.instance.promoteOnPublish},t.prototype._savePageAsTemplateInternal=function(e,t,n){var a="".concat(D,"_").concat(this._webServerRelativeUrl);u.remove(a);var i="".concat(this._restSitePagesEndPointUrl,"(").concat(e,")/").concat(t);return this.createOrCopyPage(i,new h.n("POST"),(new h.t).toString(),n,t)},t}(h.e);t.default=I},"UF/m":function(e,t,n){"use strict";n.d(t,"n",function(){return p}),n.d(t,"t",function(){return m}),n.d(t,"e",function(){return _});var a=n("ut3N"),i=n("Pk8u"),r=n("vlQI"),o=n("UWqr"),s=n("y88i"),c=n("EMa1"),d=n("onFi"),l=n("q+wp"),u=n("xs0R"),f=n("XdGY"),p=function(e){this["OData-Version"]="3.0",this["If-Match"]="*",this["X-HTTP-Method"]=e},m=function(){function e(e){var t;t=u.t.isSpace?"SP.Publishing.SitePage3D":l.e.isNewTopicPage()?"SP.Publishing.TopicSitePage":"SP.Publishing.SitePage",this.__metadata={type:t},e&&Object(i.assign)(this,e)}return e.prototype.toString=function(){return JSON.stringify(this)},e}(),_=function(){function e(t,n){this._pageContext=t,this._spHttpClient=n,this._spHttpClientFetch=this._spHttpClient.fetch.bind(this._spHttpClient),this._spHttpClientGet=this._spHttpClient.get.bind(this._spHttpClient),this._spHttpClientPost=this._spHttpClient.post.bind(this._spHttpClient),this._isResponseSuccessful=l.e.isResponseSuccessful.bind(l.e),this._isSaveSuccessful=e._isSaveResponseSuccessful}return e._getOdataRestApiError=function(e,t,n){var a;void 0===t&&(t=500);var i=e["odata.error"],r=n&&n.message||"unknown",o=Object(f.X)()||null===(a=n)||void 0===a?void 0:a.correlationId;return i&&i.message?new d.e("Inner-Message: ".concat(i.message.value," Exception-Message: ").concat(r),t,i.code,o):void 0},e._encodeAndSanitizeURIComponent=function(e){return(e=encodeURIComponent(e).replace(/'/g,"''")).replace(/[~!*()']/g,function(e){return"%"+e.charCodeAt(0).toString(16)})},e._isSaveResponseSuccessful=function(e){return l.e.isResponseSuccessful(e)||413===e},Object.defineProperty(e.prototype,"_webServerRelativeUrl",{get:function(){return o.UrlUtilities.removeEndSlash(this._pageContext.legacyPageContext.webServerRelativeUrl)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restSitePagesEndPointUrl",{get:function(){return this._webServerRelativeUrl+"/_api/sitepages/pages"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restSpacesEndPointUrl",{get:function(){return this._restSitePagesEndPointUrl+"/spaces"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restWebEndPointForEtag",{get:function(){return this._webServerRelativeUrl+"/_api/web/getfilebyserverrelativeurl('{0}')?$select=ETag"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restWebEndPointForCheckInComments",{get:function(){return this._webServerRelativeUrl+"/_api/web/getfilebyserverrelativeurl('{0}')?$select=CheckInComment"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restTopicsEndPointUrl",{get:function(){return this._restSitePagesEndPointUrl+"/topics"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_defaultSitePageThumbnail",{get:function(){return s.Uri.concatenate("/",this._pageContext.legacyPageContext.layoutsUrl,"/images/sitepagethumbnail.png")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_pageServerRelativeUrl",{get:function(){var t="/"+e._encodeAndSanitizeURIComponent(l.e.url(!0).replace(l.e.domainUrl(),""));return l.e.doesUrlHaveFileName?t:l.e.spPageContextInfo.serverRequestPath},enumerable:!1,configurable:!0}),e.prototype._fetch=function(e,t,n,a){var i=this._spHttpClientPost,o={body:n,headers:t};return t?"GET"===t["X-HTTP-Method"]&&(i=this._spHttpClientFetch):(o=void 0,i=this._spHttpClientGet),i(e,r.SPHttpClient.configurations.v1,o).catch(function(e){return Promise.reject({error:new d.e})}).then(function(e){if(!a(e.status)){var t=Object(f.X)()?new d.e(l.e.getStatusMessage(e),e.status):new d.e(l.e.getStatusMessage(e),e.status,void 0,e.headers.get("SPRequestGuid")||void 0);throw t.response=e,{error:t,isResponseSuccessful:!1}}return e})},e.prototype._fetchJson=function(t,n,a,i){var r;return this._fetch(t,n,a||(new m).toString(),i||this._isResponseSuccessful).catch(function(e){if(!1===e.isResponseSuccessful)return r=e.error,e.error.response;throw e.error}).then(function(e){return e.ok&&204===e.status?e:e.json()}).then(function(t){var n=e._getOdataRestApiError(t,r&&r.status,r)||r;if(n)throw n;return t})},e.prototype._handleOdataError=function(e,t,n,i,r){if(e){if(Object(f.X)()||void 0===e.correlationId||((r=r||{}).spPagesApiCorrelationId=e.correlationId),400!==t||e.message!==c.t.exceedStreamLimitationErrorMessage&&e.message!==c.t.requestMessageTooBigErrorMessage)if(409===t){var o=new d.e("File checked out by another user",409);n.writeExpectedFailure("FailedResponsePageConflict",o,r)}else if(404===t){var s=new d.e("Page is not found",404);n.writeExpectedFailure("FailedResponseNotFound",s,r)}else 406===t?n.writeExpectedFailure("FailedResponseNotAcceptable",e,r):403===t?n.writeExpectedFailure("FailedResponseForbidden",e,r):n.writeUnexpectedFailure("FailedResponseStatus",e,r);else n.writeUnexpectedFailure("FailedResponseExceedStreamLimitation",e,r);throw a._TraceLogger.logError(this._logSource,e,i),e}},e}()},pfXd:function(e,t,n){"use strict";var a=n("ut3N"),i=n("EMa1"),r=n("XdGY"),o=n("jyrw"),s=n("E7/L");function c(){return Promise.all([n.e(8),n.e(176)]).then(n.bind(null,"+Mf1")).then(function(e){return e.default})}var d=n("xs0R"),l=n("q+wp"),u=function(){function e(){}return e.setIsTemplate=function(t){o.e._dispatchAction("FIELDS_SET_TEMPLATE_STATUS",t,e._moduleName,"set page template flag")},e.setNumMissingRequiredProps=function(t){o.e._dispatchAction("FIELDS_SET_MISSING_PROPS",t,e._moduleName,"set missing required properties")},e.setCategories=function(t){o.e._dispatchAction("FIELDS_SET_CATEGORIES",t,e._moduleName,"set categories")},e.addFieldsToUpdate=function(t){e._dispatchAction("FIELDS_UPDATE",t,"SPPageFieldStoreSetFields")},e.addFieldToUpdate=function(t,n){if(!t)throw new Error("fieldName is undefined");var a={};a[t]=n,e.addFieldsToUpdate(a)},e.setPromotedState=function(t){e._dispatchAction("FIELDS_SET_PROMOTEDSTATE",t,"SPPageFieldStoreSetFields")},e.clearPrivateAuthoringFlag=function(){var t,n;if(!Object(r.Je)()){var a=null===(n=null===(t=d.t.fields)||void 0===t?void 0:t.PageFlags)||void 0===n?void 0:n.filter(function(e){return e&&e!==i.t.privateAuthoringFlagKey});a&&e.addFieldToUpdate("PageFlags",a)}},e.setFields=function(t){e._dispatchAction("FIELDS_SET",t,"SPPageFieldStoreSetFields")},e.createNewPage=function(t,n,i,r){return r&&(t.bannerImageUrl=d.t.fields.BannerImageUrl),(t.pageFieldData?Promise.resolve(t.pageFieldData):Object(s.e)().then(function(e){return e.createNewPageStub(t,n,i,r)})).then(function(t){e._dispatchAction("PAGE_CREATE_STUB",t,"SPPageFieldStoreCreatePageStub"),t&&l.e.logUserEngagementForPage(t,!0,"NewButton")}).catch(function(t){a._TraceLogger.logError(e._logSource,t)})},e.createNewPageDeprecated=function(t,n,i,r,o,c,u,f,p,m,_,h){return p&&(_=d.t.fields.BannerImageUrl),(i?Promise.resolve(i):Object(s.e)().then(function(e){return e.createNewPageStubDeprecated(t,n,r,o,c,u,f,p,m,_)})).then(function(t){e._dispatchAction("PAGE_CREATE_STUB",t,"SPPageFieldStoreCreatePageStub"),t&&l.e.logUserEngagementForPage(t,!0,"NewButton")}).catch(function(t){a._TraceLogger.logError(e._logSource,t)})},e.scheduleNewMajorVersionToServerAsync=function(){return c().then(function(e){return e.scheduleNewMajorVersionToServerAsync()})},e.publishNewMajorVersionToServerAsync=function(){return c().then(function(e){return e.publishNewMajorVersionToServerAsync()})},e.publishTopicPageMajorVersionToServerAsync=function(){return c().then(function(e){return e.publishTopicPageMajorVersionToServerAsync()})},e.discardPageOnServerAsync=function(){return c().then(function(e){return e.discardPageOnServerAsync()})},e.getPreviousPageVersionInfoAsync=function(){return c().then(function(e){return e.getPreviousPageVersionInfoAsync()})},e.setListItemModerationStatusAsync=function(e,t){return c().then(function(n){return n.setListItemModerationStatusAsync(e,t)})},e.setFileCheckInCommentsAsync=function(){return c().then(function(e){return e.setFileCheckInCommentsAsync()})},e.checkOutFieldsFromServerAsync=function(){return c().then(function(e){return e.checkOutFieldsFromServerAsync()})},e.saveDraftToServerAsync=function(){return c().then(function(e){return e.saveDraftToServerAsync()})},e.saveFieldsToServerAsync=function(e){return void 0===e&&(e=!1),c().then(function(t){return t.saveFieldsToServerAsync(e)})},e.getPageUrlFromServerAsync=function(){return c().then(function(e){return e.getPageUrlFromServerAsync()})},e.checkInFileAsync=function(e,t,n){return c().then(function(a){return a.checkInFileAsync(e,t,n)})},e.ensureValidPageTitleAsync=function(){return c().then(function(e){return e.ensureValidPageTitle()})},e.promotePageToNewsAsync=function(){return c().then(function(e){return e.promotePageToNewsAsync()})},e.cacheClientForm=function(t,n){void 0===n&&(n=!1),e._dispatchAction("FIELDS_CACHE_CLIENTFORM",{clientForm:t,forceCanvasUpdate:n},"SPPageCacheClientForm")},e.ensurePageExistsAsync=function(){return d.t.doesPageExistOnServer?(a._TraceLogger.logVerbose(e._logSource,"Page already Exists"),Promise.resolve()):(a._TraceLogger.logVerbose(e._logSource,"Page does not Exists, calling createNewPageOnServerAsync"),c().then(function(e){return e.createNewPageOnServerAsync()}))},e.commitTitle=function(){e._dispatchAction("FIELDS_COMMIT_TITLE",void 0,"SPPageFieldStoreCommitTitle")},e.deletePageAsync=function(){return c().then(function(e){return e.deletePageAsync()})},e.setIsCanvasWizardOpen=function(t){e._dispatchAction("FIELDS_SET_IS_CANVAS_WIZARD_OPEN",t,"SPPageFieldSetIsCanvasWizardOpen")},e.turnOnIsCollaborating=function(){e._dispatchAction("FIELDS_SET_IS_COLLABORATING",!0,"SPPageFieldTurnOnIsCollaborating")},e.setFocusMode=function(t){e._dispatchAction("FIELDS_SET_FOCUS_MODE_STATUS",t,"SPPageFieldSetFocusMode")},e._dispatchAction=function(t,n,a){return o.e._dispatchAction(t,n,e._moduleName,a,void 0,e._logSource)},e._moduleName="[PageFieldStoreAction]",e._logSource=a._LogSource.create("PageFieldStoreActionCreator"),e}();t.e=u},s2tg:function(e,t,n){"use strict";n.r(t);var a=n("jyrw"),i=function(){function e(){}return e.load=function(t){a.e._dispatchAction("CHROME_CONFIG_LOAD",t,e._moduleName,"SPPageConfigChrome")},e._moduleName="[ChromeConfigurationAction]",e}(),r=n("2q6Q"),o=n("7plR"),s=n("n1SJ"),c=n("LjAQ"),d=function(){function e(){}return e.addQuickLaunchNode=function(t){var n=new r._QosMonitor("SPPageNavigationUpdateQuickLaunch");try{o.e.instance.getPageDataProviderAsync().then(function(e){return e.addPageToQuickLaunchAsync(t.name,t.url)}).then(function(t){a.e._dispatchAction("QUICKLAUNCH_ADDONE",t,e._moduleName,"SPPageNavigationUpdateQuickLaunch",void 0,void 0,n)}).catch(function(e){s.e.showError(c.e,c.t)})}catch(e){throw n.writeUnexpectedFailure("SPPageNavigationUpdateQuickLaunch",e),e}},e._moduleName="[NavigationAction]",e}(),l=n("17wl"),u=n("pfXd"),f=n("ut3N"),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.undo=function(){a.e._dispatchAction("FIELDS_UNDO",{},t._undoableModuleName,"Undo",void 0,t.LOG_SOURCE,new f._QosMonitor("Undo"))},t.redo=function(){a.e._dispatchAction("FIELDS_REDO",{},t._undoableModuleName,"Redo",void 0,t.LOG_SOURCE,new f._QosMonitor("Redo"))},t.clearHistory=function(){a.e._dispatchAction("FIELDS_CLEAR_HISTORY",{},t._undoableModuleName,"ClearHistory",void 0,t.LOG_SOURCE,new f._QosMonitor("ClearHistory"))},t.disableUndo=function(){a.e._dispatchAction("FIELDS_DISABLE_UNDO",{},t._undoableModuleName,"DisableUndo")},t.enableUndo=function(){a.e._dispatchAction("FIELDS_ENABLE_UNDO",{},t._undoableModuleName,"EnableUndo")},t.LOG_SOURCE=f._LogSource.create("UndoablePageFieldStoreActionCreator"),t._undoableModuleName="[UndoablePageFieldStoreAction]",t}(u.e),m=p,_=function(){function e(){}return e.loadPageLayoutMapping=function(t){a.e._dispatchAction("PAGELAYOUTMAPPING_LOAD",t,e._moduleName,"SPPageLayoutMapping",{Mapping:t.toString()})},e.addPageLayoutMapping=function(t,n){a.e._dispatchAction("PAGELAYOUTMAPPING_ADD",{key:t,pageLayout:n},e._moduleName,"SPPageAddPageLayoutMapping",{key:t})},e._moduleName="[PageFieldStoreAction]",e}(),h=n("Fn15"),b=function(){function e(){}return e.load=function(t){a.e._dispatchAction("PAGE_TEMPLATE_LOAD",t,e._moduleName,"SPPageTemplatesLoad")},e._moduleName="[PageTemplateAction]",e}(),g=function(){function e(){}return e.setListSettings=function(t){a.e._dispatchAction("SET_LIST_SETTINGS",t,e._moduleName,"set list settings")},e._moduleName="[ListActionCreator]",e}(),v=n("hiL/"),y=n("q+wp"),S=n("sSDQ"),D=n("UWqr"),I=n("I6O9"),x=n("EMa1"),C=n("ExwJ"),O=n("0IsF"),w=n("XdGY"),E=n("9sBY"),A=n("M+LP"),L=n("67N2"),k=n("lDgI"),M=function(){function e(){}return e.createNewPage=function(t,n){var a=n.canvasContent1?e._extractWebPartIdsFromCanvasContent(n.canvasContent1):[];return(Object(v.isCortexEnabled)(o.e.instance.pageContext)?e._loadComponentManifests(a):Promise.resolve()).then(function(){return o.e.instance.autoSaverPromise.then(function(a){return o.e.instance.getPageDataProviderAsync().then(function(i){var r,c,d,l=Object(L.i)()?Boolean(!n.isPreview&&(null===(c=n.pageFieldData)||void 0===c?void 0:c.EntityType)):(null===(r=n.pageFieldData)||void 0===r?void 0:r.PageLayoutType)===O.e.Topic,u=n.pageLayoutType===O.e.Space||(null===(d=n.pageFieldData)||void 0===d?void 0:d.PageLayoutType)===O.e.Space;return i.getListMetadataAsync().then(function(i){g.setListSettings(i),a.resetAutoSaveAttempts();var r=i.EnableMinorVersions?"0.1":"1.0";return Object(L.e)()?e._dispatchNewPageActionsDeprecated(t,n.source,n.promotedState,n.pageTemplateId,n.pageFieldData,n.canvasContent1,n.spaceContent,n.serverWebPartsDataMap,i.EnableModeration?v.SPModerationStatusType.Draft:void 0,r,n.templateFolderName,n.pageLayoutType,n.isPreview,n.previewPageFileName,n.bannerImageUrl,n.publishStartDate):e._dispatchNewPageActions(n,t,i.EnableModeration?v.SPModerationStatusType.Draft:void 0,r)}).then(function(){return n.isPreview?Promise.resolve():s.e.setDisplayModeEditAsync().then(function(){var e,t;!Object(L.i)()&&l?document.title=E.a:document.title=null!==(e=n.previewPageFileName)&&void 0!==e?e:E.n,Object(L.c)()||(y.e.authorId=null===(t=y.e.preloadedData.user)||void 0===t?void 0:t.Id)})}).then(function(){var e,t;if(l)if(Object(L.n)())(a=new URL(y.e.url())).searchParams.append("isNewTopicPage","true"),y.e.pushUrl(Object(L.s)()?a.toString():a.href,void 0,!0);else{var a=y.e.url(),i=y.e.appendUrlParam("isNewTopicPage","true",a);a!==i&&y.e.pushUrl(i,void 0,!0)}else if(D._SPFlight.isEnabled(943)&&u){var r=null===(e=n.pageFieldData)||void 0===e?void 0:e.Title,s=null===(t=n.pageFieldData)||void 0===t?void 0:t.Description;r&&(o.e.actions.fieldActions.addFieldToUpdate(C.e.Title,r),o.e.actions.fieldActions.commitTitle()),s&&o.e.actions.fieldActions.addFieldToUpdate(C.e.Description,s)}}).then(function(){return o.e.instance.serviceScope.whenFinished(function(){o.e.instance.serviceScope.consume(k.e.serviceKey).raiseNavigatedEvent()})}).catch(function(e){s.e.showError(e.message)})})})})},e.createNewCrossSitePage=function(e,t){return D.Validate.isNonemptyString(t.crossSiteUrl,"crossSiteUrl"),this.createNewPage(e,t)},e._dispatchNewPageActions=function(e,t,n,a){var i=!!e.templateFolderName;return o.e.instance.autoSaver&&o.e.instance.autoSaver.resetAutoSaveAttempts(),u.e.createNewPage(e,n,a,e.templateFolderName).then(function(){if(s.e.setSaveStatus(v.PageSaveStatus.Draft),u.e.setIsTemplate(i),Object(A.e)(1743)&&u.e.setNumMissingRequiredProps(-1),t){var n=!Object(w.F)()&&e.templateFolderName?"SitePages/".concat(e.templateFolderName):"SitePages",a=D.UrlUtilities.removeEndSlash(o.e.instance.pageContext.legacyPageContext.webServerRelativeUrl)+"/".concat(n,"/").concat(e.isPreview?e.previewPageFileName||x.t.previewPageStubFileName:x.t.newPageStubFileName+"?Mode=Edit")+"".concat(e.source?"&source="+encodeURIComponent(e.source):"");t.push(a,{isNewPage:!0})}})},e._dispatchNewPageActionsDeprecated=function(e,t,n,a,i,r,c,d,l,f,p,m,_,h,b,g){var y=!!p;return o.e.instance.autoSaver&&o.e.instance.autoSaver.resetAutoSaveAttempts(),u.e.createNewPageDeprecated(n,a,i,r,c,d,l,f,p,m,b,g).then(function(){s.e.setSaveStatus(v.PageSaveStatus.Draft),u.e.setIsTemplate(y),Object(A.e)(1743)&&u.e.setNumMissingRequiredProps(-1);var n=!Object(w.F)()&&p?"SitePages/".concat(p):"SitePages";if(e){var a=D.UrlUtilities.removeEndSlash(o.e.instance.pageContext.legacyPageContext.webServerRelativeUrl)+"/".concat(n,"/").concat(_?h||x.t.previewPageStubFileName:x.t.newPageStubFileName+"?Mode=Edit")+"".concat(t?"&source="+encodeURIComponent(t):"");e.push(a,{isNewPage:!0})}})},e._extractWebPartIdsFromCanvasContent=function(e){return("string"==typeof e?JSON.parse(e):e).reduce(function(e,t){return t.controlType===S.CanvasControlType.WebPartZone&&e.push({id:t.webPartId}),e},[])},e._loadComponentManifests=function(e){return e&&e.length?new I._ManifestProvider(o.e.instance.serviceScope,o.e.instance.pageContext.legacyPageContext.webAbsoluteUrl).tryGetManifests(e).then(function(e){I._ManifestStore.instance.registerManifests(e,!1)}).catch(function(t){var n=f._LogSource.create("PageCreationActionCreator");f._TraceLogger.logError(n,new Error("Failed to load one or more manifests [".concat(e.join(),"]")))}):Promise.resolve()},e}();t.default=function(){this.actions={coreActions:s.e,chromeActions:i,navActions:d,fieldActions:m,layoutMappingActions:_,statusActions:h.e,templateActions:b,listActions:g,pageCreationActions:M}}}}]);