(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[19],{"/ayA":function(e,t,n){"use strict";var a=n("Pk8u"),i=n("9tPQ");t.e=Object(a.once)(Object(i.e)("lokiAadSearchBoxTokenProvider","https://loki.delve.office.com"))},"0kuo":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return N});var a=n("l9q1"),i=n("/ayA"),r=n("ReWL"),o=n("4ERF"),s=n("ACeQ"),c="from";function d(e){var t=e.siteId,n=e.webId,a=e.isHubSite;return window&&-1!==window.location.search.indexOf("".concat(c,"=").concat("sph"))||window&&-1!==window.location.search.indexOf("".concat(c,"=").concat("spc"))?"SPHomeWeb":Object(s.e)(n,t)?"MSW":a?"HubSiteSearch":function(e){if(e.featureInfo){var t=new o.e(e.featureInfo);if(t){var n=t.get("SitePagePublishing");return!!n&&n.enabled}return!1}var a=e.webTemplate,i=e.webTemplateConfiguration;return!("68"!==a||!i||"SITEPAGEPUBLISHING#0"!==i.toUpperCase())}(e)?"CommSiteSearch":"TeamSiteSearch"}var l=n("K9kD"),u="/search/",f="_api/search/query",p=n("gERi"),m=n("mcYv");function _(e,t,n){if(!Object(p.e)(t)&&Object(r.n)()&&!Object(m.c)()){var a=function(e,t){if(e){var n=e.toLowerCase()+"/",a=n.lastIndexOf(u);if(a>=0)return l.Uri.concatenate(n.substring(0,a+u.length),f)}return l.Uri.concatenate(t,f)}(n,t.webAbsoluteUrl);e.fetchPersonalRankingContext({clientId:d(t),endpoint:a,tokenProvider:function(){return Promise.resolve("")}}).catch(function(){})}}var h,b=n("sjml"),g=n("TB8f"),v=n("+uXQ"),y=n("rFgO"),S=n("Hduh"),D=n("6bSo"),I=n("Pk8u"),x=n("yb5F"),C=n("tw28"),O=n("DA9l"),w=n("l9LU"),E=n("UWqr"),A=n("7awU"),L={AllVerticalContent:"None",FilesVerticalContent:"None"},k=function(){return Promise.resolve("")},M=Object(I.once)(function(e,t){if(h)return h;var n,o,c,d,l,u,f=e.rawSearchCenterUrl?(n=e.rawSearchCenterUrl,Object(x.e)(function(){return Promise.resolve({xhr:{responseText:'{ "d": { "searchcenterurl": "'.concat(n,'" } } '),status:200}})})({cacheId:"searchcenterurl",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return{}}})({}).then(function(e){var t=JSON.parse(e.xhr.responseText);return t&&t.d&&t.d.searchcenterurl||""})):t.fetchRawSearchCenterUrl({siteRoot:(o=e.legacyPageContext,c=Object(v.e)(o),d=Object(g.e)(o),l=o.webAbsoluteUrl,u=Object(s.e)(c,d)?"https://microsoft.sharepoint.com/search":l,u),tokenProvider:k}).catch(function(){return""});e.prefetchOptions.initializeIframeProxy&&t.substrateIframeProxy().catch(),e.warmupOptions.warmupSubstrateSearch&&Object(m.c)()&&function(e,t,n){"SPHomeWeb"===n.clientId?t.then(function(t){return T(e,n,Object(O.e)(t))}):T(e,n)}(t,f,e);var p=e.warmupOptions.warmupMsb&&Object(m.s)()&&function(e,t){Object(a.e)(e,t.legacyPageContext.webAbsoluteUrl,Object(m.i)(),t.legacyPageContext.formDigestValue,!0)({attempt:0}).then(function(n){e.warmupMsb({token:n,clientType:"OfficeSharePoint",msbUrl:e.resolveBingUrl(Object(C.e)(t.legacyPageContext)||"prod"),tokenProvider:function(){return Promise.resolve("")}})})}(t,e)||void 0;!Object(m.c)()&&e.warmupOptions.fetchPersonalRankingContext&&f.then(function(n){return _(t,e.legacyPageContext,n)}).catch(function(){return _(t,e.legacyPageContext)}),e.warmupOptions.fetchPersonalData&&function(e,t){var n=window._spHomePageContext,a=n&&n.mySiteUrl;e.fetchPersonalData({url:t.legacyPageContext.webAbsoluteUrl+"/_api/SP.UserProfiles.PeopleManager/GetMyProperties?$select=AccountName,PersonalUrl,UserUrl",tokenProvider:function(){return Promise.resolve("")}}).then(function(e){var t=JSON.parse(e.xhr.responseText);return t&&t.d&&t.d.PersonalUrl}).catch(function(){return t.errorLogger&&t.errorLogger("FETCH_PERSONAL_URL_FAILED "),""}),a&&"string"==typeof a&&Promise.resolve(a)}(t,e);var y=Promise.resolve(L),D=void 0;if(e.prefetchOptions.prefetchSearchConfiguration&&Object(r.o)()&&!e.isGuestUser){var I=Promise.resolve("");("SPHomeWeb"===e.clientId||E._SPKillSwitch.isActivated("d80437dd-965c-4750-8b7b-83b28efb61c9"))&&(I=f),D=I.then(function(n){var a=Object(b.e)(n,e.legacyPageContext.webAbsoluteUrl),o=Object(i.e)(t,Object(m.i)()?e.legacyPageContext.webAbsoluteUrl:a,Object(m.i)(),e.overrideDigest,!0),s=function(e,t,n){var a="SPHomeWeb"===t.clientId?"SPHome":"ODSP",i="SPHomeWeb"===t.clientId?"":Object(g.e)(t.legacyPageContext);if(E._SPKillSwitch.isActivated("ca55db61-dc8e-46bd-8476-94189650a03b"))i=1===Object(w.e)(t.legacyPageContext)?"":i;else{var o=function(e){return Object(A.e)(e.hubSiteId)}(t.legacyPageContext),s=Object(w.e)(t.legacyPageContext);i=1===s?"":2===s&&""!==o?o:i}return e.fetchAndParseSearchConfiguration({tokenProvider:n,environment:Object(S.e)(t.legacyPageContext),clientType:a,useSimpleRequest:Object(r.P)(),additionalHeaders:{"X-MSSearchScenario":a,"X-MSSearchComponent":"SERP"},siteId:i})}(t,e,o);return y=s.then(function(n){return n&&n.ecsSettings&&n.ecsSettings.enableSerpFileShareConnector?function(e,t){return e.fetchFileShareConnectorSettings({endpoint:t.legacyPageContext.webAbsoluteUrl,tokenProvider:k}).then(function(e){var t=e.xhr,n=JSON.parse(t.responseText);return n&&n.d||L}).catch(function(){return L})}(t,e):L}),s})}return h={rawSearchCenterUrlPromise:f,searchConfigurationPromise:D,fileShareConnectorSettingsPromise:y,personalUrlPromise:p,logActiveExperimentValues:P}});function P(e){[m.a,m.i,m.s,m.c].forEach(function(t){return t(e)})}function T(e,t,n){Object(D.e)(e,t.clientId,n||t.legacyPageContext.webAbsoluteUrl,Object(y.e)(t.legacyPageContext)||"",Object(m.c)(),Object(m.a)(),Object(v.e)(t.legacyPageContext),Object(g.e)(t.legacyPageContext),Object(m.i)(),t.overrideDigest,Object(S.e)(t.legacyPageContext))}var U=n("17wl");function F(e,t){var n=Object(I.find)(e,{Key:t});return n&&n.Value||""}var H=0,R=n("hEaJ");function N(e,t,n,a){var i=M(e,t);if(e.prefetchOptions.prefetchSites){var r=function(e,t,n){var a=t.hubSiteId,i=t.siteId,r=t.webId,o=t.webAbsoluteUrl,s=Object(A.e)(a),c=Object(A.e)(i),d=Object(A.e)(r),l=!!t.hubSiteId&&2===Object(w.e)(t);return function(e){return e.fetcher(function(t){var n=function(e,t){void 0===t&&(t="100");var n,a,i=e.webAbsoluteUrl,r=e.cleanedHubSiteId,o=e.cleanedSiteId,s=e.cleanedWebId,c=e.clientId,d=e.useCrossGeo,l=e.isHubSite,u=r&&l?function(e,t){if(""===e&&!t)return"";var n="",a=Object(A.e)(e);a&&(n="((DepartmentId:".concat(a,") OR (DepartmentId:{").concat(a,"}))"));var i=Object(A.e)(t);if(!i)return n;var r="",o="";return i&&(r="XRANK(cb=1000)",o="((SiteID:".concat(i,") OR (SiteID:{").concat(i,"}))")),"".concat(n).concat(r).concat(o)}(r,o):(n=o,"((WebId:".concat(a=s," AND SiteId:").concat(n,") OR ")+"(WebId:{".concat(a,"} AND SiteId:{").concat(n,"}))")),f=d?",EnableMultiGeoSearch:true":",EnableMultiGeoSearch:false",p=E._SPKillSwitch.isActivated(E.Guid.tryParse("345ae054-3eae-4b5c-bcff-06fa57e5e84a"),"7/20/2020","Change clienttype and clientfunction 2")?"&ClientType='SpClient'":"&ClientType='".concat(c,"'&ClientFunction='fetchSites'");return"".concat(i,"/_api/search/query")+"?QueryText='".concat(u,"'")+"&QueryTemplate='{searchterms} (contentclass=STS_Site OR contentclass=STS_Web)'&SelectProperties='SiteId,WebId,Path,DepartmentId,Title,IsHubSite,RelatedHubSites'&EnableQueryRules=false"+"&Properties='ClientFunction:fetchSites,EnableDynamicGroups:true".concat(f,"'")+"&RowLimit=".concat(t)+"".concat(p)}(t);return e.fetch({url:n,method:"GET",headers:{Accept:"application/json;odata=verbose"},timeoutMs:5e3})},{monitorName:"fetchSitesFromSharePoint",cacheId:"fetchSitesFromSharePoint",cacheVersion:"0",cacheItemLifetime:108e5,cacheKeyExtractor:function(e){return Object(U.__assign)({},e)}})}(e)({webAbsoluteUrl:o,cleanedHubSiteId:s,cleanedSiteId:c,cleanedWebId:d,clientId:n||"SpClient",isHubSite:l,useCrossGeo:!0,tokenProvider:function(){return Promise.resolve("")}}).then(function(e){return JSON.parse(e.xhr.responseText)}).then(function(e){var n,a,i,r,o,s,l=null===(s=null===(o=null===(r=null===(i=null===(a=null===(n=null==e?void 0:e.d)||void 0===n?void 0:n.query)||void 0===a?void 0:a.PrimaryQueryResult)||void 0===i?void 0:i.RelevantResults)||void 0===r?void 0:r.Table)||void 0===o?void 0:o.Rows)||void 0===s?void 0:s.results;if(l&&l.length){var u=l.map(function(e){var n=e.Cells&&e.Cells.results||[],a=F(n,"Path"),i=F(n,"WebId"),r=F(n,"SiteId"),o=F(n,"Title"),s=Object(A.e)(i),l=Object(A.e)(r),u=d===s&&c===l,f=u&&2===Object(w.e)(t);return{siteId:l,webId:s,id:F(n,"DocId"),sitePath:a,url:a,name:o,title:o,departmentId:F(n,"DepartmentId"),relatedHubSites:F(n,"RelatedHubSites"),isHubSite:f,isDefaultSite:u}});if(Object(I.find)(u,{isDefaultSite:!0}))return u;throw new Error("Site not found.")}throw new Error("Sites not found.")}).catch(function(){return[{id:"".concat(--H),siteId:c,webId:d,sitePath:t.webAbsoluteUrl,url:t.webAbsoluteUrl,name:t.webTitle,isHubSite:!!t.isHubSite,isDefaultSite:!0}]})}(t,e.legacyPageContext,e.clientId);i.sitesPromise=r,n&&!E._SPKillSwitch.isActivated("1fbc032f-297b-4e67-ba57-282144aaced2")&&r.then(function(n){Object(R.e)(t,n,e.clientId)})}return Promise.all([i.rawSearchCenterUrlPromise,i.searchConfigurationPromise,i.fileShareConnectorSettingsPromise,i.personalUrlPromise,i.sitesPromise]).then(function(){return a&&a.mark("SerpPrefetchDone")}),i}},"4ERF":function(e,t,n){"use strict";var a=function(){function e(e){if(this._features=new Map,!e)throw new Error("Cannot create SPFeatureInfo object, incoming data is undefined.");for(var t in e)if(void 0!==t){var n=e[t];this._features.set(t,{version:n.Version,enabled:n.Enabled})}}return e.prototype._serialize=function(){var e={};return this._features.forEach(function(t,n){e[n]={Version:t.version,Enabled:t.enabled}}),e},e.prototype.get=function(e){if(!e||e&&0===e.length)throw new Error("Cannot get feature, featureName input is empty or undefined");return this._features.get(e)},e}();t.e=a},"6bSo":function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n("17wl"),i=n("FqN5"),r=n("ReWL"),o=n("ACeQ"),s=n("mcYv"),c=function(e,t,n,c,d,l,u,f,p,m,_){void 0===p&&(p=!1),void 0===m&&(m=""),void 0===_&&(_="Prod");var h=Object(o.e)(u,f)?"https://microsoft.sharepoint.com/search":n,b=e.resolveSubstrateUrl(_);if(Object(r.n)()||Object(s.c)()){e.substrateIframeProxy(b).catch();var g={"x-anchormailbox":c},v=Object(a.__spreadArray)(Object(a.__spreadArray)([],Object(r._)()?["EnabledModernResultTypeWarmup"]:[],!0),Object(s.o)()?["SPOPersonalizedSpeller"]:[],!0);(Object(r._)()||Object(s.o)())&&(g["X-Client-Flights"]=v.join(",")),e.warmupSubstrateSearch({queryStringParameters:Object(a.__assign)(Object(a.__assign)({scenario:t,userContextUrl:h},u&&{webId:u}),f&&{siteId:f}),headers:g,postAction:d?"initv2":"init",substrateUrl:b,tokenProvider:Object(i.e)(e,l,n,p,m,!0,_)}).catch(function(){}),l&&Object(r.s)()&&Object(i.e)(e,!1,n,p,m,!0,_)({attempt:0}).catch(function(){})}}},"9tPQ":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("UWqr");function i(e,t,n){return void 0===n&&(n=!1),function(i,r,o,s,c){void 0===o&&(o=!1),void 0===s&&(s=""),void 0===c&&(c=!1);var d,l,u=0,f=function(){return c&&u>0&&u<=2};return i.withPeriodicRefresh(e,(d=function(){return(o?i.fetchSharePointDigestV2({endpoint:r,overrideDigest:s,tokenProvider:function(){return Promise.resolve("")}}):i.fetchSharePointDigest({endpoint:r,forceDigestRefresh:f})).then(function(e){return JSON.parse(e.xhr.responseText).d.GetContextWebInformation.FormDigestValue}).then(function(e){return i.fetchAcquireToken({portalUrl:r,resourceUrl:t,digest:e,useSTI:n})}).then(function(e){var t=JSON.parse(e.xhr.responseText),n=t.access_token,i=t.expires_on;return u=0,a._SPKillSwitch.isActivated("add015d8-3cd4-4362-b552-524729334435")?n:i?{token:n,expiry:i}:n}).catch(function(e){throw e&&e.status&&403===e.status&&c&&u++,new Error("Failed to retrieve a valid token")})},l=void 0,function(e){return!e.attempt&&l?l:l=d()}))}}},DA9l:function(e,t,n){"use strict";function a(e){if(e){var t=e.length;e.toUpperCase().lastIndexOf("/PAGES")===t-6&&(e=e.substr(0,t-6))}return e}n.d(t,"e",function(){return a})},FqN5:function(e,t,n){"use strict";var a=n("Pk8u"),i=n("9tPQ"),r=Object(a.once)(Object(i.e)("stiSubstrateTokenProvider","https://substrate.office.com",!0)),o=Object(a.once)(Object(i.e)("aadSubstrateTokenProvider","https://outlook.office365.com/search",!1)),s=Object(a.once)(Object(i.e)("aadGallatinSubstrateTokenProvider","https://partner.outlook.cn/search",!1));t.e=function(e,t,n,a,i,c,d){return void 0===a&&(a=!1),void 0===d&&(d="Prod"),t?function(e){return"Gallatin"===e?s:o}(d)(e,n,a,i,c):r(e,n,a,i,c)}},hEaJ:function(e,t,n){"use strict";function a(e,t,n){var a=t&&t.filter(function(e){return e.isDefaultSite})[0];a&&e.fetchSiteNewsSuggestions({site:a,clientId:n,tokenProvider:function(){return Promise.resolve("")}})}n.d(t,"e",function(){return a})},l9q1:function(e,t,n){"use strict";var a=n("Pk8u"),i=n("9tPQ");t.e=Object(a.once)(Object(i.e)("bingSerpTokenProvider","https://www.bing.com"))},rFgO:function(e,t,n){"use strict";function a(e){if(e)return e.aadUserId&&e.aadTenantId?"OID:".concat(e.aadUserId,"@").concat(e.aadTenantId):e.userLoginName||e.userEmail}n.d(t,"e",function(){return a})},sjml:function(e,t,n){"use strict";function a(e,t){var n=function(e){if(!function(e){return/\/search\/?/i.test(e)}(e))return"";var t=e.toLowerCase()+"/",n="/search/",a=t.lastIndexOf(n);return a<0?"":t.substring(0,a+n.length).replace(/\/$/,"")}(e);return n||t}n.d(t,"e",function(){return a})}}]);