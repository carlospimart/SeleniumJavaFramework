define("1cea229f-b208-4202-8014-22503d92a019_0.1.0",["tslib","@ms/sp-telemetry","@microsoft/sp-image-helper","@ms/odsp-core-bundle","@microsoft/office-ui-fabric-react-bundle","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-page-context","@ms/i18n-utilities","@ms/sp-component-utilities","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p,m){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,d=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);d.length;)d.shift()()}var n={},a={0:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise(function(t,i){n=a[e]=[t,i]});t.push(n[2]=r);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+"chunk."+({1:"sp-queryablemanagedproperties",2:"sp-retrievablemanagedproperties"}[e]||e)+"_"+"none"+"_"+{1:"39c1d3bdf418fcf4a3f9",2:"85ee2abfe1dfa40309fb"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(d);var n=a[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",c.name="ChunkLoadError",c.type=i,c.request=r,n[1](c)}a[e]=void 0}};var d=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var r=window.webpackJsonp_1cea229f_b208_4202_8014_22503d92a019_0_1_0=window.webpackJsonp_1cea229f_b208_4202_8014_22503d92a019_0_1_0||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var s=0;s<r.length;s++)t(r[s]);var c=o;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-dataproviders_en-us_e4f539084346d9f39149\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="mwqp")}({"0Res":function(e,t,n){e.exports=n.p+"icon_helpitemimg1_c0dba21d.png"},"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"6DSs":function(e){e.exports=JSON.parse('{"e":"Can\\u0027t get data. {0}: {1} REST call failed. Status Code: {2} Status Message: {3}"}')},"8dK2":function(e,t){e.exports=i},"9G/9":function(e){e.exports=JSON.parse('{"e":"Search"}')},G9eg:function(e,t,n){e.exports=n.p+"icon_helpitemimg2-2x_5a055172.png"},K9kD:function(e,t){e.exports=r},KL1q:function(e,t){e.exports=o},LJjX:function(e,t,n){e.exports=n.p+"icon_helpitemimg2_4dca3af9.png"},Pk8u:function(e,t){e.exports=s},QRxg:function(e){e.exports=JSON.parse('{"e":"Page"}')},QVYh:function(e,t,n){var a=n("K9kD");e.exports=a.SPAlternativeUrls},"R/pT":function(e){e.exports=JSON.parse('{"e":"Can\\u0027t get data. A list identifier or title must be specified."}')},UWqr:function(e,t){e.exports=c},"X+PM":function(e,t){e.exports=d},Y2xY:function(e,t,n){e.exports=n.p+"icon_helpitemimg3-2x_ef307bcc.png"},Ycni:function(e,t){e.exports=l},YkpB:function(e){e.exports=JSON.parse('{"t":"List","e":"Invalid ListRequestType value."}')},fP0x:function(e){e.exports=JSON.parse('{"t":"Unknown error happens.","e":"This Events list no longer exists. Try a different Events list."}')},hE4m:function(e){e.exports=JSON.parse('{"p":"Keep your team updated with news on your team site","f":"From the site home page you\\u0027ll be able to quickly author a news post - a status update, trip report, or even just highlight a document with some additional context provided to the team.","m":"https://go.microsoft.com/fwlink/p/?linkid=827920","h":"What is a team site?","_":"A SharePoint team site connects you and your team to the content, information, and apps you rely on every day. For example, you can use a team site to store and collaborate on files or to create and manage lists of information. On a team site home page, you can view links to important team files, apps, and web pages and see recent site activity in the activity feed.","b":"https://go.microsoft.com/fwlink/p/?linkid=827918","v":"Add a page to a site","g":"Using pages is a great way to share ideas using images, Excel, Word and PowerPoint documents, video, and more. You can create and publish pages quickly and easily, and they look great on any device. When you create a page, you add and customize web parts with a toolbox available right in the editing pane. And, you can publish with just a click.","y":"https://go.microsoft.com/fwlink/p/?linkid=827919","I":"Welcome to the new team site experience","D":"Quickly author a new news post, a status update, or a trip report on the new team site home page.","S":"SharePoint","w":"News","x":"Hub News","O":"My News","C":"Multi-site News","n":"Create a news post","i":"No news posts are available right now","t":"Keep your audience engaged by sharing your latest updates.","a":"Check back later to see the latest News.","l":"Title of news post","d":"Preview that shows the first few lines of the article.","c":"Author name","u":"A few seconds ago","e":"Automatic","r":"Build successful portals","o":"Modern SharePoint branding","s":"SharePoint News reaches more users"}')},"hiL/":function(e,t){e.exports=u},j2UY:function(e,t,n){e.exports=n.p+"icon_helpitemimg1-2x_296a0ca6.png"},mBwh:function(e,t,n){e.exports=n.p+"icon_helpitemimg3_7f442b60.png"},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"BaseDataProvider",function(){return o}),n.d(t,"BookmarksDataProvider",function(){return M}),n.d(t,"NewsUtilities",function(){return X}),n.d(t,"news",function(){return Z}),n.d(t,"viewCounts",function(){return $}),n.d(t,"currentViewCounts",function(){return ee}),n.d(t,"hubNews",function(){return te}),n.d(t,"newsDigest",function(){return ne}),n.d(t,"multiSiteNews",function(){return ae}),n.d(t,"myNews",function(){return ie}),n.d(t,"staleViewCounts",function(){return re}),n.d(t,"NewsDataSource",function(){return U}),n.d(t,"newsDataSourceProp",function(){return F}),n.d(t,"_appendAudienceFilteringQueryParam",function(){return H}),n.d(t,"_appendLanguageOverrideQueryParam",function(){return R}),n.d(t,"_getExtraDataForLogging",function(){return N}),n.d(t,"NewsEmptyStateType",function(){return V}),n.d(t,"ExchangeViewCountsDataProvider",function(){return fe}),n.d(t,"HubNewsDataProvider",function(){return Le}),n.d(t,"MicroServiceNewsDataProvider",function(){return ye}),n.d(t,"NewsDataProvider",function(){return Ne}),n.d(t,"NewsDigestDataProvider",function(){return je}),n.d(t,"NewsDigestUtilities",function(){return Ve}),n.d(t,"NewsSearchDataProvider",function(){return ut}),n.d(t,"MultiSiteNewsDataProvider",function(){return Fe}),n.d(t,"MyNewsDataProvider",function(){return ft}),n.d(t,"tryGetAuthoritativeSiteDetails",function(){return z}),n.d(t,"DocumentType",function(){return Qe}),n.d(t,"FilterOperator",function(){return Ye}),n.d(t,"FilterSince",function(){return Je}),n.d(t,"FilterType",function(){return K}),n.d(t,"UserType",function(){return $e}),n.d(t,"TokenUtilities",function(){return et}),n.d(t,"TieredCacheHelper",function(){return v}),n.d(t,"ContentLocation",function(){return We}),n.d(t,"ContentType",function(){return qe}),n.d(t,"DeferredManagedProperties",function(){return _t}),n.d(t,"KQLQueryBuilder",function(){return ct}),n.d(t,"AUDIENCE_TARGET_KQL_QUERY",function(){return st}),n.d(t,"ManagedDataType",function(){return Xe.e}),n.d(t,"SortType",function(){return Ze}),n.d(t,"SearchDataProvider",function(){return lt}),n.d(t,"PersonaSettingsCache",function(){return ht}),n.d(t,"sanitizeSearchQueryParameter",function(){return bt}),n.d(t,"CAMLQueryBuilder",function(){return Nt}),n.d(t,"ListRequestType",function(){return Bt}),n.d(t,"ListDataProvider",function(){return zt}),n.d(t,"ContentRollupDataProvider",function(){return Kt}),n.d(t,"EventDataProvider",function(){return un}),n.d(t,"EventsSearchDataProvider",function(){return _n}),n.d(t,"EventsListDataProvider",function(){return bn}),n.d(t,"PageDataProvider",function(){return Dn}),n.d(t,"PageDataSource",function(){return vn}),n.d(t,"_getWebPartDataFromPage",function(){return In}),n.d(t,"TemplatePanelDataSource",function(){return On}),n.d(t,"TemplateSelectedPageCopyDataSource",function(){return wn}),n.d(t,"TemplateSelectedPageAsJsonDataSource",function(){return En}),n.d(t,"DefaultNewPageTemplateIdDataSource",function(){return An}),n.d(t,"DeleteTemplatePageDataSource",function(){return Ln}),n.d(t,"TemplatePanelDataProvider",function(){return kn}),n.d(t,"TemplatePanelSelectedPageCopyDataProvider",function(){return Mn}),n.d(t,"TemplatePanelSelectedPageAsJsonDataProvider",function(){return Pn}),n.d(t,"DefaultNewPageTemplateIdDataProvider",function(){return Tn}),n.d(t,"DeleteTemplatePageDataProvider",function(){return Un}),n.d(t,"RecentDocumentsDataProvider",function(){return Fn}),n.d(t,"TopicFirstRunDataProvider",function(){return Kn}),n.d(t,"TopicFirstRunKeys",function(){return Vn}),n.d(t,"ViewCountDataProvider",function(){return ue}),n.d(t,"ListDataSource",function(){return It}),n.d(t,"ListFieldDataSource",function(){return Ct}),n.d(t,"ListFieldType",function(){return Ot}),n.d(t,"ListItemDataSource",function(){return Lt}),n.d(t,"SPRenderListDataOptions",function(){return wt}),n.d(t,"ListViewDataSource",function(){return Mt}),n.d(t,"BaseDataSource",function(){return gt}),n.d(t,"ODataQueryStringBuilder",function(){return St}),n.d(t,"SPDataSource",function(){return yt}),n.d(t,"SPHomeHttpClient",function(){return E}),n.d(t,"SPHomeMicroserviceNotAvailableError",function(){return f}),n.d(t,"SPHomeMicroserviceFetchTokenError",function(){return p}),n.d(t,"SeeAllPageLayoutWebparts",function(){return Wn}),n.d(t,"SearchAPIRequest",function(){return Ke}),n.d(t,"SearchAPISortDirection",function(){return ze});var a=n("X+PM"),i=n("vlQI"),r=n("UWqr"),o=function(){function e(e){return this._options=e,this._serviceScope=e.serviceScope,this}return e.prototype.requestData=function(e){var t=this;return this.resolveServices().then(function(){return t.getItems(e)})},e.prototype.resolveServices=function(){var e=this;return new Promise(function(t,n){e._serviceScope.whenFinished(function(){e._pageContext=e._serviceScope.consume(a.PageContext.serviceKey),e._baseEndPoint=r.UrlUtilities.removeEndSlash(e._pageContext.web.absoluteUrl),e._options.useHttpClient?e._httpClient=e._serviceScope.consume(i.HttpClient.serviceKey):e._spHttpClient=e._serviceScope.consume(i.SPHttpClient.serviceKey),e._options.requiresTokenProvider&&(e._tokenProvider=e._serviceScope.consume(i.OAuthTokenProvider.serviceKey)),t()})})},Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"httpClient",{get:function(){return this._httpClient},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spHttpClient",{get:function(){return this._spHttpClient},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageContext",{get:function(){return this._pageContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenProvider",{get:function(){return this._tokenProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseEndPoint",{get:function(){return this._baseEndPoint},enumerable:!1,configurable:!0}),e}(),s=n("ut3N"),c=n("17wl"),d=n("KL1q"),l=n("hiL/"),u=n("y88i"),f=function(e){this.name="SPHomeMicroserviceNotAvailableError",this.message="SPHome Microservice not available in this environment",this.message=e||this.message},p=function(e,t){this.message="Unknown Token Error",this.name=e,this.message=t||this.message};function m(e){return e?JSON.stringify({name:e.name,message:e.message}):""}var _=function(e){function t(t){var n=e.call(this,t)||this;return n._requestUpdater=function(e){return Promise.resolve(e)},n}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"requestUpdater",{set:function(e){this._requestUpdater=e},enumerable:!1,configurable:!0}),t.prototype._fetch=function(t,n,a){var i=this;return this._requestUpdater({url:t,options:a}).then(function(t){return e.prototype._fetch.call(i,t.url,n,t.options)})},t}(i.SPHttpClient),h=r.ServiceKey.create("sp-http:SPHttpMicroserviceClient",_),b="TieredCacheHe",g=function(){function e(){}return e.applyCacheAndNetwork=function(t,n,a,i){var r=new s._QosMonitor("".concat(a.qosMonitorLabel,".getProcessedResponseInSmartRace")),o=t.serverResponse.then(function(e){return a.parseHttpClientResponse(e,n,r)}).then(function(t){var n=a.isEmptyResponse(t);return e._executeIfDefined(a,a.onServerResponseResolved,n),t}).catch(function(t){throw e._executeIfDefined(a,a.onServerResponseFailed,t),t}),c=new s._QosMonitor("".concat(a.qosMonitorLabel,".getProcessedCachedResponseInSmartRace")),d=[{raceablePromise:e.processResponseRawData(t.cachedResponse,a.isRawData,a.processRawData,n,c).then(function(t){var n=a.isEmptyResponse(t);return e._executeIfDefined(a,a.onCacheResponseResolved,n),t}).catch(function(t){throw c.writeUnexpectedFailure("ParseCacheResultsFailed",t),e._executeIfDefined(a,a.onCacheResponseFailed,t),t}),raceId:e._cachedDataPromiseId},{raceablePromise:o,raceId:e._serverDataPromiseId}];return l.SmartRace.race(d).then(function(t){return t.raceId===e._cachedDataPromiseId&&o.then(function(t){e._executeIfDefined(a,a.onServerResponseResolvedWithCache,t)}).catch(function(){}),i.writeSuccess({cacheStatus:t.raceId===e._cachedDataPromiseId?"WonRace":"LostRace"}),t.raceablePromise}).catch(function(e){throw i.writeUnexpectedFailure("SmartRaceFailed",e),e})},e.applyCacheThenNetwork=function(t,n,a,i){var r,o=t.cachedResponse?e.processResponseRawData(t.cachedResponse,a.isRawData,a.processRawData,n,i):void 0,c=new s._QosMonitor("".concat(a.qosMonitorLabel,".getProcessedResponse")),d=null===(r=t.serverResponse)||void 0===r?void 0:r.then(function(e){return a.parseHttpClientResponse(e,n,c)}).then(function(t){var n=a.isEmptyResponse(t);return e._executeIfDefined(a,a.onServerResponseResolved,n),t}).catch(function(t){throw e._executeIfDefined(a,a.onServerResponseFailed,t),t});return o?(o.then(function(t){var n=a.isEmptyResponse(t);e._executeIfDefined(a,a.onCacheResponseResolved,n),d?(e._executeIfDefined(a,a.onCacheThenNetworkServerDataReturned,d,!0,n),d.then(function(t){e._executeIfDefined(a,a.onServerResponseResolvedWithCache,t)}).catch(function(){})):e._executeIfDefined(a,a.onCacheThenNetworkServerDataNotReturned,!0,n)}).catch(function(t){e._executeIfDefined(a,a.onCacheResponseFailed,t)}),o):(i.writeSuccess(),e._executeIfDefined(a,a.onCacheThenNetworkServerDataReturned,d,!1,!0),d)},e.executeCacheStrategy=function(t,n,a){var i=new s._QosMonitor("".concat(t.qosMonitorLabel,".getData"));return n(a).then(function(n){var r;if(n instanceof Response||(null===(r=n)||void 0===r?void 0:r.nativeResponse)instanceof Response)return t.parseHttpClientResponse(n,a,i);var o=n;return o.serverResponse&&o.cachedResponse?e.applyCacheAndNetwork(o,a,t,i):o.cachedResponse||o.serverResponse?e.applyCacheThenNetwork(o,a,t,i):e.processResponseRawData(Promise.resolve(n),t.isRawData,t.processRawData,a).then(function(n){return i.writeSuccess(),e._executeIfDefined(t,t.onCacheResponseResolved,!!n),n}).catch(function(n){throw i.writeUnexpectedFailure("Error Processing cached data",n),e._executeIfDefined(t,t.onCacheResponseFailed,n),n})}).catch(function(e){throw i.hasEnded||i.writeUnexpectedFailure("Excecute Request failed",e),e})},e.processResponseRawData=function(e,t,n){for(var a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];return e.then(function(e){return t(e)?n.apply(void 0,Object(c.__spreadArray)([e],a,!1)):e})},e.getAppCacheDataProvider=function(e){return e.consume(Object(i._getCacheDataProviderServiceKey)())._provider},e.generateCacheKey=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var a=[];return t.forEach(function(t){"string"==typeof t?a.push(t.toUpperCase()):a.push(e._serializeMap(t))}),Object(l.sha256)(a.sort().join(","))},e.getItem=function(e,t,n,a){var i=new s._QosMonitor("".concat(b,".").concat(t,".getItem"));return n.getData(e,a).then(function(e){return i.writeSuccess(),Promise.resolve(e.data)}).catch(function(e){return i.writeUnexpectedFailure("GetTieredCacheFailed",e),Promise.reject(e)})},e.getItemVerbose=function(e,t,n,a){var i=new s._QosMonitor("".concat(b,".").concat(t,".getItemVerbose"));return n.getData(e,a).then(function(e){return i.writeSuccess(),Promise.resolve(e)}).catch(function(e){return i.writeUnexpectedFailure("GetTieredCacheFailed",e),Promise.reject(e)})},e.setItem=function(e,t,n,a,i){var r=new s._QosMonitor("".concat(b,".").concat(n,".setItem"));return a.setData(e,t,i).then(function(){return r.writeSuccess(),Promise.resolve()}).catch(function(e){return r.writeUnexpectedFailure("SetItemFailed",e),Promise.reject(e)})},e._serializeMap=function(t){var n=t instanceof Array;return Object.keys(t).map(function(a){var i=n?"":a.toUpperCase();return t[a]instanceof Object?i+e._serializeMap(t[a]):i+"".concat(t[a]).toUpperCase()}).sort().reduce(function(e,t){return e+t},"")},e.useStalePropName="useStale",e.enableDataPrefetch="enableDataPrefetch",e.dataPrefetchKey="dataPrefetchKey",e.parentKeyOverride="parentKeyOverride",e.onlyIndexedDB="onlyIndexedDB",e.onlyMySiteCache="onlyMySiteCache",e.cacheKeyOverride="cacheKeyOverride",e._cachedDataPromiseId=r.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),e._serverDataPromiseId=r.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),e._executeIfDefined=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];if(t)return t.apply(e,n)},e}(),v=g;function y(){return r._SPKillSwitch.isActivated("83c7fd57-b124-44b5-98c9-19fbfa5e8826")}function S(){return r._SPKillSwitch.isActivated("ac52d2d0-e041-4af4-9eaa-addeba264ba3")}function D(){return r._SPKillSwitch.isActivated("e7a8878e-98e5-447b-b462-bcbb1df03ac8")}function I(){return r._SPKillSwitch.isActivated("f6d6f28c-002c-42c8-8825-59c0be23c8a4")}function x(){return r._SPKillSwitch.isActivated("b35f5ad6-6538-41ec-bbfa-14c8109a4b44")}function C(){return r._SPKillSwitch.isActivated("e9d08579-a002-4119-bd5d-b52687094d1f")}var O=new l.KillSwitch("0306551a-b040-4e46-ae3d-98f35375764b"),w=function(){return r._SPKillSwitch.isActivated("6605c58b-ddee-4dbc-8260-94ab68b82d04")},E=function(){function e(e){var t=this;this._isServiceAvailable=void 0,this._hasPrefetchedToken=!1,this._sphomeTokenError={PrefetchError:void 0,ApiError:void 0},this._requestUpdater=function(e){return t._fetchTokenIfExpired().then(function(){return{url:t._generateUrlVersionedPath(e.url),options:t._getRequestOptions(e.options)}})},this._isPrefetchTokenFlightEnabled&&(this._initializeFromPrefetchedToken=new Promise(function(e,n){var a=new d.Async;window._spHomeClientContextLoaded=function(){a.dispose();var i=new s._QosMonitor("SpHomeClientContextPrefetch");try{t._initializeWithPrefetchedToken(),t._hasPrefetchedToken?i.writeSuccess():i.writeUnexpectedFailure("NoPrefetchedToken")}catch(e){i.writeUnexpectedFailure("Unexpected",e),!w()&&e instanceof Error&&(t._sphomeTokenError.PrefetchError=e),n(e)}e()},w()?a.setTimeout(function(){return!t._hasPrefetchedToken&&n(new Error("Timeout"))},1e4):a.setTimeout(function(){if(!t._hasPrefetchedToken){var e=new Error("Timeout");t._sphomeTokenError.PrefetchError=e,n(e)}},1e4)})),this._stopUsingSPHttpMSClient=r._SPKillSwitch.isActivated("14b96c7e-3dcc-42e8-8a42-f56091d1f9f3"),e.whenFinished(function(){t._spHttpClient=e.consume(i.SPHttpClient.serviceKey),t._stopUsingSPHttpMSClient||(t._spHttpMicroserviceClient=e.consume(h),t._spHttpMicroserviceClient.requestUpdater=t._requestUpdater),t._httpClient=e.consume(i.HttpClient.serviceKey),t._pageContext=e.consume(a.PageContext.serviceKey),t._isPrefetchTokenFlightEnabled&&t._initializeWithPrefetchedToken(),t._isUserSupportedBySubstrate=t._isSubtrateSupportedUser(e.consume(a.PageContext.serviceKey).user)})}return e.prototype.get=function(e,t,n,a){return a?this._get(e,t,n,a):this._get_deprecated(e,t,n)},e.prototype.post=function(e,t,n,a,i){return i?this._post(e,t,n,a,i):this._post_deprecated(e,t,n,a)},Object.defineProperty(e.prototype,"isServiceAvailable",{get:function(){var e=this;return void 0!==this._isServiceAvailable?Promise.resolve(this._isServiceAvailable):this._fetchTokenIfExpired().then(function(){return e._isServiceAvailable=!0,e._isServiceAvailable}).catch(function(t){return e._isServiceAvailable=!1,e._isServiceAvailable})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUserSupportedBySubstrate",{get:function(){return this._isUserSupportedBySubstrate},enumerable:!1,configurable:!0}),e.prototype._get=function(e,t,n,a){var r=this;if(!this._stopUsingSPHttpMSClient&&this._spHttpMicroserviceClient){var o=this._generateVersionedPath(e,t);return this._spHttpMicroserviceClient.get(o,new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),this._getRequestOptions({},n),this._getCacheConfiguration(a,o))}return this._fetchTokenIfExpired().then(function(){return r._spHttpClient.get(r._generateUrl(e,t),new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),r._getRequestOptions({},n),a)})},e.prototype._get_deprecated=function(e,t,n){var a=this;return this._fetchTokenIfExpired().then(function(){return O.isActivated()?a._httpClient.get(a._generateUrl(e,t),i.HttpClient.configurations.v1,a._getRequestOptions({},n)):a._spHttpClient.get(a._generateUrl(e,t),new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),a._getRequestOptions({},n))})},e.prototype._post=function(e,t,n,a,r){var o=this;if(void 0===t&&(t=""),!this._stopUsingSPHttpMSClient&&this._spHttpMicroserviceClient){var s=this._generateVersionedPath(e,n);return this._spHttpMicroserviceClient.fetch(s,new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),this._getRequestOptions({body:t},a,"POST"),this._getCacheConfiguration(r,s))}return this._fetchTokenIfExpired().then(function(){return o._spHttpClient.fetch(o._generateUrl(e,n),new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),o._getRequestOptions({body:t},a,"POST"),r)})},e.prototype._post_deprecated=function(e,t,n,a){var r=this;return void 0===t&&(t=""),this._fetchTokenIfExpired().then(function(){return O.isActivated()?r._httpClient.post(r._generateUrl(e,n),i.HttpClient.configurations.v1,r._getRequestOptions({body:t},a)):r._spHttpClient.post(r._generateUrl(e,n),new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),r._getRequestOptions({body:t},a))})},e.prototype._getCacheConfiguration=function(e,t){return e&&(e.extraProps||(e.extraProps=new Map),e.extraProps.set(v.parentKeyOverride,t)),e},e.prototype._generateUrl=function(t,n){return void 0===n&&(n=1),r.Text.format(e.MICROSERVICE_ENDPOINT,this._url,n,t)},e.prototype._generateUrlVersionedPath=function(t){return r.Text.format(e.MICROSERVICE_ENDPOINT_V,this._url,t)},e.prototype._generateVersionedPath=function(t,n){return void 0===n&&(n=1),r.Text.format(e.VERSIONED_PATH,n,t)},e.prototype._isTokenValid=function(){return!!(this._tokenExpiry&&this._tokenExpiry>new Date)},e.prototype._getTokenAndMicroserviceDetails=function(){var e,t=this,n=new s._QosMonitor("SPHomeHttpClient"),a="".concat(this._pageContext.web.absoluteUrl,"/_api/sphomeservice/context?$expand=Token,Payload");return this._spHttpClient.get(a,i.SPHttpClient.configurations.v1).then(function(t){if(e=t.correlationId?t.correlationId.toString():void 0,t.ok)return t.json();var a=new Error(t.statusText);throw n.writeUnexpectedFailure("FailedResponse",a,{correlationId:e,Status:t.status}),a}).then(function(e){if(!e.Token||!e.Token.access_token)throw t._isServiceAvailable=!1,new f;t._isServiceAvailable=!0,t._token=e.Token.access_token,t._tokenExpiry=new Date(1e3*Number(e.Token.expires_on)-15e3),t._payload=e.Payload,t._url=e.Urls[0],t._alreadyGettingTokenPromise=void 0,n.writeSuccess()}).catch(function(a){throw a instanceof f?n.writeExpectedFailure("NotAvailable",a,{correlationId:e}):n.writeUnexpectedFailure("SPHomeHttpClient",a,{correlationId:e}),t._alreadyGettingTokenPromise=void 0,w()||(t._sphomeTokenError.ApiError=a),a})},e.prototype._getRequestOptions=function(e,t,n){var a;void 0===e&&(e={});var i={};this._token&&(i.Authorization="Bearer ".concat(this._token)),this._payload&&(i["SPHome-ApiContext"]=this._payload),i["Content-Type"]="application/json",i["SPHome-ClientType"]="PagesWeb",(null===(a=this._pageContext)||void 0===a?void 0:a.legacyPageContext)&&(i.FarmLabel=this._pageContext.legacyPageContext.farmLabel);var r=u.SPAlternativeUrls.tryGetAlternativeUrl("AFDCDNEnabled");return r&&(i["client-on-afd-spo"]=("True"===r).toString()),n&&(i["X-HTTP-Method"]=n,e.method=n),t&&t.forEach(function(e,t){i[t]=e}),Object(c.__assign)(Object(c.__assign)({},e),{headers:Object(c.__assign)(Object(c.__assign)({},e.headers||{}),i)})},e.prototype._initializeWithPrefetchedToken=function(){var e,t=new s._QosMonitor("InitializeSpHomeClientContext");try{if(!this._hasPrefetchedToken)if(window._spHomeClientContext&&window._spHomeClientContext!==[]){var n=window._spHomeClientContext,a=n.Token;this._token=null==a?void 0:a.AccessToken,this._payload=n.Payload,this._url=null===(e=n.Urls)||void 0===e?void 0:e[0],this._tokenExpiry=(null==a?void 0:a.ExpiresOn)?new Date(1e3*Number(a.ExpiresOn)-15e3):void 0,this._hasPrefetchedToken=!0,t.writeSuccess()}else window._spHomeClientContext===[]?t.writeUnexpectedFailure("SPHomeClientContextNotAvailable",new Error("EmptyTokenReturned")):t.writeExpectedFailure("SPHomeClientContextNotAvailable",new Error("TokenNotAvailable"))}catch(e){this._hasPrefetchedToken=!1,t.writeUnexpectedFailure("InitializeSPHomeClientContextFailed",e.message)}return this._hasPrefetchedToken},e.prototype._fetchTokenIfExpired=function(){var e=this;if(this._isTokenValid())return Promise.resolve();if(!this._alreadyGettingTokenPromise)if(this._initializeFromPrefetchedToken){var t=r.Guid.parse("928806ac-3e49-4e4e-9114-7c392215230f"),n=r.Guid.parse("5ff931f9-8682-4614-b4f1-9b8d1aa74942"),a=[{raceablePromise:this._initializeFromPrefetchedToken,raceId:t},{raceablePromise:this._getTokenAndMicroserviceDetails(),raceId:n}];this._alreadyGettingTokenPromise=l.SmartRace.race(a).then(function(e){return e.raceablePromise}).catch(function(t){throw w()?t:new p("SPHomeFetchTokenFailedByPrefetchAndServer","PrefetchError: ".concat(m(e._sphomeTokenError.PrefetchError),"; ApiError: ").concat(m(e._sphomeTokenError.ApiError)))})}else this._alreadyGettingTokenPromise=this._getTokenAndMicroserviceDetails().catch(function(t){if(!(w()||t instanceof f))throw new p("SPHomeFetchTokenFailedByServer",m(e._sphomeTokenError.ApiError));throw t});return this._alreadyGettingTokenPromise},Object.defineProperty(e.prototype,"_isPrefetchTokenFlightEnabled",{get:function(){return r._SPFlight.isEnabled(1265)},enumerable:!1,configurable:!0}),e.prototype._isSubtrateSupportedUser=function(e){if(e){var t=e.isAnonymousGuestUser,n=e.isExternalGuestUser;return!t&&!n}return!0},e.serviceKey=r.ServiceKey.create("sp-component-utilities:SPHomeHttpClient",e),e.MICROSERVICE_ENDPOINT="{0}/api/v{1}/{2}",e.MICROSERVICE_ENDPOINT_V="{0}/api/{1}",e.VERSIONED_PATH="v{0}/{1}",e}(),A="AddBookmark",L="RemoveBookmark",k="IsBookmarked",M=function(){function e(e,t){var n=this;this._qosComponentName=e,t.whenFinished(function(){n._spHomeHttpClient=t.consume(E.serviceKey)})}return e.prototype.addBookmark=function(e){var t=new s._QosMonitor(this._qosComponentName+"."+A),n=e;return this._spHomeHttpClient.post("documents/followed/add",JSON.stringify(n)).then(function(e){return e.ok}).then(function(e){return t.writeSuccess(),e}).catch(function(e){return t.writeUnexpectedFailure(A),!1})},e.prototype.removeBookmark=function(e){var t=new s._QosMonitor(this._qosComponentName+"."+L),n=decodeURI(e);return this._spHomeHttpClient.post("documents/followed/remove",JSON.stringify(n)).then(function(e){return e.ok}).then(function(e){return t.writeSuccess(),e}).catch(function(e){return t.writeUnexpectedFailure(L),!1})},e.prototype.isBookmarked=function(e){var t=new s._QosMonitor(this._qosComponentName+"."+k);return this._spHomeHttpClient.isUserSupportedBySubstrate?this._isBookmarkedRequest(e).then(function(e){return t.writeSuccess(),e.json()}).then(function(e){return e.SavedForLater}).catch(function(e){return t.writeUnexpectedFailure(k),!1}):(t.writeExpectedFailure("SubstrateUnsupportedUser"),Promise.resolve(!1))},e.prototype._isBookmarkedRequest=function(e){var t="document/metadata?siteId=".concat(e.siteId,"&webId=").concat(e.webId)+"&listId=".concat(e.listId,"&uniqueId=").concat(e.listItemUniqueId,"&url=").concat(e.url)+(e.groupId?"&groupId=".concat(e.groupId):"");return this._spHomeHttpClient.get(t)},e}(),P=n("8dK2"),T=n("QVYh"),U={CurrentSite:1,Hub:2,ChooseSites:3,MyNews:4},F="newsDataSourceProp";function H(e){return e.audienceTargetingEnabled?"&".concat("filterByAudience","=true"):""}function R(e,t){void 0===t&&(t=!1);var n=e.languageOverride;return n?t?"&languageOverride='".concat(n,"'"):"&languageOverride=".concat(n):""}function N(e,t){var n="noFilter";e.serializedFilterQuery?n="filterCAMLQueryAdded":e.filterKQLQuery&&(n="filterKQLQueryAdded");var a={audienceTargetingEnabled:(!!e.audienceTargetingEnabled).toString(),isOnSeeAllPage:X.isOnSeeAllPage.toString(),isAdvanceMode:(!!e.languageOverride).toString(),alias:n};return t&&t.legacyPageContext&&t.legacyPageContext.isHubSite&&(a.service="HubSite"),a}var B=n("hE4m"),j=function(){function e(){}return e.getIconUrl=function(t){if(t===e._modernizedImageKey&&!e._assetIconsMap[this._modernizedImageKey]){var a=n("pJH1");e._assetIconsMap[this._modernizedImageKey]=[a,a]}var i=e._assetIconsMap[t];return i[window.devicePixelRatio>=2&&i.length>=2?1:0]},e._assetIconsMap={HelpImg1:[n("0Res"),n("j2UY")],HelpImg2:[n("LJjX"),n("G9eg")],HelpImg3:[n("mBwh"),n("Y2xY")]},e._modernizedImageKey="HelpImgModern",e}(),V={None:0,TeamSite:1,CommSite:2,Carousel:3};function z(e,t,n){if(e&&t&&n.legacyPageContext&&n.legacyPageContext.organizationNewsSiteReference){var a=r.Guid.tryParse(e),i=r.Guid.tryParse(t);if(a&&i&&n.legacyPageContext.organizationNewsSiteReference)for(var o=0,s=n.legacyPageContext.organizationNewsSiteReference;o<s.length;o++){var c=s[o];if(G(a,i,c))return c}}}function G(e,t,n){var a=r.Guid.tryParse(n.SiteId),i=r.Guid.tryParse(n.WebId);return!!(a&&i&&e.equals(a)&&t.equals(i))}var K={TitleContaining:1,AnyTextContaining:2,TaggedWith:3,CreatedBy:4,ModifiedBy:5,Field:6,RecentlyChanged:7,RecentlyAdded:8,PageAuthorByline:9},W=n("Pk8u"),q="newsProcessBannerImageUrl",Q="",Y={filterType:K.TitleContaining,value:"",values:[]},J=function(e){this["OData-Version"]="3.0",this["If-Match"]="*",this["X-HTTP-Method"]=e},X=function(){function e(){}return e._isHaukShadowcallsKillSwitchActivated=function(){return r._SPKillSwitch.isActivated("79c0fa86-b3e9-44e2-988d-d3990317c384")},e._isPPSShadowcallsKillSwitchActivated=function(){return r._SPKillSwitch.isActivated("612dd0c0-cbf8-4314-802a-a8896fc00709")},e.isCallToActionEnabled=function(){return r._SPFlight.isEnabled(60497)},e.cacheViewCountsValue=function(t,n,a){var i=e.viewCountsDictionary[t+"/"+n];(void 0===i||i<a)&&(e.viewCountsDictionary[t+"/"+n]=a)},e._internalGetTeamSiteHelpItems=function(t,n){var i=void 0!==t&&t<=3?t:3,r=[],o=!1;n&&n.whenFinished(function(){var e=n.consume(a.PageContext.serviceKey);o=e.legacyPageContext.IsHomepageModernized});for(var s=[{description:o?B.D:B.f,title:o?B.I:B.p,url:o?e._mdrnHelpUrl:B.m},{description:B._,title:B.h,url:B.b},{description:B.g,title:B.v,url:B.y}],c=0;c<i;c++){var d="f7752afa-9c69-49c8-bc62-5b5b35d01775",l=o&&0===c?"Modern":"".concat(c+1);r.push({author:B.S,authorInitial:"SP",authorAccountName:"",description:s[c].description,email:"",image:j.getIconUrl("HelpImg"+l),publishedOn:new Date,publishedOnRelativeTime:"",title:s[c].title,url:s[c].url,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:d,siteId:d,webId:d})}return r},e.isValidNewsSource=function(e){return e===U.CurrentSite||e===U.Hub||e===U.ChooseSites||e===U.MyNews},e.getEmptyStateItems=function(t,n,a,i){switch(t){case V.CommSite:return e.getCommSiteHelpArticles(a);case V.TeamSite:return e._internalGetTeamSiteHelpItems(a,n);case V.Carousel:return e.getEmptyCarouselItems(a,i);default:return[]}},e.getCommSiteHelpArticles=function(e){for(var t=void 0!==e&&e<=3?e:3,n=[],a=0;a<t;a++){var i=r.Guid.newGuid().toString();n.push({author:B.c,authorAccountName:"",description:B.d,email:"",image:"",publishedOn:void 0,publishedOnRelativeTime:B.u,title:B.l,url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:i,siteId:i,webId:i})}return n},e.getEmptyCarouselItems=function(e,t){for(var n=void 0!==e&&e<=3?e:3,a=[],i=[B.r,B.o,B.s],o=0;o<n;o++){var s=r.Guid.newGuid().toString(),c=l.DefaultImageHelper.getDefaultNewsCarouselImageById(o);c=P._ThumbnailUrlGenerator.getThumbnailUrl({absoluteUrl:c,spResource:c,width:t,callerId:"EmptyCarouselItems"}),a.push({author:"",authorAccountName:"",description:"",email:"",image:c,publishedOn:void 0,publishedOnRelativeTime:"",title:i[o],url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:s,siteId:s,webId:s})}return a},Object.defineProperty(e,"autofillItem",{get:function(){var e=r.Guid.newGuid().toString();return{author:"",authorAccountName:"",description:"",image:"",publishedOn:void 0,publishedOnRelativeTime:B.u,title:B.e,url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:e,siteId:e,webId:e}},enumerable:!1,configurable:!0}),e.getTipActionNewsItem=function(e,t){var n=r.Guid.newGuid().toString();return{author:"",authorAccountName:"",description:e?B.t:B.a,image:"",isContributorActionCard:e,publishedOn:void 0,publishedOnRelativeTime:"",title:e?B.n:B.i,url:e?u.Uri.concatenate(t,"/_layouts/15/CreateSitePage.aspx?source=")+u.UriEncoding.encodeURIComponent(window.location.pathname)+"&promotedState=1":B.m,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:n,siteId:n,webId:n}},e.extractNewsItemsFromSearch=function(t,n){return t.map(function(t){var a=t.SiteID?r.Guid.parse(t.SiteID).toString():void 0,i=t.WebId?r.Guid.parse(t.WebId).toString():void 0,o=t.ListId?r.Guid.parse(t.ListId).toString():void 0,s=t.UniqueID?r.Guid.parse(t.UniqueID).toString():void 0,c=t.ViewCountLifetime,d="number"==typeof c?c:void 0,u=z(a,i,n),f=t.SPWebUrl,p=e._handleDefaultBanner(t.PictureThumbnailURL);return{author:e._getUserDisplayNameFromSearch(t.CreatedBy),authorAccountName:t.AuthorOWSUSER,description:t.Description||"",email:e._getAuthorEmail(t.AuthorOWSUSER),isAuthoritative:!!u,image:p||Q,publishedOn:new Date(t.FirstPublishedDate),publishedOnRelativeTime:"",title:t.Title||t.FileName,url:I()?e.encodeSegments(t.Path):l.UrlUtility.encodeSegments(t.Path),listItemId:t.ListItemId,originalSourceItemId:void 0,originalSourceUrl:I()?e.encodeSegments(t.OriginalPath):l.UrlUtility.encodeSegments(t.OriginalPath),path:t.Path,siteTitle:e._getSiteTitle(t,a,i,n),siteUrl:f,viewCounts:d,isHelpArticle:!1,uniqueId:s,siteId:a,webId:i,listId:o}})},e.extractNewsItems=function(t,n){var a=this;return t.map(function(t){var i,o,s,c,d,f=function(e){return r.Guid.parse(e).toString()},p=t.SiteID?f(t.SiteID):n.site.id.toString(),m=t.WebId?f(t.WebId):n.web.id.toString(),_=t.ListId?f(t.ListId):null===(o=null===(i=n.list)||void 0===i?void 0:i.id)||void 0===o?void 0:o.toString(),h=t.UniqueId?f(t.UniqueId):null===(c=null===(s=n.listItem)||void 0===s?void 0:s.id)||void 0===c?void 0:c.toString(),b=z(p,m,n),g=t.BannerImageUrl,v=t.BannerThumbnailUrl;d=r._SPFlight.isEnabled(1047)&&g&&g.toUpperCase().indexOf("/_LAYOUTS/IMAGES/")>-1?e._handleDefaultBanner(g):e._handleDefaultBanner(v||g);var y=!a._isUseRedirectPageUrlKillSwitchActivated()&&n.web&&n.web.absoluteUrl&&t.Path&&t.Path.DecodedUrl?u.Uri.concatenate(n.web.absoluteUrl,"/",t.Path.DecodedUrl):t.AbsoluteUrl;return{author:t.CreatedBy.Name,authorAccountName:t.CreatedBy.AccountName,callToAction:a.isCallToActionEnabled()?t.CallToAction:void 0,description:t.Description?t.Description:"",email:e._getAuthorEmail(t.CreatedBy.AccountName),isAuthoritative:!!b,image:d||Q,publishedOn:new Date(t.FirstPublished),publishedOnRelativeTime:"",title:t.Title||t.FileName,url:I()?e.encodeSegments(y):l.UrlUtility.encodeSegments(y),listItemId:t.Id,originalSourceItemId:t.OriginalSourceItemId,originalSourceUrl:I()?e.encodeSegments(t.OriginalSourceUrl):l.UrlUtility.encodeSegments(t.OriginalSourceUrl),path:t.Path&&t.Path.DecodedUrl,siteTitle:b?e._getSiteTitle(t,p,m,n):void 0,siteUrl:n.web.absoluteUrl,viewCounts:void 0,isHelpArticle:!1,uniqueId:h,siteId:p,webId:m,listId:_}})},e.extractMicroserviceNewsItems=function(t,n,a){return t.map(function(t){var i,o,s,c=t.Site&&t.Site.ItemReference,d=t.Library,u=r.Guid.tryParse(c&&c.SiteId);i=(null==u?void 0:u.toString())||(a?n.site.id.toString():void 0);var f=r.Guid.tryParse(c&&c.WebId);o=(null==f?void 0:f.toString())||(a?n.web.id.toString():void 0);var p=r.Guid.tryParse(d&&d.ListId);s=p&&p.toString();var m=t.UniqueId?r.Guid.parse(t.UniqueId).toString():void 0,_=z(i,o,n),h=t.Site&&t.Site.Url?t.Site.Url:t.SiteUrl||n.site.absoluteUrl,b=e._handleDefaultBanner(t.ImageUrl);return{author:t.Author&&t.Author.Title?t.Author.Title:"",authorAccountName:t.Author&&t.Author.AccountName?t.Author.AccountName:"",description:t.Description,email:e._getAuthorEmail(t.Author&&t.Author.AccountName?t.Author.AccountName:""),isAuthoritative:t.IsAuthoritativeNews||!!_,image:b||Q,publishedOn:new Date(t.FirstPublishedDate),publishedOnRelativeTime:"",title:t.Title,url:I()?e.encodeSegments(t.Url):l.UrlUtility.encodeSegments(t.Url),viewCounts:void 0,isHelpArticle:!1,siteTitle:e._getSiteTitle(t,i,o,n),siteUrl:h,listItemId:t.ListItemId,originalSourceItemId:t.OriginalSourceItemId,originalSourceUrl:I()?e.encodeSegments(t.OriginalSourceurl):l.UrlUtility.encodeSegments(t.OriginalSourceUrl),path:t.Path&&t.Path.DecodedUrl,uniqueId:m,siteId:i,webId:o,listId:s}})},e.extractVroomNewsItems=function(t,n){return t.map(function(t){var a,i,r,o,s,c,d,u,f,p,m,_,h,b,g,v,y,S=(null===(a=t.sharepointIds)||void 0===a?void 0:a.siteUrl)||n.site.absoluteUrl,D=(null===(i=t.sharepointIds)||void 0===i?void 0:i.siteId)||n.site.id.toString(),x=(null===(r=t.sharepointIds)||void 0===r?void 0:r.webId)||n.web.id.toString(),C=z(D,x,n),O=t.thumbnails?t.thumbnails[0]:void 0,w=O?e._handleDefaultBanner(O.source.url):void 0;return{author:(null===(s=null===(o=t.createdBy)||void 0===o?void 0:o.user)||void 0===s?void 0:s.displayName)||"",authorAccountName:"",description:t.description,email:null===(d=null===(c=t.createdBy)||void 0===c?void 0:c.user)||void 0===d?void 0:d.email,isAuthoritative:!!C,image:w||Q,publishedOn:new Date(t.firstPublishedDate),publishedOnRelativeTime:"",title:t.title,url:I()?e.encodeSegments(t.webUrl):l.UrlUtility.encodeSegments(t.webUrl),viewCounts:null===(p=null===(f=null===(u=t.analytics)||void 0===u?void 0:u.allTime)||void 0===f?void 0:f.access)||void 0===p?void 0:p.actionCount,isHelpArticle:!1,siteTitle:(null===(m=t.parentReference)||void 0===m?void 0:m.siteTitle)||e._getSiteTitle(t,D,x,n),siteUrl:S,listItemId:null===(_=t.sharepointIds)||void 0===_?void 0:_.listItemId,originalSourceItemId:null===(h=t.originalSourceIds)||void 0===h?void 0:h.listItemUniqueId,originalSourceUrl:I()?e.encodeSegments(null===(b=t.originalSourceIds)||void 0===b?void 0:b.url):l.UrlUtility.encodeSegments(null===(g=t.originalSourceIds)||void 0===g?void 0:g.url),uniqueId:null===(v=t.sharepointIds)||void 0===v?void 0:v.listItemUniqueId,siteId:D,webId:x,listId:null===(y=t.sharepointIds)||void 0===y?void 0:y.listId}})},e.processBannerImageUrlPart=function(t,n,a,i,r,o,c){try{return e._processBannerImageUrlPartCore(t,n,a,i,r,o,c)}catch(e){var d={defaultUniqueId:n,imageWidth:i};return r&&(d.siteId=r),o&&(d.webId=r),new s._QosMonitor("News.processBannerImageUrlPart").writeExpectedFailure("UrlError",e,d),""}},e.getResourceFromPrivateCDNUrl=function(e){if(P._ThumbnailUrlGenerator.getThumbnailProvider(e)===P._ThumbnailProviderType.PrivateCDN){var t=new P._SPResourcePath(e);e=(e="https:/".concat(t.path)).split("?")[0]}return e},e.isPrefetchStale=function(e){return void 0!==this._initialUrl||(this._initialUrl=e,!1)},e.extractParamFromUrl=function(e,t){var n=new RegExp("[?&]".concat(e,"=([^?&]+)(&|$)")).exec(t);return n?decodeURIComponent(n[1]):void 0},e.isNewsItemInList=function(t,n){return!(!t||!n)&&t.some(function(t,a){return t&&e.getNewsItemKey(t,"".concat(a))===e.getNewsItemKey(n,"".concat(a))})},e.getPaddingCount=function(e,t){var n=0;return e.emptyItemType&&(n=e.count-t,n=e.emptyItemsCount?Math.min(e.emptyItemsCount,n):n),n},e.hasSameSetOfPosts=function(e,t){if(!e||!t||e.length!==t.length)return!1;var n=!0;return e.every(function(e){return n=n&&t.some(function(t){return e.url===t.url})}),n},e.hasSameOrderOfPosts=function(e,t){if(!e||!t||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},e.removeQueryParam=function(e,t){if(e&&t){var n=new u.Uri(e);return n.removeQueryParameter(t),n.toString()}return e},e.didRenderedPropertiesChange=function(e,t){return e&&t&&(e.description!==t.description||e.image!==t.image||e.title!==t.title)},e.getNewsItemKey=function(e,t){return e.isHelpArticle?t:"".concat(e.siteId,"-").concat(e.webId,"-").concat(e.listId,"-").concat(e.uniqueId)},Object.defineProperty(e,"isOnSeeAllPage",{get:function(){var e=new u.Uri(window.location.href);return u.StringHelper.doesStringEndWith(e.getPath(!0).toLowerCase(),"/_layouts/15/news.aspx")},enumerable:!1,configurable:!0}),e.getFilterQueryBody=function(e){return void 0===e&&(e=""),JSON.stringify(e)},e.encodeSegments=function(e){if(!e)return e;var t="/"===e.substring(e.length-1)?"/":"",n=new P._SPResourcePath(e);if(!n.authority&&!n.domain)return e;var a=new RegExp(".+.aspx"),i=new RegExp("^(?:[^%]|%[0-9A-Fa-f]{2})+$"),r=n.segments.filter(function(e){return!!e}).map(function(e){try{var t=a.exec(i.test(e)?decodeURIComponent(e):e);if(t){var n=t[0];return e.replace(a,encodeURIComponent(n))}return e}catch(t){return e}});return u.Uri.concatenate.apply(u.Uri,[n.authority].concat(r))+t+n.searchParamString},e.getDefaultFilter=function(){return JSON.stringify([Object(W.cloneDeep)(Y)])},e._shouldDeprecateDocViz=function(){return P._ThumbnailUrlGenerator.isVROOMThumbnailEnabled()},e._getSiteTitle=function(e,t,n,a){var i=e.SiteTitle;if(!i){var o=r.Guid.tryParse(t),s=r.Guid.tryParse(n);(null==o?void 0:o.equals(a.site.id))&&(null==s?void 0:s.equals(a.web.id))&&(i=a.web.title)}return i},e._getUserDisplayNameFromSearch=function(e){var t=e,n=null==e?void 0:e.split("|");return n&&n.length>1&&(t=n[1]),t||""},e._handleDefaultBanner=function(t){return e._isDefaultBannerImage(t)?Q:t},e._extractImageFromBanner=function(e){var t=e.split(", ");return t[t.length>1?1:0].trim()},e._isDefaultBannerImage=function(t){return!t||u.StringHelper.doesStringEndWith(e._extractImageFromBanner(t),"/images/sitepagethumbnail.png")},e._isUseRedirectPageUrlKillSwitchActivated=function(){return r._SPKillSwitch.isActivated("5a9dc530-5eb2-4032-b8b9-b6d4222ad8ad")},e._processBannerImageUrlPartCore=function(t,n,a,i,r,o,c){var d=e._extractImageFromBanner(t),f=c||a.web.absoluteUrl,p="".concat(q,":"),m=e._tryGetExternalBanner(a,d,p);if(m)return m;if(e._isDefaultBannerImage(d))return"";var _=P._ThumbnailUrlGenerator.getThumbnailProvider(d);if(_===P._ThumbnailProviderType.PrivateCDN&&!Object(T.isAlterantiveUrlFresh)(d)){var h=new P._SPResourcePath(d);d=(d="https:/".concat(h.path)).split("?")[0],_=P._ThumbnailProviderType.Original}var b=new P._SPResourcePath(d),g=b.path.toLowerCase();if(_===P._ThumbnailProviderType.Stock)return d;if(_===P._ThumbnailProviderType.VROOMMeTACache||_===P._ThumbnailProviderType.PrivateCDN||_===P._ThumbnailProviderType.PublicCDN||_===P._ThumbnailProviderType.MeTA)return P._ThumbnailUrlGenerator.updateThumbnailWidth(d,i);if(_===P._ThumbnailProviderType.DocViz){if(s._TraceLogger.logVerbose(e._logSource,"".concat(p," already from GetPreview")),e._shouldDeprecateDocViz()){var v=P._ThumbnailUrlGenerator.fromGetPreview(d,q,i);if(v)return v}var y=P._PreviewUtility.normalizeWidthToResolution(i),S=new u.Uri(d);return S.setQueryParameter(P._PreviewHelper.RESOLUTION,y.toString()),S.toString()}var D=_!==P._ThumbnailProviderType.SharePointHost&&_!==P._ThumbnailProviderType.MySite;if(_!==P._ThumbnailProviderType.Unknown&&D)return P._ThumbnailUrlGenerator.updateThumbnailWidth(d,i);var I={absoluteUrl:b.authority||f,fileType:P._PreviewUtility.getFileExtension(b),spResource:g,width:i,callerId:q};return P._ThumbnailUrlGenerator.getThumbnailUrl(I,l.DefaultImageHelper.getDefaultImage(b))},e._tryGetExternalBanner=function(t,n,a){var i=new P._SPResourcePath(n),r=Q;if(i&&(r=i.authority),r&&!l.UrlUtility.isInternalResource(n,t))return s._TraceLogger.logVerbose(e._logSource,"".concat(a," external host")),n},e._getAuthorEmail=function(e){var t;if(e){var n=e.split("|");t=n[n.length-1]}return t},e.aliasPrefix="FirstParty_NewsWebPart_",e.viewCountsDictionary={},e._logSource=s._LogSource.create("NewsUtilities"),e._mdrnHelpUrl=" https://go.microsoft.com/fwlink/?linkid=2103711",e}(),Z="news",$="viewCounts",ee="currentViewCounts",te="hubNews",ne="newsDigest",ae="multiSiteNews",ie="myNews",re="staleViewCounts",oe=n("2q6Q");function se(e,t){return!(r._BrowserDetection.getBrowserInformation().browser!==r._Browser.IE&&!t||!e)}function ce(e,t){return t?de(e)?"ThrottledResponse":"ResponseNotOk":"AzureFrontDoorHeadersMissing"}function de(e){return 429===e||503===e}var le,ue=function(){function e(e){var t=this;e.whenFinished(function(){t._sphomeHttpClient=e.consume(E.serviceKey)})}return e.prototype.getViewCounts=function(e){var t=this;if(0===e.length)return Promise.resolve([]);var n=new oe._QosMonitor("ExchangeViewCountsFetch");if(!this._sphomeHttpClient.isUserSupportedBySubstrate)return n.writeExpectedFailure("SubstrateUnsupportedUser"),Promise.resolve([]);var a=this._requestForItem(e);return this._sphomeHttpClient.post("documents/metadata",JSON.stringify(a)).then(function(e){if(e.ok)return e.json();var t=function(e){var t=e.headers.get("MS-CV"),n=se(t,e.url);return{MSCV:t,responseStatus:e.status.toString(),errorCode:ce(e.status,n)}}(e),a=t.errorCode,i=new Error(a);throw n.writeUnexpectedFailure(a,i,t),i}).then(function(a){return n.writeSuccess(),e.map(function(e){return t._addMicroserviceViewCount(e,a.Items)})}).catch(function(e){return n.hasEnded||n.writeUnexpectedFailure("ExchangeViewCountsFetchSearchFallback",e),[]})},e.prototype._addMicroserviceViewCount=function(e,t){var n=this,a=t.filter(function(t){return n._guidEquals(t.Site.ItemReference.SiteId,e.siteId)&&n._guidEquals(t.Site.ItemReference.WebId,e.webId)&&n._guidEquals(t.UniqueId,e.uniqueId)})[0];return a&&void 0!==a.Views&&(e.viewCount=a.Views),e},e.prototype._guidEquals=function(e,t){var n=r.Guid.tryParse(e),a=r.Guid.tryParse(t);return!(!n||!a)&&n.equals(a)},e.prototype._requestForItem=function(e){return[].concat.apply([],e.map(function(e){return[{Site:{ItemReference:{SiteId:e.siteId,WebId:e.webId,Type:"SiteReference"},Type:"Site"},Library:{ListId:e.listId,Type:"Library"},UniqueId:e.uniqueId,Type:"Document"},{Site:{ItemReference:{SiteId:e.siteId,WebId:e.webId,Type:"GroupReference"},Type:"Site"},Library:{ListId:e.listId,Type:"Library"},UniqueId:e.uniqueId,Type:"Document"}]}))},e.serviceKey=r.ServiceKey.create("sp-dataproviders:ViewCountDataProvider",e),e}(),fe=function(){function e(e){var t=this;this.id="ExchangeViewCounts",this.title="",this.options=e,this.options.serviceScope.whenFinished(function(){t._pageContext=t.options.serviceScope.consume(a.PageContext.serviceKey),t._viewCountDataSource=t.options.serviceScope.consume(ue.serviceKey)})}return e._getViewCountFromCacheIfAvailable=function(e){this._viewCountCache.hasOwnProperty(e.uniqueId)&&(e.viewCounts=this._viewCountCache[e.uniqueId])},e._cacheViewCounts=function(e){var t=this;e.forEach(function(e){void 0!==e.uniqueId&&(t._viewCountCache[e.uniqueId]=e.viewCounts)})},e.prototype.requestData=function(e){var t=Object(W.chunk)(e,10);return Promise.all(t.map(this._createRequestForItems.bind(this))).then(function(){return e})},e.prototype._addViewCountsToItems=function(e,t){return e.filter(this._needsViewCount).map(function(e){var n=t.filter(function(t){return t.uniqueId===e.uniqueId||t.siteId===e.siteId&&t.webId===e.webId&&t.listItemId===Number(e.listItemId)})[0];return e.viewCounts=void 0!==n?Number(n.viewCount):void 0,e})},e.prototype._createRequestForItems=function(t){var n=this;return this._viewCountDataSource.getViewCounts(this._buildRequest(t)).then(function(a){return t=n._addViewCountsToItems(t,a),e._cacheViewCounts(t),t})},e.prototype._buildRequest=function(e){var t=this._pageContext.site.id.toString(),n=this._pageContext.web.id.toString();return e.filter(this._needsViewCount).map(function(e){return{listItemId:Number(e.listItemId)||0,uniqueId:e.uniqueId,siteId:e.siteId||t,webId:e.webId||n,listId:e.listId}})},e.prototype._needsViewCount=function(t){e._getViewCountFromCacheIfAvailable(t);var n=t.viewCounts;return null==n||"number"!=typeof n},e._viewCountCache={},e}(),pe="EmptyResponse",me="_Response_Parse_Error",_e="Cache",he="Server",be="UnexpectedError",ge="UnexpectedRetryableError",ve="MicroServiceNews",ye=function(){function e(e){var t=this;this._maxRetryCount=3,this.parsedResponseCount=0,this.canCompare=!1,this._extraData={},this._retryCount=0,this._processMicroserviceServiceResponse=function(e,n,a){var i;if(X._isHaukShadowcallsKillSwitchActivated())i=e;else{t.canCompare=!!e.clone;var r=t.parsedResponseCount>0&&t.canCompare;t.parsedResponseCount++,i=r?e.clone():e}return i.json().then(function(i){var r=N(n,t._pageContext);return r.retryCount=t._retryCount,t._processMicroserviceServiceResponseCore(i,n,r,a,e)})},this._onCacheThenNetworkServerDataNotReturned=function(e,n){t._onCacheThenNetworkServerDataReturned(Promise.resolve([]),e,n)},this._onCacheThenNetworkServerDataReturned=function(e,n,a){var i=n&&a,r=i?_e:"";e.then(function(e){var a=t._isEmptyResponse(e);if(a||i){var o=a?he:"";t._writeToEmptyResultsMonitor(t._extraData,n,"".concat(r).concat(o).concat(pe))}}).catch(function(e){t._writeToEmptyResultsMonitor(t._extraData,n,"".concat(r).concat(he).concat(me),e)})},this._isEmptyResponse=function(e){var t=e&&e.filter(function(e){return!(null==e?void 0:e.isHelpArticle)});return!(null==t?void 0:t.length)},this._isRawData=function(e){var t;return void 0!==(null===(t=e)||void 0===t?void 0:t.Items)},this._parseHttpClientResponse=function(e,n,a){var i=N(n);i.responseStatus=e.status.toString();var r=se(i.MSCV,i.URL),o=ce(e.status,r);return e.ok?e.json().then(function(e){var r=t._processRawData(e,n,a);return a.writeSuccess(i),r}).catch(function(e){throw a.writeUnexpectedFailure(o,e,i),e}):(a.writeUnexpectedFailure(o,new Error(be),i),Promise.reject())},this._processRawData=function(e,n,a){var i=X.getPaddingCount(n,e.Items?e.Items.length:0),r=!e.Items||0===e.Items.length;t._logEmptyResultToQos(t._extraData,r,e);var o=r?[]:t.extractMicroserviceNewsItems(e.Items);return o=o.concat(X.getEmptyStateItems(n.emptyItemType,t.options.serviceScope,i,n.webpartWidth)),a.writeSuccess(t._extraData),o},this.options=e,this.options.serviceScope.whenFinished(function(){t._pageContext=t.options.serviceScope.consume(a.PageContext.serviceKey),t._sphomeHttpClient=t.options.serviceScope.consume(E.serviceKey),t._spHttpClient=t.options.serviceScope.consume(i.SPHttpClient.serviceKey)})}return Object.defineProperty(e.prototype,"isMicroserviceUnavailable",{get:function(){return this._sphomeHttpClient.isServiceAvailable},enumerable:!1,configurable:!0}),e.prototype.requestData=function(t){var n=this;this._retryCount=0;var a=e._requestCount++;return this._addPageUsageStartData(a),this._requestData(t).then(function(e){return n._addPageUsageEndData(a),e}).catch(function(e){if(++n._retryCount<n._maxRetryCount&&n.shouldRetryDataFetch(e))return n._requestData(t).then(function(e){return n._addPageUsageEndData(a),e});throw n._addPageUsageEndData(a,!0),e})},e.prototype.extractMicroserviceNewsItems=function(e){return X.extractMicroserviceNewsItems(e,this._pageContext)},e.prototype.shouldRetryDataFetch=function(e){return e.message===ge},e.prototype._processHttpClientResponsePromise=function(e,t,n,a,i){var r,o=this;return e.then(function(e){if(X._isHaukShadowcallsKillSwitchActivated())r=e;else{o.canCompare=!!e.clone;var t=(!!i||o.parsedResponseCount>0)&&o.canCompare;o.parsedResponseCount++,r=t?e.clone():e}return r.json()}).then(function(e){return o._processMicroserviceServiceResponseCore(e,t,n,a,r)})},e.prototype._applyCacheAndNetwork=function(e,t,n,a){var i=this;if(e.serverResponse&&e.cachedResponse){var o=new s._QosMonitor("".concat(this.qosMonitorLabel,".getNewsItemsInSmartRace")),c=this._processHttpClientResponsePromise(e.serverResponse,t,n,o).then(function(e){var n=i._isEmptyResponse(e);return t.onServerResponseResolved(n),e}).catch(function(e){throw t.onServerResponseFailed(e),e}),d=new s._QosMonitor("".concat(this.qosMonitorLabel,".getCachedNewsItemsInSmartRace")),u=v.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData,t,d).then(function(e){var n=i._isEmptyResponse(e);return t.onCacheResponseResolved(n),e||[]}).catch(function(e){throw d.writeUnexpectedFailure("ParseCacheResultsFailed",e),t.onCacheResponseFailed(e),e}),f=r.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),p=r.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),m=[{raceablePromise:u,raceId:f},{raceablePromise:c,raceId:p}];return l.SmartRace.race(m).then(function(e){return e.raceId===f&&c.then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){}),a.writeSuccess({cacheStatus:e.raceId===f?"WonRace":"LostRace"}),e.raceablePromise}).catch(function(e){throw a.writeUnexpectedFailure("SmartRaceFailed",e),e})}},e.prototype._addPageUsageStartData=function(e){var t=oe._PageUsageAdapter.getInstance(),n=t.elapsedTime();t.markFeature("".concat(ve,"-").concat(this.qosMonitorLabel,"-").concat("StartTime","-").concat(e),n.toFixed(2))},e.prototype._addPageUsageEndData=function(e,t){var n=oe._PageUsageAdapter.getInstance(),a=n.elapsedTime();n.markFeature("".concat(ve,"-").concat(this.qosMonitorLabel,"-").concat("EndTime","-").concat(e,"-").concat(this._retryCount),a.toFixed(2)),t&&n.markFeature("".concat(ve,"-").concat(this.qosMonitorLabel,"-")+"".concat(e,"-").concat(this._retryCount,"-").concat("Failure"))},e.prototype._addMoreAdditionalFields=function(e,t){t.spHomeServer=e.headers.get("sphome-server");var n=e.headers.get("sphome-sharepointid");n&&(t.spHomeSharepointId=n)},e.prototype._addCacheAndServerEmptyStateLogs=function(e,t,n,a,i){var r=this,o=n&&a,s=o?_e:"";return e.then(function(e){var a=r._isEmptyResponse(e);if(i.onServerResponseResolved(a),a||o){var c=a?he:"";r._writeToEmptyResultsMonitor(t,n,"".concat(s).concat(c).concat(pe))}return e}).catch(function(e){throw r._writeToEmptyResultsMonitor(t,n,"".concat(s).concat(he).concat(me),e),i.onServerResponseFailed(e),e})},e.prototype._getIsExpectedError=function(e){return e>=400&&e<500&&!de(e)},e.prototype._getIsUnExpectedRetryableError=function(e){return e>=500&&e<600&&!de(e)},e.prototype._logEmptyResultToQos=function(e,t,n){var a=new s._QosMonitor("".concat(this.qosMonitorLabel,".getNewsItems.EmptyResults"));t?a.writeUnexpectedFailure(pe,new Error("200 ".concat(n.Items?"0 Items":"No Items")),e):a.writeSuccess(e)},e.prototype._logThrottledResultToQos=function(e,t){if(de(t)){var n=new s._QosMonitor("GetNewsItems.ThrottledResult");e.dataProvider=this.qosMonitorLabel,n.writeSuccess(e)}},e.prototype._parseClientCachableResponse=function(e,t,n,a){var i=this,r=e.cachedResponse?v.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData,t,a):void 0,o=e.serverResponse?this._processHttpClientResponsePromise(e.serverResponse,t,n,a):void 0;return r?(r.then(function(e){var a=i._isEmptyResponse(e);if(t.onCacheResponseResolved(a),o)i._addCacheAndServerEmptyStateLogs(o,n,!0,a,t).then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){});else{var r=a?_e:"";a&&i._writeToEmptyResultsMonitor(n,!0,"".concat(r).concat(pe))}}).catch(function(e){t.onCacheResponseFailed(e)}),r):(a.writeSuccess(n),this._addCacheAndServerEmptyStateLogs(o,n,!1,!0,t))},e.prototype._processMicroserviceServiceResponseCore=function(e,t,n,a,i){n.URL=X.removeQueryParam(i.url,"mainSiteUrl"),n.MSCV=i.headers.get("MS-CV"),this._extraData=n,this._addMoreAdditionalFields(i,n);var r=se(n.MSCV,n.URL);if(i.ok&&r)return this._processRawData(e,t,a);var o=i.status,s=ce(o,r);n.statusCode=o.toString(),n.responseStatus=i.statusText;var c=void 0,d=e;throw this._getIsExpectedError(o)?(c=new Error("ExpectedError"),n.id=d.ErrorLabel,a.writeExpectedFailure(s,c,n)):(this._getIsUnExpectedRetryableError(o)?c=new Error(ge):(c=new Error(be),this._logThrottledResultToQos(n,o)),n.id=d.ErrorLabel,a.writeUnexpectedFailure(s,c,n)),c},e.prototype._requestData=function(e){var t=this;if(!S()){var n={parseHttpClientResponse:this._processMicroserviceServiceResponse,isEmptyResponse:this._isEmptyResponse,isRawData:this._isRawData,processRawData:this._processRawData,qosMonitorLabel:this.qosMonitorLabel,onServerResponseResolvedWithCache:e.onServerResponseResolvedWithCache,onServerResponseResolved:e.onServerResponseResolved,onServerResponseFailed:e.onServerResponseFailed,onCacheResponseResolved:e.onCacheResponseResolved,onCacheResponseFailed:e.onCacheResponseFailed,onCacheThenNetworkServerDataReturned:this._onCacheThenNetworkServerDataReturned,onCacheThenNetworkServerDataNotReturned:this._onCacheThenNetworkServerDataNotReturned};return v.executeCacheStrategy(n,this.executeRequest,e)}var a=new s._QosMonitor("".concat(this.qosMonitorLabel,".getNewsItems")),r=N(e,this._pageContext);return r.retryCount=this._retryCount,this.executeRequest(e).then(function(n){if(n instanceof i.HttpClientResponse)return t._parseHttpClientResponse(n,e,a);var o=n,s=t._applyCacheAndNetwork(o,e,r,a);if(s)return s;var c=n;return t._parseClientCachableResponse(c,e,r,a)}).catch(function(e){if(!a.hasEnded&&0===r.retryCount)if(e instanceof f)a.writeUnexpectedFailure("TokenNotAvailable",e,r);else{var t=e.message;e=new Error(be),a.writeUnexpectedFailure(t,e,r)}throw e})},e.prototype._writeToEmptyResultsMonitor=function(e,t,n,a){var i=new s._QosMonitor("GetNewsItems.ZeroResult");e.mySiteCacheHit=t,e.dataProvider=this.qosMonitorLabel,e.source=n,a?i.writeUnexpectedFailure(n,a,e):t&&n==="".concat(_e).concat(he).concat(pe)?i.writeExpectedFailure(n,new Error("Expected Cache and Server Empty Result"),e):i.writeSuccess(e)},e._requestCount=0,e}(),Se=n("K9kD");function De(e){var t,n=e.webAbsoluteUrl,a=e.multiGeoInfo;if(!r._SPKillSwitch.isActivated("3d261ee4-bce3-46e4-a64f-6a6bf694277e")){if(!n||!a||!a.length)return;try{var i=new Se.Uri(n).getHost();return null===(t=a.filter(function(e){return new Se.Uri(e.RootSiteUrl).getHost()===i})[0])||void 0===t?void 0:t.InstanceId}catch(e){return}}}!function(e){function t(){return r._SPFlight.isEnabled(60465)}function n(){return r._SPFlight.isEnabled(60229)}function a(){return r._SPFlight.isEnabled(60705)}e.isNewsHaukAPIFlightEnabled=t,e.isNewsHaukAPIModelEnabled=function(){return 1===oe._SPPerfExperiment.getVariantAndTrackExperiment(oe._PerformanceExperiment.NewsHaukAPIExperiment)||t()},e.isAsyncPrefetchPatternEnabled=function(){return(1===oe._SPPerfExperiment.getVariantAndTrackExperiment(oe._PerformanceExperiment.AsyncDataFlushExperiment,!0)||r._SPFlight.isEnabled(oe._PerformanceFlight.AsyncDataFlushFlight))&&r._SPFlight.isEnabled(oe._PerformanceFlight.AsyncDataPrefetchClientNewsFlight)},e.isMyNewsHaukAPIFlightEnabled=n,e.isMyNewsHaukAPIModelEnabled=function(){return 1===oe._SPPerfExperiment.getVariantAndTrackExperiment(oe._PerformanceExperiment.MyNewsHaukAPIExperiment)||n()},e.useGetMultiSiteForThisSite=a,e.isGetMultiSiteForThisSiteEnabled=function(e){return(1===oe._SPPerfExperiment.getVariantAndTrackExperiment(oe._PerformanceExperiment.NewsUseGetMultiSiteForThisSiteExp)||a())&&!e}}(le||(le={}));var Ie="EmptyResponse",xe="Cache",Ce="Server",Oe=function(){function e(e){var t=this;this._extraData={},this.requestData=function(e){return t._requestData(e)},this.executeRequest=function(e){var n=void 0;return r._SPKillSwitch.isActivated("381ce7de-c105-43a5-973d-3fa81c146c46")?"POST"===t.httpMethod&&(n={body:JSON.stringify(t.getRequestBody(e)),headers:new J("POST"),method:"POST"}):t._getHeaders(e)&&(n={headers:t._getHeaders(e),method:t.httpMethod},"POST"===t.httpMethod&&(n.body=JSON.stringify(t.getRequestBody(e)))),x()?t.httpClient instanceof i.HttpClient?t.httpClient.fetch(t.getAPIPath(e),i.HttpClient.configurations.v1,n,t.getRequestCacheOptions(e)):t.httpClient.fetch(t.getAPIPath(e),i.SPHttpClient.configurations.v1,n,t.getRequestCacheOptions(e)):t.getRequestCacheOptionsAsync(e).then(function(a){return t.httpClient instanceof i.HttpClient?t.httpClient.fetch(t.getAPIPath(e),i.HttpClient.configurations.v1,n,a):t.httpClient.fetch(t.getAPIPath(e),i.SPHttpClient.configurations.v1,n,a)})},this.getCacheProps=function(e){return{parseHttpClientResponse:t.parseHttpClientResponse,isEmptyResponse:t._isEmptyResponse,isRawData:t.isRawData,processRawData:t.processRawData,qosMonitorLabel:t.qosMonitorLabel,onServerResponseResolvedWithCache:e.onServerResponseResolvedWithCache,onServerResponseResolved:e.onServerResponseResolved,onServerResponseFailed:e.onServerResponseFailed,onCacheResponseResolved:e.onCacheResponseResolved,onCacheResponseFailed:e.onCacheResponseFailed,onCacheThenNetworkServerDataReturned:t._onCacheThenNetworkServerDataReturned,onCacheThenNetworkServerDataNotReturned:t._onCacheThenNetworkServerDataNotReturned}},this.getExtraHeaders=function(e){},this.getRequestBody=function(e){return{}},this.getRequestCacheOptions=function(e){var n=new Map;n.set(v.useStalePropName,!0),le.isAsyncPrefetchPatternEnabled()&&n.set(v.enableDataPrefetch,!0);var a={alias:X.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:le.isAsyncPrefetchPatternEnabled()?i._CacheStrategy.CacheThenNetwork:i._CacheStrategy.CacheAndNetwork,extraProps:n};return e.canCacheRequest&&!t.isPaginationRequest(e)||(a.cacheStrategy=i._CacheStrategy.NetworkOnly),a},this.getRequestCacheOptionsAsync=function(e){var n=t._getCacheKeyOverrideAsync(e);return n?n.then(function(n){var a=new Map;a.set(v.useStalePropName,!0),n&&a.set(v.cacheKeyOverride,n);var r={alias:X.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:le.isAsyncPrefetchPatternEnabled()?i._CacheStrategy.CacheThenNetwork:i._CacheStrategy.CacheAndNetwork,extraProps:a};return e.canCacheRequest&&!t.isPaginationRequest(e)||(r.cacheStrategy=i._CacheStrategy.NetworkOnly),r}):Promise.resolve(t.getRequestCacheOptions(e))},this.parseHttpClientResponse=function(e,n,a){t._extraData=N(n),t._extraData.responseStatus="".concat(e.status);var i="".concat(e.correlationId),r="".concat(e.statusMessage),o="".concat(e.statusText);if(t._extraData.correlationId=i,t._extraData.message=r,t._extraData.statusText=o,e.ok)return e.json().then(function(e){return t.processRawData(e,n,a)}).catch(function(e){throw a.writeUnexpectedFailure("Unexpected",e,t._extraData),e});var s=new Error(r||o);return a.writeUnexpectedFailure("Unexpected",s,t._extraData),Promise.reject(s)},this.processRawData=function(e,n,a){var i=t.getRawItems(e),r=X.getPaddingCount(n,i?i.length:0),o=!i||0===i.length;t._logEmptyResultToQos(o,e);var s=o?[]:t._extractNewsItems(i);return s=s.concat(X.getEmptyStateItems(n.emptyItemType,t.options.serviceScope,r,n.webpartWidth)),a.writeSuccess(t._extraData),s},this._extractNewsItems=function(e){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];return t.extractNewsItemsCallback(e,t._pageContext,n)},this._getBaseCacheKey=function(e){var n,a={userId:null===(n=t._pageContext.aadInfo)||void 0===n?void 0:n.userId.toString(),source:t.id,count:e.count};if(r._SPKillSwitch.isActivated("2dd92e7a-2f47-4ce7-b680-630d2dbf8afd"))a=Object(c.__assign)(Object(c.__assign)({},a),{rootUrl:t.rootUrl});else{a=Object(c.__assign)(Object(c.__assign)({},a),{spInstanceId:De(t._pageContext.legacyPageContext)});var i=new s._QosMonitor("".concat(t.qosMonitorLabel,".SPInstanceId.Availability"));a.spInstanceId?i.writeSuccess():i.writeUnexpectedFailure("SPInstanceIdNotAvailable")}return a},this._getCacheKeyOverrideAsync=function(e){if(t.cacheKeyOverrideEnabled)return v.generateCacheKey(t.getKeyOverride(e))},this._getHeaders=function(e){var n=t.getExtraHeaders(e);if("POST"===t.httpMethod||n){var a=new J(t.httpMethod);return null==n||n.forEach(function(e,t){a[t]=e}),a}},this._onCacheThenNetworkServerDataNotReturned=function(e,n){t._onCacheThenNetworkServerDataReturned(Promise.resolve([]),e,n)},this._onCacheThenNetworkServerDataReturned=function(e,n,a){var i=n&&a,r=i?xe:"";e.then(function(e){var a=t._isEmptyResponse(e);if(a||i){var o=a?Ce:"";t._writeToEmptyResultsMonitor(n,"".concat(r).concat(o).concat(Ie))}}).catch(function(e){t._writeToEmptyResultsMonitor(n,"".concat(r).concat(Ce).concat("_Response_Parse_Error"),e)})},this._isEmptyResponse=function(e){var t=e&&e.filter(function(e){return!(null==e?void 0:e.isHelpArticle)});return!(null==t?void 0:t.length)},this._logEmptyResultToQos=function(e,n){var a=new s._QosMonitor("".concat(t.qosMonitorLabel,".getNewsItems.EmptyResults"));e?a.writeUnexpectedFailure(Ie,new Error("200 ".concat(t.getRawItems(n)?"0 Items":"No Items")),t._extraData):a.writeSuccess(t._extraData)},this._requestData=function(e){return v.executeCacheStrategy(t.getCacheProps(e),t.executeRequest,e)},this._writeToEmptyResultsMonitor=function(e,n,a){var i=new s._QosMonitor("GetNewsItems.ZeroResult");t._extraData.mySiteCacheHit=e,t._extraData.dataProvider=t.qosMonitorLabel,t._extraData.source=n,a?i.writeUnexpectedFailure(n,a,t._extraData):e&&n==="".concat(xe).concat(Ce).concat(Ie)?i.writeExpectedFailure(n,new Error("Expected Cache and Server Empty Result"),t._extraData):i.writeSuccess(t._extraData)},this.options=e,this.options.serviceScope.whenFinished(function(){t._pageContext=t.options.serviceScope.consume(a.PageContext.serviceKey)})}return e.prototype.getKeyOverride=function(e){return this._getBaseCacheKey(e)},e}(),we=function(e){function t(t){var n=e.call(this,t)||this;return n.paginationCompleted=!1,n.getRawItems=function(e){return e["@odata.nextLink"]?n.nextLink=e["@odata.nextLink"]:n.paginationCompleted=!0,e.value},n.isRawData=function(e){return!!e.value},n.isPaginationRequest=function(e){return!!e.isPaginationRequest&&!!n.nextLink},n.extractNewsItemsCallback=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return X.extractVroomNewsItems(e,t)},n.options.serviceScope.whenFinished(function(){n.httpClient=n.options.serviceScope.consume(i.SPHttpClient.serviceKey)}),n}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"cacheKeyOverrideEnabled",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{get:function(){return"POST"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rootUrl",{get:function(){return u.UriEncoding.escapeUrlForCallback(this._pageContext.web.absoluteUrl.replace(this._pageContext.web.serverRelativeUrl,""))},enumerable:!1,configurable:!0}),t.prototype.getKeyOverride=function(t){return Object(c.__assign)(Object(c.__assign)({},e.prototype.getKeyOverride.call(this,t)),this.getRequestBody(t))},t}(Oe),Ee=we,Ae=function(e,t,n){var a=this;this.newsApiPromises=new Map,this.newsApiResults=new Map,this.newsDataProviderIndex=new Map,this.addApiPromise=function(e,t,n){a.newsApiPromises.set(t,n),a.newsDataProviderIndex.set(t,e),n.then(function(e){a.addApiResult(t,e)}).catch(function(e){})},this.handleRacing=function(){var e=new s._QosMonitor("NewsAPIComparer.handleRacing"),t=[],n=[],i={};a.newsApiPromises.forEach(function(e,r){var o=1;i["dataProvider-".concat(o++)]=a.newsDataProviderIndex.get(r),t.push(e),n.push({raceablePromise:e,raceId:r})}),l.SmartRace.race(n).then(function(n){var r=function(t){i=Object(c.__assign)(Object(c.__assign)({},i),{fasterAPI:a.newsDataProviderIndex.get(n.raceId),"error.name":null==t?void 0:t.name,"error.message":null==t?void 0:t.message,"error.stack":null==t?void 0:t.stack}),e.writeSuccess(i)};Promise.all(t).then(function(){i=a.compareNewsItemsArray(i),r()}).catch(function(e){r(e)})}).catch(function(t){throw e.writeUnexpectedFailure("SmartRaceFailed",t,i),t})},this.addApiResult=function(e,t){a.newsApiResults.set(e,t)},this.compareNewsItemsArray=function(e){var t,n=a.newsApiResults.get(a.baseApiGuid)||[],i=(null===(t=a.newsApiResults.get(a.baseApiGuid))||void 0===t?void 0:t.length)||0;return a.newsApiResults.forEach(function(t,r){if(a.baseApiGuid!==r){var o=a.newsDataProviderIndex.get(r),c={baseDataProvider:a.newsDataProviderIndex.get(a.baseApiGuid),compareToDataProvider:o};a.baseApiPromiseStringified!==JSON.stringify(t)?(c["baseDataProvider.length"]="".concat(i),c["compareToDataProvider.length"]="".concat(t.length),c=a.compareNewsItems(n,t,c),s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("NewsComparer","DifferentArrays_Base",s._LogType.Event,e)),s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("NewsComparer","DifferentArrays_Details",s._LogType.Event,c))):(s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("NewsComparer","SameResults_Base",s._LogType.Event,e)),s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("NewsComparer","SameResults_Details",s._LogType.Event,c)))}}),e},this.compareNewsItems=function(e,t,n){for(var i=Array.from(Array(2),function(){return new Array(Math.max(e.length,t.length))}),r=0;r<e.length;r++)if(!i[0][r])for(var o=0;o<t.length;o++)i[0][o]||(a._compareEqualItem(e[r],t[o])?(i[0][r]=i[1][o]=!0,n["itemsEqualAtIndex-".concat(r,"-").concat(o)]="".concat(!0),n=a._logFieldMismatch(e[r],t[o],n,r,o),++r):(n["itemsEqualAtIndex-".concat(r,"-").concat(o)]="".concat(!1),e[r].isHelpArticle||t[o].isHelpArticle?(e[r].isHelpArticle&&(n["baseItemStartsHelpArticlesAt-".concat(r,"-").concat(o)]="".concat(!0),r=e.length),t[o].isHelpArticle&&(n["compareToItemStartsHelpArticlesAt-".concat(r,"-").concat(o)]="".concat(!0),o=t.length)):e[r].publishedOn>t[o].publishedOn?n["baseItemNewerAtIndex-".concat(r,"-").concat(o)]="".concat(!0):n["baseItemNewerAtIndex-".concat(r,"-").concat(o)]="".concat(!1)));return n},this._logFieldMismatch=function(e,t,n,a,i){return["author","description","email","isAuthoritative","image","publishedOn","title","url","siteTitle","siteUrl","listItemId","originalSourceItemId","originalSourceUrl","uniqueId","siteId","webId","listId"].forEach(function(r){e[r]&&t[r]&&e[r].toString()!==t[r].toString()&&(n["fieldisEqual-".concat(r,"-").concat(a,"-").concat(i)]="".concat(!1))}),n},this._getItemKeyCallback=function(e){return X.getNewsItemKey(e,"".concat(e.siteId,"-").concat(e.webId,"-").concat(e.uniqueId))},this._compareEqualItem=function(e,t){var n=a._getItemKeyCallback;return n(e)===n(t)&&e.siteUrl==e.siteUrl},this.baseApiGuid=t,this.addApiPromise(e,t,n),n.then(function(e){a.addApiResult(t,e),a.baseApiPromiseStringified=JSON.stringify(e)})},Le=function(){function e(e){return this.id="hubNews",this.title=B.x,le.isNewsHaukAPIModelEnabled()&&!e.shouldUseMicroservice?this.instance=new ke(e):this.instance=new Me(e),this.instance}return Object.defineProperty(e.prototype,"qosMonitorLabel",{get:function(){return"HubNewsDataProvider"},enumerable:!1,configurable:!0}),e.prototype.requestData=function(e){return this.instance.requestData(e)},e}(),ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="hubNews",t.title=B.x,t.getRequestBody=function(e){if(x())return{hubs:["".concat(e.hubId)],filterByAudience:!!e.audienceTargetingEnabled,preferredLanguage:e.languageOverride};var t={hubs:["".concat(e.hubId)],filterByAudience:!!e.audienceTargetingEnabled};return e.languageOverride&&(t.preferredLanguage=e.languageOverride),t},t.getAPIPath=function(e){var n=u.UriEncoding.escapeUrlForCallback(t._pageContext.web.absoluteUrl),a="?$expand=analytics($expand=allTime),thumbnails&$top=".concat(e.count);return t.isPaginationRequest(e)?t.nextLink:n+"/_api/v2.1/getMultiHubNews"+a},t}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"VroomHubNewsDataProvider"},enumerable:!1,configurable:!0}),t}(Ee),Me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="hubNews",t.title=B.x,t.executeRequest=function(e){var n={alias:X.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:i._CacheStrategy.CacheAndNetwork,extraProps:new Map([[v.useStalePropName,!0]])};e.canCacheRequest||(n.cacheStrategy=i._CacheStrategy.NetworkOnly);var a=t._sphomeHttpClient.post(t.getMicroservicePath(e),X.getFilterQueryBody(e.filterKQLQuery),void 0,void 0,n);return X._isHaukShadowcallsKillSwitchActivated()||t._compareNewAPIs(a,e),a},t}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"HubNewsDataSource"},enumerable:!1,configurable:!0}),t.prototype.extractMicroserviceNewsItems=function(e){return X.extractMicroserviceNewsItems(e,this._pageContext,!0)},t.prototype.getMicroservicePath=function(e){var t="departmentId=".concat(e.hubId,"&start=").concat(e.skip,"&count=").concat(e.count);return t+=H(e),t+=R(e),"".concat("news/hub/filtered","?").concat(t)},t.prototype._compareNewAPIs=function(e,t){var n=this;setTimeout(function(){if(n.canCompare){var a=e.then(function(e){if(!(e instanceof i.HttpClientResponse)&&e.serverResponse){var a=new s._QosMonitor("SPHomeQualityTest.getHubProcessedResponse");return n._processHttpClientResponsePromise(e.serverResponse,t,{},a,!0)}return[]}),o=new Ae("SPHomeMicroservice",r.Guid.parse("92d60991-5b57-4828-9f5f-da94e71c6257"),a),c=t;c.canCacheRequest=!1;var d=new s._QosMonitor("News.HubsiteVroom"),l=new ke(n.options).requestData(c).then(function(e){return d.writeSuccess(),e}).catch(function(e){return d.writeUnexpectedFailure("Error",e),[]});o.addApiPromise("VroomAPI",r.Guid.parse("4a609117-4832-4b81-a400-c222a06d25be"),l),o.handleRacing()}},3e3)},t}(ye);function Pe(){return r._SPFlight.isEnabled(60218)||1===oe._SPPerfExperiment.getVariantAndTrackExperiment(oe._PerformanceExperiment.SOXEventUpdate)}function Te(){return r._SPFlight.isEnabled(60278)}function Ue(){return r._SPFlight.isEnabled(60373)}var Fe=function(){function e(e){return this.id="MultiSiteNews",this.title=B.C,le.isNewsHaukAPIModelEnabled()&&!e.shouldUseMicroservice?this.instance=new He(e):this.instance=new Re(e),this.instance}return Object.defineProperty(e.prototype,"qosMonitorLabel",{get:function(){return"MultiSiteNewsDataProvider"},enumerable:!1,configurable:!0}),e.prototype.requestData=function(e){return this.instance.requestData(e)},e}(),He=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="MultiSiteNews",t.title=B.C,t.getRequestBody=function(e){var t=[];if(e.siteList.forEach(function(e){t.push("".concat(e.ItemReference.SiteId,",").concat(e.ItemReference.WebId))}),x())return{sites:t,filterByAudience:!!e.audienceTargetingEnabled,preferredLanguage:e.languageOverride};var n={sites:t,filterByAudience:!!e.audienceTargetingEnabled};return e.languageOverride&&(n.preferredLanguage=e.languageOverride),n},t.getAPIPath=function(e){var n=u.UriEncoding.escapeUrlForCallback(t._pageContext.web.absoluteUrl),a="?$expand=analytics($expand=allTime),thumbnails&$top=".concat(e.count);return t.isPaginationRequest(e)?t.nextLink:n+"/_api/v2.1/getMultiSiteNews"+a},t}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"VroomMultiSiteNewsDataProvider"},enumerable:!1,configurable:!0}),t}(Ee),Re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="MultiSiteNews",t.title=B.C,t.executeRequest=function(e){var n={alias:X.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:i._CacheStrategy.CacheAndNetwork,extraProps:new Map([[v.useStalePropName,!0]])};e.canCacheRequest||(n.cacheStrategy=i._CacheStrategy.NetworkOnly);var a=t._sphomeHttpClient.post(t.getMicroservicePath(e),t._getSiteListAndFilterBody(e.siteList,e.filterKQLQuery),void 0,void 0,n);return X._isHaukShadowcallsKillSwitchActivated()||t._compareNewAPIs(a,e),a},t}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"MultiSiteNewsDataSource"},enumerable:!1,configurable:!0}),t.prototype.requestData=function(t){var n;return(null===(n=t.siteList)||void 0===n?void 0:n.length)?e.prototype.requestData.call(this,t):Promise.resolve(this._getNewsItemsWithPadding(t,0))},t.prototype.extractMicroserviceNewsItems=function(e){return X.extractMicroserviceNewsItems(e,this._pageContext,!0)},t.prototype.getMicroservicePath=function(e){var t="mainSiteUrl=".concat(this._pageContext.site.absoluteUrl,"&"),n="start=".concat(e.skip,"&count=").concat(e.count);n+=H(e),n+=R(e);var a=this._shouldQueryCurrentSite(e.siteList||[]);return"".concat("news/sites/filtered","?").concat(a?t:"").concat(n)},t.prototype._getNewsItemsWithPadding=function(e,t){var n=X.getPaddingCount(e,t);return X.getEmptyStateItems(e.emptyItemType,this.options.serviceScope,n,e.webpartWidth)},t.prototype._shouldQueryCurrentSite=function(e){var t=this._pageContext.site.id.toString(),n=this._pageContext.web.id.toString();return W.findIndex(e,function(e){return e.ItemReference.SiteId===t&&e.ItemReference.WebId===n})>-1},t.prototype._getSiteListAndFilterBody=function(e,t){return JSON.stringify({ReferenceList:this._getSiteListBody(e),FilterQuery:t})},t.prototype._getSiteListBody=function(e){return e.map(function(e){return{Type:"SiteReference",SiteId:e.ItemReference.SiteId,WebId:e.ItemReference.WebId}})},t.prototype._compareNewAPIs=function(e,t){var n=this;setTimeout(function(){if(n.canCompare){var a=e.then(function(e){if(!(e instanceof i.HttpClientResponse)&&e.serverResponse){var a=new s._QosMonitor("SPHomeQualityTest.getMultiSiteProcessedResponse");return n._processHttpClientResponsePromise(e.serverResponse,t,{},a,!0)}return[]}),o=new Ae("SPHomeMicroservice",r.Guid.parse("364f9d77-37e1-4060-b45c-d85d631f2ebf"),a),c=t;c.canCacheRequest=!1;var d=new s._QosMonitor("News.MultisiteVroom"),l=new He(n.options).requestData(c).then(function(e){return d.writeSuccess(),e}).catch(function(e){return d.writeUnexpectedFailure("Error",e),[]});o.addApiPromise("VroomAPI",r.Guid.parse("3e2b65bb-803a-4b31-9189-4c88a3aa9836"),l),o.handleRacing()}},3e3)},t}(ye),Ne=function(){function e(e){var t,n=this;return this.id="News",this.title=B.w,this.qosMonitorLabel="NewsreelDataSource",this._executeRequest=function(e){var t={metadataFilter:e.serializedFilterQuery,languageOverride:e.languageOverride},a={body:JSON.stringify(t),headers:new J("POST"),method:"POST"},r={alias:X.aliasPrefix+n.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:i._CacheStrategy.CacheAndNetwork,extraProps:new Map([[v.useStalePropName,!0]])};return e.canCacheRequest||(r.cacheStrategy=i._CacheStrategy.NetworkOnly),n._spHttpClient.fetch(n._getNewsItemsUrl(e),i.SPHttpClient.configurations.v1,a,r)},this._isEmptyResponse=function(e){var t=null==e?void 0:e.filter(function(e){return!(null==e?void 0:e.isHelpArticle)});return!(null==t?void 0:t.length)},this._isRawData=function(e){var t;return null===(t=e)||void 0===t?void 0:t.value},this._parseSPHttpClientResponse=function(e,t,a){var i=N(t),r=n._isInSmartRace?"NewsreelDataSource.getNewsItemsInSmartRace":"NewsreelDataSource.getNewsItems",o=a||new oe._QosMonitor(r);if(i.correlationId="".concat(e.correlationId),i.responseStatus="".concat(e.status),i.message=e.statusMessage,e.ok)return e.json().then(function(e){var a=n._processRawData(e,t);return o.writeSuccess(i),a}).catch(function(e){throw o.writeUnexpectedFailure("Unexpected",e,i),e});var s=new Error(e.statusMessage);return o.writeUnexpectedFailure("Unexpected",s,i),Promise.reject(s)},this._processRawData=function(e,t){var a=X.getPaddingCount(t,e.value?e.value.length:0);return(e.value&&e.value.length>0?X.extractNewsItems(e.value,n._pageContext):[]).concat(X.getEmptyStateItems(t.emptyItemType,n.options.serviceScope,a,t.webpartWidth))},this.options=e,this.options.serviceScope.whenFinished(function(){var e;n._spHttpClient=n.options.serviceScope.consume(i.SPHttpClient.serviceKey),n._pageContext=n.options.serviceScope.consume(a.PageContext.serviceKey),n._absoluteUrl=null===(e=n._pageContext)||void 0===e?void 0:e.web.absoluteUrl}),u.Locale.language||(u.Locale.language="en-us"),this._isOneBox="onebox"===(null===(t=this._pageContext.legacyPageContext)||void 0===t?void 0:t.env2),le.isGetMultiSiteForThisSiteEnabled(this._isOneBox)&&(this._defaultFilter=X.getDefaultFilter(),this._multiSiteDataProvider=new Be(this.options)),this}return e.prototype.requestData=function(e){var t=this;if(this._shouldUseMultiSiteDataProvider(e))return this._requestMultiSiteData(e);if(!S()){var n={parseHttpClientResponse:this._parseSPHttpClientResponse,isEmptyResponse:this._isEmptyResponse,isRawData:this._isRawData,processRawData:this._processRawData,qosMonitorLabel:this.qosMonitorLabel,onServerResponseResolvedWithCache:e.onServerResponseResolvedWithCache,onServerResponseResolved:e.onServerResponseResolved,onServerResponseFailed:e.onServerResponseFailed,onCacheResponseResolved:e.onCacheResponseResolved,onCacheResponseFailed:e.onCacheResponseFailed};return v.executeCacheStrategy(n,this._executeRequest,e)}return this._executeRequest(e).then(function(n){if(n instanceof i.SPHttpClientResponse)return t._parseSPHttpClientResponse(n,e);var a=n;return t._applyCacheAndNetwork(a,e)||t._parseClientCachableResponse(n,e)})},e.prototype._applyCacheAndNetwork=function(e,t){var n=this;if(e.serverResponse&&e.cachedResponse){this._isInSmartRace=!0;var a=e.serverResponse.then(function(e){return n._parseSPHttpClientResponse(e,t)}).then(function(e){var a=n._isEmptyResponse(e);return t.onServerResponseResolved(a),e}).catch(function(e){throw t.onServerResponseFailed(e),e}),i=v.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData.bind(this),t).then(function(e){var a=n._isEmptyResponse(e);return t.onCacheResponseResolved(a),e||[]}).catch(function(e){throw t.onCacheResponseFailed(e),e}),o=r.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),s=r.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),c=[{raceablePromise:i,raceId:o},{raceablePromise:a,raceId:s}];return l.SmartRace.race(c).then(function(e){return e.raceId===o&&a.then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){}),e.raceablePromise})}},e.prototype._getNewsItemsUrl=function(e){var t=u.UriEncoding.escapeUrlForCallback(this._absoluteUrl),n="/_api/sitepages/pages/"+(e.audienceTargetingEnabled?"FeedTargeted":"feed")+"?promotedstate=2&published=true",a="&$skip="+(e.skip?e.skip.toString():"0"),i="&$top="+(e.count>0?e.count.toString():""),r="";Ue()&&(r="&$filter=not startswith(ContentTypeId ,'0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B00873E381CC9DD4F2E808A377A72C311BB')");var o="&$select=Description,BannerImageUrl,BannerThumbnailUrl,AbsoluteUrl,FirstPublished,Title,FileName,Id,UniqueId,ListId,OriginalSourceItemId,OriginalSourceUrl,Path";return X.isCallToActionEnabled()&&(o+=",CallToAction"),t+n+r+a+i+"&$expand=CreatedBy"+o},e.prototype._parseClientCachableResponse=function(e,t){var n,a=this,i=null===(n=e.serverResponse)||void 0===n?void 0:n.then(function(e){return a._parseSPHttpClientResponse(e,t)}).then(function(e){var n=a._isEmptyResponse(e);return t.onServerResponseResolved(n),e}).catch(function(e){throw t.onServerResponseFailed(e),e});return e.cachedResponse?(i&&i.then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){}),v.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData.bind(this),t).then(function(e){var n=a._isEmptyResponse(e);return t.onCacheResponseResolved(n),e||[]}).catch(function(e){throw t.onCacheResponseFailed(e),e})):i},e.prototype._shouldUseMultiSiteDataProvider=function(e){var t,n=JSON.stringify(e.filters)!==this._defaultFilter;return le.isNewsHaukAPIModelEnabled()&&le.isGetMultiSiteForThisSiteEnabled(null!==(t=e.isOneBox)&&void 0!==t&&t)&&!e.isCallToActionEnabled&&!n},e.prototype._requestMultiSiteData=function(e){var t=new oe._QosMonitor("NewsreelDataSource.requestMultiSiteData"),n={Acronym:"",Title:"",BannerColor:"",Url:this._absoluteUrl,Type:"",ItemReference:{SiteId:"".concat(this._pageContext.site.id),WebId:"".concat(this._pageContext.web.id),Type:""}};return e.siteList=[n],this._multiSiteDataProvider.requestData(e).then(function(e){return t.writeSuccess(),e}).catch(function(e){throw t.writeUnexpectedFailure("Unexpected",e),e})},e}(),Be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.title=B.w,t}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"CurrentSiteNewsDataProviderVroom"},enumerable:!1,configurable:!0}),t}(He),je=function(){function e(e){this.id=ne,this.title="NewsDigest",this.options=e}return e.prototype.requestData=function(e){var t=this.options.newsItems||[];return Promise.resolve(t)},e}(),Ve=function(){function e(e,t,n){return r.Validate.isNotNullOrUndefined(e,"pageContext"),this._pageContext=e,this._spHttpClient=t,this._newsDigestBubbleType=n,this._absoluteUrl=this._pageContext.web.absoluteUrl,this}return Object.defineProperty(e.prototype,"_newsDigestFirstExperienceBitRestApiUrl",{get:function(){return this._absoluteUrl+"/_api/SP.Directory.DirectorySession/GetGraphUser(principalName='"+u.UriEncoding.encodeURIComponent(this._pageContext.user.loginName)+"')"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_newsDigestFirstExperienceBitRestUrl",{get:function(){return this._newsDigestFirstExperienceBitRestApiUrl+"?$select="+this._newsDigestBubbleType},enumerable:!1,configurable:!0}),e.readCachedFirstRunExperience=function(e){var t=window.localStorage.getItem(e);if(t)return"true"===t},e.prototype.writeCachedFirstRunExperience=function(t){var n=this._newsDigestBubbleType,a=window.localStorage.getItem(n),i=String(t);if(a!==i)try{window.localStorage.setItem(n,i)}catch(t){s._TraceLogger.logError(e._logSource,t)}},e.prototype.showFirstRun=function(){var t=e.readCachedFirstRunExperience(this._newsDigestBubbleType);return!0===t?(s._TraceLogger.logVerbose(e._logSource,this._newsDigestBubbleType+" is true in the local storage"),Promise.resolve(!1)):!1===t?(s._TraceLogger.logVerbose(e._logSource,this._newsDigestBubbleType+" is false in the local storage"),Promise.resolve(!0)):this.getFirstRunBitApi()},e.prototype.setFirstRunSeen=function(t){var n=this,a=new oe._QosMonitor("SetNewsDigestFirstRunExperienceAPI"),r={};r[this._newsDigestBubbleType]=Boolean(t);var o="application/json; odata=minimalmetadata",c=new Headers;return c.append("Accept","*/*, ".concat(o)),c.append("Content-Type",o),c.append("X-HTTP-Method","PATCH"),c.append("X-ClientType","NewsDigest_SetFirstRunBit"),this._spHttpClient.post(this._newsDigestFirstExperienceBitRestApiUrl,i.SPHttpClient.configurations.v1,{body:JSON.stringify(r),headers:c}).then(function(i){s._TraceLogger.logVerbose(e._logSource,"Set news digest first run bit to API: ".concat(t)),a.writeSuccess(),n.writeCachedFirstRunExperience(t)}).catch(function(t){throw s._TraceLogger.logError(e._logSource,t),a.writeUnexpectedFailure("SetNewsDigestFirstRunExperienceAPI",t),t})},e.prototype.getFirstRunBitApi=function(){var t=this,n=new oe._QosMonitor("GetNewsDigestFirstRunExperienceAPI"),a=new Headers;return a.append("X-ClientType","NewsDigest_GetFirstRunBit"),this._spHttpClient.get(this._newsDigestFirstExperienceBitRestUrl,i.SPHttpClient.configurations.v1,{headers:a}).then(function(e){return e.json()}).then(function(a){var i=a[t._newsDigestBubbleType];return s._TraceLogger.logVerbose(e._logSource,"Get news digest first run bit from API, status: ".concat(i)),n.writeSuccess(),t.writeCachedFirstRunExperience(i),!i}).catch(function(t){return s._TraceLogger.logError(e._logSource,t),n.writeUnexpectedFailure("FailedToGetNewsDigestFirstExperienceError",t),!1})},e._logSource=s._LogSource.create("NewsDigestFirstRunDataProvider"),e}(),ze=function(){function e(){}return e.ascending=0,e.descending=1,e}(),Ge={shouldUseCachedRequest:!1,webpartId:"",alias:"",qosMonitorLabel:""},Ke=function(){function e(e,t,n){var a=this;void 0===t&&(t=""),void 0===n&&(n=Ge),this.extraData={},this._parseHttpClientResponse=function(e,t,n){return a.extraData={correlationId:"".concat(e.correlationId),responseStatus:"".concat(e.status),message:e.statusMessage,cacheStatus:"None"},a._parseResponse(e).catch(function(e){return n.writeUnexpectedFailure("Unexpected",e.message),e}).then(function(e){return a._parseRawResponse(e,void 0,n)})},this._parseRawResponse=function(e,t,n){var i=a._simplifyResultForTemplating(e);return n.writeSuccess(a.extraData),i},this._isEmptyResponse=function(e){var t;return!(null===(t=null==e?void 0:e.rows)||void 0===t?void 0:t.length)},this._isRawData=function(e){return!(null==e?void 0:e.rows)},this._serviceScope=e,this._qosPrefix=t,this._tieredCachingProps=n,this._simplifyResultForTemplating=this._simplifyResultForTemplating.bind(this)}return Object.defineProperty(e.prototype,"_shouldUseTieredCaching",{get:function(){return(r._SPFlight.isEnabled(60469)||1===oe._SPPerfExperiment.getVariantAndTrackExperiment(oe._PerformanceExperiment.WEXMySiteCacheTCExpHCW))&&this._tieredCachingProps.shouldUseCachedRequest},enumerable:!1,configurable:!0}),e.prototype.getSearchQueryResponse=function(e){var t=this._qosPrefix?new oe._QosMonitor("".concat(this._qosPrefix,".SearchDataProviderGetResponse")):new oe._QosMonitor("SearchDataProviderGetResponse");return(this._shouldUseTieredCaching?this._getSearchQueryResponse(e):this._getRawSearchQueryResponse(e).then(this._simplifyResultForTemplating)).then(function(e){return t.writeSuccess(),e}).catch(function(e){return t.writeUnexpectedFailure("FailedSearchPOST",e,{correlationId:e.correlationId}),Promise.reject(e)})},e.prototype.getManagedPropertiesQueryResponse=function(e){var t=new oe._QosMonitor("ManagedPropertiesRequest");return this._getRawSearchQueryResponse(e).then(function(e){var n,a,i=(null===(a=null===(n=e.PrimaryQueryResult)||void 0===n?void 0:n.RefinementResults)||void 0===a?void 0:a.Refiners)||[],r=(i.length>0?i[0].Entries:[]).map(function(e){return e.RefinementName});return t.writeSuccess(),Promise.resolve(r)}).catch(function(e){return t.writeUnexpectedFailure("ManagedPropertiesRequestFailed",e),Promise.reject(e)})},e.prototype._getRawSearchQueryHeaders=function(e){e.ClientType=e.ClientType||"ModernWebPart";var t='{ "request": '+(e?JSON.stringify(e):"{}")+" }",n=new Headers;return n.append("Accept","application/json;odata=nometadata"),n.append("Content-type","application/json;charset=utf-8"),n.append("OData-Version","3.0"),this._afterServiceScopeFinished().then(function(e){var a=e.pageContext;return{spHttpClient:e.spHttpClient,postUrl:"".concat(a.web.absoluteUrl,"/_api/search/postquery"),body:t,headers:n}})},e.prototype._getRawSearchQueryResponse=function(e){var t=this;return this._getRawSearchQueryHeaders(e).then(function(e){var n=e.spHttpClient,a=e.postUrl,r=e.body,o=e.headers;return n.post(a,i.SPHttpClient.configurations.v1,{body:r,headers:o}).then(t._parseResponse)})},e.prototype._getSearchQueryResponse=function(e){var t=this;return this._getRawSearchQueryHeaders(e).then(function(e){var n=e.spHttpClient,a=e.postUrl,r=e.body,o=e.headers,s=t._tieredCachingProps,c=s.webpartId,d=s.alias;return v.executeCacheStrategy(t._cacheProps,function(){var e={method:"POST",body:r,headers:o},t={id:c,expirationDuration:6e5,cacheStrategy:i._CacheStrategy.CacheAndNetwork,alias:d,extraProps:new Map([[v.useStalePropName,!0]])};return n.fetch(a,i.SPHttpClient.configurations.v1,e,t)},void 0)})},Object.defineProperty(e.prototype,"_cacheProps",{get:function(){var e=this._tieredCachingProps,t=(e.webpartId,e.shouldUseCachedRequest,e.alias,Object(c.__rest)(e,["webpartId","shouldUseCachedRequest","alias"]));return Object(c.__assign)(Object(c.__assign)({},t),{parseHttpClientResponse:this._parseHttpClientResponse,isEmptyResponse:this._isEmptyResponse,isRawData:this._isRawData,processRawData:this._parseRawResponse})},enumerable:!1,configurable:!0}),e.prototype._simplifyResultForTemplating=function(e){var t,n,a,i={};try{var r=[],o=null===(a=null===(n=null===(t=e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.Table)||void 0===a?void 0:a.Rows;if(!o)throw new Error("Did not receive response rows.");for(var s=0;s<o.length;s++){for(var c={},d=o[s].Cells,l=0;l<d.length;l++){var u=d[l];c[u.Key]=u.Value}r.push(c)}i.rows=r}catch(e){i.rows=[]}return i},e.prototype._afterServiceScopeFinished=function(){var e=this;return new Promise(function(t){e._serviceScope.whenFinished(function(){t({pageContext:e._serviceScope.consume(a.PageContext.serviceKey),spHttpClient:e._serviceScope.consume(i.SPHttpClient.serviceKey)})})})},e.prototype._parseResponse=function(t){return t.status>=200&&t.status<300?t.json():t.json().then(function(n){var a="BadSearchResponse: statusMessage=".concat(t.statusMessage);throw s._TraceLogger.logVerbose(e._LogSource,"".concat(a,", response inner error=").concat(JSON.stringify(n))),{message:a,status:t.status,correlationId:t.correlationId?t.correlationId.toString():"",innerError:n}})},e._LogSource=s._LogSource.create("SearchAPIRequest"),e}(),We={CurrentSite:1,CurrentSiteCollection:2,AllSites:3,CurrentSiteDocumentLibrary:4,AllSitesInTheHub:5,CurrentSitePageLibrary:6,CurrentSiteEventsList:7,SelectedSites:99},qe={Document:1,Page:2,Video:3,Event:4,Issue:5,Task:6,Link:7,Contact:8,Image:9,News:10,All:99},Qe={Word:1,Excel:2,PowerPoint:3,OneNote:4,Visio:5,PDF:10,Video:11,Any:99},Ye={Equals:1,NotEqual:2,BeginsWith:3,EndsWith:4,Contains:5,DoesNotContain:6,LessThan:7,GreaterThan:8,Between:9,GreaterThanOrEqualTo:10,LessThanOrEqualTo:11,IsNull:12},Je={Today:1,Yesterday:2,ThisWeek:3,ThisMonth:4,LastMonth:5,ThisYear:6,LastYear:7},Xe=n("ui8f"),Ze={MostRecent:1,MostViewed:2,Trending:3,FieldAscending:4,FieldDescending:5},$e={CurrentUser:1,SpecificUser:2},et=function(){function e(){}return e.isValidMeToken=function(e){return new RegExp("^\\[me\\]$","i").test(e)},e.isValidTodayToken=function(e){return new RegExp("^\\[today\\]([\\+|\\-]\\d+$)?$","i").test(e)},e}(),tt="Created",nt="LastModifiedTime",at="8413CD39-2156-4E00-B54D-11EFD9ABDB89",it="ContentTypeId:0x0106*",rt="ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118*",ot="DepartmentId",st="(ModernAudienceAadObjectIds:{User.Audiences} OR NOT IsAudienceTargeted:true)",ct=function(){function e(){}return e.generateKqlFromFilters=function(e){var t="",n=!1;if(!e||!e.query||!e.query.filters)return{expr:t,isFilteringByDate:n};for(var a=Object(W.clone)(e.query.filters),i=a.length;i--;)void 0!==a[i].value&&""!==a[i].value||void 0!==a[i].userType&&a[i].userType!==$e.SpecificUser||a.splice(i,1);a=a.sort(function(e,t){return e.filterType-t.filterType});for(var r=!1,o=0;o<a.length;o++){o>0&&(t+=" ".concat(r?"OR":"AND"," "));var s=a[o],c=o<a.length-1?a[o+1]:void 0;r||void 0===(null==c?void 0:c.value)||s.filterType!==c.filterType||(t+="(",r=!0);var d=this._kqlFilter(s,e.queryableManagedProperties);t+=d.expr,n=n||d.isFilteringByDate,r&&s.filterType!==(null==c?void 0:c.filterType)&&(t+=")",r=!1)}return t.length>0&&(t+=" AND"),{expr:t,isFilteringByDate:n}},e.generateKqlFromFilterGroup=function(e){if(!e||!e.query||!e.query.filterGroup)return{expr:"",isFilteringByDate:!1};var t=this._buildFilterGroupExpr(e.query.filterGroup,e.queryableManagedProperties);return t.expr.length>0&&(t.expr+=" AND"),t},e.generateQuery=function(e,t){var n="";if(!e||!e.query)return{queryTemplate:n};var a=e,i=!1,o=!1;if(a.query.advancedQueryText)n=a.query.advancedQueryText;else if(a.query.filterGroup)n=(s=this.generateKqlFromFilterGroup(a)).expr,i=s.isFilteringByDate;else if(a.query.filters){var s;n=(s=this.generateKqlFromFilters(a)).expr,i=s.isFilteringByDate}n.length>0&&(o=!0),n+=" ".concat(this.generateContentLocationKqlQuery(a)),n+=this._generateContentKql(a,o);var c=void 0;return(i||!r._SPKillSwitch.isActivated("877ec1e9-752d-4af4-a970-5c22c24339cc")&&a.query.advancedQueryText)&&(c=t.user.preferUserTimeZone?t.user.timeZoneInfo.id:t.web.timeZoneInfo.id),a.audienceTarget&&(n=n.trim()+" ".concat(st)),{queryTemplate:n.trim(),timeZoneId:c}},e.generateContentLocationKqlQuery=function(e){var t=this;switch(e.query.contentLocation){case We.AllSitesInTheHub:return"".concat(this._siteCriteria(e.hubSiteId,ot));case We.CurrentSite:return this._generateSiteIdCriteria(e.siteId,e.webId);case We.CurrentSiteCollection:return"(".concat(this._siteCriteria(e.siteId,"NormSiteID"),")");case We.SelectedSites:if(e.siteIds&&e.siteIds.length>0){var n=e.siteIds.map(function(e){return t._generateSiteIdCriteria(e.siteId,e.webId)});return"(".concat(n.join(" OR "),")")}}return""},e.generateSearchAPIQueryOptions=function(e,t,n){var a=n.isPrivateGroup;!a&&n.query&&(a=n.query.contentLocation===We.AllSites||n.query.contentLocation===We.AllSitesInTheHub);var i=a?"True":"False",r=n.enableMultiGeoSearch?"True":"False",o={ClientType:n.clientType,QueryTemplate:e,TimeZoneId:t,SelectProperties:["ContentType","ContentTypeId","Title","EditorOwsUser","ModifiedBy","LastModifiedBy","FileExtension","FileType","Path","SiteName","SiteTitle","PictureThumbnailURL","DefaultEncodingURL","LastModifiedTime","ListID","ListItemID","SiteID","WebId","UniqueID"],Properties:[{Name:"TrimSelectProperties",Value:{StrVal:"1",QueryPropertyValueTypeIndex:1}},{Name:"EnableDynamicGroups",Value:{BoolVal:i,QueryPropertyValueTypeIndex:3}},{Name:"EnableMultiGeoSearch",Value:{BoolVal:r,QueryPropertyValueTypeIndex:3}}]};if(o.SourceId=at,o.TrimDuplicates=!1,e.indexOf(it)>-1&&o.SelectProperties.push("UserName","WorkEmail","OrgNames","JobTitle","WorkPhone","MobilePhone"),n.query&&n.query.filters){for(var s=n.query.filters,c=!1,d=!1,l=0;l<s.length;l++)switch(s[l].filterType){case K.RecentlyAdded:c=!0;break;case K.RecentlyChanged:d=!0}c&&o.SelectProperties.push(tt),d&&o.SelectProperties.push(nt)}if(n.selectProperties){var u={};for(l=0;l<o.SelectProperties.length;l++)u[o.SelectProperties[l]]=!0;for(l=0;l<n.selectProperties.length;l++)this._addSelectField(o.SelectProperties,n.selectProperties[l],u)}if(n.maxItemsPerPage&&(o.RowLimit=n.maxItemsPerPage,o.RowsPerPage=n.maxItemsPerPage),n.startRow&&(o.StartRow=n.startRow),n.query)switch(n.query.sortType){case Ze.MostRecent:o.SortList=[{Property:nt,Direction:ze.descending}];break;case Ze.MostViewed:o.SortList=[{Property:"ViewsLifeTime",Direction:ze.descending}];break;case Ze.Trending:o.SortList=[{Property:"ViewsRecent",Direction:ze.descending}];break;case Ze.FieldAscending:case Ze.FieldDescending:n.query.sortField&&(o.SortList=[{Property:n.query.sortField,Direction:n.query.sortType===Ze.FieldAscending?ze.ascending:ze.descending}])}return o},e.generateSearchAPIQueryOptionsForManagedProperties=function(e){var t,n=e.query,a=n.managedPropertiesRefinerOptions,i=isNaN(a.limit)?5e4:a.limit,r=a.managedPropertyMatchText?"*".concat(a.managedPropertyMatchText,"*"):"*",o=btoa(Object(W.unescape)(encodeURIComponent(r)));switch(n.contentLocation){case We.CurrentSite:t=e.webAbsoluteUrl;break;case We.CurrentSiteCollection:t=e.siteAbsoluteUrl;break;case We.AllSites:default:t=new URL(e.webAbsoluteUrl).origin}var s='path:"'.concat(t,'" ').concat(this._generateContentKql(e,!1));return{ClientType:e.clientType,SourceId:at,Querytext:s,Refiners:"ManagedProperties(filter3i=".concat(i,"/0/").concat(o,",sort=name/ascending)"),EnableQueryRules:!1,ProcessBestBets:!1,ProcessPersonalFavorites:!1,Properties:[{Name:"EnableDynamicGroups",Value:{BoolVal:"False",QueryPropertyValueTypeIndex:3}},{Name:"ClientFunction",Value:{StrVal:"SchemaLookup",QueryPropertyValueTypeIndex:1}}]}},e._buildFilterGroupExpr=function(e,t){var n=this,a="",i=!1;return e.filters&&e.filters.forEach(function(r){if(void 0!==r.value&&""!==r.value||void 0!==r.userType&&r.userType!==$e.SpecificUser){var o=n._kqlFilter(r,t);i=i||o.isFilteringByDate,a=n._chainKqlFilterExpr(a,o,e.logicalOperator)}}),e.filterGroups&&e.filterGroups.forEach(function(r){var o=n._buildFilterGroupExpr(r,t);i=i||o.isFilteringByDate,a=n._chainKqlFilterExpr(a,o,e.logicalOperator)}),a&&(a+=")"),{expr:a,isFilteringByDate:i}},e._chainKqlFilterExpr=function(e,t,n){var a=e;return t.expr&&(a?a+=" ".concat(n," "):a="(",a+=t.expr),a},e._generateContentKql=function(e,t){var n=e.query,a=e.languageCode,i="",o=Ue()?"(".concat(rt," AND PromotedState=2 AND NOT ContentTypeId:").concat("0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B00873E381CC9DD4F2E808A377A72C311BB","*)"):"(".concat(rt," AND PromotedState=2)"),s="(FileType=".concat(l.spConstants.imageExtensions.join(" OR FileType="),")"),d="(".concat("ContentTypeId:0x010108*"," OR ").concat("ContentTypeId:0x01010901*"," OR ").concat(rt," OR ").concat("ContentTypeId:0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF39*",")"),u=n.contentTypes||[qe.Document],f=!1;u.indexOf(qe.All)>-1&&(f=!0,n.contentLocation!==We.AllSites||t||(i+="*"));var p=!1,m=!1;if(!f)for(var _="",h=0;h<u.length;++h)switch(1===h&&(_=" OR"),u[h]){case qe.Document:i=this._appendCriteriaUniquely(i,_,"IsDocument:1"),p||(i+=" AND NOT (FileType:aspx OR FileType:html OR FileType:htm OR FileType:mhtml)"),p=!0;break;case qe.Page:i=this._appendCriteriaUniquely(i,_,d,a),m||(i+=" AND NOT (FileType:one OR FileType:onepkg OR FileType:ms-one-stub OR FileType:onetoc OR FileType:onetoc2)"),m=!0;break;case qe.News:i=this._appendCriteriaUniquely(i,_,o,a);break;case qe.Event:i=this._appendCriteriaUniquely(i,_,"ContentTypeId:0x0102*");break;case qe.Issue:i=this._appendCriteriaUniquely(i,_,"ContentTypeId:0x0103*");break;case qe.Task:i=this._appendCriteriaUniquely(i,_,"ContentTypeId:0x0108*");break;case qe.Link:i=this._appendCriteriaUniquely(i,_,"ContentTypeId:0x0105*");break;case qe.Contact:i=this._appendCriteriaUniquely(i,_,it);break;case qe.Video:i=this._appendCriteriaUniquely(i,_,"ContentTypeId:0x010100F3754F12A9B6490D9622A01FE9D8F012*"),r._SPFlight.isEnabled(1538)&&(""===_&&(i+=" OR "),i=this._appendCriteriaUniquely(i,_,this._documentTypeCriteria(Object(c.__spreadArray)([],l.spConstants.videoExtensions,!0))));break;case qe.Image:i=this._appendCriteriaUniquely(i,_,s)}if(a&&f&&(i+="".concat(y()?" AND":"")+" (SPTranslationLanguage:".concat(a," ")+"OR (NOT SPTranslatedLanguages:".concat(a," AND NOT SPIsTranslation:true))")),p||f){var b=n.documentTypes||[Qe.Any];if(-1===b.indexOf(Qe.Any))for(_="",h=0;h<b.length;++h)switch(1===h&&(_=" OR"),b[h]){case Qe.Word:i=this._appendCriteriaUniquely(i,_,this._documentTypeCriteria(["doc","docm","docx"]));break;case Qe.Excel:i=this._appendCriteriaUniquely(i,_,this._documentTypeCriteria(["xls","xlsb","xlsm","xlsx"]));break;case Qe.PowerPoint:i=this._appendCriteriaUniquely(i,_,this._documentTypeCriteria(["pot","potx","ppt","pptm","pptx"]));break;case Qe.OneNote:i=this._appendCriteriaUniquely(i,_,this._documentTypeCriteria(["one","onepkg","ms-one-stub","onetoc","onetoc2"]));break;case Qe.Visio:i=this._appendCriteriaUniquely(i,_,this._documentTypeCriteria(["vsd","vsdm","vsdx","vdw"]));break;case Qe.PDF:i=this._appendCriteriaUniquely(i,_,this._documentTypeCriteria(["pdf"]))}}return i&&" (".concat(i.trim(),")")},e._addSelectField=function(e,t,n){n[t]||(n[t]=!0,e.push(t))},e._generateSiteIdCriteria=function(e,t){return"(".concat(this._siteCriteria(e,"NormSiteID")," AND ").concat(this._siteCriteria(t,"NormWebId"),")")},e._siteCriteria=function(e,t){return t===ot?"(".concat(t,":").concat(e," OR ").concat(t,":{").concat(e,"})"):"".concat(t,":").concat(e)},e._appendCriteriaUniquely=function(e,t,n,a){return-1===e.indexOf(n)&&(a&&(n+="".concat(y()?" AND ":"")+" (SPTranslationLanguage:".concat(a," ")+"OR (NOT SPTranslatedLanguages:".concat(a," AND NOT SPIsTranslation:true))")),e+="".concat(t," ").concat(n)),e},e._kqlFilter=function(e,t){var n=" ",a=!1;if(e&&(void 0!==e.value||void 0!==e.userType)){var i=void 0!==e.value?e.value.toString():"",r=void 0;switch(e.filterType){case K.TitleContaining:n+=i?'title:"'.concat(i,'"'):"";break;case K.AnyTextContaining:n+=i?'"'.concat(i,'"'):"";break;case K.TaggedWith:n+=i?'tags:"'.concat(i,'"'):"";break;case K.CreatedBy:e.userType===$e.CurrentUser?n+="createdby:{User}":i&&(et.isValidMeToken(i)?n+="createdby:{User}":n+='createdby:"'.concat(i,'"'));break;case K.ModifiedBy:e.userType===$e.CurrentUser?n+="modifiedby:{User}":i&&(et.isValidMeToken(i)?n+="modifiedby:{User}":n+='modifiedby:"'.concat(i,'"'));break;case K.RecentlyAdded:r=tt;break;case K.RecentlyChanged:r=nt;break;case K.Field:if(t){var o=this._managedPropertyFilter(e,t);n+=o.expr,a=o.isFilteringByDate}}if(r)switch(a=!0,this._filterSince(i)){case Je.Today:n+="".concat(r,"=today");break;case Je.Yesterday:n+="(".concat(r,"=today OR ").concat(r,"=yesterday)");break;case Je.ThisWeek:n+="".concat(r,'="this week"');break;case Je.ThisMonth:n+="".concat(r,'="this month"');break;case Je.LastMonth:n+="(".concat(r,'="this month" OR ').concat(r,'="last month")');break;case Je.ThisYear:n+="".concat(r,'="this year"');break;case Je.LastYear:n+="(".concat(r,'="this year" OR ').concat(r,'="last year")')}}return{expr:n.trim(),isFilteringByDate:a}},e._filterSince=function(e){try{return parseInt(e,10)}catch(e){return Je.ThisMonth}},e._documentTypeCriteria=function(e){return"(FileType:".concat(e.join(" OR FileType:"),")")},e._managedPropertyFilter=function(e,t){var n=e.fieldInfo||t[e.fieldname];n=n||Xe.e.Text;var a=this._parseManagedFieldValue(e.value,n),i="",r=n===Xe.e.DateTime;if(""===a.trim()&&e.op!==Ye.Equals&&e.op!==Ye.NotEqual&&e.op!==Ye.Between)return{expr:"",isFilteringByDate:!1};switch(e.op){case Ye.BeginsWith:var o=a.substr(1,a.length-2);i="".concat(e.fieldname,'="').concat(o,'*"');break;case Ye.Between:var s=this._parseManagedFieldValue(e.value2,n);""!==a.trim()&&""!==s.trim()?i="".concat(e.fieldname,">=").concat(a," AND ").concat(e.fieldname,"<=").concat(s):""!==a.trim()?i="".concat(e.fieldname,">=").concat(a):""!==s.trim()&&(i="".concat(e.fieldname,"<=").concat(s));break;case Ye.Contains:i="".concat(e.fieldname,":").concat(a);break;case Ye.DoesNotContain:i="-".concat(e.fieldname,":").concat(a);break;case Ye.Equals:i="".concat(e.fieldname,"=").concat(a);break;case Ye.GreaterThan:i="".concat(e.fieldname,">").concat(a);break;case Ye.GreaterThanOrEqualTo:i="".concat(e.fieldname,">=").concat(a);break;case Ye.LessThan:i="".concat(e.fieldname,"<").concat(a);break;case Ye.LessThanOrEqualTo:i="".concat(e.fieldname,"<=").concat(a);break;case Ye.NotEqual:i="-".concat(e.fieldname,"=").concat(a)}return{expr:i,isFilteringByDate:r}},e._parseManagedFieldValue=function(e,t){var n="";switch(t){case Xe.e.DateTime:if("string"==typeof e&&et.isValidTodayToken(e)){var a=e.substr("[today]".length)||"";return a?"{Today".concat(a,"}"):"{Today}"}var i=new Date(e.toString());"[object Date]"===Object.prototype.toString.call(i)&&(isNaN(i.getTime())||(n='"'.concat(i.toISOString(),'"')));break;case Xe.e.Decimal:case Xe.e.Double:var r=parseFloat(e.toString());isNaN(r)||(n=r.toString());break;case Xe.e.Integer:var o=parseInt(e.toString(),10);isNaN(o)||(n=o.toString());break;case Xe.e.Text:n="string"==typeof e&&et.isValidMeToken(e)?"{User}":'"'.concat(e.toString().trim(),'"');break;case Xe.e.YesNo:n=e?"true":"false"}return n},e}(),dt=n("9G/9"),lt=function(){function e(e){var t=this;return this.id="Search",this.title=dt.e,this.options=e,this.options.serviceScope.whenFinished(function(){t._spHttpClient=t.options.serviceScope.consume(i.SPHttpClient.serviceKey),t._pageContext=t.options.serviceScope.consume(a.PageContext.serviceKey),t._initVariables()}),this._searchAPIRequest=new Ke(e.serviceScope,e.qosPrefix||"",e.tieredCachingProps),u.Locale.language||(u.Locale.language="en-us"),this}return e.prototype.requestData=function(e){var t,n,a;if(null===(n=null===(t=e.searchOptions)||void 0===t?void 0:t.query)||void 0===n?void 0:n.managedPropertiesRefinerOptions)return a=ct.generateSearchAPIQueryOptionsForManagedProperties(e.searchOptions),this._searchAPIRequest.getManagedPropertiesQueryResponse(a).catch(function(e){return Promise.reject(e)});if(e.returnCachedValues)return this._returnCachedResults();if(e.searchAPIQueryOptions)a=e.searchAPIQueryOptions;else if(e.searchOptions){var i=ct.generateQuery(e.searchOptions,this._pageContext);a=ct.generateSearchAPIQueryOptions(i.queryTemplate,i.timeZoneId,e.searchOptions)}return a?this._searchAPIRequest.getSearchQueryResponse(a).then(this._mapResponse).catch(function(e){return Promise.reject(e)}):Promise.resolve([])},e.prototype._initVariables=function(){},e.prototype._mapResponse=function(e){return Promise.resolve(e)},e.prototype._returnCachedResults=function(){return Promise.resolve([])},e}(),ut=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){var n=X.extractNewsItemsFromSearch(e.rows,t._pageContext);return Promise.resolve(n)},t}return Object(c.__extends)(t,e),t._requestNewsData=function(e){var n="0x0101009D1CB255DA76424F860D91F20E6C4118",a=Ue()?"ContentTypeId:".concat(n,"* AND PromotedState:2 AND (NOT ContentTypeId:").concat("0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B00873E381CC9DD4F2E808A377A72C311BB","*)"):"ContentTypeId:".concat(n,"* AND PromotedState:2"),i=[];return e.uniqueIdGuids?(i.push("".concat(a," AND (")),e.uniqueIdGuids.forEach(function(e,t){0===t?i.push("UniqueID:".concat(e.toString())):i.push(" OR UniqueID:".concat(e.toString())),i.push(" OR UniqueID:{".concat(e.toString(),"}"))}),i.push(")")):i.push("{searchterms} ".concat(a)),t._request(e,i.join(""))},t._request=function(e,n){return new t({serviceScope:e.serviceScope}).requestData({searchOptions:{query:{contentLocation:e.contentLocation}},searchAPIQueryOptions:{Properties:[{Name:"EnableDynamicGroups",Value:{BoolVal:!0,QueryPropertyValueTypeIndex:3}},{Name:"EnableMultiGeoSearch",Value:{BoolVal:!0,QueryPropertyValueTypeIndex:3}}],Querytext:e.searchText||"",QueryTemplate:n,RowLimit:e.rowLimit,SelectProperties:["CreatedBy","AuthorOWSUSER","Description","PictureThumbnailURL","FirstPublishedDate","Title","FileName","ListItemId","OriginalPath","Path","SiteTitle","SPSiteURL","SPWebUrl","ViewCountLifetime","UniqueID","SiteID","WebId","ListId"],SortList:[{Property:"LastModifiedTime",Direction:ze.descending}],StartRow:e.startRow,TrimDuplicates:!0}})},t}(lt),ft=function(){function e(e){return this.id="myNews",this.title=B.O,le.isMyNewsHaukAPIModelEnabled()&&!e.shouldUseMicroservice?this._instance=new pt(e):this._instance=new mt(e),this._instance}return Object.defineProperty(e.prototype,"qosMonitorLabel",{get:function(){return"MyNewsDataSource"},enumerable:!1,configurable:!0}),e.prototype.requestData=function(e){return this._instance.requestData(e)},e}(),pt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="myNews",t.title=B.O,t.getAPIPath=function(e){var n=u.UriEncoding.escapeUrlForCallback(t._pageContext.web.absoluteUrl),a="section=SharePointNewsFeedTargeted&$expand=analytics($expand=allTime),thumbnails&$top=".concat(e.count);if(t.isPaginationRequest(e))return t.nextLink;var i=new u.Uri(u.Uri.concatenate(n,"/_api/v2.1/getNewsFeed"));return i.setQuery(a),i.toString()},t.getExtraHeaders=function(e){var t=new Map;return t.set("scenario","SPNewsWebpart"),t},t}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"httpMethod",{get:function(){return"GET"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"VroomMyNewsDataSource"},enumerable:!1,configurable:!0}),t}(Ee),mt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="myNews",t.title=B.O,t.executeRequest=function(e){var n={alias:X.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:i._CacheStrategy.CacheAndNetwork,extraProps:new Map([[v.useStalePropName,!0]])};e.canCacheRequest||(n.cacheStrategy=i._CacheStrategy.NetworkOnly);var a=t._sphomeHttpClient.post(t.getMicroservicePath(e),X.getFilterQueryBody(e.filterKQLQuery),void 0,void 0,n);return X._isPPSShadowcallsKillSwitchActivated()||t._compareNewAPIs(a,e),a},t}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"MyNewsDataSource"},enumerable:!1,configurable:!0}),t.prototype.getMicroservicePath=function(e){var t="start=".concat(e.skip,"&count=").concat(e.count);return t+=H(e),t+=R(e),"".concat("news/filtered","?").concat(t)},t.prototype._compareNewAPIs=function(e,t){var n=this;setTimeout(function(){if(n.canCompare){var a=e.then(function(e){if(!(e instanceof i.HttpClientResponse)&&e.serverResponse){var a=new s._QosMonitor("SPHomeQualityTest.getMyNewsProcessedResponse");return n._processHttpClientResponsePromise(e.serverResponse,t,{},a,!0)}return[]}),o=new Ae("SPHomeMicroservice",r.Guid.parse("92d60991-5b57-4828-9f5f-da94e71c6257"),a),c=t;c.canCacheRequest=!1;var d=new s._QosMonitor("News.MyNewsPPS"),l=new pt(n.options).requestData(c).then(function(e){return d.writeSuccess(),e}).catch(function(e){return d.writeUnexpectedFailure("Error",e),[]});o.addApiPromise("VroomAPI",r.Guid.parse("4a609117-4832-4b81-a400-c222a06d25be"),l),o.handleRacing()}},4e3)},t}(ye),_t=function(){function e(){}return e.ensureQueryableManagedProperties=function(){return e._loadedQueryableManagedPropertiesPromise||(e._loadedQueryableManagedPropertiesPromise=n.e(1).then(n.bind(null,"n9CK")).then(function(e){return e.default})),e._loadedQueryableManagedPropertiesPromise},e.ensureRetrievableManagedProperties=function(){return e._loadedRetrievableManagedPromise||(e._loadedRetrievableManagedPromise=n.e(2).then(n.bind(null,"oz+a")).then(function(e){return e.default})),e._loadedRetrievableManagedPromise},e}(),ht=function(){function e(){}return e.prototype.getPerson=function(e,t){var n,a,i,r;if(!e&&t)(o=t.split(";")).length>0&&(a=o[o.length-1]);else if(e){var o;if((o=e.split(" | ")).length>=2&&(i=o[0],a=o[1]),o.length>=3&&o[2]){var s=o[2].split(" ");s.length>1&&s[1].length>1&&(r=this._getAccountNameFromClaim(s[1]))}}return n={name:a},r&&(n.profileImageSrc=l.SPUtility.getUserPhotoUrl(r)),i?(n.email=i,n.profileImageSrc||(n.profileImageSrc=l.SPUtility.getUserPhotoUrl(i))):a?n.initials=this._getEditorInitials(a):n.profileImageSrc||(n.profileImageSrc=l.SPUtility.getUserPhotoUrl()),n},e.prototype._getEditorInitials=function(e){var t;if(e){var n=e.split("(")[0].trim().split(" ");t=(t=1===n.length?n[0].substring(0,2):n[0].charAt(0)+n[n.length-1].charAt(0)).toUpperCase()}return t},e.prototype._getAccountNameFromClaim=function(e){if(e){var t=e.lastIndexOf("|");if(t>=0)return e.substr(t+1)}},e}();function bt(e){if(!e)return"";var t=new RegExp('[*{}"]',"g");return e.replace(t," ")}var gt=function(){function e(e){this._pageContext=e.pageContext}return e.prototype.buildUrl=function(e,t,n){var a=r.UrlUtilities.removeEndSlash(e),i=0===t.indexOf("/")?"":"/",o=t.indexOf("?")>-1?"&":"?";return"".concat(a).concat(i).concat(t).concat(n?o+n:"")},Object.defineProperty(e.prototype,"pageContext",{get:function(){return this._pageContext},enumerable:!1,configurable:!0}),e}(),vt=n("6DSs"),yt=function(e){function t(t){var n=e.call(this,t)||this;return n._spHttpClient=t.spHttpClient,n}return Object(c.__extends)(t,e),t.prototype.get=function(e,t,n,a,r,o,s,c){var d=this.buildUrl(e,t,n);return this._getResponse(this._spHttpClient.get(d,i.SPHttpClient.configurations.v1,{headers:o}),a,r,s,c)},t.prototype.post=function(e,t,n,a,r,o,s,c,d){var l=this.buildUrl(e,t,n);return this._getResponse(this._spHttpClient.post(l,i.SPHttpClient.configurations.v1,{body:a,headers:s}),r,o,c,d)},t.prototype.patch=function(e,t,n,a,r,o,s,c,d){var l=this.buildUrl(e,t,n);return this._getResponse(this._spHttpClient.fetch(l,i.SPHttpClient.configurations.v1,{body:a,headers:s,method:"PATCH"}),r,o,c,d)},t.prototype._getResponse=function(e,t,n,a,i){return e.then(function(e){if(e.ok)return i?{}:e.json();var o=r.Text.format(vt.e,t,n,e.status,e.statusMessage);if(a)throw e;return e.json().then(function(t){throw{message:o,status:e.status,correlationId:e.correlationId?e.correlationId.toString():"",innerError:t}})})},t}(gt),St=function(){function e(){}return e.generateQueryString=function(e){var t=e.fields?e.fields.map(function(e){return u.UriEncoding.encodeURIComponent(e)}).join(","):void 0,n=new URLSearchParams(e.queryString);function a(e,t){var a="$".concat(e);t&&!n.has(a)&&n.set(a,t.toString())}return a("select",t),a("filter",e.filter),a("top",e.top),a("skip",e.skip),a("orderby",e.orderBy),a("expand",e.expand),n.toString()},e}(),Dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getListsForWeb=function(e,t){return this.get(e,"/_api/web/lists",t,"ListDataSource","getListsForWeb",{headers:{accept:"application/json;odata.metadata=none"}}).then(function(e){return e.value})},t.prototype.getListFromWeb=function(e,t,n){return this.get(e,"/_api/web/lists(guid'".concat(t,"')"),n,"ListDataSource","getListFromWeb").then(function(e){return e})},t.prototype.getDefaultDocumentLibrary=function(e,t){return this.get(e,"/_api/web/DefaultDocumentLibrary",t,"ListDataSource","getDefaultDocumentLibrary").then(function(e){return e})},t}(yt),It=Dt,xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getFieldsForList=function(e,t,n){return this.get(e,"/_api/web/lists('".concat(t,"')/Fields"),n,"ListFieldDataSource","getFieldsForList",{headers:{accept:"application/json;odata.metadata=none"}}).then(function(e){return e.value})},t}(yt),Ct=xt,Ot={Integer:1,Text:2,DateTime:4,Counter:5,Choice:6,Boolean:8,Number:9,Currency:10,MultiChoice:15,User:20},wt={None:0,ContextInfo:1,ListData:2,ListSchema:4},Et=n("R/pT"),At=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getItemsForList=function(e,t,n,a,i,o,s,c,d,l,u,f){var p,m=this;if(!a&&!t&&!n)throw Et.e;void 0===i&&(i=wt.None),s?(0===s.indexOf("?")&&(s=s.substring(1)),0!==s.indexOf("&")&&(s="&"+s)):s="",a?p="DefaultDocumentLibrary":(p="Lists",p+=t?"(guid'".concat(t,"')"):"/GetByTitle('".concat(n,"')"));var _=u?"View=".concat(u):"",h="/_api/web/".concat(p,"/RenderListDataAsStream?").concat(_).concat(s),b={parameters:{__metadata:{type:"SP.RenderListDataParameters"},RenderOptions:i}},g=new Headers;return g.append("Content-Type","application/json;odata=verbose"),g.append("Accept","application/json;odata=nometadata"),g.append("OData-Version","3.0"),o&&(b.parameters.ViewXml=o),d&&(b.parameters.ImageFieldsToTryRewriteToCdnUrls=d),void 0!==l&&(b.parameters.AudienceTarget=l),r._SPKillSwitch.isActivated("260c3c80-b336-4a28-a0b9-56085fa507b5")?this.post(e,h,"",JSON.stringify(b),"ListItemDataSource","getItemsForList",g,c).then(function(e){return e.ListData.Row}):f?f(e).then(function(t){return t&&g.append("authorization","Bearer "+t),m._getItems(e,h,b,g,c)}):this._getItems(e,h,b,g,c)},t.prototype._getItems=function(e,t,n,a,i){return this.post(e,t,"",JSON.stringify(n),"ListItemDataSource","getItemsForList",a,i).then(function(e){return e.ListData.Row})},t}(yt),Lt=At,kt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.addView=function(e,t){var n="/_api/web/lists('".concat(t,"')/Views/Add"),a=JSON.stringify({parameters:{__metadata:{type:"SP.ViewCreationInformation"},PersonalView:!1}});return this.post(e,n,void 0,a,"ListViewDataSource","addView",{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"}).then(function(e){return e.d})},t.prototype.updateViewXml=function(e,t,n,a){var i="/_api/web/lists('".concat(t,"')/views('").concat(n,"')/SetViewXml()"),r=JSON.stringify({viewXml:a});return this.post(e,i,void 0,r,"ListViewDataSource","updateViewXml",{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"}).then(function(e){return e.d})},Object(c.__decorate)([Object(l.monitor)("ListViewDataSource.addView")],t.prototype,"addView",null),Object(c.__decorate)([Object(l.monitor)("ListViewDataSource.updateViewXml")],t.prototype,"updateViewXml",null),t}(yt),Mt=kt,Pt="Author",Tt="_AuthorByline",Ut="Editor",Ft="Created",Ht="Modified",Rt="Modified",Nt=function(){function e(){}return e.generateCAMLQuery=function(t,n){var a=this;(t=t||{}).documentTypes=t.documentTypes||[Qe.Any],t.fields=t.fields||["Editor","FileLeafRef","File_x0020_Type","ID","Modified","Title","UniqueID"],t.filters=t.filters||[],t.fieldDictionary=t.fieldDictionary||{};var i=[],r=[],o=!1;t.documentTypes.map(function(e){switch(e){case Qe.Any:o=!0;break;case Qe.Word:i.push(a._documentTypeCriteria(["doc","docm","docx"]));break;case Qe.Excel:i.push(a._documentTypeCriteria(["xls","xlsb","xlsm","xlsx"]));break;case Qe.PowerPoint:i.push(a._documentTypeCriteria(["pot","potx","ppt","pptm","pptx"]));break;case Qe.OneNote:i.push(a._documentTypeCriteria(["one","onepkg","ms-one-stub"]));break;case Qe.Visio:i.push(a._documentTypeCriteria(["vsd","vsdm","vsdx","vdw"]));break;case Qe.PDF:i.push(a._documentTypeCriteria(["pdf"]));break;case Qe.Video:i.push(a._documentTypeCriteria(Object(c.__spreadArray)([],l.spConstants.videoExtensions,!0)))}}),o&&(i=[]),i.length&&(i=['<And><In><FieldRef Name="File_x0020_Type" /><Values>'].concat(i,"</Values></In>"),r.push("</And>")),o&&(i=['<And><And><Eq><FieldRef Name="FSObjType" /><Value Type="Integer">0</Value></Eq>'.concat(e._generateNotIn("File_x0020_Type",["onetoc","onetoc2"]),"</And>")],r.push("</And>")),t.contentTypes&&t.contentTypes.indexOf(qe.News)>-1&&(i.push('<And><Eq><FieldRef Name="PromotedState" /><Value Type="Integer">2</Value></Eq>'),r.push("</And>")),t.languageCode&&this._filterByLanguage(t,i,r);var s=t.sortField||Rt,d="true";s===Rt&&(d="false");var u="";t.maxItemsPerPage&&(u='<RowLimit Paged="false">'.concat(t.maxItemsPerPage,"</RowLimit>"));var f=t.fields.map(function(e){return'<FieldRef Name="'.concat(e,'" />')}).join("");return'<View Scope="RecursiveAll"><Query>'+e.generateCAMLFilter(t,i,r,n)+"<OrderBy>"+'<FieldRef Name="'.concat(s,'" Ascending="').concat(d,'" />')+"</OrderBy></Query><ViewFields>"+f+"</ViewFields>"+u+"</View>"},e.generateCAMLFilter=function(e,t,n,a){var i=this;if(t=t||[],n=n||[],e.filterGroup){var r=this._generateCriteriaFromFilterGroup(e.filterGroup,e.fieldDictionary,a);return"<Where>"+t.join("")+(r?"<And>":"")+r+'<Eq><FieldRef Name="FSObjType" /><Value Type="Integer">0</Value></Eq>'+(r?"</And>":"")+n.join("")+"</Where>"}var o=new Map;return e.filters.map(function(t){if(t){var n=i._generateFieldName(t),r=i._generateCriteria(t,e.fieldDictionary,a);n&&r&&(o.get(t.filterType)||o.set(t.filterType,new Map),o.get(t.filterType).get(n)||o.get(t.filterType).set(n,[]),o.get(t.filterType).get(n).push(r))}}),o.forEach(function(e){e.forEach(function(e){t.push("<And>".concat(i._combineCriteria(e,"Or"))),n.push("</And>")})}),"<Where>"+t.join("")+'<Eq><FieldRef Name="FSObjType" /><Value Type="Integer">0</Value></Eq>'+n.join("")+"</Where>"},e._generateNotIn=function(e,t){return t.map(function(t){return'<Neq><FieldRef Name="'.concat(e,'" /><Value Type="Text">').concat(t,"</Value></Neq>")}).reduceRight(function(e,t){return""===e?t:"<And>".concat(t).concat(e,"</And>")},"")},e._generateCriteriaFromFilterGroup=function(t,n,a){var i=this,r="";return t.filters&&(r=t.filters.reduce(function(r,o){var s=i._generateCriteria(o,n,a);return e._appendCriteria(t.logicalOperator,r,s)},r)),t.filterGroups&&(r=t.filterGroups.reduce(function(a,r){var o=i._generateCriteriaFromFilterGroup(r,n);return e._appendCriteria(t.logicalOperator,a,o)},r)),r},e._appendCriteria=function(e,t,n){var a="AND"===e?"And":"Or";return t&&n?"<".concat(a,">").concat(t).concat(n,"</").concat(a,">"):t+n},e._generateFieldName=function(e){switch(e.filterType){case K.TitleContaining:return"Title";case K.CreatedBy:return Pt;case K.PageAuthorByline:return Tt;case K.ModifiedBy:return Ut;case K.RecentlyAdded:return Ft;case K.RecentlyChanged:return Ht;case K.Field:return e.fieldname}return""},e._generateCriteria=function(e,t,n){var a=e.value?this._encodeUserEntryForXML(e.value.toString(),n):"";switch(e.filterType){case K.TitleContaining:return a?'<Contains><FieldRef Name="Title"/><Value Type="Text">'.concat(a,"</Value></Contains>"):"";case K.CreatedBy:return this._userTypeCriteria(e.userType,a,Pt,e.op);case K.PageAuthorByline:return this._userTypeCriteria(e.userType,a,Tt,e.op);case K.ModifiedBy:return this._userTypeCriteria(e.userType,a,Ut,e.op);case K.RecentlyAdded:return this._dateTimeTypeCriteria(e.value,Ft);case K.RecentlyChanged:return this._dateTimeTypeCriteria(e.value,Ht);case K.Field:return this._fieldTypeCriteria(e,t,n)}return""},e._encodeUserEntryForXML=function(e,t){var n=document.createElement("div");return n.appendChild(document.createTextNode(e)),t?encodeURIComponent(n.innerHTML).replace(new RegExp("'","g"),"%27%27"):n.innerHTML},e._documentTypeCriteria=function(e){return e.map(function(e){return'<Value Type="Text">'.concat(e,"</Value>")}).join("")},e._getISODateString=function(e){return"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate())},e._getDateTimeTypeComparisonValueElement=function(e,t,n){return["<And>",this._comparisonElement("Geq",e,'<Value Type="DateTime">'.concat(this._getISODateString(t),"</Value>")),this._comparisonElement("Leq",e,'<Value Type="DateTime">'.concat(this._getISODateString(n),"</Value>")),"</And>"].join("")},e._dateTimeTypeCriteria=function(e,t){var n=new Date;if("number"==typeof e)switch(e){case Je.Today:return this._comparisonElement("Eq",t,'<Value Type="DateTime"><Today /></Value>');case Je.Yesterday:return this._comparisonElement("Eq",t,'<Value Type="DateTime"><Today OffsetDays="-1" /></Value>');case Je.ThisWeek:var a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-n.getDay());return this._getDateTimeTypeComparisonValueElement(t,a,n);case Je.ThisMonth:var i=new Date(n.getFullYear(),n.getMonth(),1),r=new Date(n.getFullYear(),n.getMonth()+1,0);return this._getDateTimeTypeComparisonValueElement(t,i,r);case Je.LastMonth:var o=new Date(n.getFullYear(),n.getMonth()-1,1),s=new Date(n.getFullYear(),n.getMonth(),0);return this._getDateTimeTypeComparisonValueElement(t,o,s);case Je.ThisYear:var c=new Date(n.getFullYear(),0,1),d=new Date(n.getFullYear(),11,31);return this._getDateTimeTypeComparisonValueElement(t,c,d);case Je.LastYear:var l=new Date(n.getFullYear()-1,0,1),u=new Date(n.getFullYear()-1,11,31);return this._getDateTimeTypeComparisonValueElement(t,l,u)}return""},e._userTypeCriteria=function(e,t,n,a){switch(a){case Ye.IsNull:return this._comparisonElement("IsNull",n,"");case Ye.Equals:default:var i=this._comparisonElement("Eq",n,'<Value Type="Integer"><UserID Type="Integer" /></Value>');return e===$e.CurrentUser?i:e===$e.SpecificUser&&t?et.isValidMeToken(t)?i:this._comparisonElement("Eq",n,'<Value Type="User">'.concat(t.toString(),"</Value>")):""}},e._criteriaElement=function(e,t,n,a){var i=a?this._encodeUserEntryForXML(n,a):n,r='<Value Type="'.concat(t.TypeAsString,'">').concat(i,"</Value>");if(t.FieldTypeKind===Ot.User&&et.isValidMeToken(i))r='<Value Type="Integer"><UserID Type="Integer" /></Value>';else if(t.FieldTypeKind===Ot.DateTime&&et.isValidTodayToken(i)){var o=i.substr("[today]".length)||"0",s=parseInt(o,0);r='<Value Type="DateTime"><Today OffsetDays="'.concat(s,'" /></Value>')}return this._comparisonElement(e,t.InternalName,r)},e._comparisonElement=function(e,t,n){return"<".concat(e,'><FieldRef Name="').concat(t,'"/>').concat(n,"</").concat(e,">")},e._includeElement=function(e,t,n){var a=this,i=t.map(function(t){return t?a._criteriaElement("Eq",e,t,n):'<IsNull><FieldRef Name="'.concat(e.InternalName,'"/></IsNull>')});return this._combineCriteria(i,"Or")},e._combineCriteria=function(e,t){if(!e||0===e.length)return"";for(var n="",a=1;a<e.length;a++)n+="<".concat(t,">");for(n+=e[0],a=1;a<e.length;a++)n+="".concat(e[a],"</").concat(t,">");return n},e._fieldTypeCriteria=function(e,t,n){var a=this;if(!e.fieldInfo&&!t)return"";var i=e.fieldInfo||t[e.fieldname];if(!i)return"";var r=this._parseListFieldValue(e.value,i.FieldTypeKind);if(""===r.trim()&&e.op!==Ye.Equals&&e.op!==Ye.NotEqual&&e.op!==Ye.Between)return"";var o="";switch(e.op){case Ye.BeginsWith:o=this._criteriaElement("BeginsWith",i,r,n);break;case Ye.Between:var s=this._parseListFieldValue(e.value2,i.FieldTypeKind);""!==r.trim()&&""!==s.trim()?o="<And>"+this._criteriaElement("Geq",i,r,n)+this._criteriaElement("Leq",i,s,n)+"</And>":""!==r.trim()?o=this._criteriaElement("Geq",i,r,n):""!==s.trim()&&(o=this._criteriaElement("Leq",i,s,n));break;case Ye.Contains:o=this._criteriaElement("Contains",i,r,n);break;case Ye.Equals:o=e.values&&e.values.length>0?this._includeElement(i,e.values.map(function(e){return a._parseListFieldValue(e,i.FieldTypeKind)}),n):this._criteriaElement("Eq",i,r,n);break;case Ye.GreaterThan:o=this._criteriaElement("Gt",i,r,n);break;case Ye.GreaterThanOrEqualTo:o=this._criteriaElement("Geq",i,r,n);break;case Ye.LessThan:o=this._criteriaElement("Lt",i,r,n);break;case Ye.LessThanOrEqualTo:o=this._criteriaElement("Leq",i,r,n);break;case Ye.NotEqual:o=this._criteriaElement("Neq",i,r,n)}return o},e._parseListFieldValue=function(e,t){var n="";if(void 0===e)return n;switch(t){case Ot.DateTime:if("string"==typeof e&&et.isValidTodayToken(e)){n=e.trim();break}var a=new Date(e.toString());"[object Date]"===Object.prototype.toString.call(a)&&(isNaN(a.getTime())||(n="".concat(a.toISOString())));break;case Ot.Number:case Ot.Currency:var i=parseFloat(e.toString());isNaN(i)||(n=i.toString());break;case Ot.Integer:case Ot.Counter:var r=parseInt(e.toString(),10);isNaN(r)||(n=r.toString());break;case Ot.User:case Ot.Text:default:n="".concat(e.toString().trim())}return this._encodeUserEntryForXML(n)},e._filterByLanguage=function(e,t,n){var a=e.contentTypes&&e.contentTypes.indexOf(qe.All)>-1,i=!1,r=!1;if(e.contentTypes&&!a)for(var o=0;o<e.contentTypes.length;++o)switch(e.contentTypes[o]){case qe.Page:i=!0;break;case qe.News:r=!0}if(e.languageCode&&(a||i||r)){var s=e.languageCode,c='<FieldRef Name="_SPTranslationLanguage" />',d='<Value Type="Choice">'.concat(s,"</Value>"),l="<Eq>".concat(c).concat(d,"</Eq>"),u='<Value Type="MultiChoice">'.concat(s,"</Value>"),f="<Neq>".concat('<FieldRef Name="_SPTranslatedLanguages" />').concat(u,"</Neq>"),p="<IsNull>".concat(c,"</IsNull>");t.push("<And><Or>".concat(l,"<And>").concat(f).concat(p,"</And></Or>")),n.push("</And>")}},e}(),Bt={List:1,Item:2,Field:3},jt=n("YkpB"),Vt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="List",t.title=jt.t,t._logSource=s._LogSource.create("ListDataProvider"),t}return Object(c.__extends)(t,e),t.prototype.getItems=function(e){var t=this;switch(e.requestType){case Bt.List:return this._listDataSource||(this._listDataSource=new It({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._listDataSource.getListsForWeb(this.baseEndPoint,St.generateQueryString(e));case Bt.Item:return this._listItemDataSource||(this._listItemDataSource=new Lt({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),e.viewId?(this._listViewDataSource||(this._listViewDataSource=new Mt({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._listViewDataSource.updateViewXml(this.baseEndPoint,e.id,e.viewId,e.caml).then(function(){return t._listItemDataSource.getItemsForList(t.baseEndPoint,e.id,e.title,e.isDefaultDocumentLibrary,e.renderOptions,void 0,void 0,void 0,void 0,e.audienceTarget,e.viewId)})):this._listItemDataSource.getItemsForList(this.baseEndPoint,e.id,e.title,e.isDefaultDocumentLibrary,e.renderOptions,e.caml,void 0,void 0,void 0,e.audienceTarget);case Bt.Field:return this._listFieldDataSource||(this._listFieldDataSource=new Ct({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._listFieldDataSource.getFieldsForList(this.baseEndPoint,e.id,St.generateQueryString(e));default:var n=new Error(jt.e);return s._TraceLogger.logError(this._logSource,n),Promise.reject(n)}},t.prototype.addView=function(e){return this._listViewDataSource||(this._listViewDataSource=new Mt({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._listViewDataSource.addView(this.baseEndPoint,e)},t}(o),zt=Vt,Gt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){for(var n=[],a=["aspx","html","htm"],i=0,r=e.rows;i<r.length;i++){var o=r[i],s=t._personaSettingsCache.getPerson(o.EditorOwsUser,o.ModifiedBy),c=a.indexOf(o.FileExtension)>-1?o.Path:l.SPUtility.getWebPathOfFile(o.DefaultEncodingURL?o.DefaultEncodingURL:o.Path),d=o.LastModifiedTimeForRetention,u=o.SitePath;u&&(u=u.split(";")[0]);var f=l.SPFormatDateTime.formatTimestampToDisplayDate(d,t._pageContext,{skeleton:"yMMMd"}),p=W.extend(o,{Name:s.name,Email:s.email,ProfileImageSrc:s.profileImageSrc,Initials:s.initials,InitialsColor:s.initials,WebPath:c,ModifiedDate:f,SitePath:u});p.SiteName&&(p.SiteName=encodeURI(p.SiteName)),n.push(p)}return new Promise(function(e,t){return e(n)})},t}return Object(c.__extends)(t,e),t.prototype._initVariables=function(){this._personaSettingsCache=new ht},t}(lt),Kt=Gt;function Wt(e){var t=new Date(e);return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]}function qt(e,t){return n="\n    <View>\n      <ViewFields>\n        ".concat(Pe()?'<FieldRef Name="BannerUrl" />':"",'\n        <FieldRef Name="Category" />\n        <FieldRef Name="EndDate" />\n        <FieldRef Name="EventDate" />\n        <FieldRef Name="ID" />\n        <FieldRef Name="Location" />\n        <FieldRef Name="Title" />\n        <FieldRef Name="fAllDayEvent" />\n        <FieldRef Name="_ModernAudienceTargetUserField" />\n      </ViewFields>\n      <Query>\n        <Where>\n          ').concat(function(e){return r._SPFlight.isEnabled(1634)?"\n      <And>\n        ".concat(e,'\n        <Neq>\n          <FieldRef Name="fRecurrence" />\n          <Value Type="Boolean">1</Value>\n        </Neq>\n      </And>\n    '):"\n      <And>\n        ".concat(e,'\n        <Eq>\n          <FieldRef Name="fRecurrence" />\n          <Value Type="Boolean">0</Value>\n        </Eq>\n      </And>\n    ')}(function(e,t){var n=function(e){return e.category?"\n      <Eq>\n        <FieldRef Name='Category' />\n        <Value Type='Choice'>".concat(u.HtmlEncoding.encodeText(e.category),"</Value>\n      </Eq>\n    "):""}(e),a=function(e,t){var n='\n      <Geq>\n        <FieldRef Name="EndDate" />\n        <Value IncludeTimeValue="True" Type="DateTime">\n          '.concat(e.startDate||"<Today />","\n        </Value>\n      </Geq>\n    "),a=e.endDate?'\n      <Lt>\n        <FieldRef Name="EventDate" />\n        <Value IncludeTimeValue="True" Type="DateTime">\n          '.concat(Wt(e.endDate),"\n        </Value>\n      </Lt>\n    "):"",i=e.startDate?Qt(e.startDate,t):"<Today />",r=e.endDate?Qt(Wt(e.endDate),t):"",o='\n        <Geq>\n          <FieldRef Name="EndDate" />\n          <Value IncludeTimeValue="True" Type="DateTime">\n            '.concat(i,"\n          </Value>\n        </Geq>\n      "),s=e.endDate?'\n      <Lt>\n        <FieldRef Name="EventDate" />\n        <Value IncludeTimeValue="True" Type="DateTime">\n          '.concat(r,"\n        </Value>\n      </Lt>\n    "):"",c='\n      <Neq>\n        <FieldRef Name="fAllDayEvent" />\n        <Value Type="Boolean">1</Value>\n      </Neq>\n    ';return a?"\n      <Or>\n        <And>\n          ".concat(c,"\n          <And>\n            ").concat(n,"\n            ").concat(a,'\n          </And>\n        </And>\n        <And>\n          <Eq>\n            <FieldRef Name="fAllDayEvent" />\n            <Value Type="Boolean">1</Value>\n          </Eq>\n          <And>\n            ').concat(o,"\n            ").concat(s,"\n          </And>\n        </And>\n      </Or>\n      "):"\n      <Or>\n        <And>\n          ".concat(c,"\n          ").concat(n,'\n        </And>\n        <And>\n          <Eq>\n            <FieldRef Name="fAllDayEvent" />\n            <Value Type="Boolean">1</Value>\n          </Eq>\n          ').concat(o,"\n        </And>\n      </Or>")}(e,t);return n?"\n      <And>\n        ".concat(a,"\n        ").concat(n,"\n      </And>\n    "):a}(e,t)),"\n        </Where>\n      </Query>\n      ").concat(function(e){return e.rowLimit?'<RowLimit Paged="FALSE">'.concat(e.rowLimit,"</RowLimit>"):""}(e),"\n    </View>\n  "),n.replace(/" \/>/g,'"/>').split(/(?:\r\n|\r|\n)/).map(function(e){return e.trim()}).join("");var n}function Qt(e,t){var n=new Date(e);return n.setMinutes(n.getMinutes()-t.offset),n.toISOString()}var Yt=n("Ycni"),Jt=function(){function e(){}return e.dateStringToUTCDate=function(t,n,a){if(e._allDayKillSwitch.isActivated())return new Date(t);var i=new Date(e.ensureISOTimestamp(t));if(!a)return i;var r=new Yt.SPDate({fullYear:i.getUTCFullYear(),month:i.getUTCMonth(),date:i.getUTCDate(),hours:i.getUTCHours(),minutes:i.getUTCMinutes(),seconds:i.getUTCSeconds(),milliseconds:i.getUTCMilliseconds()}),o=n?r.convertToUTC(n):r;return new Date(Date.UTC(o.fullYear,o.month,o.date,o.hours,o.minutes,o.seconds,o.milliseconds))},e.dateStringToLocalDate=function(t,n,a){var i=new Date(e.ensureISOTimestamp(t));if(!n)return i;var r=new Yt.SPDate({fullYear:i.getUTCFullYear(),month:i.getUTCMonth(),date:i.getUTCDate(),hours:i.getUTCHours(),minutes:i.getUTCMinutes(),seconds:i.getUTCSeconds(),milliseconds:i.getUTCMilliseconds()}),o=a?r:r.convertFromUTC(n);return new Date(o.fullYear,o.month,o.date,o.hours,o.minutes,o.seconds)},e.localToUtc=function(e,t){if(!t)return e;var n=new Yt.SPDate({fullYear:e.getFullYear(),date:e.getDate(),month:e.getMonth(),hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()}).convertToUTC(t);return new Date(Date.UTC(n.fullYear,n.month,n.date,n.hours,n.minutes,n.seconds))},e.ensureISOTimestamp=function(e){if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.?[0-9]*Z$/i.test(e))return e;if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.?[0-9]*$/i.test(e))return"".concat(e.substring(0,19),"Z");throw new Error("EventTimeZoneUtilities: date time string ".concat(e," is not supported"))},e.getUTCMilliseconds=function(e){return Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())},e._allDayKillSwitch=new l.KillSwitch("5a511229-1361-450b-a2ac-61bdf600d687"),e}(),Xt=n("fP0x"),Zt="7F759147-C861-4CD6-A11F-5AA3037D9634";function $t(e,t){return{FieldName:e,FieldValue:t}}function en(e){return"".concat(e<10?"0":"").concat(e)}function tn(e){return"".concat(e.getFullYear(),"-").concat(en(e.getMonth()+1),"-").concat(en(e.getDate()))+" ".concat(en(e.getHours()),":").concat(en(e.getMinutes()),":").concat(en(e.getSeconds()))}function nn(e,t,n){if(t){var a=r._SPKillSwitch.isActivated("ad3c840c-8bc3-447e-888d-8f1a0311b3dc")?"".concat(e.getFullYear(),"-").concat(en(e.getMonth()+1),"-").concat(en(e.getDate()),"T00:00:00.000Z"):"".concat(e.getFullYear(),"-").concat(en(e.getMonth()+1),"-").concat(en(e.getDate()),"T12:00:00.000Z");return Jt.dateStringToLocalDate(a,n,!1)}return e}function an(e,t,n,a){var i={formValues:[$t("Title",e.title),$t("Category",e.category?e.category instanceof Array?JSON.stringify(e.category):e.category:""),$t("Description",e.description),$t("Location",e.location),$t("EventDate",tn(nn(e.startTime,e.isAllDayEvent,n))),$t("EndDate",tn(nn(e.endTime,e.isAllDayEvent,n))),$t("fAllDayEvent",e.isAllDayEvent?"true":"false"),$t("Workspace",e.linkUrl?"".concat(e.linkUrl,", ").concat(e.linkName):""),$t("BannerUrl",e.bannerUrl),$t("ParticipantsPicker",JSON.stringify(t.map(function(e){return{Key:e}}))),$t("Geolocation",e.geolocation?"Point (".concat(e.geolocation.longitude," ").concat(e.geolocation.latitude,")"):"")],bNewDocumentUpdate:!1,checkInComment:null};return e.audiences&&i.formValues.push($t("_ModernAudienceTargetUserField",JSON.stringify(e.audiences.map(function(e){return{Key:e}})))),a&&i.formValues.push($t("BannerImageUrl",e.bannerImageUrl)),i}function rn(e){return e.status>=200&&e.status<300?204===e.status?Promise.resolve():e.json():e.json().then(function(t){throw ln(e.correlationId,e.status,t.error)})}function on(e){return e.status>=200&&e.status<300?Promise.resolve(!0):e.json().then(function(t){var n;if(400===e.status&&"string"==typeof(null===(n=t.error)||void 0===n?void 0:n.message)&&t.error.message.indexOf(Zt))return Promise.resolve(!1);throw ln(e.correlationId,e.status,t.error)})}function sn(e){var t=new oe._QosMonitor("EventDataProvider.GetBannerImageUrlField");return e.status>=200&&e.status<300?(t.writeSuccess(),Promise.resolve(!0)):e.json().then(function(n){var a=ln(e.correlationId,e.status,n.error);return t.writeUnexpectedFailure("Unexpected",void 0,Object(c.__assign)(Object(c.__assign)({},a),{name:"BannerImageUrlError"})),Promise.reject(!1)})}function cn(e){var t=e.value.filter(function(e){return 0!==e.ErrorCode});if(t.length>0)throw{correlationId:r.Guid.empty,httpStatus:200,code:t[0].ErrorCode.toString(),message:t[0].ErrorMessage};return e.value.filter(function(e){return"Id"===e.FieldName})[0].FieldValue}function dn(e){if(e)try{var t=new P._SPResourcePath(e).getQueryParameter("ar"),n=t?parseFloat(t):void 0;if(!n||isNaN(n)||!isFinite(n)||n<=0)return;return n}catch(e){return}}function ln(e,t,n){var a=n||{code:"UnknownErrorCode",message:Xt.t};return{correlationId:e,httpStatus:t,code:a.code,message:"string"==typeof a.message?a.message:a.message.value}}var un=function(){function e(t){var n=this;this.id="Event",this.title="EventDataProvider",this.extraData={},this.qosMonitorLabel="EventDataSource",this._eventToETag=new Map,this._fetchEventData=function(t){var a;return n._afterServiceScopeFinished().then(function(o){var s=o.pageContext,d=o.httpClient,l=r.UrlUtilities.removeEndSlash(s.web.absoluteUrl);a=n._getTimeZoneFromPageContext(s);var u=t.listId.toString(),f=n._buildQueryString(t),p="".concat(l,"/_api/web/Lists(guid'").concat(u,"')/RenderListDataAsStream?").concat(f),m=JSON.stringify({parameters:Object(c.__assign)({__metadata:{type:"SP.RenderListDataParameters"},DatesInUtc:!0,RenderOptions:3,ViewXml:qt(t,a),AudienceTarget:t.audienceTarget},!!t.cdnRewriteBannerUrl&&{ImageFieldsToTryRewriteToCdnUrls:"BannerUrl"})}),_={alias:e.aliasPrefix+n.id,id:t.webpartId,expirationDuration:6e5,cacheStrategy:i._CacheStrategy.CacheAndNetwork,extraProps:new Map([[v.useStalePropName,!0]])};return d.fetch(p,i.SPHttpClient.configurations.v1,{body:m,headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"},method:"POST"},_)})},this._parseSPHttpClientResponse=function(e,t,a){return n.extraData.correlationId="".concat(e.correlationId),n.extraData.responseStatus="".concat(e.status),n.extraData.message=e.statusMessage,n.extraData.cacheStatus="None",e.ok?204===e.status?Promise.resolve():e.json().then(function(e){return n._processRawData(e,t,a)}).catch(function(e){throw a.writeUnexpectedFailure("Unexpected",e),e}):e.json().then(function(t){var n=new Error(e.statusMessage);throw a.writeUnexpectedFailure("Unexpected",n),ln(e.correlationId,e.status,t.error)}).catch(function(e){throw e})},this._isRawData=function(e){return!!(e&&e.ListData&&e.ListData.Row instanceof Array)},this._processRawData=function(e,t,a){if(n._isRawData(e)){var i=e.ListData.Row.map(function(a){var i;return{id:a.ID,category:a.Category,title:n._htmlDecode(a.Title),description:void 0,startTime:Jt.dateStringToLocalDate(a.EventDate,t.timeZone,"1"===a["fAllDayEvent.value"]),endTime:Jt.dateStringToLocalDate(a.EndDate,t.timeZone,"1"===a["fAllDayEvent.value"]),allDay:"1"===a["fAllDayEvent.value"],location:n._htmlDecode(a.Location),attendees:void 0,containsAudiences:Boolean(null===(i=a._ModernAudienceTargetUserField)||void 0===i?void 0:i.length),prevPageQuery:n._constructPageQuery(e.ListData.PrevHref),nextPageQuery:n._constructPageQuery(e.ListData.NextHref),geolocation:void 0,linkUrl:"",linkName:"",bannerUrl:Pe()?String(a.BannerUrl):void 0,webName:"",webUrl:""}});return null==a||a.writeSuccess(n.extraData),i}throw new Error(Xt.e)},this._isEmptyResponse=function(e){return!(null==e?void 0:e.length)},this.options=t,this._serviceScope=t.serviceScope}return e.prototype.requestData=function(e){return e.listId?e.startDate&&e.endDate&&new Date(e.startDate)>new Date(e.endDate)?Promise.resolve([]):r._SPFlight.isEnabled(60402)||1===oe._SPPerfExperiment.getVariantAndTrackExperiment(oe._PerformanceExperiment.WEXMySiteCacheTCExpEvents)?this.executeRequest(e):this.executeRequest_legacy(e):Promise.resolve([])},e.prototype.executeRequest=function(e){var t,n=this;return this._afterServiceScopeFinished().then(function(a){var i=a.pageContext;t=t=n._getTimeZoneFromPageContext(i),e.timeZone=t;var r={parseHttpClientResponse:n._parseSPHttpClientResponse,isEmptyResponse:n._isEmptyResponse,isRawData:n._isRawData,processRawData:n._processRawData,qosMonitorLabel:n.qosMonitorLabel,onServerResponseResolvedWithCache:e.onServerResponseResolvedWithCache,onServerResponseResolved:e.onServerResponseResolved,onServerResponseFailed:e.onServerResponseFailed,onCacheResponseResolved:e.onCacheResponseResolved,onCacheResponseFailed:e.onCacheResponseFailed};return v.executeCacheStrategy(r,n._fetchEventData,e)})},e.prototype.executeRequest_legacy=function(e){var t,n=this;return this._afterServiceScopeFinished().then(function(a){var o=a.pageContext,s=a.httpClient,d=r.UrlUtilities.removeEndSlash(o.web.absoluteUrl);t=n._getTimeZoneFromPageContext(o);var l=e.listId.toString(),u=n._buildQueryString(e),f="".concat(d,"/_api/web/Lists(guid'").concat(l,"')/RenderListDataAsStream?").concat(u),p=JSON.stringify({parameters:Object(c.__assign)({__metadata:{type:"SP.RenderListDataParameters"},DatesInUtc:!0,RenderOptions:3,ViewXml:qt(e,t),AudienceTarget:e.audienceTarget},!!e.cdnRewriteBannerUrl&&{ImageFieldsToTryRewriteToCdnUrls:"BannerUrl"})});return s.post(f,i.SPHttpClient.configurations.v1,{body:p,headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"}})}).then(rn).then(function(e){if(e&&e.ListData&&e.ListData.Row instanceof Array)return e.ListData.Row.map(function(a){var i;return{id:a.ID,category:a.Category,title:n._htmlDecode(a.Title),description:void 0,startTime:Jt.dateStringToLocalDate(a.EventDate,t,"1"===a["fAllDayEvent.value"]),endTime:Jt.dateStringToLocalDate(a.EndDate,t,"1"===a["fAllDayEvent.value"]),allDay:"1"===a["fAllDayEvent.value"],location:n._htmlDecode(a.Location),attendees:void 0,containsAudiences:(null===(i=a._ModernAudienceTargetUserField)||void 0===i?void 0:i.length)>0,prevPageQuery:n._constructPageQuery(e.ListData.PrevHref),nextPageQuery:n._constructPageQuery(e.ListData.NextHref),geolocation:void 0,linkUrl:"",linkName:"",bannerUrl:Pe()?String(a.BannerUrl):void 0,bannerImageAspectRatio:D()?void 0:dn(String(a.BannerUrl)),webName:"",webUrl:""}});throw new Error(Xt.e)})},e.prototype.requestEventItem=function(e,t){return this._requestEventItem(e,t,!1)},e.prototype.requestUTCEventItem=function(e,t,n){return this._requestEventItem(t,n,!0,e)},e.prototype.updateEventItem=function(e,t,n){var a,o=this;return this._afterServiceScopeFinished().then(function(s){var c=s.pageContext,d=s.httpClient,l=r.UrlUtilities.removeEndSlash(c.web.absoluteUrl);a="".concat(l,"/_api/web/Lists(guid'").concat(e.toString(),"')/items('").concat(t,"')/ValidateUpdateListItem()");var u={"If-Match":o._eventToETag.get(a),"Content-Type":"application/json;charset=utf-8"};return o._getEventPeopleIds(n.attendees).then(function(t){return o._getBannerImageUrlEnabledPromise(e,l).then(function(e){var r=JSON.stringify(an(n,t.map(function(e){return e.UserPrincipalName||e.LoginName}),o._getTimeZoneFromPageContext(c),e));return d.post(a,i.SPHttpClient.configurations.v1,{headers:u,body:r})})})}).then(function(e){return rn(e).then(function(){return e})}).then(function(e){o._eventToETag.set(a,e.headers.get("ETag"))})},e.prototype.deleteEventItem=function(e,t){var n,a=this;return this._afterServiceScopeFinished().then(function(o){var s=o.pageContext,c=o.httpClient,d=r.UrlUtilities.removeEndSlash(s.web.absoluteUrl),l="".concat(d,"/_api/web/Lists(guid'").concat(e.toString(),"')/items(").concat(t,")"),u="".concat(l,"/recycle");n=C()?l:u;var f={"If-Match":a._eventToETag.get(n)},p=C()?"DELETE":"POST";return c.fetch(n,i.SPHttpClient.configurations.v1,{headers:f,method:p})}).then(rn).then(function(){a._eventToETag.delete(n)}).catch(function(e){if("-2130575234, Microsoft.SharePoint.SPException"!==e.code)throw e;oe._EngagementLogger.logEvent("EventDataProvider.DeleteEventItemFailure.HasSkypeLink")})},e.prototype.createEventItem=function(e,t){var n=this;return this._afterServiceScopeFinished().then(function(a){var o=a.pageContext,s=a.httpClient,c=r.UrlUtilities.removeEndSlash(o.web.absoluteUrl),d="".concat(c,"/_api/web/Lists(guid'").concat(e.toString(),"')/AddValidateUpdateItemUsingPath()"),l={Accept:"application/json","Content-Type":"application/json;charset=utf-8"};return n._getEventPeopleIds(t.attendees).then(function(a){return n._getBannerImageUrlEnabledPromise(e,c).then(function(e){var r=JSON.stringify(an(t,a.map(function(e){return e.UserPrincipalName||e.LoginName}),n._getTimeZoneFromPageContext(o),e));return s.post(d,i.SPHttpClient.configurations.v1,{headers:l,body:r})})})}).then(rn).then(cn).then(function(t){return n.requestEventItem(e,t)})},e.prototype.getAllCategories=function(e){return Promise.all([this.getInUsedCategories(e),this.getPreDefinedCategories(e)]).then(function(e){var t=e[0],n=e[1];return Object(W.uniq)(Object(c.__spreadArray)(Object(c.__spreadArray)([],t,!0),n.categories,!0)).sort()})},e.prototype.getPreDefinedCategories=function(e){return this._afterServiceScopeFinished().then(function(t){var n=t.pageContext,a=t.httpClient,o=r.UrlUtilities.removeEndSlash(n.web.absoluteUrl),s="".concat(o,"/_api/web/Lists(guid'").concat(e.toString(),"')/fields/GetByInternalNameOrTitle('Category')");return a.get(s,i.SPHttpClient.configurations.v1).then(rn).then(function(e){return{categories:Object(c.__spreadArray)([],e.Choices,!0),type:e.TypeAsString}})})},e.prototype.getInUsedCategories=function(e){var t=this;return this._afterServiceScopeFinished().then(function(n){var a=n.pageContext,i=n.httpClient,o=r.UrlUtilities.removeEndSlash(a.web.absoluteUrl);return t._getViewId(o,e.toString(),i).then(function(n){return t._getCategoriesFromView(o,e.toString(),i,n)})})},e.prototype.convertDisplayedDateToUTC=function(e){var t=this;return this._afterServiceScopeFinished().then(function(n){var a=n.pageContext;return Jt.localToUtc(e,t._getTimeZoneFromPageContext(a))})},e.prototype.getAudienceTargetEnabledFlag=function(e){return this._afterServiceScopeFinished().then(function(t){var n=t.pageContext,a=t.httpClient,o=r.UrlUtilities.removeEndSlash(n.web.absoluteUrl),s="".concat(o,"/_api/web/Lists(guid'").concat(e.toString(),"')/Fields(guid'").concat(Zt,"')");return a.get(s,i.SPHttpClient.configurations.v1,{headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}})}).then(on)},e.prototype._getBannerImageUrlEnabledPromise=function(e,t){return Te()?this._afterServiceScopeFinished().then(function(n){var a=n.pageContext,o=n.httpClient;t=t||r.UrlUtilities.removeEndSlash(a.web.absoluteUrl);var s="".concat(t,"/_api/web/Lists(guid'").concat(e.toString(),"')/Fields(guid'").concat("8A4BE162-151D-4A11-b9BE-E7DC05196D73","')");return o.get(s,i.SPHttpClient.configurations.v1,{headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}})}).then(sn).catch(function(){return!1}):Promise.resolve(!1)},e.prototype._getViewId=function(e,t,n){var a="".concat(e,"/_api/web/Lists/GetById('").concat(t,"')/Views?$select=Id&$filter=BaseViewId eq '1'");return n.get(a,i.SPHttpClient.configurations.v1).then(rn).then(function(e){return e.value&&e.value.length>0?e.value[0].Id:Promise.reject(new Error("No view is found."))})},e.prototype._getCategoriesFromView=function(e,t,n,a){var r=this,o="".concat(e,"/_api/web/Lists/GetById('").concat(t,"')/RenderListFilterData")+"?FieldInternalName='Category'&ViewId='".concat(a,"'");return n.post(o,i.SPHttpClient.configurations.v1,{}).then(function(e){if(e.ok)return e.text();throw new Error(JSON.stringify(e))}).then(function(e){var t=new RegExp('Value="([^"]*)',"g"),n=e.match(t).map(function(e){return e.replace(t,"$1")}).map(r._htmlDecode);return Object(W.uniq)(n)})},e.prototype._mapRESTResponseEvent=function(e,t,n){var i=this;return void 0===n&&(n=!1),this._getEventAttachments(e).then(function(r){return{id:e.ID.toString(),category:e.Category,title:e.Title,description:e.Description,startTime:n?Jt.dateStringToUTCDate(e.EventDate,t,e.fAllDayEvent):Jt.dateStringToLocalDate(e.EventDate,t,e.fAllDayEvent),endTime:n?Jt.dateStringToUTCDate(e.EndDate,t,e.fAllDayEvent):Jt.dateStringToLocalDate(e.EndDate,t,e.fAllDayEvent),location:e.Location,attendees:i._mapRESTResponsePeople(e.ParticipantsPicker),audiences:i._mapRESTResponseAudience(e.OData__ModernAudienceTargetUserField,e["OData__ModernAudienceTargetUserField@odata.navigationLink"]),bannerUrl:e.BannerUrl?e.BannerUrl.Url:"",attachments:r,linkName:e.Workspace?e.Workspace.Description:"",linkUrl:e.Workspace?e.Workspace.Url:"",isAllDayEvent:e.fAllDayEvent,geolocation:e.Geolocation?{latitude:e.Geolocation.Latitude,longitude:e.Geolocation.Longitude}:void 0,permission:new a.SPPermission(e.EffectiveBasePermissions),isRecurrence:e.fRecurrence,prevPageQuery:void 0,nextPageQuery:void 0,webName:"",webUrl:""}})},e.prototype._getEventAttachments=function(e){var t=this;return this._afterServiceScopeFinished().then(function(n){var a=n.pageContext,o=n.httpClient,s=r.UrlUtilities.removeEndSlash(a.web.absoluteUrl);if(e.Attachments){var c=o.beginBatch(),d=e.AttachmentFiles.map(function(e){return e.ServerRelativeUrl}).map(function(e){var t="".concat(s,"/_api/web/getFileByUrl('").concat(e,"')");return c.get(t,i.SPHttpClientBatch.configurations.v1,{headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(function(e){return rn(e)})});return c.execute().then(function(){return Promise.all(d)}).then(t._mapRESTAttachments)}return Promise.resolve([])})},e.prototype._constructEventPayload=function(e,t,n){return this._getEventPeopleIds(e.attendees).then(function(e){return e.map(function(e){return e.Id})}).then(function(a){var i={Title:e.title,Category:e.category?e.category:null,Description:e.description,Location:e.location,EventDate:Jt.localToUtc(e.startTime,t).toISOString(),EndDate:Jt.localToUtc(e.endTime,t).toISOString(),fAllDayEvent:e.isAllDayEvent,Workspace:e.linkUrl?{Description:e.linkName,Url:e.linkUrl}:null,BannerUrl:e.bannerUrl?{Url:e.bannerUrl}:null,ParticipantsPickerId:a,Geolocation:e.geolocation?{Latitude:e.geolocation.latitude,Longitude:e.geolocation.longitude}:null,fRecurrence:e.isRecurrence};return n&&(i.BannerImageUrl=e.bannerImageUrl),i})},e.prototype._getEventPeopleIds=function(e){return(null==e?void 0:e.length)?this._afterServiceScopeFinished().then(function(t){var n=t.pageContext,a=t.httpClient,o=r.UrlUtilities.removeEndSlash(n.web.absoluteUrl),s=a.beginBatch(),c=e.map(function(e){var t="".concat(o,"/_api/web/ensureUser(@user)?@user='").concat(encodeURIComponent(e.id),"'");return s.get(t,i.SPHttpClientBatch.configurations.v1).then(rn).then(function(e){return e})});return s.execute().then(function(){return Promise.all(c)})}):Promise.resolve([])},e.prototype._requestEventItem=function(e,t,n,a){var o,s,c=this;return void 0===n&&(n=!1),this._afterServiceScopeFinished().then(function(n){var d=n.pageContext,l=n.httpClient;s=c._getTimeZoneFromPageContext(d),a=a||r.UrlUtilities.removeEndSlash(d.web.absoluteUrl);var f=["Attachments","BannerUrl","Category","Description","EffectiveBasePermissions","EndDate","EventDate","fAllDayEvent","ID","Location","ParticipantsPicker/Name","ParticipantsPicker/Title","Title","Workspace","fRecurrence","Geolocation"],p=["AttachmentFiles","ParticipantsPicker"];o="".concat(a,"/_api/web/Lists(guid'").concat(e.toString(),"')/items(").concat(t,")");var m={Accept:"application/json","Content-Type":"application/json;charset=utf-8"},_=c.getAudienceTargetEnabledFlag(e),h=new u.Uri(a),b=new u.Uri(d.web.absoluteUrl),g=h.getScheme()+"://"+h.getHost();return(g===b.getScheme()+"://"+b.getHost()?Promise.resolve():i._AadTokenProviders.configurable._getTokenInternal(g,i._AadTokenProviders.preAuthorizedConfiguration).then(function(e){return m.Authorization="Bearer ".concat(e),Promise.resolve()},function(){return Promise.resolve()})).then(function(){return _}).then(function(e){return e&&(f.push("OData__ModernAudienceTargetUserField/Name"),p.push("OData__ModernAudienceTargetUserField")),Promise.resolve(!0)},function(){return Promise.resolve(!0)}).then(function(){var e="$select=".concat(f.join(","),"&$expand=").concat(p.join(",")),t="".concat(o,"/?").concat(e);return l.get(t,i.SPHttpClient.configurations.v1,{headers:m})})}).then(rn).then(function(e){return c._eventToETag.set(o,e["@odata.etag"]),c._mapRESTResponseEvent(e,s,n)})},e.prototype._afterServiceScopeFinished=function(){var e=this;return new Promise(function(t){e._serviceScope.whenFinished(function(){t({pageContext:e._serviceScope.consume(a.PageContext.serviceKey),httpClient:e._serviceScope.consume(i.SPHttpClient.serviceKey)})})})},e.prototype._buildQueryString=function(e){if(e.pageQuery)return e.pageQuery;var t=[];return e.orderBy&&t.push(["SortField",e.orderBy.field],["SortDir",e.orderBy.direction]),t.map(function(e){return e.join("=")}).join("&")},e.prototype._mapRESTResponsePeople=function(e){return e?e.map(function(e){return{id:e.Name,name:e.Title}}):[]},e.prototype._mapRESTResponseAudience=function(e,t){return e?e.map(function(e){return function(e){var t;return(null===(t=e.Name)||void 0===t?void 0:t.length)>=36?e.Name.substr(e.Name.length-36):""}(e)}):t?[]:void 0},e.prototype._mapRESTAttachments=function(e){return e?e.map(function(e){return{fileName:e.Name,fileSize:e.Length,filePreviewUrl:e.LinkingUri,fileRelativeUrl:e.ServerRelativeUrl}}):[]},e.prototype._constructPageQuery=function(e){return e?e.substr(1).replace("&View=00000000-0000-0000-0000-000000000000",""):""},e.prototype._getTimeZoneFromPageContext=function(e){return e.user.preferUserTimeZone?e.user.timeZoneInfo:e.web.timeZoneInfo},e.prototype._htmlDecode=function(e){return e?(new DOMParser).parseFromString(e,"text/html").body.innerText:e},e.aliasPrefix="FirstParty_EventsWebPart_",Object(c.__decorate)([Object(l.monitor)("EventDataProvider.RequestData")],e.prototype,"requestData",null),Object(c.__decorate)([Object(l.monitor)("EventDataProvider.UpdateEventItem")],e.prototype,"updateEventItem",null),Object(c.__decorate)([Object(l.monitor)("EventDataProvider.DeleteEventItem")],e.prototype,"deleteEventItem",null),Object(c.__decorate)([Object(l.monitor)("EventDataProvider.CreateEventItem")],e.prototype,"createEventItem",null),Object(c.__decorate)([Object(l.monitor)("EventDataProvider.GetPreDefinedCategories")],e.prototype,"getPreDefinedCategories",null),Object(c.__decorate)([Object(l.monitor)("EventDataProvider.GetInUsedCategories")],e.prototype,"getInUsedCategories",null),Object(c.__decorate)([Object(l.monitor)("EventDataProvider.GetAudienceTargetEnabledFlag")],e.prototype,"getAudienceTargetEnabledFlag",null),Object(c.__decorate)([Object(l.monitor)("EventDataProvider.GetEventAttachments")],e.prototype,"_getEventAttachments",null),Object(c.__decorate)([Object(l.monitor)("EventDataProvider.GetEventPeopleIds")],e.prototype,"_getEventPeopleIds",null),Object(c.__decorate)([Object(l.monitor)("EventDataProvider.RequestEventItem")],e.prototype,"_requestEventItem",null),e}(),fn='EventsRollUpEndDate >="',pn='EventsRollUpStartDate<"',mn='"',_n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){var n=t._pageContext.user.preferUserTimeZone?t._pageContext.user.timeZoneInfo:t._pageContext.web.timeZoneInfo,a=e.rows.map(function(e){var t,a="true"===e.IsAllDayEvent,i=Jt.dateStringToLocalDate(e.EventsRollUpStartDate.toString(),n,a),r=Jt.dateStringToLocalDate(e.EventsRollUpEndDate.toString(),n,a),o="";return Pe()&&(e.PictureThumbnailURL?o=e.PictureThumbnailURL:e.BannerUrlOWSURLH&&(o=e.BannerUrlOWSURLH.split(",")[0])),{endTime:r,isAllDayEvent:a,startTime:i,id:e.ListItemID,attendees:void 0,audiences:void 0,bannerUrl:o,bannerImageAspectRatio:D()?void 0:dn(String(null===(t=e.BannerUrlOWSURLH)||void 0===t?void 0:t.split(",")[0])),category:e.EventsRollUpCategory?e.EventsRollUpCategory.toString():"",description:void 0,geolocation:void 0,linkName:void 0,linkUrl:void 0,listId:e.ListID,location:e.Location?e.Location.toString():"",nextPageQuery:void 0,prevPageQuery:void 0,title:e.Title,webName:e.SiteTitle?e.SiteTitle:"",webUrl:e.SPWebUrl?e.SPWebUrl.toString():"",containsAudiences:Boolean(e.ModernAudienceAadObjectIds)}});return Promise.resolve(a)},t._filterSearchResults=function(e,n){if(void 0!==e&&e.length>0&&n){var a=t._regexMatchQuery(n,fn,mn);if(a){var i=t._regexMatchQuery(n,pn,mn);if(i){var r=t._pageContext.user.preferUserTimeZone?t._pageContext.user.timeZoneInfo:t._pageContext.web.timeZoneInfo,o=Jt.dateStringToLocalDate(a,r,!1),s=Jt.dateStringToLocalDate(i,r,!1),c=Jt.getUTCMilliseconds(o),d=Jt.getUTCMilliseconds(s),l=e.filter(function(e){var t=Jt.getUTCMilliseconds(e.startTime),n=Jt.getUTCMilliseconds(e.endTime);return!e.isAllDayEvent||t>=c&&n<d});return Promise.resolve(l)}}}return Promise.resolve(e)},t._regexMatchQuery=function(e,t,n){var a,i=null===(a=null==e?void 0:e.QueryTemplate)||void 0===a?void 0:a.match(t+"(.*?)"+n);return i?i[1]:""},t}return Object(c.__extends)(t,e),Object.defineProperty(t,"selectProperties",{get:function(){var e=["EventsRollUpCategory","EventsRollUpEndDate","EventsRollUpStartDate","IsAllDayEvent","ListID","ListItemID","Location","SiteTitle","SPWebUrl","Title"];return Pe()&&Te()&&(e.push("BannerUrlOWSURLH"),e.push("PictureThumbnailURL")),e},enumerable:!1,configurable:!0}),t.prototype.requestData=function(t){var n=this;return r._SPKillSwitch.isActivated("dffb2f88-0ca6-4e97-b318-a4bc1e3822c2")?e.prototype.requestData.call(this,t):e.prototype.requestData.call(this,t).then(function(e){return n._filterSearchResults(e,t.searchAPIQueryOptions)})},t}(lt),hn=[-2130575322,-2147024891],bn=function(){function e(e){this._serviceScope=e}return e.prototype.getEventsLists=function(){var e=this;return this._afterServiceScopeFinished().then(function(t){var n=t.pageContext,a=t.httpClient,r=n.web.absoluteUrl,o="".concat(r,"/_api/web/Lists?$filter=BaseTemplate eq 106&$select=Id,Title");return a.get(o,i.SPHttpClient.configurations.v1).then(e._parseResponse).then(function(e){return e.value})})},e.prototype.ensureEventsList=function(){var e=this;return this._afterServiceScopeFinished().then(function(t){var n=t.pageContext,a=t.httpClient,r=n.web.absoluteUrl,o="".concat(r,"/_api/Lists/EnsureEventsList?$select=Title,Id");return a.post(o,i.SPHttpClient.configurations.v1,{}).then(e._parseResponse)})},e.prototype.getEventsListPermission=function(e){var t=this;return e?this._afterServiceScopeFinished().then(function(n){var r=n.pageContext,o=n.httpClient,s=r.web.absoluteUrl,c="".concat(s,"/_api/web/Lists(guid'").concat(e,"')/EffectiveBasePermissions");return o.get(c,i.SPHttpClient.configurations.v1).then(t._parseResponse).then(function(e){return new a.SPPermission(e)}).catch(function(e){return hn.forEach(function(t){if(-1!==e.code.indexOf(String(t)))throw new l.ExpectedFailure("SPErrorCode_".concat(e.code),e.message,{correlationId:e.correlationId?e.correlationId.toString():void 0})}),Promise.reject(e)})}):Promise.resolve(void 0)},e.prototype._afterServiceScopeFinished=function(){var e=this;return new Promise(function(t){e._serviceScope.whenFinished(function(){t({pageContext:e._serviceScope.consume(a.PageContext.serviceKey),httpClient:e._serviceScope.consume(i.SPHttpClient.serviceKey)})})})},e.prototype._parseResponse=function(e){return e.status>=200&&e.status<300?204===e.status?Promise.resolve():e.json():e.json().then(function(t){var n=t.error||{code:"UnknownErrorCode",message:Xt.t};throw{correlationId:e.correlationId,httpStatus:e.status,code:n.code,message:"string"==typeof n.message?n.message:n.message.value}})},Object(c.__decorate)([Object(l.monitor)("EventDataProvider.GetEventsLists")],e.prototype,"getEventsLists",null),Object(c.__decorate)([Object(l.monitor)("EventDataProvider.EnsureEventsList")],e.prototype,"ensureEventsList",null),Object(c.__decorate)([Object(l.monitor)("EventDataProvider.GetEventsListPermission")],e.prototype,"getEventsListPermission",null),e}(),gn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getPageJsonBlob=function(e,t,n){return this.get(e,"_api/sitepages/pages/GetByUrl('".concat(u.UriEncoding.encodeRestUriStringToken(t),"')"),n,"PageDataSource","getPageJsonBlob").then(function(e){return[e]})},t.prototype.getPageCanvasContent=function(e){return this.get("/",e,"asjson=1","PageDataSource","getPageCanvasContent").then(function(e){return e.page.Content.CanvasContent1})},t}(yt),vn=gn,yn=n("QRxg"),Sn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="Page",t.title=yn.e,t}return Object(c.__extends)(t,e),t.prototype.getItems=function(e){return this._pageDataSource||(this._pageDataSource=new vn({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._pageDataSource.getPageCanvasContent(e.pageRelativeUrl).then(function(e){return[e]})},t}(o),Dn=Sn;function In(e){var t=e.pageRelativeUrl,n=e.webPartInstanceId,a=e.componentName,i=e.webPartAlias,r=e.defaultWebPartData,o=e.serviceScope,s=e.processWebPartDataCallback,c=new oe._QosMonitor("".concat(a,".ParseWebPartDataFromPage"));return new Dn({serviceScope:o}).requestData({pageRelativeUrl:t}).then(function(e){var t=null==e?void 0:e[0],n=t.CanvasJson1||t;return n||function(e,t){var n=new Error("StockContent");throw e.writeExpectedFailure(n.message,n,xn(t)),n}(c,i),JSON.parse(n)}).then(function(e){return function(e,t){if(t)for(var n=0,a=t;n<a.length;n++){var i=a[n];if(i.id===e)return i}}(n,e)}).then(function(e){var t;if(e&&(t=e.webPartData),!t){var a=new Error("NoInstanceDataFound");throw c.writeUnexpectedFailure(a.message,a,xn(i)),a}return t.instanceId=n,s&&(t=s(t)),c.writeSuccess(xn(i)),t}).catch(function(e){return c.hasEnded||c.writeUnexpectedFailure("FailedToParse",e,xn(i)),oe._EngagementLogger.logEvent("".concat(a,".LoadDefaultWebPartData")),r}).then(function(e){return e})}function xn(e){return{webpart:e}}var Cn,On=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getPages=function(e){var t=new s._QosMonitor("TemplatePanelDataSource.getPages");return this.get(e,"_api/sitepages/pages/templates","asjson=1","TemplatePanelDataSource","getPages").then(function(e){return t.writeSuccess(),[e]}).catch(function(e){return 404===e.status?t.writeExpectedFailure("TemplatePanelError",Error(e.statusMessage||"getPage returned 404"),{correlationId:e.correlationId,status:e.status}):t.writeUnexpectedFailure("TemplatePanelError",Error(e.statusMessage||"Failed to getPage"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t}(yt),wn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getPage=function(e,t){var n=new s._QosMonitor("TemplateSelectedPageCopyDataSource.getPage");return this.get(e,"_api/sitepages/pages(".concat(t,")"),"$select=CanvasContent1,LayoutWebpartsContent","TemplateCopyDataSource","getPage").then(function(e){return n.writeSuccess(),[e]}).catch(function(e){return n.writeUnexpectedFailure("TemplateSelectedPageCopyError",Error(e.statusMessage||"Failed to getPage"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t}(yt),En=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getPage=function(e){var t=new s._QosMonitor("TemplateSelectedPageAsJsonDataSource.getPage");return this.get(e,"","as=json","TemplateSelectedPageAsJsonDataSource","getPage").then(function(e){return t.writeSuccess(),[e]}).catch(function(e){return t.writeUnexpectedFailure("TemplateSelectedPageAsJsonError",Error(e.statusMessage||"Failed to getPage"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t}(yt),An=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.getDefaultNewPageTemplateId=function(e){var n="GetDefaultNewPageTemplateId",a=new s._QosMonitor(t._dataSourceName+"."+n);return this.get(e,"_api/web/DefaultNewPageTemplateId","",t._dataSourceName,n,this._headers).then(function(e){var t=e.value;return a.writeSuccess(),t}).catch(function(e){return a.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to get DefaultNewPageTemplateId"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t.prototype.setDefaultNewPageTemplateId=function(e,n){var a="SetDefaultNewPageTemplateId",i=new s._QosMonitor(t._dataSourceName+"."+a,!1,!0);return this.post(e,"_api/web/SetDefaultNewPageTemplateId","",JSON.stringify({defaultNewPageTemplateId:n}),t._dataSourceName,a,this._headers,!0,!0).then(function(){return i.writeSuccess(),!0}).catch(function(e){return i.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to set DefaultNewPageTemplateId"),{correlationId:e.correlationId,status:e.status}),!1})},Object.defineProperty(t.prototype,"_headers",{get:function(){var e=new Headers;return e.append("Content-Type","application/json; odata=verbose"),e.append("Accept","application/json; odata.metadata=minimal"),e},enumerable:!1,configurable:!0}),t._dataSourceName="DefaultNewPageTemplateIdDataSource",t._errorTag="DefaultNewPageTemplateIdError",t}(yt),Ln=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.deleteTemplatePage=function(e,n){var a="deleteTemplatePage",i=new s._QosMonitor(t._dataSourceName+"."+a),r="".concat(t._apiRelativePath,"('").concat(n,"')");return this.post(e,"".concat(r,"/recycle()"),"","",t._dataSourceName,a,this._headers,!0,!0).then(function(){return i.writeSuccess(),!0}).catch(function(e){return i.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to delete template page"),{correlationId:e.correlationId,status:e.status}),!1})},Object.defineProperty(t.prototype,"_headers",{get:function(){var e=new Headers;return e.append("Content-Type","application/json; odata=verbose"),e.append("Accept","application/json; odata.metadata=minimal"),e.append("IF-MATCH","*"),e},enumerable:!1,configurable:!0}),t._apiRelativePath="_api/web/GetFileByServerRelativeUrl",t._dataSourceName="DeleteTemplatePageDataSource",t._errorTag="DeleteTemplatePageError",t}(yt),kn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="PageTemplates",t.title="Template Data Provider",t}return Object(c.__extends)(t,e),t.prototype.getItems=function(e){return this._templatePanelDataSource||(this._templatePanelDataSource=new On({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._templatePanelDataSource.getPages(e.webAbsoluteUrl)},t}(o),Mn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="PageTemplatesCopy",t.title="Template Copy Data Provider",t}return Object(c.__extends)(t,e),t.prototype.getItems=function(e){return this._templateSelectedPageCopyDataSource||(this._templateSelectedPageCopyDataSource=new wn({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._templateSelectedPageCopyDataSource.getPage(e.webAbsoluteUrl,e.page.Id)},t}(o),Pn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="PageTemplatesAsJson",t.title="Template As Json Data Provider",t}return Object(c.__extends)(t,e),t.prototype.getItems=function(e){return this._templateSelectedPageAsJsonDataSource||(this._templateSelectedPageAsJsonDataSource=new En({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._templateSelectedPageAsJsonDataSource.getPage(e.page.AbsoluteUrl)},t}(o),Tn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="DefaultNewPageTemplateId",t.title="Default New Page Template Id Data Provider",t.getItems=function(){return Promise.resolve([])},t}return Object(c.__extends)(t,e),t.prototype.getDefaultNewPageTemplateId=function(e){return this._ensureDefaultNewPageTemplateIdDataSourceAsync().then(function(t){return t.getDefaultNewPageTemplateId(e.RequestingWebUrl)})},t.prototype.setDefaultNewPageTemplateId=function(e){return this._ensureDefaultNewPageTemplateIdDataSourceAsync().then(function(t){return t.setDefaultNewPageTemplateId(e.RequestingWebUrl,e.DefaultNewPageTemplateId)})},t.prototype._ensureDefaultNewPageTemplateIdDataSourceAsync=function(){var e=this;return this._defaultNewPageTemplateIdDataSourcePromise||(this._defaultNewPageTemplateIdDataSourcePromise=this.resolveServices().then(function(){return new An({spHttpClient:e.spHttpClient,pageContext:e.pageContext})})),this._defaultNewPageTemplateIdDataSourcePromise},t}(o),Un=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="DeleteTemplatePage",t.title="Delete Template Page Data Provider",t.getItems=function(){return Promise.resolve([])},t}return Object(c.__extends)(t,e),t.prototype.deleteTemplatePage=function(e){var t=this;return this._defaultDeleteTemplatePageDataSourcePromise||(this._defaultDeleteTemplatePageDataSourcePromise=this.resolveServices().then(function(){return new Ln({spHttpClient:t.spHttpClient,pageContext:t.pageContext})})),this._defaultDeleteTemplatePageDataSourcePromise.then(function(t){return t.deleteTemplatePage(e.RequestingWebUrl,e.RelativePageUrl)})},t}(o),Fn=function(){function e(e){this.id="RecentDocuments",this.title="Recent documents",this._pageContext=e}return e.prototype.requestData=function(e){var t=this,n=new oe._QosMonitor("RecentDocumentsDataProvider.getRecentDocuments");return e.authToken.then(function(n){return fetch(t._getApiUrl(e),t._getHttpConfig(n))}).then(function(e){return n.writeSuccess(),e.json()}).catch(function(e){n.writeUnexpectedFailure("Unexpected",e)}).then(function(e){return e&&e.documents&&e.documents.items?e.documents.items.map(function(e){var t=new Date(e.time_stamp),n=e.url.substring(0,e.url.lastIndexOf("/")),a="OneNote"===e.app?"one":e.extension,i=new u.Uri(e.url);return i.setQueryParameter("web","1"),{fileName:e.title,fileUrl:i.toString(),filePathSegments:e.display_path,filePathUrl:n,fileType:e.app,fileExtension:a,lastAccessedRelative:t}}):[]})},e.prototype._getApiUrl=function(e){var t=this._pageContext.legacyPageContext.msMruEndpointUrl,n="apps=Word,Excel,PowerPoint,Visio,OneNote,Sway,PdfViewer&show=".concat(e.numDocsToRequest||50,"&sort=Date");return"".concat(t).concat("/ocs/v2/recent/docs","?").concat(n)},e.prototype._getHttpConfig=function(e){var t=new Headers;return t.set("Authorization","Bearer ".concat(e)),t.set("Content-Type","application/json"),t.set("X-Office-Application","120"),t.set("X-Office-Platform","Web"),t.set("X-Office-Version","aec61d34-20ca-455f-ba08-4fbe7e366f81"),t.set("X-CorrelationId",r.Guid.newGuid().toString()),{headers:t}},e}();!function(e){e.GetFirstRunHTTPError403="GetFirstErrorHTTP403",e.GetFirstRunHTTPStatusError="GetFirstHTTPStatusError",e.GetFirstRunHTTPRequestError="GetFirstHTTPRequestError"}(Cn||(Cn={}));var Hn,Rn=Cn,Nn={true:!0,false:!1},Bn=function(){function e(){}return e.getIsFirstRun=function(e){var t=window.localStorage.getItem(e);return t?Nn[t]:void 0},e.setIsFirstRun=function(t,n){var a=window.localStorage.getItem(t),i=String(n);if(a!==i)try{window.localStorage.setItem(t,i)}catch(t){s._TraceLogger.logError(e._logSource,t)}},e._logSource=s._LogSource.create("CortexFirstRunCacheManager"),e}();!function(e){e.KnowledgeCenter="KnowledgeCenterFirstRun",e.KnowledgeManagementTopicPage="KnowledgeManagementTopicPageFirstRun",e.TopicPageEditButton="TopicPageEditFirstRun",e.TopicPagePrivacyPermissionBanner="TopicPagePrivacyPermissionFirstRun",e.TopicPagePublishButton="TopicPagePublishFirstRun",e.TopicManualHighlight="TopicManualHighlightFirstRun",e.TopicAutoHighlight="TopicAutoHighlightFirstRun",e.AddTopicHighlight="AddTopicHighlightFirstRun"}(Hn||(Hn={}));var jn,Vn=Hn,zn=function(){function e(){}return e.topicFirstRun="CSIKM.FirstRun",e.topicFirstRunDPLogPrefix="".concat(e.topicFirstRun,".DP"),e.topicFirstRunGetAPIDPPrefix="".concat(e.topicFirstRun,"GetAPI.DP"),e.topicFirstRunSetAPIDPPrefix="".concat(e.topicFirstRun,"SetAPI.DP"),e}(),Gn=((jn={})[Vn.KnowledgeCenter]="sharePointKnowledgeCenterFirstRun",jn[Vn.KnowledgeManagementTopicPage]="sharePointKnowledgeManagementTopicPageFirstRun",jn[Vn.TopicPageEditButton]="sharePointTopicPageEditFirstRun",jn[Vn.TopicPagePrivacyPermissionBanner]="sharePointTopicPagePrivacyPermissionFirstRun",jn[Vn.TopicPagePublishButton]="sharePointTopicPagePublishFirstRun",jn[Vn.TopicManualHighlight]="sharePointTopicManualHighlightFirstRun",jn[Vn.TopicAutoHighlight]="sharePointTopicAutoHighlightFirstRun",jn[Vn.AddTopicHighlight]="sharePointAddTopicHighlightFirstRun",jn),Kn=function(){function e(e,t){this._polishFREDataProvider=!r._SPKillSwitch.isActivated("d85cd581-d743-463a-946c-3fa5ffd420f4"),this._spHttpClient=t,this._pageContext=e}return e._domainUrl=function(){return decodeURIComponent("".concat(window.location.protocol,"//").concat(window.location.host))},e._getErrorExtraData=function(e){var t=e.headers.get("sprequestguid")||"",n=e.headers.get("microsoftsharepointteamservices")||"";return{status:e.status,correlationId:t,spVersion:n}},e.prototype.getIsFirstRun=function(t){return Object(c.__awaiter)(this,void 0,void 0,function(){var n;return Object(c.__generator)(this,function(a){switch(a.label){case 0:return!r._SPKillSwitch.isActivated("4d4ca241-7195-4013-83ae-b1b70dbce756")&&Object(l.isRunCortexTAB)()?[2,!1]:"boolean"!=typeof(n=Bn.getIsFirstRun(t))?[3,1]:(s._TraceLogger.logVerbose(e._logSource,"".concat(zn.topicFirstRun," is ").concat(n," in the local storage")),[2,n]);case 1:return[4,this._getServerIsFirstRun(t)];case 2:return[2,a.sent()]}})})},e.prototype.setIsFirstRun=function(e,t){return Object(c.__awaiter)(this,void 0,void 0,function(){return Object(c.__generator)(this,function(n){switch(n.label){case 0:return[4,this.setServerIsFirstRun(e,t)];case 1:return n.sent(),this.setLocalIsFirstRun(e,t),[2]}})})},e.prototype.setServerIsFirstRun=function(t,n){return Object(c.__awaiter)(this,void 0,void 0,function(){var a,r,o,d,l;return Object(c.__generator)(this,function(c){switch(c.label){case 0:return a=!n,r=new oe._QosMonitor(zn.topicFirstRunGetAPIDPPrefix),(o={})[Gn[t]]=a,[4,this._spHttpClient.post(this._bitRestUrl,i.SPHttpClient.configurations.v1,{body:JSON.stringify(o),headers:{Accept:"*/*, application/json; odata=minimalmetadata","X-HTTP-Method":"PATCH","Content-Type":"application/json; odata=minimalmetadata","X-ClientType":"PageAuthoring_SetFirstRunBit"}})];case 1:if(!(d=c.sent()).ok)throw l=new Error(d.statusText),s._TraceLogger.logError(e._logSource,l),r.writeUnexpectedFailure(zn.topicFirstRunSetAPIDPPrefix,l,e._getErrorExtraData(d)),l;return s._TraceLogger.logVerbose(e._logSource,"Request successfully for setting page authoring first run, the status: ".concat(a)),r.writeSuccess(),[2]}})})},e.prototype.setLocalIsFirstRun=function(e,t){Bn.setIsFirstRun(e,t)},e.prototype._getServerIsFirstRun=function(t){return Object(c.__awaiter)(this,void 0,void 0,function(){var n,a,r,o,d,l,u;return Object(c.__generator)(this,function(c){switch(c.label){case 0:n=new oe._QosMonitor(zn.topicFirstRunGetAPIDPPrefix),c.label=1;case 1:return c.trys.push([1,6,,7]),[4,this._spHttpClient.get(this._retrieveBitRestUrl(t),i.SPHttpClient.configurations.v1,{headers:{"X-ClientType":"PageAuthoring_GetFirstRunBit"}})];case 2:return(a=c.sent()).ok?[4,a.json()]:[3,4];case 3:return r=c.sent(),o=!r[Gn[t]],this._polishFREDataProvider&&"boolean"!=typeof Bn.getIsFirstRun(t)&&this.setLocalIsFirstRun(t,o),s._TraceLogger.logVerbose(e._logSource,"Retrieving first run bit ".concat(t," successfully, the status: ").concat(o)),n.writeSuccess(),[2,o];case 4:return d=new Error(a.statusText),l=e._getErrorExtraData(a),403===a.status?(n.writeExpectedFailure(Rn.GetFirstRunHTTPError403,d,l),[2,!1]):(s._TraceLogger.logError(e._logSource,d),n.writeUnexpectedFailure(Rn.GetFirstRunHTTPStatusError,d,l),this._polishFREDataProvider?[2,!1]:[2,Promise.reject(d)]);case 5:return[3,7];case 6:return u=c.sent(),s._TraceLogger.logError(e._logSource,u),n.writeUnexpectedFailure(Rn.GetFirstRunHTTPRequestError,u),this._polishFREDataProvider?[2,!1]:[2,Promise.reject(u)];case 7:return[2]}})})},e.prototype._retrieveBitRestUrl=function(e){return"".concat(this._bitRestUrl,"?$select=").concat(Gn[e])},Object.defineProperty(e.prototype,"_bitRestUrl",{get:function(){return"".concat(e._domainUrl(),"/_api/SP.Directory.DirectorySession/GetGraphUser(principalName='").concat(u.UriEncoding.encodeURIComponent(this._pageContext.legacyPageContext.userLoginName),"')")},enumerable:!1,configurable:!0}),e._logSource=s._LogSource.create(zn.topicFirstRunDPLogPrefix),e}(),Wn={HighlightedContent:1,SiteActivity:2,Sites:3,RecentDocuments:4,OfficeFeed:5,MyTopics:6,Other:999}},pJH1:function(e,t,n){e.exports=n.p+"Modernize_News_a3fe9f83e59c20415da4c571d192296b.svg"},ui8f:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Text:1,Integer:2,Decimal:3,DateTime:4,YesNo:5,Binary:6,Double:7}},ut3N:function(e,t){e.exports=f},vlQI:function(e,t){e.exports=p},y88i:function(e,t){e.exports=m}})});