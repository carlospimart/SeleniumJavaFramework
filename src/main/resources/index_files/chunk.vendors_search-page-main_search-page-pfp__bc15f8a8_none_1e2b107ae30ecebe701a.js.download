(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[5,217],{"+Qbe":function(e,t,n){"use strict";function a(e){return e}function i(e,t){return t}n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i})},"1OQn":function(e,t,n){"use strict";n.r(t),n.d(t,"resolveSubstrateUrl",function(){return i});var a=n("+Qbe");function i(e){var t="https://substrate.office.com";switch(e){case"Blackforest":return"https://substrate.office.de";case"GccHigh":return"https://substrate.office365.us";case"DoD":return"https://substrate-dod.office365.us";case"Gallatin":return"https://partner.outlook.cn";case"AG08":return"https://substrate.exo.eaglex.ic.gov";case"AG09":return"https://substrate.exo.microsoft.scloud";case"Df":case"Msit":case"Prod":case"GccModerate":case"Unknown":return t;default:return Object(a.t)(e,t)}}},"1tcB":function(e,t,n){"use strict";n.r(t),n.d(t,"cacheId",function(){return o});var a=n("17wl"),i=n("2xJV"),r=n("dnbZ"),o="personalaccountname";t.default=Object(r.e)(function(e){var t=e.url,n=e.token;return Object(i.e)({url:t,method:"GET",headers:Object(a.__assign)({Accept:"application/json;odata=verbose"},n?{Authorization:"Bearer ".concat(n)}:{}),timeoutMs:5e3})},{monitorName:"fetchPersonalAccountName",cacheId:o,cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return{}}})},"2xJV":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("17wl"),i=n("Scik");function r(e){return new Promise(function(t,n){var r=new(e.XMLHttpRequest||XMLHttpRequest);r.requestLogData=Object(a.__assign)({},e.requestLogData),r.open(e.method,e.url,!0),e.timeoutMs&&(r.timeout=e.timeoutMs),e.withCredentials&&(r.withCredentials=e.withCredentials);var o=e.headers||{};Object.keys(o).map(function(e){r.setRequestHeader(e,o[e])}),r.onload=function(){4===r.readyState&&(Object(i.default)(r.status)?t(r):n(r))},r.onerror=function(){n(r)},r.ontimeout=function(){n(r)};var s=e.body||null;r.send(s)})}},"3bMT":function(e,t,n){"use strict";function a(e){if("object"==typeof e)return{token:e.token,expEpoch:1e3*e.expiry};var t=Number.MAX_VALUE,n=e&&e.split(".");if(n&&3===n.length){var a=JSON.parse(function(e){var t=(e=e.trim()).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^\-_a-zA-Z0-9]/.test(e))&&function(e){throw new Error(e).name="InvalidCharacterError",new Error(e)}("Invalid character: the string to be decoded is not correctly encoded.");for(var n,a=0,i=0,r="",o=-1;++o<t;)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".indexOf(e.charAt(o)),i=a%4?64*i+n:n,a++%4&&(r+=String.fromCharCode(255&i>>(-2*a&6)));return r}(n[1]));a&&a.exp&&(t=1e3*a.exp)}return{token:e,expEpoch:t}}function i(e){return!!r(e)&&Date.now()>e.expEpoch-24e4}function r(e){return!(!e||e.expEpoch-Date.now()<12e4)}n.r(t),n.d(t,"toTokenDetail",function(){return a}),n.d(t,"isApproachingExpiration",function(){return i}),n.d(t,"isValid",function(){return r})},"8rpD":function(e,t,n){"use strict";n.r(t),n.d(t,"cacheId",function(){return o});var a=n("17wl"),i=n("2xJV"),r=n("dnbZ"),o="spohubsitesinfo";t.default=Object(r.e)(function(e){var t=e.clientId,n=e.endpoint,r=e.token;return Object(i.e)({url:"".concat(n,"/_api/search/query?querytext='IsHubSite=1%20contentclass:STS_Site'")+"&selectproperties='DepartmentId,Title'&rowlimit=1000&ClientType='".concat(t,"'")+"&Properties='ClientFunction:SpoHubSitesInfo,FetchSpoHubSitesInfo:true,EnableDynamicGroups:true'&EnableQueryRules=false&ProcessBestBets=false&BypassResultTypes=true&ProcessPersonalFavorites=false&SourceId='8413cd39-2156-4e00-b54d-11efd9abdb89'&suxrid=spohubsitesinfo",method:"GET",headers:Object(a.__assign)({Accept:"application/json;odata=verbose"},r?{Authorization:"Bearer ".concat(r)}:{}),timeoutMs:5e3})},{monitorName:"prefetchSpoHubSitesInfo",cacheId:o,cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(e){return{endpoint:e.endpoint}}})},A9eu:function(e,t,n){"use strict";n.d(t,"r",function(){return l}),n.d(t,"i",function(){return u}),n.d(t,"e",function(){return f}),n.d(t,"t",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"n",function(){return _});var a=n("17wl"),i=n("XtNw"),r=n("meYL"),o=n("z3ty"),s=n("/ZMv");function c(e){return"string"==typeof e?e.replace(/\/+$/,""):e}var d=function(e){return"".concat(c(e),"/api/v1/search/configuration")};function l(e,t,n){void 0===t&&(t="");var a=function(e,t){var n=Object(i.e)(e);return n===e&&(n=Object(i.e)("Prod")),t(n)}(e,n);return"".concat(a).concat(t?"/".concat(t):"")}function u(e,t){return void 0===t&&(t=""),l(e,t,d)}function f(e,t,n){var i;return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},t),((i={"X-MSSearchVersion":s.e,"X-ClientFeature":"Search"})["X-ClientType"]=e,i)),n?{Authorization:"Bearer ".concat(n)}:{})}function p(e){return"".concat(c(e)||"","/api/v1/search/configuration/verticals")}function m(e,t){void 0===t&&(t=!1);var n={};return e&&(n.siteCollectionId=e.toUpperCase()),t&&(n.verticalState="all"),Object(r.getQueryStringValue)("ecsOverrides")&&(n.ecsOverrides=Object(r.getQueryStringValue)("ecsOverrides")),n}function _(){var e;return"true"===Object(r.getQueryStringValue)("cacheClear")?((e={})[o.e.VerticalsCacheClear]="uncached",e):{}}},BXxH:function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("2xJV"),r=n("dnbZ");t.default=Object(r.e)(function(e){var t=e.endpoint,n=e.clientId,r=e.token;return Object(i.e)({url:"".concat(t,"?querytext='*'&ClientType='").concat(n,"'")+"&Properties='ClientFunction:PersonalRelevanceContext,FetchPersonalRelevanceContext:true'&EnableQueryRules=false&ProcessBestBets=false&BypassResultTypes=true&ProcessPersonalFavorites=false&SourceId='8413cd39-2156-4e00-b54d-11efd9abdb89'&suxrid=ms-oil-datasource-spopersonalcontext",method:"GET",headers:Object(a.__assign)({Accept:"application/json;odata=verbose"},r?{Authorization:"Bearer ".concat(r)}:{}),timeoutMs:7e3})},{monitorName:"prefetchPersonalRelevance",cacheId:"prctx",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return{}}})},BzbU:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n("17wl"),i=n("n1Yx"),r=Math.random();function o(e,t){var n=e.monitorType,o=e.monitorName,d=e.monitorOnce,l=e.samplingOptions,u=e.successPropExtractor,f=e.failurePropExtractor,p=!1;return function(e){if(d&&p)return t(e);if(l&&function(e,t){if(!(e.sampleRate>=0&&e.sampleRate<=1))return!1;if(void 0!==e.sampleIdExtractor){var n=e.sampleIdExtractor(t);return s(n)%1e3/1e3>=e.sampleRate}return r>=e.sampleRate}(l,e))return t(e);var m=(null==e?void 0:e.prefetchPerformance)||performance,_=(null==e?void 0:e.prefetchDispatcher)||Object(i.getDispatcher)();p=!0;var h,b=Math.round(m.now());function g(e,t){_.dispatch({eventType:"QOSSTOP",name:n,result:e,nameDetail:o,startTimestamp:b,totalTime:Math.round(m.now())-b,properties:l?Object(a.__assign)(Object(a.__assign)({},t),{sampleRate:l.sampleRate}):t})}_.dispatch({eventType:"QOSSTART",name:n,nameDetail:o,timestamp:b});try{h=t(e)}catch(e){return g("FAILURE",{promiseFactoryFailed:!0}),Promise.reject(e)}return h.then(function(e){return g("SUCCESS",c(e,u,{successExtractorFailed:!0})),e},function(e){return g("FAILURE",c(e,f,{failureExtractorFailed:!0})),Promise.reject(e)})}}var s=function(e){for(var t=0,n=e.length-1;n>=0;n--){var a=e.charCodeAt(n),i=n%8;t^=(a<<i)+(a>>8-i)}return t},c=function(e,t,n){try{return(t||d)(e)}catch(e){return n}},d=function(){return{}}},CcTF:function(e,t,n){"use strict";function a(e){var t=null;return function(n){return t?t(n):e.then(function(e){return t=e,e(n)})}}n.r(t),n.d(t,"createAsyncTokenProvider",function(){return a}),n.d(t,"fetch",function(){return i.e}),n.d(t,"fetchAcquireToken",function(){return r.default}),n.d(t,"fetchAndParseSearchConfiguration",function(){return f}),n.d(t,"fetchCustomVerticals",function(){return m.e}),n.d(t,"fetcher",function(){return _.e}),n.d(t,"fetchBingConsumer",function(){return h.default}),n.d(t,"fetchFileShareConnectorSettings",function(){return v}),n.d(t,"fetchHubSites",function(){return y.default}),n.d(t,"fetchPersonalData",function(){return S.default}),n.d(t,"fetchPersonalRankingContext",function(){return D.default}),n.d(t,"fetchSearchCenterUrl",function(){return w}),n.d(t,"fetchRawSearchCenterUrl",function(){return I}),n.d(t,"fetchSearchConfiguration",function(){return l.e}),n.d(t,"fetchTellMeSearchResults",function(){return E.default}),n.d(t,"fetchParsedCustomVerticals",function(){return d.default}),n.d(t,"fetchSearchConfigurationFromEcs",function(){return L}),n.d(t,"fetchConfigFromEcsWithCacheAndMonitor",function(){return T}),n.d(t,"fetchSpHomeNews",function(){return U.fetchSpHomeNews}),n.d(t,"fetchSpHomePrefetch",function(){return U.fetchSpHomePrefetch}),n.d(t,"fetchSiteNewsSuggestions",function(){return N}),n.d(t,"fetchSiteActivities",function(){return B.default}),n.d(t,"siteActivitiesCacheKeyExtractor",function(){return B.cacheKeyExtractor}),n.d(t,"fetchSharePointDigest",function(){return j.default}),n.d(t,"fetchSharePointDigestV2",function(){return G}),n.d(t,"fetchSitesFromSubstrate",function(){return Q}),n.d(t,"cache",function(){return Y.cache}),n.d(t,"init",function(){return Y.init}),n.d(t,"puid",function(){return Y.puid}),n.d(t,"statusOk",function(){return W.default}),n.d(t,"substrateIframeProxy",function(){return q.substrateIframeProxy}),n.d(t,"toTokenDetail",function(){return J.toTokenDetail}),n.d(t,"warmupMsb",function(){return Z}),n.d(t,"resolveBingUrl",function(){return te}),n.d(t,"resolveLokiEnvironment",function(){return ne.resolveLokiEnvironment}),n.d(t,"resolveSubstrateUrl",function(){return ae.resolveSubstrateUrl}),n.d(t,"warmupSubstrateSearch",function(){return ie.default}),n.d(t,"withBasicMonitor",function(){return k.e}),n.d(t,"withMonitor",function(){return re.e}),n.d(t,"withImportMonitor",function(){return oe.default}),n.d(t,"withPeriodicRefresh",function(){return de}),n.d(t,"withRefresh",function(){return ce}),n.d(t,"getEcsIds",function(){return le.e}),n.d(t,"withCache",function(){return M.e});var i=n("2xJV"),r=n("m1yz"),o=n("meYL"),s="searchux.killSwitches.",c=n("pK/n"),d=n("lTLd"),l=n("FkJ5"),u=n("z3ty");function f(e){var t,n;Object(o.getQueryStringValue)("sid")&&(e.siteId=Object(o.getQueryStringValue)("sid")),e.siteId&&(e.siteId=e.siteId.toUpperCase());var a=null===(n=null===(t=e.additionalHeaders)||void 0===t?void 0:t[u.e.SearchComponent])||void 0===n?void 0:n.toLowerCase();return"serp"===a&&Object(d.createSearchConfigPromiseEntity)(e),Object(l.e)(e).then(function(e){var t=e.xhr,n=JSON.parse(t.responseText),i=null==n?void 0:n.ecsSettings;n.ecsSettings=function(e){var t={},n={};for(var a in e)if(e.hasOwnProperty(a))if(0===a.indexOf(s)){var i=a.slice(s.length),r=Boolean(e[a]);n[i]=r}else t[a]=e[a];return t["searchux.killSwitches"]=n,t}(Object(c.e)("ecsOverrides","wipeEcsConfig",i));var r=Object(d.getSearchConfigPromiseEntity)();return"serp"===a&&(n.verticalConfig?(null==r?void 0:r.promiseResolver)&&r.promiseResolver(n.verticalConfig):(null==r?void 0:r.promiseRejector)&&r.promiseRejector()),n}).catch(function(){var e,t=null===(e=Object(d.getSearchConfigPromiseEntity)())||void 0===e?void 0:e.promiseRejector;t&&t()})}var p,m=n("m/5T"),_=n("dnbZ"),h=n("wYV+"),b=n("17wl"),g=["AllVerticalContent","FilesVerticalContent"],v=Object(_.e)(function(e){var t=e.endpoint,n=e.token;return Object(i.e)({url:"".concat(t,"/_api/web/AllProperties?$select=").concat(g.join(",")),method:"GET",headers:Object(b.__assign)({Accept:"application/json;odata=verbose"},n?{Authorization:"Bearer ".concat(n)}:{}),timeoutMs:5e3})},{monitorName:"prefetchFileShareConnectorsInfo",cacheId:"fileshareconnectorsettings",cacheVersion:"0",cacheItemLifetime:216e5,cacheKeyExtractor:function(e){return{endpoint:e.endpoint}}}),y=n("8rpD"),S=n("1tcB"),D=n("BXxH");function I(e){var t=e.siteRoot,n=e.tokenProvider;return O({siteRoot:t,tokenProvider:n}).then(function(e){if(e.cacheItemResolved&&p)return p;var t=JSON.parse(e.xhr.responseText),n=t&&t.d&&t.d.searchcenterurl||"";return p=n,n})}var x,C,O=Object(_.e)(function(e){var t=e.siteRoot;return(0,e.tokenProvider)({attempt:0}).then(function(e){return Object(i.e)({url:"".concat(t,"/_api/search/searchcenterurl"),method:"GET",headers:Object(b.__assign)({Accept:"application/json;odata=verbose"},e?{Authorization:"Bearer ".concat(e)}:{}),timeoutMs:5e3})})},{monitorName:"fetchSearchCenterUrl",cacheId:"searchcenterurl",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return{}}}),w=function(e){return I({siteRoot:e.siteRoot,tokenProvider:e.tokenProvider}).then(function(e){return n="/search/",(a=(t=e).lastIndexOf(n))<0?"":t.substring(0,a+n.length).replace(/\/$/,"");var t,n,a})},E=n("Sodt"),A=n("O/vF"),L=(x=function(e){return e?{url:Object(c.t)(e),method:"GET"}:Object(A.e)("missing options for ECS call")},function(e){return(e.prefetchFetch||i.e)(x(e))}),k=n("BzbU"),M=n("yb5F"),P="searchConfigurationFromEcs",T=Object(k.e)({monitorName:P,monitorType:"prefetch_request",successPropExtractor:function(e){return Object(c.n)(Object(c.a)(null==e?void 0:e.xhr.responseText,{disableUrlOverrides:!0}))},failurePropExtractor:function(e){return{errorCode:(null==e?void 0:e.status)||-1}}},Object(M.e)((C=L,function(e){return C(e).then(function(e){return{xhr:e}})}))({cacheId:P,cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return Object(b.__rest)(e,[])}})),U=n("HSx8");function F(e,t,n){return"".concat(n.sitePath,"/_api/search/query?QueryText='*'").concat(function(e){var t=e.departmentId,n=e.isHubSite;return"&QueryTemplate='({searchterms}) ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118*"+" AND PromotedState:2 AND ".concat((n&&t?R:H)(e),"'")}(n))+"&HitHighlightedProperties='Title'&StartRow=0&RowLimit=100"+"&Properties='ClientFunction:News,EnableMultiGeoSearch:".concat(e?"true":"false","'")+"&sortlist='LastModifiedTime:descending'&SelectProperties='ContentClass,ContentTypeId,DefaultEncodingURL,DocId,EditorOWSUSER,FileExtension,GeoLocationSource,LastModifiedTime,ModifiedBy,Path,SPWebUrl,SecondaryFileExtension,ServerRedirectedUrl,SiteId,Title,UniqueId,WebId'"+"&ClientType='".concat(t,"'&EnableQueryRules=false")}function H(e){var t=e.sitePath;return'Path:"'.concat(t,'"')}function R(e){var t=e.departmentId;return"(DepartmentId:".concat(t," OR DepartmentId:").concat(t.replace(/[{}]/g,""),")")}var N=Object(_.e)(function(e){var t=e.clientId,n=e.site,a=e.token;return Object(i.e)({url:F(!0,t,n),method:"GET",headers:Object(b.__assign)({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},a?{Authorization:"Bearer ".concat(a)}:{})})},{monitorName:"sitenews-rawPrefetch",cacheId:"sitenews-rawPrefetch",cacheVersion:"0",cacheItemLifetime:9e5,cacheKeyExtractor:function(e){return{sitePath:e.site.sitePath}}}),B=n("jxox"),j=n("ZHuH"),V="fetchSharepointDigest",z=!1,G=Object(_.e)(function(e){var t=e.endpoint,n=e.token,a=e.overrideDigest;return a&&!z?(z=!0,new Promise(function(e){e({responseText:JSON.stringify({d:{GetContextWebInformation:{FormDigestValue:a}}})})})):Object(i.e)({url:"".concat(t,"/_api/contextinfo"),method:"POST",headers:Object(b.__assign)({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},n?{Authorization:"Bearer ".concat(n)}:{}),timeoutMs:5e3})},{monitorName:V,cacheId:V,cacheVersion:"0",cacheItemLifetime:179e4,cacheKeyExtractor:function(e){return{url:e.endpoint}}}),K=n("m//X"),W=n("Scik"),q=n("te/z"),Q=Object(_.e)(function(e){var t=e.token,n=e.prefix,a=e.substrateUrl;return Object(q.substrateIframeProxy)(a).then(function(e){return e({action:"queryv2",token:t,prefix:n,cvid:Object(K.e)()}).then(function(e){if(!Object(W.default)(e.statusCode))throw{status:e.statusCode};return{status:e.statusCode,responseText:e.qfResponse}})})},{monitorName:"fetchSitesFromSubstrate",cacheId:"fetchSitesFromSubstrate",cacheVersion:"0",cacheItemLifetime:108e5,cacheKeyExtractor:function(e){e.token;var t=Object(b.__rest)(e,["token"]);return Object(b.__assign)({},t)}}),Y=n("wxe1"),J=n("3bMT"),X="warmupMsb",Z=Object(_.e)(function(e){var t=e.msbUrl,n=e.clientType,a=e.token;"https://business.bing.com"===t&&(t+="/work/api");var r="".concat(t,"/v3/user/init"),o={Authentication:a,clientContext:{clientType:n}};return Object(i.e)({url:r,method:"POST",body:JSON.stringify(o)})},{monitorName:X,cacheId:X,cacheVersion:"0",cacheItemLifetime:5e3,cacheKeyExtractor:function(e){e.token;var t=Object(b.__rest)(e,["token"]);return Object(b.__assign)({},t)}}),$=n("+Qbe");function ee(e){switch(e){case"dev":return"https://localhost:18101/api";case"test":return"https://bingatwork.asgfalcon-test.io/api";case"prod":return"https://business.bing.com/api";case"prod_generic":return"https://business.bing.com/work/api";case"prod_gcc":return"https://usgov.business.bing.com/api";case"dev_bing":return"https://localhost/work/api";case"staging_bing":return"https://www.staging-bing-int.com/work/api";default:return Object($.e)(e)}}function te(e){switch(e){case"test":return ee(e);case"gcc":return ee("prod_gcc");default:return ee("prod_generic")}}var ne=n("e/PZ"),ae=n("1OQn"),ie=n("cH4r"),re=n("xbJB"),oe=n("uVZz"),se=n("n1Yx");function ce(e,t){var n,a=null,i=!1,r=function(){return i||(i=!0,n=t({attempt:1}).then(function(e){return a=Object(J.toTokenDetail)(e),i=!1,a.token}).catch(function(e){throw i=!1,e})),n};return function(n,i,o){void 0===o&&(o=!0);var s,c,d,l,u=o?(s="".concat(e,"_withRefresh"),c="generic_qos",d=performance.now(),(l=Object(se.getDispatcher)()).dispatch({name:c,nameDetail:s,timestamp:d,eventType:"QOSSTART"}),function(e,t,n){var a=performance.now();l.dispatch({name:c,nameDetail:s,startTimestamp:d,totalTime:a-d,eventType:"QOSSTOP",result:e,properties:{customLogProps:JSON.stringify(t)},error:n})}):function(){};if(!t)return u("FAILURE",Object(b.__assign)({cacheItemResolved:!1,tokenProviderNull:!0},i)),Promise.reject("token provider is null");if(!a||!Object(J.isValid)(a)||n.attempt>0)return r().then(function(e){return u("SUCCESS",Object(b.__assign)({cacheItemResolved:!1,expires:a&&new Date(a.expEpoch),didRefresh:!0},i)),e}).catch(function(e){throw u("FAILURE",Object(b.__assign)({cacheItemResolved:!1,tokenProviderNull:!1},i)),e.reason||e});var f=Object(J.isApproachingExpiration)(a);return f&&r(),u("SUCCESS",Object(b.__assign)({cacheItemResolved:!0,expires:a&&new Date(a.expEpoch),backgroundRefresh:f},i)),Promise.resolve(a.token)}}function de(e,t,n){var a,i,r=0,o=ce(e,t);return function(e){return r++,i||(i=window.setInterval(function(){r++,o({attempt:0},{invokedByPeriodicRefresh:!0,invocationCounter:r},!1),Date.now()-a>864e5&&(window.clearInterval(i),i=void 0)},n||3e5)),a=Date.now(),o(e,{invokedByPeriodicRefresh:!1,invocationCounter:r},!0)}}var le=n("Xgtk")},FkJ5:function(e,t,n){"use strict";var a=n("17wl"),i=n("meYL"),r=n("pK/n"),o=n("2xJV"),s=n("dnbZ"),c=n("A9eu"),d="searchConfiguration";t.e=Object(s.e)(function(e){var t=e.token,n=e.clientType,r=e.environment,s=e.culture,d=e.additionalHeaders,l=e.siteId,u=void 0===l?"":l,f=e.useSimpleRequest,p=void 0!==f&&f,m=Object(c.e)(n,Object(a.__assign)(Object(a.__assign)({},d),Object(c.n)()),t);return p?Object(o.e)({url:Object(i.constructUrl)(Object(c.i)(r,s),Object(a.__assign)(Object(a.__assign)({},Object(c.a)(u,!1)),{ConvertGetPost:"true"})),method:"POST",body:JSON.stringify(m)}):Object(o.e)({url:Object(i.constructUrl)(Object(c.i)(r,s),Object(c.a)(u,!1)),method:"GET",headers:m})},{monitorName:d,cacheId:d,cacheVersion:"0",cacheItemLifetime:6e5,cacheKeyExtractor:function(e){e.token;var t=Object(a.__rest)(e,["token"]),n=t.additionalHeaders&&t.additionalHeaders["X-MSSearchScenario"]||"";return Object(a.__assign)(Object(a.__assign)({},t),{msSearchScenario:n})},additionalSuccessPropsExtractor:function(e){return Object(a.__assign)(Object(a.__assign)({},Object(r.n)(e.responseText)),{cacheClear:Object(i.getQueryStringValue)("cacheClear")})},forceRefresh:function(){return"true"===Object(i.getQueryStringValue)("cacheClear")}})},HSx8:function(e,t,n){"use strict";n.r(t),n.d(t,"fetchSpHomePrefetch",function(){return c}),n.d(t,"fetchSpHomeNews",function(){return d});var a,i=n("17wl"),r=n("2xJV"),o=n("dnbZ"),s=(a=function(e){var t=e.clientId,n=e.token,a=e.fetcher,o=(0,e.requestDataProvider)(),s=o.endpoint,c=o.context,d=o.microserviceFlights,l={url:s,method:"GET",headers:Object(i.__assign)(Object(i.__assign)({Accept:"application/json;odata=verbose","SPHome-ClientType":t,"SPHome-ApiContext":JSON.stringify(c)},n?{Authorization:"Bearer ".concat(n)}:{}),d&&{"SPHome-MicroserviceFlights":d.join(";")})};return a?a(s,l).then(function(e){return e.json()}).then(function(e){return{responseText:JSON.stringify(e)}}):Object(r.e)(l)},function(e){return Object(o.e)(a,{monitorName:e,cacheId:e,cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(){return{}}})}),c=s("sphome-rawsprefetch"),d=s("sphome-rawnews")},Scik:function(e,t,n){"use strict";function a(e){return e>=200&&e<=300||0===e}n.r(t),n.d(t,"default",function(){return a})},SmHW:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"}(a||(a={}))},Sodt:function(e,t,n){"use strict";n.r(t);var a=n("2xJV"),i=n("yb5F"),r=n("xbJB");t.default=function(e){return Object(r.e)({monitorName:"tell-me-search-service-prefetch"},Object(i.e)(function(t){var n=t.url;return Object(a.e)({url:n,method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Office-Application":e.application,"X-Office-Platform":"Web","X-TellMe-SuggestionTypes":e.searchTypes.join(),"X-TellMe-Culture":e.marketValue},body:JSON.stringify({Query:e.searchText,TemplateInfo:{Application:e.templateTypes.join(),MaxTemplate:e.numberOfResultsToFetch}})}).then(function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}})})({cacheId:"tell-me-search-service-prefetch",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return{query:e.searchText}}}))(e)}},WSFI:function(e,t,n){"use strict";n.r(t),n.d(t,"spRequestDurationHeader",function(){return a}),n.d(t,"spClientServiceRequestDurationHeader",function(){return i}),n.d(t,"sharePointCorrelationHeader",function(){return r}),n.d(t,"getNamedHeadersFromXhr",function(){return o}),n.d(t,"getRequestDurationFromXhr",function(){return s}),n.d(t,"getRequestDurationFromHeaders",function(){return c});var a="sprequestduration",i="spclientservicerequestduration",r="sprequestguid";function o(e,t){var n={};if(e.getAllResponseHeaders){var a=e.getAllResponseHeaders();t.forEach(function(t){e.getResponseHeader&&-1!==a.indexOf(t)&&(n[t]=e.getResponseHeader(t)||"")})}return n}function s(e){var t=o(e,[a,i]);return t[a]||t[i]||void 0}function c(e){return e[a]||e[i]||""}},Xgtk:function(e,t,n){"use strict";function a(e){return e?e.filter(function(e){return e.indexOf("31828")>-1}).join()||e.join():void 0}n.d(t,"e",function(){return a})},XtNw:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("+Qbe"),i=n("SmHW");function r(e){switch(e){case"Df":return i.e.Dogfood;case"Msit":return i.e.MSIT;case"Blackforest":return i.e.Blackforest;case"GccModerate":return i.e.GccModerate;case"GccHigh":return i.e.GccHigh;case"DoD":return i.e.DOD;case"Gallatin":return i.e.Gallatin;case"Prod":return i.e.TopLevel;case"AG08":return i.e.AG08;case"AG09":return i.e.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return Object(a.e)(e)}}},ZHuH:function(e,t,n){"use strict";n.r(t);var a=n("2xJV"),i=n("yb5F"),r=n("xbJB");t.default=function(e){var t=e.endpoint,n=e.forceDigestRefresh;return Object(r.e)({monitorName:"prefetchSharepointDigest"},Object(i.e)(function(e){var t=e.endpoint;return Object(a.e)({url:"".concat(t,"/_api/contextinfo"),method:"POST",headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},timeoutMs:5e3}).then(function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}})})({cacheId:"pspd",cacheVersion:"0",cacheItemLifetime:179e4,cacheKeyExtractor:function(e){return{url:"".concat(e.endpoint,"/_api/contextinfo")}},forceRefresh:n}))({endpoint:t,forceDigestRefresh:n})}},cH4r:function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("m//X"),r=n("dnbZ"),o=n("Scik"),s=n("te/z"),c="Substrate-DiagnosticsDuration";function d(e){return e.getResponseHeader?{correlationID:e.getResponseHeader("request-id")||"",properties:JSON.stringify({serverLatency:e.getResponseHeader("x-end2endlatencyms")||"",diagnosticsDuration:e.getResponseHeader(c)||""})}:{}}t.default=Object(r.e)(function(e){var t=e.token,n=e.queryStringParameters,r=e.headers,d=e.postAction,l=void 0===d?"init":d,u=e.cvid,f=e.makeSubstrateRequest,p=e.substrateUrl,m=n?Object(a.__assign)({},n):{},_={action:l,token:t,prefix:void 0,cvid:u||Object(i.e)(),additionalInfo:Object(a.__assign)(Object(a.__assign)({},m),{diagnostics:"1"}),headers:r};return(f?f(_):Object(s.sendSubstrateRequest)(_,p)).then(function(e){var t={};try{t=JSON.parse(e.responseHeaders)}catch(e){}if(e.diagnostics)try{var n=Object(s.parseDiagnostics)(e.diagnostics);n&&n.duration&&(t[c]=""+n.duration)}catch(e){}var a={status:e.statusCode,responseText:e.qfResponse,getResponseHeader:function(e){return t[e]}};if(!Object(o.default)(e.statusCode))throw a;return a})},{monitorName:"warmupSubstrateSearch",cacheId:"warmupSubstrateSearch",cacheVersion:"0",cacheItemLifetime:5e3,additionalSuccessPropsExtractor:d,additionalFailurePropsExtractor:d,cacheKeyExtractor:function(e){e.token,e.makeSubstrateRequest,e.cvid;var t=Object(a.__rest)(e,["token","makeSubstrateRequest","cvid"]);return Object(a.__assign)({},t)}})},dnbZ:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n("yb5F"),i=n("xbJB"),r=n("17wl");function o(e){return!!e&&(401===e.status||0===e.status)}function s(e,t,n,a){if(!n.token&&!n.tokenProvider)return Promise.reject(new Error("Token or token provider must be specified."));var i=-1;return n.token?a(Object(r.__assign)(Object(r.__assign)({},n),{token:n.token})).then(function(e){return{tokenAttemptCount:0,tokenFetchDuration:0,xhr:e}}):n.tokenProvider({attempt:e}).then(function(e){return i=performance.now()-t,a(Object(r.__assign)(Object(r.__assign)({},n),{token:e}))}).then(function(t){return{tokenAttemptCount:e+1,tokenFetchDuration:i,xhr:t}})}function c(e,t){return Object(i.e)(t,Object(a.e)((n=e,function(e){var t=performance.now();return s(0,t,e,n).catch(function(a){return o(a)?s(1,t,e,n).catch(function(e){return function(e,t,n){if(o(e)){var a=e;throw a.tokenAttemptCount=2,a.tokenFetchDuration=n,a}throw e}(e,0,performance.now()-t)}):Promise.reject(a)})}))(t));var n}},"e/PZ":function(e,t,n){"use strict";n.r(t),n.d(t,"resolveLokiEnvironment",function(){return i});var a=n("+Qbe");function i(e){switch(e){case"o365test":case"onebox":case"edog":case"spdf":case"test":return"Df";case"prodbubble":return"Msit";case"":case"prod":return"Prod";case"blackforest":return"Blackforest";case"gallatin":return"Gallatin";case"pathfinder":return"DoD";case"trailblazer":return"GccHigh";case"gcc":return"GccModerate";case"ag08":return"AG08";case"ag09":return"AG09";default:return Object(a.t)(e,"Prod")}}},hjpC:function(e,t,n){"use strict";function a(e,t,n){var a;return t&&t.safeToLog?(a=new Error("".concat(e," ").concat(t.message))).innerError=t:a=new Error(e),a.safeToLog=!0,a.logProperties=n,Object.freeze(a),a}function i(e,t,n){throw a(e,t,n)}n.r(t),n.d(t,"default",function(){return a}),n.d(t,"throwSafeToLogError",function(){return i})},jxox:function(e,t,n){"use strict";n.r(t),n.d(t,"cacheKeyExtractor",function(){return o});var a=n("17wl"),i=n("2xJV"),r=n("dnbZ");function o(e){return{scope:e&&e.map(function(e){return e&&e.siteId&&e.siteId.toLowerCase()}).join(",")||""}}t.default=Object(r.e)(function(e){var t=e.clientId,n=e.token,r=e.requestDataProvider,o=e.sites,s=r(),c=s.endpoint,d=s.microserviceFlights,l={url:c,method:"POST",headers:Object(a.__assign)(Object(a.__assign)({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","SPHome-ClientType":t},n?{Authorization:"Bearer ".concat(n)}:{}),d&&{"SPHome-MicroserviceFlights":d.join(";")}),body:JSON.stringify(o.slice(0,30).map(function(e){return{IndexId:e.id,SiteId:e.siteId,WebId:e.webId,Type:"SiteReference"}}))};return Object(i.e)(l)},{monitorName:"site-activities-rawsprefetch",cacheId:"site-activities-rawsprefetch",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return o(e.sites.slice(0,30))}})},lTLd:function(e,t,n){"use strict";n.r(t),n.d(t,"getSearchConfigScope",function(){return d}),n.d(t,"getSearchConfigPromise",function(){return l}),n.d(t,"getSearchConfigPromiseEntity",function(){return u}),n.d(t,"createSearchConfigPromiseEntity",function(){return f}),n.d(t,"default",function(){return p});var a,i=n("17wl"),r=n("hjpC"),o=n("m/5T"),s=n("FkJ5"),c=n("A9eu");function d(){return a&&a.option&&a.option.siteId||""}function l(){return a||f(),a?a.promiseObj:Promise.resolve([])}function u(){return a||f(),a}function f(e){if(!a||!a.isPending||a.isRejected){a={};var t=new Promise(function(e,t){a.promiseResolver=function(t){a.isPending=!1,e(t)},a.promiseRejector=function(){a.isRejected=!0,a.isPending=!1,t()}});a.promiseObj=t,a.isRejected=!1,t.catch(function(){})}a.isPending=!0,e&&(a.option=e)}function p(e){var t,n,l,u=d();if(a&&(!e.scope&&!u||(null===(n=null===(t=e.scope)||void 0===t?void 0:t.siteId)||void 0===n?void 0:n.toUpperCase())===u.toUpperCase())&&!a.isRejected){var p=a.option;return f(p),Object(s.e)(p).then(function(e){var t,n,i=e.xhr;if(i.responseText){var r=JSON.parse(i.responseText).verticalConfig;null===(t=a.promiseResolver)||void 0===t||t.call(a,r)}else null===(n=a.promiseRejector)||void 0===n||n.call(a)}).catch(function(e){var t;console.error(e),null===(t=a.promiseRejector)||void 0===t||t.call(a,e),Object(r.throwSafeToLogError)("CUSTOM_VERTICAL_FETCH_FAILED")}),a.promiseObj}var m=e.lokiUrl,_=null===(l=null==a?void 0:a.option)||void 0===l?void 0:l.environment;return("Df"===_||"Msit"===_&&-1!==(null==m?void 0:m.toLowerCase().indexOf("df")))&&(m=Object(c.r)(_,a.option.culture,function(e){return e})),Object(o.e)(Object(i.__assign)(Object(i.__assign)({},e),{lokiUrl:m})).then(function(e){var t=e.xhr;return t.responseText?JSON.parse(t.responseText):[]}).catch(function(e){console.error(e),Object(r.throwSafeToLogError)("CUSTOM_VERTICAL_FETCH_FAILED")})}},"m//X":function(e,t,n){"use strict";t.e=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},"m/5T":function(e,t,n){"use strict";var a=n("17wl"),i=n("meYL"),r=n("2xJV"),o=n("dnbZ"),s=n("A9eu"),c="customVerticals";t.e=Object(o.e)(function(e){var t=e.lokiUrl,n=e.token,o=e.clientType,c=e.scope,d=e.previewDisabledVerticals,l=e.useSimpleRequest,u=void 0!==l&&l,f=Object(s.e)(o,Object(s.n)(),n),p=c&&c.siteId?c.siteId:"";return u?Object(r.e)({url:Object(i.constructUrl)(Object(s.t)(t),Object(a.__assign)(Object(a.__assign)({},Object(s.a)(p,d)),{ConvertGetPost:"true"})),method:"POST",body:JSON.stringify(f)}):Object(r.e)({url:Object(i.constructUrl)(Object(s.t)(t),Object(s.a)(p,d)),method:"GET",headers:f})},{monitorName:c,cacheId:c,cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return{url:e.lokiUrl,showDisabled:e.previewDisabledVerticals,clientType:e.clientType,scope:e.scope&&e.scope.siteId&&e.scope.siteId.toUpperCase()||null}},additionalSuccessPropsExtractor:function(){return{cacheClear:Object(i.getQueryStringValue)("cacheClear")}},forceRefresh:function(){return"true"===Object(i.getQueryStringValue)("cacheClear")}})},m1yz:function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("2xJV"),r=n("yb5F"),o=n("xbJB"),s=["https://substrate.office.com","https://loki.delve.office.com","https://www.bing.com","https://partner.outlook.cn/search","https://outlook.office365.com/search"];t.default=Object(o.e)({monitorName:"prefetchAcquireToken",additionalSuccessPropsExtractor:function(e){var t=e&&e.responseText&&JSON.parse(e.responseText);return Object(a.__assign)({},t&&{resource:c(t.resource)?t.resource:"",expires_on:t.expires_on})},additionalFailurePropsExtractor:function(e){var t,n,a;try{a=e&&e.responseText&&JSON.parse(e.responseText)}catch(e){}var i=null===(t=null==a?void 0:a.error)||void 0===t?void 0:t.code;return{resource:null===(n=null==e?void 0:e.requestLogData)||void 0===n?void 0:n.resource,properties:JSON.stringify({responseErrorCode:isNaN(i)?"0":i})}}},Object(r.e)(function(e){var t=e.digest,n=e.portalUrl,r=e.resourceUrl,o={resource:r};return e.useSTI&&(o.tokenType="STI"),Object(i.e)(Object(a.__assign)({url:"".concat(n,"/_api/SP.OAuth.Token/Acquire"),method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","Odata-Version":"4.0",Accept:"application/json;odata.metadata=minimal","X-RequestDigest":t},body:JSON.stringify(o),timeoutMs:7e3},c(r)&&{requestLogData:{resource:r}})).then(function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1,cacheItemType:null}})})({cacheId:"psst",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return{resource:e.resourceUrl}}}));var c=function(e){return-1!==s.indexOf(e)}},meYL:function(e,t,n){"use strict";function a(e){var t=self&&self.location&&(self.location.search||self.location.hash)||"";return decodeURIComponent(t.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(e).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}function i(e,t){var n=e,a=Object.keys(t);return a.length&&(n+="?",n+=a.map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")),n}n.r(t),n.d(t,"getQueryStringValue",function(){return a}),n.d(t,"constructUrl",function(){return i})},o6FS:function(e,t,n){"use strict";function a(e){return function(e){return!!e&&(0===e.toLocaleLowerCase().indexOf("http://")||0===e.toLocaleLowerCase().indexOf("https://"))}(e)?e:"https://".concat(e)}n.d(t,"e",function(){return a})},"pK/n":function(e,t,n){"use strict";n.d(t,"t",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"e",function(){return m});var a=n("17wl"),i=n("+Qbe"),r=n("n1Yx"),o=n("meYL"),s=n("hjpC"),c=n("Xgtk"),d=function(e){var t=e.complianceEnvironment,n=e.clientWorkload,a=e.component,r=e.userId,o=e.tenantId,s=e.ring,c=e.isGuestUser,d=function(e){var t="ecs.office.com";switch(e){case"GccHigh":return"config.ecs.gov.teams.microsoft.us";case"DoD":return"config.ecs.dod.teams.microsoft.us";case"AG08":return"config.ecs.teams.eaglex.ic.gov";case"AG09":return"config.ecs.teams.microsoft.scloud";case"Blackforest":case"Df":case"Gallatin":case"GccModerate":case"Msit":case"Unknown":case"Prod":return t;default:return Object(i.t)(e,t)}}(t),l=function(e){switch(e){case"Blackforest":return"BlackForest";case"GccModerate":return"Gcc";default:return e&&"Unknown"!==e?e:"Prod"}}(t);return"https://".concat(d,"/config/v1/LokiService/1.0.0.0?")+"agents=MicrosoftSearch&ecsserviceinformation=true"+"&ClientWorkload=".concat(n)+"&id=".concat(r)+"&TenantID=".concat(o)+"&ring=".concat(s)+"&ApEnvironment=".concat(l)+"&IsGuestUser=".concat(String(c))+(a?"&MsSearch_Component=".concat(a):"")};function l(e){var t={};if(e){var n=JSON.parse(e);if(n.ecsConfigIds&&n.ecsEtag){t.ecsConfigIds=Object(c.e)(n.ecsConfigIds)||"",t.ecsEtag=n.ecsEtag.replace(/"/g,"");var a={},i="searchux.",r=i.length;n.ecsSettings&&Object.keys(n.ecsSettings).filter(function(e){return"boolean"==typeof n.ecsSettings[e]&&e.substr(0,r)===i}).forEach(function(e){return a[e.substr(r)]=n.ecsSettings[e]}),t.ecsSettings=JSON.stringify(a)}}return t}function u(e,t){return e?JSON.stringify(function(e,t){var n,i;try{var r=Object(a.__assign)({disableUrlOverrides:!1},t).disableUrlOverrides,o=JSON.parse(e),c=null==o?void 0:o.MicrosoftSearch;!r&&(c=m("ecsSbOverrides","wipeSbEcsConfig",c)),c=function(e){var t=f(e,"searchBoxPluginConfiguration.",function(e,t){return{id:"searchux.searchBoxPlugin."+e.split(".")[1],position:_(t)}}),n=f(e,"suggestionProviderGroups.",function(e,t){return{id:e.split(".")[1],optimalCount:t.optimalCount,maxCount:t.maxCount,component:t.component,ariaLabel:t.ariaLabel,heading:t.heading,providers:p(t)}});return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},e),{searchBoxPluginConfiguration:{plugins:t}}),{searchBoxSuggestionProviderConfiguration:{groups:n,streamPolicy:e["searchux.suggestionGroupStreamPolicy"]}})}(c);var d=null===(n=null==o?void 0:o.Headers)||void 0===n?void 0:n.ETag;return{ecsSettings:c,ecsConfigIds:[null===(i=null==o?void 0:o.ConfigIDs)||void 0===i?void 0:i.MicrosoftSearch],ecsEtag:d}}catch(e){Object(s.throwSafeToLogError)("Failed to parse ECS config")}}(e,t)):""}function f(e,t,n){return Object.keys(e).filter(function(n){return n.indexOf(t)>-1&&e[n]}).sort(function(t,n){return _(e[t])-_(e[n])}).map(function(t){try{return n(t,e[t])}catch(e){Object(r.getDispatcher)().dispatch({name:"generic_error",nameDetail:"ecsUtils.convertSettingsWithKeyToArray",eventType:"ERROR",detail:"Mapper failed on key: "+t})}}).filter(function(e){return e})}function p(e){return f(e,"providers.",function(e){return"searchux.suggestionProvider.provider."+e.split(".")[1]})}function m(e,t,n){var a=Object(o.getQueryStringValue)(t);a&&"true"===a.toLowerCase()&&(n={});var i=decodeURIComponent(Object(o.getQueryStringValue)(e));return i?b(n,JSON.parse(i)):n}function _(e){var t;return null!==(t=e.position)&&void 0!==t?t:Number.MAX_VALUE}function h(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}function b(e,t){if(!h(e))return e;var n=Object(a.__assign)({},e);return h(t)&&Object.keys(t).forEach(function(a){h(t[a])?n[a]=a in e?b(e[a],t[a]):t[a]:n[a]=t[a]}),n}},"te/z":function(e,t,n){"use strict";n.r(t),n.d(t,"substrateIframeProxy",function(){return m}),n.d(t,"getIframeProxy",function(){return b}),n.d(t,"sendSubstrateRequest",function(){return v}),n.d(t,"parseDiagnostics",function(){return S}),n.d(t,"parser",function(){return D});var a=n("17wl"),i=n("m//X"),r=function(e,t,n,a){return new Promise(function(i,r){return o(function o(c){if(c.source===e&&c.origin===t){var d=void 0,l=!1;try{d=n(c)}catch(e){return s(o),void r(e)}try{l=a(d,c)}catch(e){return s(o),void r(e)}l&&(s(o),i(d))}})})},o=function(e){return addEventListener("message",e,!1)},s=function(e){return removeEventListener("message",e,!1)},c=n("hjpC"),d=n("o6FS"),l="https://substrate.office.com",u={},f={},p={};function m(e){return void 0===e&&(e=l),e=Object(d.e)(e),void 0===f[e]&&(f[e]=h(e).ready),f[e].then(function(){return p[e]=!0,function(t){return y(t,e)}})}var _="ms-searchux-3s-proxy";function h(e){return u[e]?u[e]:b((t=window).mssearchux&&t.mssearchux.reuseIframe||!1,e+"/search/api/v2/resources",e);var t}function b(e,t,n){if(e){var a=document.getElementById(_),i=function(e,t){return e&&e.src===t&&e.ready&&e.postMessage?{postMessage:e.postMessage,iframe:e,ready:e.ready,initialize:function(){return e}}:null}(a,t);u[n]=i||g(!a,t,n)}else u[n]=g(!1,t,n);return u[n]}function g(e,t,n){var i=function(e,t){var n=document.createElement("iframe");return{iframe:n,initialize:function(){return document.body.contains(n)||(n.src=e,n.style.display="none",document.body.appendChild(n)),n},postMessage:function(a,i,o){var s=function(e,a){return r(n.contentWindow,t,e,a)}(i,o);return n.contentWindow&&n.contentWindow.postMessage(a,e),s}}}(t,n),o=i.initialize(),s=r(o.contentWindow,n,function(e){return e.data},function(e){return"loaded"===e});return e&&(o.id=_,o.postMessage=i.postMessage,o.ready=s),Object(a.__assign)(Object(a.__assign)({},i),{ready:s})}var v=function(e,t){return void 0===t&&(t=l),t=Object(d.e)(t),p[t]?y(e,t):m(t).then(function(t){return t(e)})};function y(e,t){var n=Object(i.e)(),a=e.action,r=e.token,o=e.prefix,s=e.cvid,c=e.additionalInfo,d=e.headers;return h(t).postMessage(JSON.stringify({requestId:n,action:a,token:r,prefix:o,cvid:s,additionalInfo:c,headers:d}),D,function(e){return e.requestId===n})}function S(e){var t=JSON.parse(e)[0];return t.name,Object(a.__rest)(t,["name"])}function D(e){try{return JSON.parse(e.data)}catch(e){return Object(c.throwSafeToLogError)("Failed to parse substrate API JSON response.")}}},uVZz:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var a=n("BzbU");function i(e,t){return Object(a.e)({monitorType:"chunk_load",monitorName:"".concat(e,"_chunk_load"),monitorOnce:!0,samplingOptions:{sampleRate:.1}},t)}},"wYV+":function(e,t,n){"use strict";n.r(t);var a=n("2xJV"),i=n("yb5F"),r=n("xbJB");t.default=function(e){return Object(r.e)({monitorName:"bing-consumer-prefetch"},Object(i.e)(function(e){var t=e.url;return Object(a.e)({url:t,method:"GET",withCredentials:!0}).then(function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}})})({cacheId:"bing-consumer-prefetch",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return{query:e.searchText}}}))(e)}},xbJB:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n("17wl"),i=n("WSFI"),r=n("BzbU");function o(e,t){var n=e.monitorName,i=e.monitorType,o=void 0===i?"prefetch_request":i,c=e.additionalSuccessPropsExtractor,d=e.additionalFailurePropsExtractor;return Object(r.e)({monitorName:n,monitorType:o,successPropExtractor:function(e){var t=e.xhr,n=e.tokenAttemptCount,i=e.tokenFetchDuration,r=e.cacheItemResolved,o=e.cacheItemType;return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},s(t)),n?{tokenAttemptCount:n,tokenFetchDuration:Math.round(i)}:{}),{cacheItemResolved:r,cacheItemType:o}),null==c?void 0:c(t))},failurePropExtractor:function(e){var t;return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},null==d?void 0:d(e)),s(e)),{errorCode:null===(t=e.status)||void 0===t?void 0:t.toString()})}},function(e){return void 0===e?Promise.reject("undefined options"):t(e)})}function s(e){if(!e||!e.getAllResponseHeaders)return{};var t=Object(i.getNamedHeadersFromXhr)(e,[i.spRequestDurationHeader,i.spClientServiceRequestDurationHeader,i.sharePointCorrelationHeader]),n={};return n[i.sharePointCorrelationHeader]=t[i.sharePointCorrelationHeader],n[i.spRequestDurationHeader]=t[i.spRequestDurationHeader]||t[i.spClientServiceRequestDurationHeader]||void 0,n}},yb5F:function(e,t,n){"use strict";n.d(t,"e",function(){return y});var a,i=n("17wl"),r=n("n1Yx"),o=n("O/vF"),s="StorageCache",c=!1,d=!1;function l(e,t,n){var a;p(n);var i=u();try{var o=i.getItem(e);if(!o)return null;a=JSON.parse(o)}catch(e){return!c&&Object(r.getDispatcher)().dispatch({eventType:"ERROR",name:s,detail:"Failed to read from storage."}),c=!0,null}return a?a.cacheVersion!==t?(i.removeItem(e),null):a.puid&&a.puid===n?a:(i.removeItem(e),null):null}var u=function(){return a||(a={getItem:function(e){return sessionStorage.getItem(f(e))},removeItem:function(e){return sessionStorage.removeItem(f(e))},setItem:function(e,t){return sessionStorage.setItem(f(e),t)}})};function f(e){return"mssearchux-cache-".concat(e)}function p(e){!e&&Object(o.e)("Puid not set.")}function m(e,t,n){var a=l(e,t,n);if(!a)return null;var i=a.cacheItems;return Object.keys(i).reduce(function(e,t){return e[t]={value:Promise.resolve({xhr:{responseText:i[t].value,status:i[t].status||0}}),expiryTime:i[t].expiryTime,cacheItemType:"storage",cacheItemResolved:!0},e},{})}function _(e,t){return e.cacheItems[t]=null}var h=function(e,t,n){return e[t]=n};function b(e){return"object"==typeof e&&null!==e}var g=n("wxe1"),v=n("/ZMv");function y(e){return function(t){var n=t.cacheId,a=t.cacheVersion,i=t.cacheItemLifetime,r=t.cacheKeyExtractor,o=t.forceRefresh;return function(t){var s=t.prefetchCacheCollection||I,c=r(function(e){return Object.keys(e).reduce(function(t,n){return n.length>S.length&&0===n.indexOf(S)||(t[n]=e[n]),t},{})}(t))||{},d=function(e){if(!b(e))throw new Error("Key argument must be an object.");for(var t=Object.keys(e).sort(),n=t.length,a=[],i=0;i<n;i++){var r=t[i],o=e[r];void 0===o||b(o)||"function"==typeof o||a.push(r+":"+o)}return a.join(",")}(c),l=(null==o?void 0:o())?"setItem":"getItem";return s.bind({cacheConsumer:D,cacheId:n,cacheVersion:a,cacheItemLifetime:i,userInfoPuid:t.prefetchUserInfoPuid||Object(g.puid)()}).operation(l,d,function(){return e(t)})}}}var S="prefetch",D={packageName:"@1js/search-prefetch",packageVersion:v.e},I={bind:function(e){return t=Object(g.cache)().caches,a=(n=e).cacheId,o=n.cacheVersion,c=n.cacheItemLifetime,f=n.userInfoPuid,{operation:function(e,n,b){var g=function(e,t,n,a){p(a);var i=e[t];return i&&i.puid!==a&&(i=null),i||(e[t]={puid:a,cacheItems:m(t,n,a)||{}})}(t,a,o,f);return"setItem"!==e&&function(e,t){var n=e.cacheItems[t];if(n){if(Date.now()<n.expiryTime)return n.value.then(function(e){return Object(i.__assign)(Object(i.__assign)({},e),{cacheItemType:n.cacheItemType,cacheItemResolved:n.cacheItemResolved,expiryTime:n.expiryTime})});_(e,t)}return null}(g,n)||function(e,t,n,a,o){var c=t.cacheId,f=t.cacheVersion,m=t.cacheItemLifetime;p(n);var b=e.cacheItems,g=h(b,o,{value:a,expiryTime:Date.now()+m,cacheItemType:"memory",cacheItemResolved:!1});return a.then(function(e){return h(b,o,Object(i.__assign)(Object(i.__assign)({},g),{cacheItemResolved:!0})),function(e,t,n,a,i,o,c){p(n);var f=l(e,t,n)||{cacheCreationTime:Date.now(),cacheVersion:t,puid:n,cacheItems:{}};f.cacheItems[a]={value:i,expiryTime:o,status:c};try{u().setItem(e,JSON.stringify(f))}catch(t){!d&&Object(r.getDispatcher)().dispatch({eventType:"ERROR",name:s,nameDetail:e,detail:"Failed to write to session storage."}),d=!0}}(c,f,n,o,e.xhr.responseText,g.expiryTime,e.xhr.status),Object(i.__assign)(Object(i.__assign)({},e),{cacheItemResolved:!1,cacheItemType:null,expiryTime:g.expiryTime})},function(t){throw _(e,o),t})}(g,{cacheId:a,cacheVersion:o,cacheItemLifetime:c},f,b(),n)}};var t,n,a,o,c,f}}},z3ty:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e.SearchComponent="X-MSSearchComponent",e.SearchScenario="X-MSSearchScenario",e.VerticalsCacheClear="X-Cache-Mode"}(a||(a={}))}}]);