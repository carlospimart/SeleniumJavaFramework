(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["cpl-host~cpl-invoker~cpl-no-submit~stream"],{"3c19":function(e,t,r){"use strict";r.d(t,"a",function(){return Ie}),r.d(t,"b",function(){return Te});var n=r("D57K"),o=r("NeXG"),i=r("UlRC"),a=r("HSwa"),s=r("grEz"),c=r("3twC");var u=r("W4Bk"),p=r("wAGM"),l=r("Ak5F"),d=r("D7WJ"),g=r("ljXs"),h=r("NQus"),f=r("w9Rb"),m=r("4zpW"),v=r("cDcd"),b=r("zH9T"),S=r("pgot"),y=r("QlCf"),O=r("PS6g"),_=r("GIWw"),j=r("LyZa"),E=r("02QY"),x=Object(E.a)(function(e){void 0===e&&(e=O.b);var t=e.themeStyles,r=e.componentStyles.PanelHeader,o=O.a.SuggestionPanel;return Object(j.b)({group:{display:"block",listStyleType:"none",margin:0,padding:"".concat(o.paddingTop," 0 ").concat(o.paddingBottom," 0"),background:t.palette.white,color:t.palette.neutralPrimary,fontSize:t.fonts.medium.fontSize,fontWeight:t.fonts.medium.fontWeight,borderBottomStyle:"solid",borderBottomWidth:o.borderBottomWidth,borderBottomColor:t.palette.neutralLight},metaInfo:Object(y.a)().offScreen,selectedItem:{selectors:{'[data-nav="true"]':{background:t.palette.neutralLighter}}},horizontalLine:{borderBottom:"".concat(t.palette.neutralLight," 1px solid")},groupTitle:Object(n.__assign)(Object(n.__assign)({fontFamily:_.a,margin:"0 0 ".concat(o.marginBottom," 0"),padding:"".concat(r.paddingTop," 0 ").concat(r.paddingBottom," ").concat(r.paddingLeft),display:"table-cell",verticalAlign:"middle"},r),{selectors:{"&:empty":{position:"absolute",left:"-100vw",top:"-100vh"}}})})});var I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,o=t.groups,i=t.fetchStartTime,a=t.activatedTime,s=t.inputTime,c=t.searchText,p=t.searchSuggestionFactory,l=t.conversation,f=t.instrumenter,m=t.theme,y=t.searchBox,O=function(e){return Object(S.a)()&&e?x(e):r("7p0W")}(m),_=function(e){return e.filter(function(e){return e.suggestions&&e.suggestions.length})}(o),j=this.impression=function(e,t,r,n,o,i,a){var s=n?n.getLogicalSearchId("sb"):Object(u.a)();return Object(b.a)(e,Object(h.a)(t),s,n&&n.conversationId||"",r.reduce(function(e,t){var r=t.suggestions;return e.concat(r.map(function(t,r){var n=t.providerId,o=t.emitTime,i=t.groupId,a=t.logProps,c=t.originalLogicalSearchId,u=t.entityType;return{pos:e.length+r,emitTime:o,groupId:i,providerId:n,delayTime:Object(d.a)()-o,fromCache:void 0!==c&&c!==s,entityId:a&&a.entityId||"",traceId:a&&a.traceId||"",originalLogicalSearchId:c||"",entityType:u}}))},[]),o,i,a)}(i,c,_,l,f,a,s),E=0;return v.createElement(v.Fragment,null,_.map(function(t,r){var o=t.ariaLabel||t.heading,i="history"===t.id&&1===_.length,a=!("querySuggestion"===t.id&&0===r),s=o?"gh_".concat(t.id,"_").concat(Object(g.a)()):void 0,c=i?"div":"li",u=t.suggestions.map(function(r,o){return v.createElement(c,{role:"presentation",className:e.props.indicateFirstItemAsSelected&&0===E?O.selectedItem:void 0,key:"".concat(r.id,"(").concat(r.searchText,")"),"data-suggestion-position":E},p(t.id,Object(n.__assign)(Object(n.__assign)({searchBox:y},r),{logProps:Object(n.__assign)(Object(n.__assign)({},r.logProps),{position:String(E),groupPosition:String(o)}),theme:m,onClick:w(e,j,E++,r.onClick,r.logProps||{})})))});return v.createElement(R,{key:t.id,groupId:t.id},i?u:v.createElement("ul",{role:"group",className:O.group+("bestMatch"===t.id?" "+O.horizontalLine:""),id:t.id,"aria-labelledby":s},o&&a&&v.createElement("li",{role:"presentation","aria-label":t.ariaLabel,id:s,className:O.groupTitle},t.heading),u))}))},t.prototype.componentDidMount=function(){this.dispatchImpressionAfterDelay(this.impression)},t.prototype.componentDidUpdate=function(){this.dispatchImpressionAfterDelay(this.impression)},t.prototype.componentWillUnmount=function(){this.dispatchImpressionAfterDelay(this.impression,0)},t.prototype.dispatchImpressionAfterDelay=function(e,t){void 0===t&&(t=1e3),e&&(clearTimeout(this.cancellationToken),t?this.cancellationToken=window.setTimeout(function(){return e.dispatch()},t):e.dispatch())},t=Object(n.__decorate)([Object(p.a)("GroupedSearchSuggestions")],t)}(v.Component),T=I;function w(e,t,r,o,i){return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var c=t.items[r],u=c.groupId,p=c.providerId,l=c.entityType;return e.dispatchImpressionAfterDelay(t,0),Object(f.a)(C(e.context),Object(n.__assign)({impressionId:t.logicalSearchId,conversationId:t.conversationId,pos:r,groupId:u,providerId:p,entityType:l},i)),"function"==typeof o&&o.apply(void 0,Object(n.__spreadArray)([],Object(n.__read)(a),!1))}}var D=I,C=Object(m.a)(D,"onImpressionItemClicked"),k={},R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasError:!1},t}return Object(n.__extends)(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(){k[this.props.groupId]||(k[this.props.groupId]=!0,Object(l.a)({eventType:"ERROR",name:"SUGGESTION_GROUP_RENDER_ERROR",detail:'Suggestion group with id "'.concat(this.props.groupId,'" failed to render.')}))},t.prototype.render=function(){return this.state.hasError?null:this.props.children},t}(v.Component),P=r("1Qxi"),L=r("CCsL"),A=r("TT9s"),B=r("mkze"),N=r("nbvZ"),F=function(){function e(e,t,r){if(this.config=e,this.groupConfig=t,!t.providers)throw new Error("Search box suggestion type configuration must contain a list of providers.");if(this.providerInstances=t.providers.map(function(o){return Object(B.a)(o,Object(n.__assign)(Object(n.__assign)({},r),{config:e,groupConfig:t,rxjs:i}))}),!this.providerInstances.every(function(e){return U(e.getId)&&U(e.createStream)}))throw new Error("Suggestion providers must implement methods getId and createStream.")}return e.prototype.createStream=function(e){for(var t=[],r=[],o=this.providerInstances,a=this.groupConfig.id,s=0;s<o.length;s++)!function(o){try{var s=o.getId();r.push(o.createStream(e).select(function(e){return Object(n.__assign)(Object(n.__assign)({},e),{emitTime:Object(d.a)(),groupId:a,providerId:s})}).catchException(function(e){var r;return N.a.DEBUG_SB_PROVIDER&&(null===(r=null===console||void 0===console?void 0:console.error)||void 0===r||r.call(console,"In provider:",s,e)),t.push(W(s,e)),i.Observable.empty()}))}catch(e){t.push(W(o.getId(),e))}}(o[s]);return r.push(i.Observable.defer(function(){return t.length?i.Observable.throwException(G(a,t)):i.Observable.empty()})),Object.freeze(r)},e}(),W=function(e,t){var r=new Error('Error in suggestion provider "'.concat(e,'". See inner error for details.'));return r.providerId=e,r.innerError=t,r},G=function(e,t){var r=new Error('Error in suggestion provider group "'.concat(e,'". See inner error for details.'));return r.providerGroupId=e,r.innerErrors=t,r};function U(e){return"function"==typeof e}var z=function(e){return e.id},J=r("rP0q");i.Observable.prototype.debounce=function(e,t,r){void 0===t&&(t=!1);i.helpers.isScheduler(r)||(r=i.Scheduler.timeout);var n=this;return new i.AnonymousObservable(function(o){var a,s=new i.SerialDisposable,c=!1,u=0,p=n.subscribe(function(t){c=!0,a=t;var n=++u,p=new i.SingleAssignmentDisposable;s.setDisposable(p),p.setDisposable(r.scheduleWithRelative(e,function(){c&&u===n&&o.onNext(a),c=!1}))},function(e){s.dispose(),t&&c&&o.onNext(a),o.onError(e),c=!1,u++},function(){s.dispose(),c&&o.onNext(a),o.onCompleted(),c=!1,u++});return new i.CompositeDisposable(p,s)})};r("PWby");var M=r("1aPi"),H=r("unnZ"),Q=r("Ei9s"),q=r("DCIk"),Z=r("hTSy"),V=r("d9YH"),X=r("PtyX"),Y=r("UkL6"),K=r("bSTi"),$=Object(K.a)(function(e){var t=(null==e?void 0:e.document)||document,r=t.createElement("div");return r.setAttribute("aria-live","polite"),r.style.position="absolute",r.style.left="-999em",r.style.top="0em",t.body.appendChild(r),r}),ee=r("SEb4");function te(e){return"innerErrors"in e&&Object(ee.a)(e.innerErrors)?(t=e.innerErrors,{message:(r=t.reduce(function(e,t){var r=e.message,o=e.groups,i=e.providers,a=t.providerGroupId,s=t.innerErrors;return{message:r,groups:Object(n.__spreadArray)(Object(n.__spreadArray)([],Object(n.__read)(o),!1),[a],!1),providers:Object(n.__spreadArray)(Object(n.__spreadArray)([],Object(n.__read)(i),!1),Object(n.__read)(s.map(function(e){return e.providerId})),!1)}},{message:"Expected suggestion stream error.",groups:[],providers:[]})).message,groups:JSON.stringify(r.groups),providers:JSON.stringify(r.providers)}):{message:"Unexpected suggestion stream error."};var t,r}var re=r("deeS"),ne=r("n5ha"),oe=r("cQB/"),ie=r("6e3C"),ae=r("CNHu"),se="||",ce="::",ue=",",pe=["->","–>","-","–"],le="INF",de="*",ge=/^\d+$/;function he(e){var t=Object(oe.a)(pe,function(t){return e.indexOf(t)>=0}),r=t?e.split(t).map(function(e){return e.trim()}):[e.trim()];if(1===r.length){var n=r[0];if(Object(ie.d)(n,de)){var o=n.substring(de.length);return o.match(ge)?function(e){return Object(ie.a)(e.toString(),o)}:null}return n.match(ge)?function(e){return e.toString()===n}:null}if(2===r.length){if(!r[0].match(ge))return null;var i=parseInt(r[0],10);if(isNaN(i))return null;if(r[1]===le)return function(e){return e>=i};if(!r[1].match(ge))return null;var a=parseInt(r[1],10);return isNaN(a)?null:function(e){return e>=i&&e<a}}return null}function fe(e,t){var r,o,i,a,s=function(t){throw new Error('pluralized string "'.concat(e,'" ').concat(t))};try{for(var c=Object(n.__values)(e.split(se)),u=c.next();!u.done;u=c.next()){var p=u.value,l=p.split(ce);2!==l.length&&s("is missing separator ".concat(ce,' in clause "').concat(p,'"'));var d=Object(n.__read)(l,2),g=d[0],h=d[1];try{for(var f=(i=void 0,Object(n.__values)(g.split(ue))),m=f.next();!m.done;m=f.next()){var v=m.value,b=he(v);if(null===b)s('contains invalid range "'.concat(v,'"'));else if(!t(h,b))return}}catch(e){i={error:e}}finally{try{m&&!m.done&&(a=f.return)&&a.call(f)}finally{if(i)throw i.error}}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}}function me(e,t){if(void 0===t)return e;try{return function(e,t){if(t<0||t!==1/0&&!Object(ae.a)(t))throw new Error("count must be a positive integer or Infinity");var r="";return fe(e,function(e,n){return!n(t)||(r=e,!1)}),r}(e,t)}catch(t){return e}}var ve=(Object(ne.declareStringWithPlaceholders)("search-box-container-plugins.searchux.strings.GroupedSearchSuggestions.suggestionsAvailable")),be=function(e){var t=e.suggestionCount;return me(ve({suggestionCount:t}),parseInt(t,0))},Se=(Object(ne.declareStringWithPlaceholders)("search-box-container-plugins.searchux.strings.GroupedSearchSuggestions.suggestionsAvailableForQueryIntervals")),ye=function(e){var t=e.suggestionCount,r=e.searchText;return me(Se({suggestionCount:t,searchText:r}),parseInt(t,0))},Oe=(Object(ne.declareStringWithPlaceholders)("search-box-container-plugins.searchux.strings.GroupedSearchSuggestions.numSuggestionsInGroup")),_e=(Object(ne.declareString)("search-box-container-plugins.searchux.strings.GroupedSearchSuggestions.unnamedGroup")),je=Object(K.a)(l.a);var Ee=Object(K.a)(l.a),xe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasError:!1},t}return Object(n.__extends)(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(){Ee({eventType:"ERROR",name:"SUGGESTIONS_RENDER_ERROR",detail:"Suggestions failed to render."})},t.prototype.render=function(){return this.state.hasError?null:v.createElement(v.Suspense,{fallback:null},this.props.children)},t}(v.Component),Ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.resources=new i.CompositeDisposable,t.suggestionsContainer=null,t.virtualFocusManager=null,t.debouncedFetchSuggestions=Object(M.a)(t.fetchSuggestions,t.props.debounceStream||0),t}return Object(n.__extends)(t,e),t.prototype.registerRefetchListener=function(){var e=this,t=this.props.updateSearchBoxListener;this.searchBoxListenerToken=null==t?void 0:t.register(function(){return e.fetchSuggestionsBasedOnDebounceStream(e.props)})},t.prototype.UNSAFE_componentWillMount=function(){this.fetchSuggestionsBasedOnDebounceStream(this.props),$(this.props.hostWindow||window),this.registerRefetchListener()},t.prototype.fetchSuggestions=function(e){var t=this;if(e.configuration){var r=this.props.instrumenter,n=Object(re.a)(e);n&&n.createLogicalSearchId("sb");var o=e&&e.searchText||"",a=Object(h.a)(o);r&&r.setProps({searchTextCharacteristics:a});var s=this,c=Object(d.a)(),u=!1;this.setState({error:null,allComplete:!1}),this.resources.dispose(),this.resources=new i.CompositeDisposable;var p=this.getDependencies(e.configuration),l=e.configuration,g=Te(l,Object(H.a)(p,p.map(function(t){return e[t]})),e.searchText||"","suggestion_stream","suggestion_provider_host");e.debounceStream&&(g=g.debounce(0,!0)),this.resources.add(g.subscribe(function(r){return u=!0,t.setState({data:{configuration:l,groups:r,fetchStartTime:c,activatedTime:e.activatedTime,inputTime:e.inputTime}})},function(r){t.setState({error:r}),f();try{e.onError&&e.onError(r)}catch(e){}},f))}function f(){var t,r;u||s.setState({data:{configuration:l,groups:[],fetchStartTime:c,activatedTime:e.activatedTime,inputTime:e.inputTime}}),function(e,t,r){try{var n=0,o=null==r?void 0:r.map(function(e){var t=e.suggestions.length;return n+=t,Oe({count:t.toString(),group:e.title||e.heading||e.ariaLabel||_e()})}).join(", "),i=t?ye({suggestionCount:n.toString(),searchText:t}):be({suggestionCount:n.toString()});e.innerText="",e.innerText=i+o}catch(e){je({eventType:"ERROR",name:"SUGGESTIONS_ARIALIVE_ERROR",detail:"Suggestions failed to create aria live region"})}}($(e.hostWindow||window),o,null===(r=null===(t=s.state)||void 0===t?void 0:t.data)||void 0===r?void 0:r.groups)}},t.prototype.componentDidUpdate=function(){var e,t,r=null===(e=this.suggestionsContainer)||void 0===e?void 0:e.querySelector("[".concat(a.a,"='true']"));r&&(null===(t=this.virtualFocusManager)||void 0===t||t.setActive(r,!0))},t.prototype.getDependencies=function(e){var t,r,n,o=e.groups;return t=Object(Q.a)(o.map(function(e){return e.providers})),r=[],n={},t.forEach(function(e){(e.__parameters||[]).forEach(function(e){var t=e.name;n[t]||(n[t]=!0,r.push(t))})}),r},t.prototype.render=function(){var e=this,t=this.props.errorComponent;if(!this.state)return null;var r=this.state.data,n=(this.props.hostWindow||window).document;return v.createElement(s.a.Consumer,null,function(o){e.virtualFocusManager=o;var i=r&&v.createElement(T,{fetchStartTime:r.fetchStartTime,activatedTime:r.activatedTime,inputTime:r.inputTime,groups:r.groups.slice(0),searchText:e.props.searchText||"",conversation:Object(re.a)(e.props),instrumenter:e.props.instrumenter,searchSuggestionFactory:we(r.configuration).suggestionFactory,theme:e.props.theme?e.props.theme:O.b,indicateFirstItemAsSelected:e.props.invokeSuggestionOnSubmit});return v.createElement(xe,null,v.createElement(v.Fragment,null,e.props.invokeSuggestionOnSubmit&&!e.props.noSubmit?v.createElement("button",{hidden:!0,onClick:function(t){var r;t.preventDefault();var o=n.querySelector("#"+e.props.searchBoxPopupId),i=o&&o.querySelector("[data-suggestion-position='0'] [data-nav='true']");null===(r=null==i?void 0:i.click)||void 0===r||r.call(i)}}):null,e.props.noSubmit&&v.createElement("button",{hidden:!0,onClick:function(e){return e.preventDefault(),e.stopPropagation()}}),(null==r?void 0:r.groups)&&(null==r?void 0:r.groups.length)>0?v.createElement("div",{ref:function(t){return e.suggestionsContainer=t}},i):i,e.state.error&&t?v.createElement(t,{error:e.state.error}):null))})},t.prototype.fetchSuggestionsBasedOnDebounceStream=function(e){var t=e&&e.searchText||"";this.props.debounceStream&&t.length>0?this.debouncedFetchSuggestions(e):this.fetchSuggestions(e)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.relevantPropsChanged(e)&&this.fetchSuggestionsBasedOnDebounceStream(e)},t.prototype.relevantPropsChanged=function(e){var t,r=this;return e.searchText!==this.props.searchText||e.configuration!==this.props.configuration||(t=e.configuration?r.getDependencies(e.configuration):[],!Object(q.a)(Object(Z.a)(r.props,t),Object(Z.a)(e,t)))},t.prototype.componentWillUnmount=function(){var e;this.resources.dispose(),$(this.props.hostWindow||window).innerText="",this.searchBoxListenerToken&&(null===(e=this.props.updateSearchBoxListener)||void 0===e||e.unregister(this.searchBoxListenerToken),this.searchBoxListenerToken=void 0)},t.defaultProps={onError:V.a,errorComponent:function(){return v.createElement("div",null)}},t=Object(n.__decorate)([J.a],t)}(v.Component);t.c=Object(c.a)("suggestion","BasicSuggestionProviderHost")(function(e){return v.createElement(Ie,Object(n.__assign)({},e))});function Te(e,t,r,o,a){return function(e,t,r){if(!e)throw new Error("Search box configuration must be specified.");var n=e.streamPolicy,o=e.groups,a=o.map(function(n){return new F(e,n,t).createStream(r)}),s=a.map(function(e){return e.slice(0,e.length-1)}),c=i.Observable.fromArray(Object(P.a)(a.map(function(e){return Object(L.a)(e)}))).selectMany(function(e){return e.catchException(function(e){return i.Observable.returnValue(e)})}).toArray().where(function(e){return!!e.length}).select(function(e){throw Object(A.a)(new Error("Suggestion stream error. See inner errors for details."),{innerErrors:e})});return(n(o,z,s,i,{searchText:r})||i.Observable.empty()).concat(c)}(e,t,r).select(function(t){return t.map(function(t){return Object(n.__assign)(Object(n.__assign)({},t),we(e).stringsIndex[t.id])})}).monitor({eventName:o,nameDetail:a,isHot:!1},void 0,te)}var we=Object(o.a)(function(e){var t=e.groups,r=Object(X.a)(Object(Y.a)(t.map(function(e){return{id:e.id,component:e.component}}),De),function(e){return e[0]});return{stringsIndex:Object(X.a)(Object(Y.a)(t.map(function(e){return{id:e.id,heading:e.heading,ariaLabel:e.ariaLabel}}),function(e){return e.id}),function(e){return e[0]}),suggestionFactory:function(e,t){var o=r[e].component;return v.createElement(o,Object(n.__assign)({},t))}}});function De(e){return e.id}},"7p0W":function(e,t,r){var n=r("EiT2"),o=r("LdDo");"string"==typeof n&&(n=[[e.i,n]]);for(var i=0;i<n.length;i++)o.loadStyles(n[i][1],!1);n.locals&&(e.exports=n.locals)},EiT2:function(e,t,r){(t=e.exports=r("RDo7")(!1)).push([e.i,'._2iF_EPp8{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}._1Dlewp4k{display:block;list-style-type:none;font-size:14px;font-weight:400;color:"[theme:neutralPrimary, default: #333333]"}html[dir] ._1Dlewp4k{margin:0;padding:3px 0 12px;border-bottom:1px solid "[theme:neutrallight, default: #eaeaea]";background:"[theme:white, default: #ffffff]"}html[dir] .dZduCJin [data-nav=true]{background:"[theme:neutralLighter, default: #f4f4f4]"}.JpvkDkU4{line-height:1.1em}html[dir] .JpvkDkU4{padding:1.1em 18px .4em;margin:0 0 .2em}.JpvkDkU4:empty{position:absolute;top:-100vh}html[dir=ltr] .JpvkDkU4:empty{left:-100vw}html[dir=rtl] .JpvkDkU4:empty{right:-100vw}',""]),t.locals={metaInfo:"_2iF_EPp8",group:"_1Dlewp4k",selectedItem:"dZduCJin",groupTitle:"JpvkDkU4"}}}]);