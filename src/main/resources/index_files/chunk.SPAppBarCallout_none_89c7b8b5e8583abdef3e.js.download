(window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0=window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0||[]).push([[6],{"2pHE":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("17wl"),i=n("K9kD"),r=function(e){function t(t){var n=e.call(this,{dataSourceName:"RecentFilesGraphDataSource",id:"RecentFilesGraphDataSource"},{pageContext:t})||this;return n._parseFilesResponse=function(e,t){var r,o;if(e){var s,c=!1;n._isCachedResultWithStatistic(e)?(s=e.data,c=!0):s=e;var d=null===(o=null===(r=null==s?void 0:s.data)||void 0===r?void 0:r.me)||void 0===o?void 0:o.recent;if(null!=d){if(!d||0===d.length)return t?{data:[],cacheStats:{lastModified:Date.now(),lastRead:Date.now(),reads:0}}:[];d=n._sortByAccessTime(d.filter(function(e){var t,n=e.remoteItem;return n.name&&(null===(t=n.sharepointIds)||void 0===t?void 0:t.siteUrl)&&(i.Killswitch.isActivated("7c90522e-4460-4492-9407-5e098008f98c","5/17/2021","switch to oneup view")?n.webUrl:n.webDavUrl)}));var l=null==d?void 0:d.slice(0,n._maxNumber).map(function(e){var t,n,r,o,s,c,d=e.remoteItem,l=null,u=d.name;if("oneNote"===(null===(t=d.package)||void 0===t?void 0:t.type))s="one",c=u;else{var f=u.lastIndexOf(".");s=u.substr(f+1),c=u.substr(0,f)}var p=d.sharepointIds.siteUrl,m=document.createElement("a");if(m.href=d.webDavUrl,"documentLibrary"===d.parentReference.driveType){var _=p.substr(p.lastIndexOf("/")+1);p=null===(n=d.webDavUrl)||void 0===n?void 0:n.substr(0,d.webDavUrl.lastIndexOf("/"));var h=m.pathname,b=h.substr(h.indexOf(_)+_.length+1),g=decodeURI(b).split("/");g.pop(),l=g.length>=3?"".concat(_," > ... > ").concat(g[g.length-1]):Object(a.__spreadArray)([_],g,!0).join(" > ")}else{var v=null===(o=null===(r=d.createdBy)||void 0===r?void 0:r.user)||void 0===o?void 0:o.displayName;l=v&&v.length>0?"OneDrive > ".concat(v):"OneDrive > Documents"}return{name:c,url:i.Killswitch.isActivated("7c90522e-4460-4492-9407-5e098008f98c","5/17/2021","switch to oneup view")?d.webUrl:"".concat(d.webDavUrl,"?web=1"),path:l,extension:s,siteurl:p}});return c?Object(a.__assign)(Object(a.__assign)({},e),{data:l}):l}}},n._sortByAccessTime=function(e){if(!e||e.length<=1)return e;var t=e.length,n={},a=-1;n[t-1]=new Date(e[t-1].remoteItem.fileSystemInfo.lastAccessedDateTime);for(var i=t-2;i>=0;i--){var r=new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime);n[i]=r,r<n[i+1]&&i+1>a&&(a=i+1)}var o=function(t,n,a){if(t===n)return t;if(new Date(e[t].remoteItem.fileSystemInfo.lastAccessedDateTime)<a)return t;if(new Date(e[n].remoteItem.fileSystemInfo.lastAccessedDateTime)>a)return n+1;if(t===n-1)return n;var i=Math.floor((t+n)/2);return new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime)>a?s(i,n,a):s(t,i,a)},s=function(t,n,a){if(t===n)return t;if(t===n-1)return new Date(e[t].remoteItem.fileSystemInfo.lastAccessedDateTime)<a?t:new Date(e[n].remoteItem.fileSystemInfo.lastAccessedDateTime)>a?n+1:n;var i=Math.floor((t+n)/2);return new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime)>a?s(i,n,a):s(t,i,a)},c=[];for(i=0;i<a;i++)c.push(e.shift());for(i=0;i<c.length;i++){var d=o(0,t-a-1+i,new Date(c[i].remoteItem.fileSystemInfo.lastAccessedDateTime));e.splice(d,0,c[i])}return e},n._isCachedResultWithStatistic=function(e){return!!e.cacheStats},n._recentFilesGraphCacheKey="recentFiles"+"_".concat(t.aadUserId),n.pageContext=t,n}return Object(a.__extends)(t,e),t.prototype.getRecentFiles=function(e){var t=this;return this._maxNumber=e.maxItems,this.getDataUtilizingPersistentCache({url:"".concat(this.pageContext.webAbsoluteUrl,"/_api/v2.1/graphql"),qosName:"RecentFilesGraph",method:"POST",contentType:"application/graphql",additionalPostData:"{ me { recent { remoteItem { name webUrl webDavUrl parentReference { driveType } package { type } sharepointIds { siteUrl } fileSystemInfo { lastAccessedDateTime } createdBy { user { displayName } } } } } }",cachingStrategy:e.cachingStrategy,cacheRequestKey:this._recentFilesGraphCacheKey+"recent",cacheTimeoutTime:e.cacheTimeoutTime?e.cacheTimeoutTime:864e5,returnStatistics:e.returnStatistics}).then(function(n){return t._parseFilesResponse(n,e.returnStatistics)})},t}(n("1tKF").e)},"7TtU":function(e,t,n){"use strict";n.d(t,"s",function(){return i}),n.d(t,"o",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"f",function(){return s}),n.d(t,"l",function(){return c}),n.d(t,"i",function(){return d}),n.d(t,"a",function(){return l}),n.d(t,"r",function(){return u}),n.d(t,"t",function(){return f}),n.d(t,"h",function(){return p}),n.d(t,"p",function(){return m}),n.d(t,"d",function(){return _}),n.d(t,"g",function(){return h}),n.d(t,"c",function(){return b}),n.d(t,"e",function(){return g}),n.d(t,"n",function(){return v}),n.d(t,"m",function(){return y}),n.d(t,"u",function(){return S}),n.d(t,"_",function(){return D});var a=n("K9kD");function i(){return a.Killswitch.isActivated("c92e40dc-3388-4078-a457-9b15495593d2","8/12/2021","window event listener mem leak fix")}function r(){return a.Killswitch.isActivated("51a8f759-b128-40d0-b421-9ce4b0c17463","9/27/2021","Use error boundary for app bar callout")}function o(){return a.Killswitch.isActivated("05b7fa9c-b894-4890-baa4-8276069fb1a0","8/26/2021","error states on token fetch error")}function s(){return a.Killswitch.isActivated("bfe78ae3-ed54-4f77-b63b-e91d3ae8c0ff","11/17/2020","Only send data to parent if exists")}function c(){return a.Killswitch.isActivated("6d98e7d7-9872-469a-86fa-97ed77f8db33","9/23/2021","disable clicks on appbar global nav linkless header")}function d(){return a.Killswitch.isActivated("85f74448-45a0-4763-ab02-25799ac4dd4d","8/30/2021","enable create list button")}function l(){return a.Killswitch.isActivated("9bdd4af2-7e33-4677-ba61-0af00a414830","9/5/2021","enable create doc (word/excel/powerpoint/onenote) button")}function u(){return a.Killswitch.isActivated("BBE926AA-5F1F-46BB-AB13-3F4B316CB6E7","11/01/2021","enable create onenote button")}function f(){return a.Killswitch.isActivated("9c21d0b8-517c-441e-b485-214c11b4e84a","10/22/2021","appbar panel render() cleanup")}function p(){return a.Killswitch.isActivated("0195F261-6BBC-4FB9-B76A-0879F694C13F","11/10/2021","teams componentData variable init fix")}function m(){return a.Killswitch.isActivated("12CAD4FC-9A1B-4B23-BB68-29EA398076DB","11/18/2021","populate followed sites from recent")}function _(){return a.Killswitch.isActivated("5D01CC3F-3248-4A6E-8E7C-409700620DC2","12/01/2021","global nav header text overflow fix")}function h(){return a.Killswitch.isActivated("346D6308-19E9-4818-8115-BEEA8BF0F2B3","11/18/2021","use FirstPublishedDate in getNewsFeed response")}function b(){return a.Killswitch.isActivated("775798BB-FA1B-42F0-94C4-87DAF8C5D1D7","01/05/2022","use lang param and orderby in getNewsFeed request")}function g(){return a.Killswitch.isActivated("5643629B-9946-480C-8350-1A5F94F83451","01/06/2022","appbar data-interception off")}function v(){return a.Killswitch.isActivated("BDE02695-1F9C-43DB-9CE2-6BEEE228C632","02/09/2022","Close app bar panel after btn click")}function y(){return a.Killswitch.isActivated("94DD7E46-1CB4-4B6B-AD62-C8CA0767EC7B","02/09/2022","Prevent closing app bar callout when dialog is open")}function S(){return a.Killswitch.isActivated("612999AE-948C-4B53-A1DF-6F25A70EABA5","02/14/2022","my news author fix")}function D(){return a.Killswitch.isActivated("F063D9B0-7F69-418B-BF7C-A21F8690E273","03/11/2022","respect link target in app bar global nav")}},"7l4e":function(e,t,n){"use strict";n.d(t,"t",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r});var a=function(e,t){return e.replace("spappbarwebpack/spappbarwebpack.js","odsp-media/images/spappbar/".concat(t))},i=function(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp(e+"=([^&]*)").exec(t);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},r=function(e,t,n){return e<768?"lists"===n?3:t?10:5:e<1024?"lists"===n?9:t?15:10:"lists"===n?14:t?20:15}},PltX:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n("17wl"),i=n("1tKF"),r=n("K9kD"),o=function(e){function t(t){var n=e.call(this,{dataSourceName:"SPHomeDataSource",id:"SPHomeDataSource"},{pageContext:t})||this;return n.isMicroserviceToken=function(e){return!!e.access_token},n._isDataSourceParam=function(e){return!!e.spHomeClientContext},n._spHomeCacheKey="spHome"+"_".concat(t.aadUserId),n}return Object(a.__extends)(t,e),t.prototype.getFrequentSites=function(e,t,n,a,i,r,o,s){var c,d;if(void 0===n&&(n=!0),this._isDataSourceParam(e)){var l=e;c=l.spHomeClientContext,t=l.spHomeCachedItem,r=l.returnStatistics,o=l.cachingStrategy,s=l.cacheTimeoutTime}else c=e,o=0,a?o=3:i&&(o=2);return d=(null==c?void 0:c.Urls)&&c.Urls[0]?"".concat(c.Urls[0],"/api/v1/sites/feed?start=0&count=30&acronyms=true"):"",this.getSPHomeData({spHomeClientContext:c,spHomeSitesCachedData:t,url:d,qosName:"spAppBarGetFrequentSites",cacheRequestKey:this._spHomeCacheKey+"frequentSites",returnStatistics:!!r,cachingStrategy:o,cacheTimeoutTime:s})},t.prototype.getFollowedSites=function(e,t,n,a,i,r,o,s){var c,d;if(void 0===n&&(n=!0),this._isDataSourceParam(e)){var l=e;c=l.spHomeClientContext,t=l.spHomeCachedItem,r=l.returnStatistics,o=l.cachingStrategy,s=l.cacheTimeoutTime}else c=e,o=0,a?o=3:i&&(o=2);return d=(null==c?void 0:c.Urls)&&c.Urls[0]?"".concat(c.Urls[0],"/api/v1/sites/followed?mostRecentFirst=true&start=0&count=30&fillSiteData=true&fillSiteCount=10"):"",this.getSPHomeData({spHomeClientContext:c,spHomeSitesCachedData:t,url:d,qosName:"spAppBarGetFollowedSites",cacheRequestKey:this._spHomeCacheKey+"followedSites",returnStatistics:!!r,cachingStrategy:o,cacheTimeoutTime:s})},t.prototype.getRecentSites=function(e,t,n,a,i,r,o,s){var c,d;if(void 0===n&&(n=!0),this._isDataSourceParam(e)){var l=e;c=l.spHomeClientContext,t=l.spHomeCachedItem,r=l.returnStatistics,o=l.cachingStrategy,s=l.cacheTimeoutTime}else c=e,o=0,a?o=3:i&&(o=2);return d=(null==c?void 0:c.Urls)&&c.Urls[0]?"".concat(c.Urls[0],"/api/v1/sites/recent?mostRecentFirst=true&start=0&count=30&fillSiteData=true&fillSiteCount=10"):"",this.getSPHomeData({spHomeClientContext:c,spHomeSitesCachedData:t,url:d,qosName:"spAppBarGetRecentSites",cacheRequestKey:this._spHomeCacheKey+"recentSites",returnStatistics:!!r,cachingStrategy:o,cacheTimeoutTime:s})},t.prototype.getNews=function(e,t,n,a,i,r,o,s){var c,d;if(void 0===n&&(n=!0),this._isDataSourceParam(e)){var l=e;c=l.spHomeClientContext,t=l.spHomeCachedItem,r=l.returnStatistics,o=l.cachingStrategy,s=l.cacheTimeoutTime}else c=e,o=0,a?o=3:i&&(o=2);return d=(null==c?void 0:c.Urls)&&c.Urls[0]?"".concat(c.Urls[0],"/api/v1/news?start=0&count=30"):"",this.getSPHomeData({spHomeClientContext:c,spHomeSitesCachedData:t,url:d,qosName:"spAppBarGetNews",cacheRequestKey:this._spHomeCacheKey+"news",returnStatistics:!!r,cachingStrategy:o,cacheTimeoutTime:s})},t.prototype.getHomeContext=function(){var e={url:"".concat(this._pageContext.webAbsoluteUrl,"/_api/sphomeservice/context?$expand=Token,Payload"),qosName:"spAppBarGetSPHomeToken",method:"GET",additionalHeaders:{accept:"application/json","SPHome-ClientType":"WebAppBar","Service-Worker-Navigation-Preload":"true"},cachingStrategy:3,cacheRequestKey:this._spHomeCacheKey+"token"};return this.getDataUtilizingPersistentCache(e)},t.prototype.shouldShowPostNewsTip=function(){return this.getDataUtilizingPersistentCache({url:"".concat(this._pageContext.webAbsoluteUrl,"/_api/sitepages/pages/feed?promotedstate=2&published=true&$top=3"),qosName:"GetFeedCount",method:"GET",cachingStrategy:3,parseResponse:function(e){var t,n;try{var a=JSON.parse(e);return(null===(n=null===(t=null==a?void 0:a.d)||void 0===t?void 0:t.results)||void 0===n?void 0:n.length)<2}catch(e){return!0}}})},t.prototype.getSPHomeData=function(e){var t=e.cachingStrategy,n={url:e.url,qosName:e.qosName,method:"GET",additionalHeaders:{"sphome-apicontext":e.spHomeClientContext.Payload,"sphome-cachecontext":e.spHomeSitesCachedData.cacheContext,"sphome-clienttype":"WebAppBar"},cacheRequestKey:e.cacheRequestKey,cachingStrategy:t,returnStatistics:e.returnStatistics},a=e.spHomeClientContext.Token;return a&&(this.isMicroserviceToken(a)?n.authToken=a.access_token:n.authToken=a.AccessToken),e.url&&0!==e.url.length||(n.getData=function(){return r.Promise.resolve()}),e.cacheTimeoutTime&&(n.cacheTimeoutTime=e.cacheTimeoutTime),this.getDataUtilizingPersistentCache(n)},t}(i.e)},X15L:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n("17wl"),i=n("1tKF"),r=n("K9kD"),o=function(e){function t(t){var n=e.call(this,{dataSourceName:"SharePointDataSource",id:"SharePointDataSource"},{pageContext:t})||this;return n._isCachedResultWithStatistic=function(e){return!!e.cacheStats},n._parseResponse=function(e,t){var i,r=!1;n._isCachedResultWithStatistic(e)?(i=e.data,r=!0):i=e;var o=t(i);return r?Object(a.__assign)(Object(a.__assign)({},e),{data:o}):o},n._cacheKey="sharepointAppBar"+"_".concat(t.aadUserId),n.pageContext=t,n}return Object(a.__extends)(t,e),t.prototype.canCreatePage=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(e.siteUrl,"/_api/sitepages/cancreatepage")},qosName:"spAppBarCanCreatePage",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_canCreatePage_").concat(e.siteCache),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return t._parseResponse(e,function(e){return!(!e||!e.d)&&e.d.CanCreatePage})})},t.prototype.canCreatePromotedPage=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return"".concat(e.siteUrl,"/_api/sitepages/cancreatepromotedpage")},qosName:"spAppBarCanCreatePromotedPage",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_canCreatePromotedPage_").concat(e.siteCache),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return t._parseResponse(e,function(e){return!(!e||!e.d)&&e.d.CanCreatePromotedPage})})},t.prototype.getRecentLists=function(e){var t=this;return this.getDataUtilizingPersistentCache({url:"".concat(this.pageContext.webAbsoluteUrl,"/_api/sp.RecentListProxy.GetRecentListsProxy/"),qosName:"spAppBarGetRecentLists",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_getRecentLists"),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseResponse(e,function(e){var t;return(null===(t=null==e?void 0:e.value)||void 0===t?void 0:t.length)>0?e.value.map(function(e){var t=e.color,n=e.icon,a=e.listId,i=e.listUrl,r=e.listTitle,o=e.siteId,s=e.siteTitle,c=e.siteUrl;return{listColor:Number(t),listIcon:Number(n),listId:a,listUrl:i,listTitle:r,siteId:o,siteTitle:s,siteUrl:c}}):[]}):[]})},t.prototype.getFavoriteLists=function(e){var t=this;return this.getDataUtilizingPersistentCache({url:"".concat(this.pageContext.webAbsoluteUrl,"/_api/SP.FavoriteLists.GetListsBy"),qosName:"spAppBarGetFavoriteLists",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_getFavoriteLists"),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseResponse(e,function(e){var t,n,a;return(null===(a=null===(n=null===(t=null==e?void 0:e.d)||void 0===t?void 0:t.GetListsBy)||void 0===n?void 0:n.results)||void 0===a?void 0:a.length)>0?e.d.GetListsBy.results.map(function(e){var t=e.color,n=e.icon,a=e.listId,i=e.listUrl,r=e.title,o=e.siteId,s=e.siteTitle,c=e.siteUrl;return{listColor:Number(t),listIcon:Number(n),listId:a,listUrl:i,listTitle:r,siteId:o,siteTitle:s,siteUrl:c}}):[]}):[]}).catch(function(e){if(e&&"-1, System.NotSupportedException"===(null==e?void 0:e.code))return[]})},t.prototype.getNewsFeed=function(e){var t=this,n=r.Killswitch.isActivated("775798BB-FA1B-42F0-94C4-87DAF8C5D1D7","01/05/2022","use lang param and orderby in getNewsFeed request")?"".concat(this.pageContext.webAbsoluteUrl,"/_api/v2.1/getNewsFeed?section=SharePointNewsFeedTargeted&$expand=analytics($expand=allTime),thumbnails"):"".concat(this.pageContext.webAbsoluteUrl,"/_api/v2.1/getNewsFeed?section=SharePointNewsFeedTargeted&preferredLanguage=").concat(r.Locale.language,"&$expand=analytics($expand=allTime),thumbnails&$orderby=FirstPublishedDate desc");return this.getDataUtilizingPersistentCache({url:n,additionalHeaders:{scenario:"SharePointAppBar"},qosName:"spAppBarGetNewsFeed",qosExtraData:{cacheTimeoutTime:e.cacheTimeoutTime,cachingStrategy:e.cachingStrategy},method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_getNewsFeed"),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseResponse(e,function(e){return(null==e?void 0:e.value)?e.value:[]}):{value:[]}})},t.prototype.getMySiteUrl=function(e){var t=this;return this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||this._pageContext.isExternalGuestUser?Promise.resolve(void 0):this.getDataUtilizingPersistentCache({url:"".concat(this.pageContext.webAbsoluteUrl,"/_api/SP.Directory.DirectorySession/me?$select=mySite"),qosName:"spAppBarGetMySiteUrl",method:"GET",noRedirect:!0,cacheRequestKey:"".concat(this._cacheKey,"_getMySiteUrl"),cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){if(e)return t._parseResponse(e,function(e){return(null==e?void 0:e.d)?e.d.mySite&&e.d.mySite.replace(/\/$/,""):void 0})})},t.prototype.getDefaultDocumentLibraryName=function(e){var t=e.webAbsoluteUrl,n=e.authToken,i=e.cacheTimeoutTime,r=e.cachingStrategy;return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,this.getDataUtilizingPersistentCache({url:"".concat(t,"/_api/web/DefaultDocumentLibrary/RootFolder/Name"),authToken:n,method:"GET",qosName:"spAppBarGetDefaultDocumentLibrary",noRedirect:!0,parseResponse:function(e){return JSON.parse(e).d.Name},cachingStrategy:r,cacheRequestKey:"".concat(this._cacheKey,"_getDefaultDocumentLibrary"),cacheTimeoutTime:i})]})})},t.prototype.createDocumentAndGetEditLink=function(e){var t=e.apiUrl,n=e.authToken;return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,this.dataRequestor.getData({method:"POST",url:t,qosName:"spAppBarCreateDocumentAndGetEditLink",authToken:n,parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})];case 1:return[2,e.sent()]}})})},t}(i.e)},rEuA:function(e,t,n){"use strict";n.r(t),n.d(t,"PreventSPAppBarCalloutDismissContext",function(){return k});var a=n("17wl"),i=n("cDcd"),r=n("7TtU"),o=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return Object(a.__extends)(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e,t){this.props.onError(e,JSON.stringify(t))},t.prototype.render=function(){return this.state.hasError?i.createElement(i.Fragment,null):i.createElement(i.Fragment,null,this.props.children)},t}(i.Component),s=n("TBTw"),c=n("u61L"),d=n("7l4e"),l=n("jidH"),u=n("X15L"),f=n("2pHE"),p=n("PltX"),m=n("K9kD");function _(e){return function(e){return!!e&&"object"==typeof e&&"default"in e}(e)?e.default:e}var h=i.lazy(function(){return Promise.all([n.e(0),n.e(15),n.e(16)]).then(n.bind(null,"+zdj"))}),b=i.lazy(function(){return Promise.all([n.e(0),n.e(3),n.e(22)]).then(n.bind(null,"at/T"))}),g=i.lazy(function(){return Promise.all([n.e(0),n.e(3)]).then(n.bind(null,"/b/M"))}),v=i.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(23)]).then(n.bind(null,"fPGQ"))}),y=i.lazy(function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,"wbrr"))}),S=i.lazy(function(){return Promise.all([n.e(0),n.e(4),n.e(24)]).then(n.bind(null,"o6Ee"))}),D=i.lazy(function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,"D4Sx"))}),I=i.lazy(function(){return Promise.all([n.e(0),n.e(14)]).then(n.bind(null,"ssIs"))}),x=i.lazy(function(){return Promise.all([n.e(0),n.e(17)]).then(n.bind(null,"OHOp"))}),C=i.lazy(function(){return Promise.all([n.e(0),n.e(5),n.e(20)]).then(n.bind(null,"Qlsk"))}),O=i.lazy(function(){return Promise.all([n.e(0),n.e(18)]).then(n.bind(null,"/g7a"))}),w=i.lazy(function(){return n.e(21).then(n.bind(null,"ApqP"))}),E=i.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(5),n.e(19)]).then(n.bind(null,"J707"))}),A=function(e){function t(t){var a,i=e.call(this,t)||this;i.tokenRefreshTimer=0,i.tokenRefreshAsync=new m.Async,i._eventListenerKSActivated=r.s(),i._isTokenErrorKSActivated=r.b(),i._isAppBarPanelRenderCleanupKSActivated=r.t(),i._isMyListsFeatureEnabled=s.t(),i._isNewNewsDataSourceFeatureEnabled=s.i(),i.componentData={},i._initializeFileTypeIcons=function(){n.e(8).then(n.bind(null,"AwmM")).then(_).then(function(e){i.initializedIcons=!0,e.initializeFileTypeIcons()})},i._isTokenExpired=function(e){return!(null==e?void 0:e.Token)||i._getExpirationTimeLeft(e.Token)<=0},i._getExpirationTimeLeft=function(e){return i.spHomeDataSource.isMicroserviceToken(e)?1e3*parseInt(e.expires_on,10)-Date.now():1e3*parseInt(e.ExpiresOn,10)-Date.now()},i._clearClientContext=function(){i._isTokenErrorKSActivated||i.state.clientContext||null===i.state.clientContext||i.setState({clientContext:null})},i._setTimeoutAndGetHomeContext=function(e){(i._isTokenErrorKSActivated||e>0)&&(i.tokenRefreshTimer=i.tokenRefreshAsync.setTimeout(function(){i.spHomeDataSource.getHomeContext().then(function(e){i._checkAndSetContext(e)}).catch(function(){i._clearClientContext()})},e))},i._checkAndSetContext=function(e,t){if(e.Token){var n=e.Token,a=i._getExpirationTimeLeft(n);a>=3e4&&(t||i.setState({clientContext:e}),i._setTimeoutAndGetHomeContext(a-3e4))}else i._clearClientContext()},i._shouldPrewarm=function(e){return!i.hasGottenFreshData&&("blank"===e.workload&&"blank"!==i.state.workload||"teams"===i.state.workload)},i._handleWorkloadMessages=function(e){if(e.origin===i.windowOrigin&&e.data&&e.data.type)if("spAppBarWorkload"===e.data.type){var t=Object(d.n)("workload",e.data.payload);i.setState({workload:t})}else if("setRTL"===e.data.type){var n=e.data.isRTL?"rtl":"ltr";document.documentElement.setAttribute("dir",n)}else"spAppBarWorkloadBlank"===e.data.type&&i.setState({workload:"blank"})},i._messageParentAppStarted=function(){window.postMessage({type:"spAppBarPanelStarted"},i.windowOrigin)},i._setUpAndPrewarm=function(e){i._fetchTokenIfExpired(),i.hasGottenFreshData=!0,i.filesDataSource=new f.e(i.pageContext),i.globalnavDataSource=new l.e(i.pageContext),i.sharePointDataSource=new u.e(i.pageContext),i._prewarmDataClick(e)},i._fetchTokenIfExpired=function(){i._isTokenExpired(i.state.clientContext)&&i.spHomeDataSource.getHomeContext().then(function(e){i.tokenRefreshTimer&&i.tokenRefreshAsync.clearTimeout(i.tokenRefreshTimer),i._checkAndSetContext(e)}).catch(function(){i._clearClientContext()})},i._prewarmDataClick=function(e){n.e(7).then(n.bind(null,"0eCT")).then(_).then(function(t){var n,a;"files"!==e&&(t.logData({name:"SPAppBar.Files.DataClick"}),i._getFilesNetwork()),"globalnav"!==e&&(null===(n=i.pageContext.appBarParams)||void 0===n?void 0:n.isGlobalNavEnabled)&&(null===(a=i.pageContext.companyPortalReference)||void 0===a?void 0:a.SiteId)&&(t.logData({name:"SPAppBar.GlobalNav.DataClick"}),i.globalnavDataSource.getGlobalNav(!1).catch()),"news"!==e&&(t.logData({name:"SPAppBar.News.DataClick"}),i._isNewNewsDataSourceFeatureEnabled?i.sharePointDataSource.getNewsFeed({cachingStrategy:0,cacheTimeoutTime:c.l,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"news")}).catch():i._getSPHomeNetwork(i.spHomeDataSource.getNews.bind(i.spHomeDataSource),c.l,c.c,"news")),"sites"!==e&&(t.logData({name:"SPAppBar.Frequent.DataClick"}),i._getSPHomeNetwork(i.spHomeDataSource.getFrequentSites.bind(i.spHomeDataSource),c.p,c.r,"frequentSites"),t.logData({name:"SPAppBar.Followed.DataClick"}),i._getSPHomeNetwork(i.spHomeDataSource.getFollowedSites.bind(i.spHomeDataSource),c.p,c.i,"followedSites"),t.logData({name:"SPAppBar.Recent.DataClick"}),i._getSPHomeNetwork(i.spHomeDataSource.getRecentSites.bind(i.spHomeDataSource),c.p,c.f,"recentSites")),"lists"!==e&&i._isMyListsFeatureEnabled&&(t.logData({name:"SPAppBar.Lists.Recent.DataClick"}),i._getRecentListsNetwork(),t.logData({name:"SPAppBar.Lists.Favorite.DataClick"}),i._getFavoriteListsNetwork())})},i._getFilesNetwork=function(){i.filesDataSource.getRecentFiles({cachingStrategy:1,returnStatistics:!0,maxItems:c.n}).then(function(e){i.receivedNewData(e,"files")}).catch()},i._getRecentListsNetwork=function(){i.sharePointDataSource.getRecentLists({cachingStrategy:0,cacheTimeoutTime:c.o,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"recentLists")}).catch()},i._getFavoriteListsNetwork=function(){i.sharePointDataSource.getFavoriteLists({cachingStrategy:0,cacheTimeoutTime:c.o,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"favoriteLists")}).catch()},i._getSPHomeNetwork=function(e,t,n,a){var r=i.state.cachedData&&i.state.cachedData.find(function(e){return e.Key===n}),o=null;if(r&&i.state.clientContext?o=e({cachingStrategy:1,spHomeCachedItem:r.Value,spHomeClientContext:i.state.clientContext,returnStatistics:!0,cacheTimeoutTime:t}):i.state.clientContext&&i.state.clientContext.Token&&(o=e({cachingStrategy:1,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:i.state.clientContext,returnStatistics:!0,cacheTimeoutTime:t})),o){switch(a){case"news":i.needsNewsData=!1;break;case"frequentSites":i.needsFrequentSitesData=!1;break;case"followedSites":i.needsFollowedSitesData=!1;break;case"recentSites":i.needsRecentSitesData=!1}o.then(function(e){i.receivedNewData(e,a)}).catch()}else switch(a){case"news":i.needsNewsData=!0;break;case"frequentSites":i.needsFrequentSitesData=!1;break;case"followedSites":i.needsFollowedSitesData=!1;break;case"recentSites":i.needsRecentSitesData=!1}};var o=Object(d.n)("workload",t.query);return i.state={workload:o,cachedData:void 0,clientContext:void 0},i.pageContext=null!==(a=i.props.spPageContextInfo)&&void 0!==a?a:window._spPageContextInfo,i.windowOrigin=window.location.origin,i.spHomeDataSource=new p.e(i.pageContext),i._eventListenerKSActivated&&(window.addEventListener("message",i._handleWorkloadMessages.bind(i)),i._messageParentAppStarted()),i.receivedNewData=c.D.bind(i),i}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){!t.clientContext&&this.state.clientContext&&(this.needsNewsData&&this._getSPHomeNetwork(this.spHomeDataSource.getNews.bind(this.spHomeDataSource),c.l,c.c,"news"),this.needsFrequentSitesData&&this._getSPHomeNetwork(this.spHomeDataSource.getFrequentSites.bind(this.spHomeDataSource),c.p,c.r,"frequentSites"),this.needsFollowedSitesData&&this._getSPHomeNetwork(this.spHomeDataSource.getFollowedSites.bind(this.spHomeDataSource),c.p,c.i,"followedSites"),this.needsRecentSitesData&&this._getSPHomeNetwork(this.spHomeDataSource.getRecentSites.bind(this.spHomeDataSource),c.p,c.f,"recentSites")),this._fetchTokenIfExpired(),this._shouldPrewarm(t)&&this._setUpAndPrewarm(this.state.workload)},t.prototype.componentDidMount=function(){this._eventListenerKSActivated||(window.addEventListener("message",this._handleWorkloadMessages),this._messageParentAppStarted()),"blank"!==this.state.workload&&this._setUpAndPrewarm(this.state.workload)},t.prototype.componentWillUnmount=function(){this._eventListenerKSActivated||window.removeEventListener("message",this._handleWorkloadMessages)},t.prototype.render=function(){var e=this;return this._isAppBarPanelRenderCleanupKSActivated?function(){var t,n=!1;switch(e.state.workload){case"globalnav":if(e.componentData.globalnav){var a=e.componentData.globalnav;t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(y,{rawNavData:a,useRouterNavigation:n,pageContext:e.pageContext,onDismissAppBarPanel:e.props.onDismissAppBarPanel}))}else t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(v,{useRouterNavigation:n,sendUpdatedDataToParent:e.receivedNewData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext}));break;case"sites":if(e.componentData.frequentSites&&e.componentData.followedSites&&e.componentData.recentSites){var r=e.componentData.frequentSites,o=e.componentData.followedSites,s=e.componentData.recentSites;t=Object(c.b)(r.cacheStats.lastModified,c.p)&&Object(c.b)(o.cacheStats.lastModified,c.p)&&Object(c.b)(s.cacheStats.lastModified,c.p)?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(O,{frequentSites:Object(c.S)(r.data),followedSites:Object(c.S)(o.data),recentSites:Object(c.S)(s.data),useRouterNavigation:n,hideFrequentSites:!1,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(d.e)(window.innerHeight,!1)})):i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(C,{useRouterNavigation:n,sendUpdatedDataToParent:e.receivedNewData,clientContext:e.state.clientContext,cachedData:e.state.cachedData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(d.e)(window.innerHeight,!1)}))}else t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(C,{useRouterNavigation:n,sendUpdatedDataToParent:e.receivedNewData,clientContext:e.state.clientContext,cachedData:e.state.cachedData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(d.e)(window.innerHeight,!1)}));break;case"news":if(e.componentData.news){var l=e.componentData.news;t=Object(c.b)(l.cacheStats.lastModified,c.l)?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(x,{news:Object(c.y)(l.data),useRouterNavigation:n,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(d.e)(window.innerHeight,!0)})):i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(I,{useRouterNavigation:n,sendUpdatedDataToParent:e.receivedNewData,clientContext:e.state.clientContext,cachedData:e.state.cachedData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(d.e)(window.innerHeight,!0)}))}else t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(I,{useRouterNavigation:n,sendUpdatedDataToParent:e.receivedNewData,clientContext:e.state.clientContext,cachedData:e.state.cachedData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(d.e)(window.innerHeight,!0)}));break;case"files":if(e.componentData.files){e.initializedIcons||e._initializeFileTypeIcons();var u=e.componentData.files;t=Object(c.b)(u.cacheStats.lastModified,c.a)?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(g,{files:u.data,useRouterNavigation:n,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(d.e)(window.innerHeight,!0)})):i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(b,{useRouterNavigation:n,sendUpdatedDataToParent:e.receivedNewData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(d.e)(window.innerHeight,!0)}))}else e.initializedIcons||e._initializeFileTypeIcons(),t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(b,{useRouterNavigation:n,sendUpdatedDataToParent:e.receivedNewData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(d.e)(window.innerHeight,!0)}));break;case"teams":t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(E,{useRouterNavigation:!0,clientContext:e.state.clientContext,cachedData:e.state.cachedData,pageContext:e.pageContext}));break;case"create":e.initializedIcons||e._initializeFileTypeIcons(),e.componentData.frequentSites&&e.componentData.followedSites?(r=e.componentData.frequentSites,o=e.componentData.followedSites,t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(h,{clientContext:e.state.clientContext,pageContext:e.pageContext,useRouterNavigation:!1,onDismissAppBarPanel:e.props.onDismissAppBarPanel,frequentSites:Object(c.S)(r.data),followedSites:Object(c.S)(o.data),countToRender:Object(d.e)(window.innerHeight,!1)}))):t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(h,{clientContext:e.state.clientContext,pageContext:e.pageContext,useRouterNavigation:!1,onDismissAppBarPanel:e.props.onDismissAppBarPanel}));break;case"lists":if(e.componentData.recentLists&&e.componentData.favoriteLists){var f=e.componentData.recentLists,p=e.componentData.favoriteLists;t=Object(c.b)(f.cacheStats.lastModified,c.o)&&Object(c.b)(p.cacheStats.lastModified,c.o)?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(D,{recentLists:f.data,favoriteLists:p.data,useRouterNavigation:n,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(d.e)(window.innerHeight,!1,"lists")})):i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(S,{useRouterNavigation:n,sendUpdatedDataToParent:e.receivedNewData,clientContext:e.state.clientContext,cachedData:e.state.cachedData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(d.e)(window.innerHeight,!1,"lists")}))}else t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(S,{useRouterNavigation:n,sendUpdatedDataToParent:e.receivedNewData,clientContext:e.state.clientContext,cachedData:e.state.cachedData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(d.e)(window.innerHeight,!1,"lists")}));break;default:t=null}return t?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(w,{content:t})):null}():function(){var t=null,n={useRouterNavigation:!1,pageContext:e.pageContext,onDismissAppBarPanel:e.props.onDismissAppBarPanel},r=Object(a.__assign)(Object(a.__assign)({},n),{sendUpdatedDataToParent:e.receivedNewData,clientContext:e.state.clientContext,cachedData:e.state.cachedData});switch(e.state.workload){case"globalnav":t=e.componentData.globalnav?i.createElement(y,Object(a.__assign)({rawNavData:e.componentData.globalnav},n)):i.createElement(v,Object(a.__assign)({},r));break;case"sites":if(e.componentData.frequentSites&&e.componentData.followedSites&&e.componentData.recentSites){var o=e.componentData.frequentSites,s=e.componentData.followedSites,l=e.componentData.recentSites;t=Object(c.b)(o.cacheStats.lastModified,c.p)&&Object(c.b)(s.cacheStats.lastModified,c.p)?i.createElement(O,Object(a.__assign)({},n,{frequentSites:Object(c.S)(o.data),followedSites:Object(c.S)(s.data),recentSites:Object(c.S)(l.data),hideFrequentSites:!1,countToRender:Object(d.e)(window.innerHeight,!1)})):i.createElement(C,Object(a.__assign)({},r,{countToRender:Object(d.e)(window.innerHeight,!1)}))}else t=i.createElement(C,Object(a.__assign)({},r,{countToRender:Object(d.e)(window.innerHeight,!1)}));break;case"news":if(e.componentData.news){var u=e.componentData.news;t=Object(c.b)(u.cacheStats.lastModified,c.l)?i.createElement(x,Object(a.__assign)({},n,{news:Object(c.y)(u.data),countToRender:Object(d.e)(window.innerHeight,!0)})):i.createElement(I,Object(a.__assign)({},r,{countToRender:Object(d.e)(window.innerHeight,!0)}))}else t=i.createElement(I,Object(a.__assign)({},r,{countToRender:Object(d.e)(window.innerHeight,!0)}));break;case"files":if(e.componentData.files){e.initializedIcons||e._initializeFileTypeIcons();var f=e.componentData.files;t=Object(c.b)(f.cacheStats.lastModified,c.a)?i.createElement(g,Object(a.__assign)({},n,{files:f.data,countToRender:Object(d.e)(window.innerHeight,!0)})):i.createElement(b,Object(a.__assign)({},r,{countToRender:Object(d.e)(window.innerHeight,!0)}))}else e.initializedIcons||e._initializeFileTypeIcons(),t=i.createElement(b,Object(a.__assign)({},r,{countToRender:Object(d.e)(window.innerHeight,!0)}));break;case"teams":t=i.createElement(E,{useRouterNavigation:!0,clientContext:e.state.clientContext,cachedData:e.state.cachedData,pageContext:e.pageContext});break;case"create":e.initializedIcons||e._initializeFileTypeIcons(),e.componentData.frequentSites&&e.componentData.followedSites?(o=e.componentData.frequentSites,s=e.componentData.followedSites,t=i.createElement(h,Object(a.__assign)({},n,{clientContext:e.state.clientContext,frequentSites:Object(c.S)(o.data),followedSites:Object(c.S)(s.data),countToRender:Object(d.e)(window.innerHeight,!1)}))):t=i.createElement(h,Object(a.__assign)({},n,{clientContext:e.state.clientContext}));break;case"lists":if(e.componentData.recentLists&&e.componentData.favoriteLists){var p=e.componentData.recentLists,m=e.componentData.favoriteLists;t=Object(c.b)(p.cacheStats.lastModified,c.o)&&Object(c.b)(m.cacheStats.lastModified,c.o)?i.createElement(D,Object(a.__assign)({},n,{recentLists:p.data,favoriteLists:m.data,countToRender:Object(d.e)(window.innerHeight,!1,"lists")})):i.createElement(S,Object(a.__assign)({},r,{countToRender:Object(d.e)(window.innerHeight,!1,"lists")}))}else t=i.createElement(S,Object(a.__assign)({},r,{countToRender:Object(d.e)(window.innerHeight,!1,"lists")}));break;default:t=null}return t?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(w,{content:i.createElement(i.Suspense,{fallback:i.createElement("div",null)},t)})):i.createElement(i.Fragment,null)}()},t}(i.PureComponent),L=n("KL1q"),k=i.createContext([!1,function(){}]),M=function(e){function t(t){var n=e.call(this,t)||this;return n._errorBoundaryKSActivated=r.o(),n._isPreventClosingPanelWhenNameDialogIsOpenKSActivated=r.m(),n._preventDismissOnEvent=function(e){var t;return!n._isPreventClosingPanelWhenNameDialogIsOpenKSActivated&&null!==(t=n.state.preventDismissal)&&void 0!==t&&t},n._onErrorBoundary=function(e,t){e&&n._qos.end({resultType:m.ResultTypeEnum.Failure,error:e.message,extraData:{errorInfo:t}})},n._handleEventFromAppBar=function(e){e.origin===window.location.origin&&e.data&&e.data.type&&("spAppBarWorkload"===e.data.type?e.data.payload!==n.state.appbarQueryString?n.setState({showAppBarCallout:!0,appbarQueryString:e.data.payload}):n.state.showAppBarCallout||(n.state.firstClose?n.setState({firstClose:!1}):n.setState({showAppBarCallout:!0,appbarQueryString:e.data.payload})):"CLOSE_CALLOUT"!==e.data.type&&"spAppBarCreateSite"!==e.data.type||n.state.showAppBarCallout&&n.setState({showAppBarCallout:!1}))},n._dismissAppBarPanel=function(e){if(n.state.showAppBarCallout&&(!e||!e.target||"sp-appBar-link"!==e.target.className)){if("focus"===(null==e?void 0:e.type))return;n.setState({showAppBarCallout:!1}),window.postMessage({type:"CLOSE_CALLOUT"},window.location.origin),window.postMessage({type:"spAppBarWorkloadBlank"},window.location.origin)}},window.addEventListener("message",n._handleEventFromAppBar),n.state={showAppBarCallout:!1,appbarQueryString:"/_layouts/15/spappbar.aspx?workload=blank",firstClose:!1,preventDismissal:!1},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._qos=new m.Qos({name:"SPAppBar.Callout.Render"})},t.prototype.render=function(){var e=this,t=document.getElementById("sp-appBar"),n=null==t?void 0:t.classList.contains("sp-appBar-mobile"),a={root:{height:"100%",display:"flex",flexDirection:"column",minWidth:n?"100vw":"320px",maxWidth:n?"unset":"320px",borderRadius:0,boxShadow:"10px 5.4px 14.4px -10px rgb(0 0 0 / 13%), 10px 0.2px 3.6px -10px rgb(0 0 0 / 11%)",animation:"none",bottom:"0px !important"},container:{height:"100%",zIndex:11},calloutMain:{display:"flex",flexDirection:"column",height:"100%",borderRadius:0},beak:{height:"97%"},beakCurtain:{height:"96%"}},r=i.createElement(k.Provider,{value:[this.state.preventDismissal,function(t){return e.setState({preventDismissal:t})}]},i.createElement(L.Callout,{className:"spappbar-callout",id:"sp-appBar-callout",gapSpace:0,target:".sp-appBar",isBeakVisible:!1,directionalHint:L.DirectionalHint.topCenter,setInitialFocus:!0,styles:a,doNotLayer:!0,minPagePadding:-1,hidden:!this.state.showAppBarCallout,onDismiss:this._dismissAppBarPanel,shouldUpdateWhenHidden:!0,dismissOnTargetClick:!0,preventDismissOnEvent:this._preventDismissOnEvent,role:"dialog"},i.createElement(A,{query:this.state.appbarQueryString,onDismissAppBarPanel:this._dismissAppBarPanel,spPageContextInfo:this.props.spPageContextInfo})));return this._errorBoundaryKSActivated?r:i.createElement(o,{onError:this._onErrorBoundary},r)},t}(i.Component);t.default=M},u61L:function(e,t,n){"use strict";n.d(t,"d",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"u",function(){return u}),n.d(t,"l",function(){return f}),n.d(t,"p",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"o",function(){return _}),n.d(t,"s",function(){return h}),n.d(t,"t",function(){return b}),n.d(t,"c",function(){return g}),n.d(t,"r",function(){return v}),n.d(t,"i",function(){return y}),n.d(t,"f",function(){return S}),n.d(t,"n",function(){return D}),n.d(t,"h",function(){return x}),n.d(t,"v",function(){return C}),n.d(t,"b",function(){return O}),n.d(t,"g",function(){return w}),n.d(t,"I",function(){return E}),n.d(t,"_",function(){return A}),n.d(t,"y",function(){return L}),n.d(t,"S",function(){return k}),n.d(t,"m",function(){return M}),n.d(t,"D",function(){return P});var a=n("TBTw"),i=n("7TtU"),r=n("71k8"),o=n("K9kD"),s=n("KL1q"),c="_spAppBarNewsSitesCachedData",d="_spAppBarHomeClientContext",l=36e5,u=1*l,f=3e5,p=4*l,m=9e5,_=1*l,h=4*l,b=4*l,g="SPHomeWeb:news",v="SPHomeWeb:sites/feed",y="SPHomeWeb:sites/followed",S="SPHomeWeb:sites/recent",D=30,I=function(e){var t;switch(e){case"STS":t=r.t.teamSite;break;case"SPSPERS":t=r.t.mySite;break;case"GROUP":t=r.t.group;break;case"SITEPAGEPUBLISHING":t=r.t.sitePagePublishing;break;default:t=r.t.invalid}return t},x=function(e,t,n,a,r,o,s,c,d){if(e)return t({cachingStrategy:2,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:{Urls:[""],Token:{AccessToken:"",ExpiresOn:""}},returnStatistics:!0}).then(function(e){var t;return e&&(i.f()||(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.Items)&&e.data.Items.length>0)?(d(e,a),O(e.cacheStats.lastModified,n)?{data:c(e.data),stale:!1,date:e.cacheStats.lastModified}:{data:c(e.data),stale:!0,date:e.cacheStats.lastModified}):{data:[],stale:!0,date:0}});var l=o&&o.find(function(e){return e.Key===s}),u=null;return l&&r?u=t({cachingStrategy:1,spHomeCachedItem:l.Value,spHomeClientContext:r,returnStatistics:!0,cacheTimeoutTime:n}):r&&r.Token&&(u=t({cachingStrategy:1,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:r,returnStatistics:!0,cacheTimeoutTime:n})),u?u.then(function(e){var t;return i.f()||(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.Items)&&e.data.Items.length>0?(d(e,a),{data:c(e.data),stale:!1,date:Date.now()}):{data:[],stale:!0,date:0}}):Promise.resolve({data:[],stale:!0,date:0})},C=function(e,t){try{if(e){var n=JSON.parse(e);if(n)return t(n)}}catch(e){}},O=function(e,t){return Date.now()-e<=t},w=function(e){return function(t){1!==t.button&&2!==t.button||o.Engagement.logData({name:e})}},E=function(e){return e.which===Object(s.getRTLSafeKeyCode)(s.KeyCodes.right)},A=function(e){return function(t){if(t.which===s.KeyCodes.enter){var n=document.getElementById(e);null==n||n.click()}}},L=function(e){if(a.i()){var t=e.map(function(e){var t,n,a;return{author:i.u()?e.createdBy:{Title:null===(n=null===(t=e.createdBy)||void 0===t?void 0:t.user)||void 0===n?void 0:n.displayName},description:e.description,publishDate:new Date(i.g()?e.createdDateTime:e.firstPublishedDate),title:e.title,url:e.webUrl,isAuthoritative:!1,site:{id:e.sharepointIds.siteId,serverRelativeUrl:e.parentReference.path,title:e.parentReference.siteTitle,webTemplateId:0},image:null===(a=e.thumbnails)||void 0===a?void 0:a[0].source.url}});return i.c()?t.sort(function(e,t){return t.publishDate.getTime()-e.publishDate.getTime()}):t}return e.Items.map(function(e){var t=e.Author,n=e.Description,a=e.ImageUrl,i=e.Title,r=e.IsAuthoritativeNews,o=e.OriginalUrl||e.Url,s=new Date(e.FirstPublishedDate),c=e.Site,d=c.ItemReference;return{author:t,description:n,isAuthoritative:r,publishDate:s,site:{id:d.WebId,siteCollectionId:d.SiteId,title:c.Title,isExternal:c.IsExternalContent,serverRelativeUrl:c.OriginalUrl||c.Url,icon:c.BannerImageUrl,color:c.BannerColor,acronym:c.Acronym,indexId:d.IndexId,itemReference:d,weight:c.Weight||0,pinOrder:c.PinOrder,webTemplateId:I(c.WebTemplate),WebTemplate:c.WebTemplate,allowPinning:!!d&&!!d.SiteId&&!!d.WebId},title:i,url:o,image:a}})},k=function(e){return e.Items.map(function(e){var t=e.ItemReference,n=t.WebId,a=t.SiteId,i=t.IndexId,r=e.Title,o=e.IsExternalContent,s=e.ItemReference,c=e.BannerImageUrl,d=e.BannerColor,l=e.Acronym,u=e.Weight,f=e.PinOrder,p=e.WebTemplate;return{id:n,siteCollectionId:a,title:r,isExternal:o,serverRelativeUrl:e.OriginalUrl||e.Url,icon:c,color:d,acronym:l,indexId:i,itemReference:s,weight:u||0,pinOrder:f,allowPinning:!!s&&!!s.SiteId&&!!s.WebId,webTemplateId:I(p),WebTemplate:p}})},M=function(e,t,n,a){var i=(a?t.filter(function(e){return e.serverRelativeUrl!==a}):t).slice(0,n);return[e.filter(function(e){return a?e.serverRelativeUrl!==a:i.reduce(function(t,n){return t&&n.serverRelativeUrl!==e.serverRelativeUrl},!0)}),i]};function P(e,t){var n;if(e&&t)if(e.name)this.componentData[t]=e;else{var a=this.componentData[t];(null===(n=null==a?void 0:a.cacheStats)||void 0===n?void 0:n.lastModified)?e.cacheStats.lastModified>a.cacheStats.lastModified?this.componentData[t]=e:isNaN(e.cacheStats.lastModified)&&(e.cacheStats.lastModified=Date.now(),this.componentData[t]=e):this.componentData[t]=e}}}}]);