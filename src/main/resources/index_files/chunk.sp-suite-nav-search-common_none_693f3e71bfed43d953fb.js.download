(window.webpackJsonpf8a8ad94_4cf3_4a19_a76b_1cec9da00219_0_1_0=window.webpackJsonpf8a8ad94_4cf3_4a19_a76b_1cec9da00219_0_1_0||[]).push([[1],{gbBp:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return G});var a=n("Pk8u"),i=n("UWqr");function r(e,t,n){return void 0===n&&(n=!1),function(a,r,o,s,c){void 0===o&&(o=!1),void 0===s&&(s=""),void 0===c&&(c=!1);var d,l,u=0,f=function(){return c&&u>0&&u<=2};return a.withPeriodicRefresh(e,(d=function(){return(o?a.fetchSharePointDigestV2({endpoint:r,overrideDigest:s,tokenProvider:function(){return Promise.resolve("")}}):a.fetchSharePointDigest({endpoint:r,forceDigestRefresh:f})).then(function(e){return JSON.parse(e.xhr.responseText).d.GetContextWebInformation.FormDigestValue}).then(function(e){return a.fetchAcquireToken({portalUrl:r,resourceUrl:t,digest:e,useSTI:n})}).then(function(e){var t=JSON.parse(e.xhr.responseText),n=t.access_token,a=t.expires_on;return u=0,i._SPKillSwitch.isActivated("add015d8-3cd4-4362-b552-524729334435")?n:a?{token:n,expiry:a}:n}).catch(function(e){throw e&&e.status&&403===e.status&&c&&u++,new Error("Failed to retrieve a valid token")})},l=void 0,function(e){return!e.attempt&&l?l:l=d()}))}}var o,s=Object(a.once)(r("bingSerpTokenProvider","https://www.bing.com")),c=Object(a.once)(r("lokiAadSearchBoxTokenProvider","https://loki.delve.office.com")),d=Object(a.once)(r("stiSubstrateTokenProvider","https://substrate.office.com",!0)),l=Object(a.once)(r("aadSubstrateTokenProvider","https://outlook.office365.com/search",!1)),u=Object(a.once)(r("aadGallatinSubstrateTokenProvider","https://partner.outlook.cn/search",!1)),f=n("K9kD");function p(e){return function(){return i._SPFlight.isEnabled(e)}}var m,_,h=p(1407),b=p(1369),g=p(1323),v=p(1324),y=(p(1356),p(1574)),S=p(1575),D=(p(1102),p(1260),p(218),p(1433),p(1411),p(1571)),I=p(1572),x=(p(1240),p(1810),p(1291),p(1565),p(1563),p(1579)),C=p(1580),O=(p(1598),p(1313)),w=p(1321),E=(p(1055),p(1421),p(1422),p(1166),p(1682)),A=p(1720),L=(p(1721),p(1853)),k=p(1888),M=(p(1823),p(60095),n("rHDF")),P=n("n1Yx"),T=n("zLqp"),U=Object(a.once)(function(){m=new T.Dispatcher,_=[],m.register(function(e){return _.push(e)}),Object(P.t)(m)}),F=!1;function H(e,t,n,a,i,r,s,c){return void 0===r&&(r=.5),void 0===s&&(s=!0),void 0===c&&(c=!1),function(d){var l=o;if(!l)throw new Error("checking experiment ".concat(e," before calling initSearchExperiments"));if(F||(f.ABExperiment.Init(l),F=!0),!s&&Object(M.e)(l))return!1;if(t())return!0;if(n()){var u=new f.ABExperiment({name:a,startDate:i,segmentPopulation:r}).IsExperimentOn();return c&&(U(),Object(P.e)()).dispatch({eventType:"USAGE",nameDetail:"searchux.".concat(a),name:"experiments",properties:{inTreatment:u}}),d&&d.sets&&d.sets("searchux.".concat(e,"Experiment"),u),u}return!1}}var R,N,B=H("aadTokenForSubstrate",x,C,"AadTokenForSubstrateExperiment","06/01/2019"),j=(H("digestV2",O,w,"DigestV2Experiment","06/25/2019"),H("enableQueryRules",D,I,"EnableQueryRulesExperiment","08/05/2019"),H("answerBlock",h,b,"showAnswerBlock","03/26/2019"),H("useSubstrateSearch",g,v,"SubstrateSearchExperiment","15/05/2019",.5,!1),H("use3SAnswers",y,S,"Use3SAnswersExperiment","05/01/2019"),H("use3SFileSuggestions",function(){return!1},function(){return!1},"3SFileSuggestionsExperiment","10/01/2019"),H("use3SPeopleSuggestions",function(){return!1},function(){return!1},"3SPeopleSuggestionsExperiment","16/01/2019"),H("use3SSiteSuggestions",function(){return!1},function(){return!1},"3SSiteSuggestionsExperiment","10/01/2019"),H("use3SEarlyWarmup",E,A,"3SEarlyWarmupExperiment","11/10/2019"),H("personalizedSpeller",L,k,"personalizedSpellerExperiment","01/03/2020",.5,!0,!0),n("wxe1")),V=n("+P3I"),z=n("2xJV");function G(e,t,n,a){var i;j.t(a),i=t.legacyPageContext,o=i;var r=function(e,t){return R||(R={BingForBusiness:s(V,t),Loki:c(V,t),Substrate:(n=V,a=B(),i=t,void 0===r&&(r=!1),void 0===p&&(p="Prod"),a?function(e){return"Gallatin"===e?u:l}(p)(n,i,r,o,f):d(n,i,r,o,f)),SharePointSites:function(n){return!n.attempt&&N||(N=function(e){return z.e({url:"".concat(e,"/_api/sphomeservice/context?$expand=Token,Payload"),method:"GET",headers:{Accept:"application/json","SPHome-ClientType":"Web"}}).then(function(e){var t=e.responseText;return JSON.parse(t)})}(t).then(function(t){var n=t.Payload,a=t.Token,i=a.access_token,r=a.resource;if(!e||!e.Search)throw new Error("No search shim available.");return e.Search.SetSharePointHomeApiRequestInfo({url:"".concat(r,"/api/v1"),context:JSON.parse(n)}),i}))}});var n,a,i,r,o,f,p}(e,t.web.absoluteUrl);return n.markHeaderBoot(),{tokenProviders:r}}}}]);